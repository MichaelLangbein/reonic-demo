var JW=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var D_e=JW((wke,ZA)=>{(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();function sy(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var qT={exports:{}},ay={},HT={exports:{}},Se={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gp=Symbol.for("react.element"),eq=Symbol.for("react.portal"),tq=Symbol.for("react.fragment"),nq=Symbol.for("react.strict_mode"),rq=Symbol.for("react.profiler"),iq=Symbol.for("react.provider"),oq=Symbol.for("react.context"),sq=Symbol.for("react.forward_ref"),aq=Symbol.for("react.suspense"),lq=Symbol.for("react.memo"),uq=Symbol.for("react.lazy"),o5=Symbol.iterator;function cq(e){return e===null||typeof e!="object"?null:(e=o5&&e[o5]||e["@@iterator"],typeof e=="function"?e:null)}var VT={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},GT=Object.assign,YT={};function pf(e,t,n){this.props=e,this.context=t,this.refs=YT,this.updater=n||VT}pf.prototype.isReactComponent={};pf.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};pf.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function XT(){}XT.prototype=pf.prototype;function US(e,t,n){this.props=e,this.context=t,this.refs=YT,this.updater=n||VT}var WS=US.prototype=new XT;WS.constructor=US;GT(WS,pf.prototype);WS.isPureReactComponent=!0;var s5=Array.isArray,QT=Object.prototype.hasOwnProperty,qS={current:null},KT={key:!0,ref:!0,__self:!0,__source:!0};function ZT(e,t,n){var r,i={},o=null,s=null;if(t!=null)for(r in t.ref!==void 0&&(s=t.ref),t.key!==void 0&&(o=""+t.key),t)QT.call(t,r)&&!KT.hasOwnProperty(r)&&(i[r]=t[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(e&&e.defaultProps)for(r in a=e.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:gp,type:e,key:o,ref:s,props:i,_owner:qS.current}}function fq(e,t){return{$$typeof:gp,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function HS(e){return typeof e=="object"&&e!==null&&e.$$typeof===gp}function dq(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var a5=/\/+/g;function Mx(e,t){return typeof e=="object"&&e!==null&&e.key!=null?dq(""+e.key):t.toString(36)}function x0(e,t,n,r,i){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case gp:case eq:s=!0}}if(s)return s=e,i=i(s),e=r===""?"."+Mx(s,0):r,s5(i)?(n="",e!=null&&(n=e.replace(a5,"$&/")+"/"),x0(i,t,n,"",function(u){return u})):i!=null&&(HS(i)&&(i=fq(i,n+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(a5,"$&/")+"/")+e)),t.push(i)),1;if(s=0,r=r===""?".":r+":",s5(e))for(var a=0;a<e.length;a++){o=e[a];var l=r+Mx(o,a);s+=x0(o,t,n,l,i)}else if(l=cq(e),typeof l=="function")for(e=l.call(e),a=0;!(o=e.next()).done;)o=o.value,l=r+Mx(o,a++),s+=x0(o,t,n,l,i);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function hg(e,t,n){if(e==null)return e;var r=[],i=0;return x0(e,r,"","",function(o){return t.call(n,o,i++)}),r}function hq(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var In={current:null},w0={transition:null},pq={ReactCurrentDispatcher:In,ReactCurrentBatchConfig:w0,ReactCurrentOwner:qS};function JT(){throw Error("act(...) is not supported in production builds of React.")}Se.Children={map:hg,forEach:function(e,t,n){hg(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return hg(e,function(){t++}),t},toArray:function(e){return hg(e,function(t){return t})||[]},only:function(e){if(!HS(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Se.Component=pf;Se.Fragment=tq;Se.Profiler=rq;Se.PureComponent=US;Se.StrictMode=nq;Se.Suspense=aq;Se.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=pq;Se.act=JT;Se.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=GT({},e.props),i=e.key,o=e.ref,s=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,s=qS.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(l in t)QT.call(t,l)&&!KT.hasOwnProperty(l)&&(r[l]=t[l]===void 0&&a!==void 0?a[l]:t[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:gp,type:e.type,key:i,ref:o,props:r,_owner:s}};Se.createContext=function(e){return e={$$typeof:oq,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:iq,_context:e},e.Consumer=e};Se.createElement=ZT;Se.createFactory=function(e){var t=ZT.bind(null,e);return t.type=e,t};Se.createRef=function(){return{current:null}};Se.forwardRef=function(e){return{$$typeof:sq,render:e}};Se.isValidElement=HS;Se.lazy=function(e){return{$$typeof:uq,_payload:{_status:-1,_result:e},_init:hq}};Se.memo=function(e,t){return{$$typeof:lq,type:e,compare:t===void 0?null:t}};Se.startTransition=function(e){var t=w0.transition;w0.transition={};try{e()}finally{w0.transition=t}};Se.unstable_act=JT;Se.useCallback=function(e,t){return In.current.useCallback(e,t)};Se.useContext=function(e){return In.current.useContext(e)};Se.useDebugValue=function(){};Se.useDeferredValue=function(e){return In.current.useDeferredValue(e)};Se.useEffect=function(e,t){return In.current.useEffect(e,t)};Se.useId=function(){return In.current.useId()};Se.useImperativeHandle=function(e,t,n){return In.current.useImperativeHandle(e,t,n)};Se.useInsertionEffect=function(e,t){return In.current.useInsertionEffect(e,t)};Se.useLayoutEffect=function(e,t){return In.current.useLayoutEffect(e,t)};Se.useMemo=function(e,t){return In.current.useMemo(e,t)};Se.useReducer=function(e,t,n){return In.current.useReducer(e,t,n)};Se.useRef=function(e){return In.current.useRef(e)};Se.useState=function(e){return In.current.useState(e)};Se.useSyncExternalStore=function(e,t,n){return In.current.useSyncExternalStore(e,t,n)};Se.useTransition=function(){return In.current.useTransition()};Se.version="18.3.1";HT.exports=Se;var uo=HT.exports;const El=sy(uo);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gq=uo,mq=Symbol.for("react.element"),yq=Symbol.for("react.fragment"),vq=Object.prototype.hasOwnProperty,xq=gq.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,wq={key:!0,ref:!0,__self:!0,__source:!0};function eN(e,t,n){var r,i={},o=null,s=null;n!==void 0&&(o=""+n),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(s=t.ref);for(r in t)vq.call(t,r)&&!wq.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)i[r]===void 0&&(i[r]=t[r]);return{$$typeof:mq,type:e,key:o,ref:s,props:i,_owner:xq.current}}ay.Fragment=yq;ay.jsx=eN;ay.jsxs=eN;qT.exports=ay;var M=qT.exports,tN={exports:{}},$r={},nN={exports:{}},rN={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(N,D){var U=N.length;N.push(D);e:for(;0<U;){var K=U-1>>>1,se=N[K];if(0<i(se,D))N[K]=D,N[U]=se,U=K;else break e}}function n(N){return N.length===0?null:N[0]}function r(N){if(N.length===0)return null;var D=N[0],U=N.pop();if(U!==D){N[0]=U;e:for(var K=0,se=N.length,be=se>>>1;K<be;){var pe=2*(K+1)-1,Re=N[pe],At=pe+1,Fr=N[At];if(0>i(Re,U))At<se&&0>i(Fr,Re)?(N[K]=Fr,N[At]=U,K=At):(N[K]=Re,N[pe]=U,K=pe);else if(At<se&&0>i(Fr,U))N[K]=Fr,N[At]=U,K=At;else break e}}return D}function i(N,D){var U=N.sortIndex-D.sortIndex;return U!==0?U:N.id-D.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var s=Date,a=s.now();e.unstable_now=function(){return s.now()-a}}var l=[],u=[],c=1,f=null,d=3,h=!1,p=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(N){for(var D=n(u);D!==null;){if(D.callback===null)r(u);else if(D.startTime<=N)r(u),D.sortIndex=D.expirationTime,t(l,D);else break;D=n(u)}}function w(N){if(g=!1,x(N),!p)if(n(l)!==null)p=!0,R(b);else{var D=n(u);D!==null&&L(w,D.startTime-N)}}function b(N,D){p=!1,g&&(g=!1,m(_),_=-1),h=!0;var U=d;try{for(x(D),f=n(l);f!==null&&(!(f.expirationTime>D)||N&&!$());){var K=f.callback;if(typeof K=="function"){f.callback=null,d=f.priorityLevel;var se=K(f.expirationTime<=D);D=e.unstable_now(),typeof se=="function"?f.callback=se:f===n(l)&&r(l),x(D)}else r(l);f=n(l)}if(f!==null)var be=!0;else{var pe=n(u);pe!==null&&L(w,pe.startTime-D),be=!1}return be}finally{f=null,d=U,h=!1}}var S=!1,E=null,_=-1,k=5,C=-1;function $(){return!(e.unstable_now()-C<k)}function O(){if(E!==null){var N=e.unstable_now();C=N;var D=!0;try{D=E(!0,N)}finally{D?A():(S=!1,E=null)}}else S=!1}var A;if(typeof v=="function")A=function(){v(O)};else if(typeof MessageChannel<"u"){var T=new MessageChannel,F=T.port2;T.port1.onmessage=O,A=function(){F.postMessage(null)}}else A=function(){y(O,0)};function R(N){E=N,S||(S=!0,A())}function L(N,D){_=y(function(){N(e.unstable_now())},D)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(N){N.callback=null},e.unstable_continueExecution=function(){p||h||(p=!0,R(b))},e.unstable_forceFrameRate=function(N){0>N||125<N?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<N?Math.floor(1e3/N):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return n(l)},e.unstable_next=function(N){switch(d){case 1:case 2:case 3:var D=3;break;default:D=d}var U=d;d=D;try{return N()}finally{d=U}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(N,D){switch(N){case 1:case 2:case 3:case 4:case 5:break;default:N=3}var U=d;d=N;try{return D()}finally{d=U}},e.unstable_scheduleCallback=function(N,D,U){var K=e.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?K+U:K):U=K,N){case 1:var se=-1;break;case 2:se=250;break;case 5:se=1073741823;break;case 4:se=1e4;break;default:se=5e3}return se=U+se,N={id:c++,callback:D,priorityLevel:N,startTime:U,expirationTime:se,sortIndex:-1},U>K?(N.sortIndex=U,t(u,N),n(l)===null&&N===n(u)&&(g?(m(_),_=-1):g=!0,L(w,U-K))):(N.sortIndex=se,t(l,N),p||h||(p=!0,R(b))),N},e.unstable_shouldYield=$,e.unstable_wrapCallback=function(N){var D=d;return function(){var U=d;d=D;try{return N.apply(this,arguments)}finally{d=U}}}})(rN);nN.exports=rN;var bq=nN.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Eq=uo,Er=bq;function V(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var iN=new Set,bh={};function au(e,t){_c(e,t),_c(e+"Capture",t)}function _c(e,t){for(bh[e]=t,e=0;e<t.length;e++)iN.add(t[e])}var as=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Tw=Object.prototype.hasOwnProperty,Sq=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,l5={},u5={};function _q(e){return Tw.call(u5,e)?!0:Tw.call(l5,e)?!1:Sq.test(e)?u5[e]=!0:(l5[e]=!0,!1)}function kq(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Cq(e,t,n,r){if(t===null||typeof t>"u"||kq(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function jn(e,t,n,r,i,o,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=s}var Jt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Jt[e]=new jn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Jt[t]=new jn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Jt[e]=new jn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Jt[e]=new jn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Jt[e]=new jn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Jt[e]=new jn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Jt[e]=new jn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Jt[e]=new jn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Jt[e]=new jn(e,5,!1,e.toLowerCase(),null,!1,!1)});var VS=/[\-:]([a-z])/g;function GS(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(VS,GS);Jt[t]=new jn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(VS,GS);Jt[t]=new jn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(VS,GS);Jt[t]=new jn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Jt[e]=new jn(e,1,!1,e.toLowerCase(),null,!1,!1)});Jt.xlinkHref=new jn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Jt[e]=new jn(e,1,!1,e.toLowerCase(),null,!0,!0)});function YS(e,t,n,r){var i=Jt.hasOwnProperty(t)?Jt[t]:null;(i!==null?i.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Cq(t,n,i,r)&&(n=null),r||i===null?_q(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=n===null?i.type===3?!1:"":n:(t=i.attributeName,r=i.attributeNamespace,n===null?e.removeAttribute(t):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var ms=Eq.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,pg=Symbol.for("react.element"),Wu=Symbol.for("react.portal"),qu=Symbol.for("react.fragment"),XS=Symbol.for("react.strict_mode"),Nw=Symbol.for("react.profiler"),oN=Symbol.for("react.provider"),sN=Symbol.for("react.context"),QS=Symbol.for("react.forward_ref"),Rw=Symbol.for("react.suspense"),Dw=Symbol.for("react.suspense_list"),KS=Symbol.for("react.memo"),Ns=Symbol.for("react.lazy"),aN=Symbol.for("react.offscreen"),c5=Symbol.iterator;function qf(e){return e===null||typeof e!="object"?null:(e=c5&&e[c5]||e["@@iterator"],typeof e=="function"?e:null)}var ot=Object.assign,Tx;function Sd(e){if(Tx===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Tx=t&&t[1]||""}return`
`+Tx+e}var Nx=!1;function Rx(e,t){if(!e||Nx)return"";Nx=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),o=r.stack.split(`
`),s=i.length-1,a=o.length-1;1<=s&&0<=a&&i[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(i[s]!==o[a]){if(s!==1||a!==1)do if(s--,a--,0>a||i[s]!==o[a]){var l=`
`+i[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=s&&0<=a);break}}}finally{Nx=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Sd(e):""}function $q(e){switch(e.tag){case 5:return Sd(e.type);case 16:return Sd("Lazy");case 13:return Sd("Suspense");case 19:return Sd("SuspenseList");case 0:case 2:case 15:return e=Rx(e.type,!1),e;case 11:return e=Rx(e.type.render,!1),e;case 1:return e=Rx(e.type,!0),e;default:return""}}function Ow(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case qu:return"Fragment";case Wu:return"Portal";case Nw:return"Profiler";case XS:return"StrictMode";case Rw:return"Suspense";case Dw:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case sN:return(e.displayName||"Context")+".Consumer";case oN:return(e._context.displayName||"Context")+".Provider";case QS:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case KS:return t=e.displayName||null,t!==null?t:Ow(e.type)||"Memo";case Ns:t=e._payload,e=e._init;try{return Ow(e(t))}catch{}}return null}function Aq(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ow(t);case 8:return t===XS?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ha(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function lN(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Fq(e){var t=lN(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(s){r=""+s,o.call(this,s)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function gg(e){e._valueTracker||(e._valueTracker=Fq(e))}function uN(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=lN(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function nm(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Pw(e,t){var n=t.checked;return ot({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function f5(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=ha(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function cN(e,t){t=t.checked,t!=null&&YS(e,"checked",t,!1)}function Lw(e,t){cN(e,t);var n=ha(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?zw(e,t.type,n):t.hasOwnProperty("defaultValue")&&zw(e,t.type,ha(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function d5(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function zw(e,t,n){(t!=="number"||nm(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var _d=Array.isArray;function lc(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+ha(n),t=null,i=0;i<e.length;i++){if(e[i].value===n){e[i].selected=!0,r&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Iw(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(V(91));return ot({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function h5(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(V(92));if(_d(n)){if(1<n.length)throw Error(V(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:ha(n)}}function fN(e,t){var n=ha(t.value),r=ha(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function p5(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function dN(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function jw(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?dN(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var mg,hN=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(mg=mg||document.createElement("div"),mg.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=mg.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Eh(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Zd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Mq=["Webkit","ms","Moz","O"];Object.keys(Zd).forEach(function(e){Mq.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Zd[t]=Zd[e]})});function pN(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Zd.hasOwnProperty(e)&&Zd[e]?(""+t).trim():t+"px"}function gN(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=pN(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}var Tq=ot({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Bw(e,t){if(t){if(Tq[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(V(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(V(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(V(61))}if(t.style!=null&&typeof t.style!="object")throw Error(V(62))}}function Uw(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ww=null;function ZS(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var qw=null,uc=null,cc=null;function g5(e){if(e=vp(e)){if(typeof qw!="function")throw Error(V(280));var t=e.stateNode;t&&(t=dy(t),qw(e.stateNode,e.type,t))}}function mN(e){uc?cc?cc.push(e):cc=[e]:uc=e}function yN(){if(uc){var e=uc,t=cc;if(cc=uc=null,g5(e),t)for(e=0;e<t.length;e++)g5(t[e])}}function vN(e,t){return e(t)}function xN(){}var Dx=!1;function wN(e,t,n){if(Dx)return e(t,n);Dx=!0;try{return vN(e,t,n)}finally{Dx=!1,(uc!==null||cc!==null)&&(xN(),yN())}}function Sh(e,t){var n=e.stateNode;if(n===null)return null;var r=dy(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(V(231,t,typeof n));return n}var Hw=!1;if(as)try{var Hf={};Object.defineProperty(Hf,"passive",{get:function(){Hw=!0}}),window.addEventListener("test",Hf,Hf),window.removeEventListener("test",Hf,Hf)}catch{Hw=!1}function Nq(e,t,n,r,i,o,s,a,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(c){this.onError(c)}}var Jd=!1,rm=null,im=!1,Vw=null,Rq={onError:function(e){Jd=!0,rm=e}};function Dq(e,t,n,r,i,o,s,a,l){Jd=!1,rm=null,Nq.apply(Rq,arguments)}function Oq(e,t,n,r,i,o,s,a,l){if(Dq.apply(this,arguments),Jd){if(Jd){var u=rm;Jd=!1,rm=null}else throw Error(V(198));im||(im=!0,Vw=u)}}function lu(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function bN(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function m5(e){if(lu(e)!==e)throw Error(V(188))}function Pq(e){var t=e.alternate;if(!t){if(t=lu(e),t===null)throw Error(V(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return m5(i),e;if(o===r)return m5(i),t;o=o.sibling}throw Error(V(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,a=i.child;a;){if(a===n){s=!0,n=i,r=o;break}if(a===r){s=!0,r=i,n=o;break}a=a.sibling}if(!s){for(a=o.child;a;){if(a===n){s=!0,n=o,r=i;break}if(a===r){s=!0,r=o,n=i;break}a=a.sibling}if(!s)throw Error(V(189))}}if(n.alternate!==r)throw Error(V(190))}if(n.tag!==3)throw Error(V(188));return n.stateNode.current===n?e:t}function EN(e){return e=Pq(e),e!==null?SN(e):null}function SN(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=SN(e);if(t!==null)return t;e=e.sibling}return null}var _N=Er.unstable_scheduleCallback,y5=Er.unstable_cancelCallback,Lq=Er.unstable_shouldYield,zq=Er.unstable_requestPaint,ht=Er.unstable_now,Iq=Er.unstable_getCurrentPriorityLevel,JS=Er.unstable_ImmediatePriority,kN=Er.unstable_UserBlockingPriority,om=Er.unstable_NormalPriority,jq=Er.unstable_LowPriority,CN=Er.unstable_IdlePriority,ly=null,no=null;function Bq(e){if(no&&typeof no.onCommitFiberRoot=="function")try{no.onCommitFiberRoot(ly,e,void 0,(e.current.flags&128)===128)}catch{}}var wi=Math.clz32?Math.clz32:qq,Uq=Math.log,Wq=Math.LN2;function qq(e){return e>>>=0,e===0?32:31-(Uq(e)/Wq|0)|0}var yg=64,vg=4194304;function kd(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function sm(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,i=e.suspendedLanes,o=e.pingedLanes,s=n&268435455;if(s!==0){var a=s&~i;a!==0?r=kd(a):(o&=s,o!==0&&(r=kd(o)))}else s=n&~i,s!==0?r=kd(s):o!==0&&(r=kd(o));if(r===0)return 0;if(t!==0&&t!==r&&!(t&i)&&(i=r&-r,o=t&-t,i>=o||i===16&&(o&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-wi(t),i=1<<n,r|=e[n],t&=~i;return r}function Hq(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Vq(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,o=e.pendingLanes;0<o;){var s=31-wi(o),a=1<<s,l=i[s];l===-1?(!(a&n)||a&r)&&(i[s]=Hq(a,t)):l<=t&&(e.expiredLanes|=a),o&=~a}}function Gw(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function $N(){var e=yg;return yg<<=1,!(yg&4194240)&&(yg=64),e}function Ox(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function mp(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-wi(t),e[t]=n}function Gq(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-wi(n),o=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~o}}function e_(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-wi(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var ze=0;function AN(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var FN,t_,MN,TN,NN,Yw=!1,xg=[],Js=null,ea=null,ta=null,_h=new Map,kh=new Map,Is=[],Yq="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function v5(e,t){switch(e){case"focusin":case"focusout":Js=null;break;case"dragenter":case"dragleave":ea=null;break;case"mouseover":case"mouseout":ta=null;break;case"pointerover":case"pointerout":_h.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":kh.delete(t.pointerId)}}function Vf(e,t,n,r,i,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},t!==null&&(t=vp(t),t!==null&&t_(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function Xq(e,t,n,r,i){switch(t){case"focusin":return Js=Vf(Js,e,t,n,r,i),!0;case"dragenter":return ea=Vf(ea,e,t,n,r,i),!0;case"mouseover":return ta=Vf(ta,e,t,n,r,i),!0;case"pointerover":var o=i.pointerId;return _h.set(o,Vf(_h.get(o)||null,e,t,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,kh.set(o,Vf(kh.get(o)||null,e,t,n,r,i)),!0}return!1}function RN(e){var t=gl(e.target);if(t!==null){var n=lu(t);if(n!==null){if(t=n.tag,t===13){if(t=bN(n),t!==null){e.blockedOn=t,NN(e.priority,function(){MN(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function b0(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Xw(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Ww=r,n.target.dispatchEvent(r),Ww=null}else return t=vp(n),t!==null&&t_(t),e.blockedOn=n,!1;t.shift()}return!0}function x5(e,t,n){b0(e)&&n.delete(t)}function Qq(){Yw=!1,Js!==null&&b0(Js)&&(Js=null),ea!==null&&b0(ea)&&(ea=null),ta!==null&&b0(ta)&&(ta=null),_h.forEach(x5),kh.forEach(x5)}function Gf(e,t){e.blockedOn===t&&(e.blockedOn=null,Yw||(Yw=!0,Er.unstable_scheduleCallback(Er.unstable_NormalPriority,Qq)))}function Ch(e){function t(i){return Gf(i,e)}if(0<xg.length){Gf(xg[0],e);for(var n=1;n<xg.length;n++){var r=xg[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Js!==null&&Gf(Js,e),ea!==null&&Gf(ea,e),ta!==null&&Gf(ta,e),_h.forEach(t),kh.forEach(t),n=0;n<Is.length;n++)r=Is[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Is.length&&(n=Is[0],n.blockedOn===null);)RN(n),n.blockedOn===null&&Is.shift()}var fc=ms.ReactCurrentBatchConfig,am=!0;function Kq(e,t,n,r){var i=ze,o=fc.transition;fc.transition=null;try{ze=1,n_(e,t,n,r)}finally{ze=i,fc.transition=o}}function Zq(e,t,n,r){var i=ze,o=fc.transition;fc.transition=null;try{ze=4,n_(e,t,n,r)}finally{ze=i,fc.transition=o}}function n_(e,t,n,r){if(am){var i=Xw(e,t,n,r);if(i===null)Hx(e,t,r,lm,n),v5(e,r);else if(Xq(i,e,t,n,r))r.stopPropagation();else if(v5(e,r),t&4&&-1<Yq.indexOf(e)){for(;i!==null;){var o=vp(i);if(o!==null&&FN(o),o=Xw(e,t,n,r),o===null&&Hx(e,t,r,lm,n),o===i)break;i=o}i!==null&&r.stopPropagation()}else Hx(e,t,r,null,n)}}var lm=null;function Xw(e,t,n,r){if(lm=null,e=ZS(r),e=gl(e),e!==null)if(t=lu(e),t===null)e=null;else if(n=t.tag,n===13){if(e=bN(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return lm=e,null}function DN(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Iq()){case JS:return 1;case kN:return 4;case om:case jq:return 16;case CN:return 536870912;default:return 16}default:return 16}}var Us=null,r_=null,E0=null;function ON(){if(E0)return E0;var e,t=r_,n=t.length,r,i="value"in Us?Us.value:Us.textContent,o=i.length;for(e=0;e<n&&t[e]===i[e];e++);var s=n-e;for(r=1;r<=s&&t[n-r]===i[o-r];r++);return E0=i.slice(e,1<r?1-r:void 0)}function S0(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function wg(){return!0}function w5(){return!1}function Ar(e){function t(n,r,i,o,s){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(n=e[a],this[a]=n?n(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?wg:w5,this.isPropagationStopped=w5,this}return ot(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=wg)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=wg)},persist:function(){},isPersistent:wg}),t}var gf={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},i_=Ar(gf),yp=ot({},gf,{view:0,detail:0}),Jq=Ar(yp),Px,Lx,Yf,uy=ot({},yp,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:o_,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Yf&&(Yf&&e.type==="mousemove"?(Px=e.screenX-Yf.screenX,Lx=e.screenY-Yf.screenY):Lx=Px=0,Yf=e),Px)},movementY:function(e){return"movementY"in e?e.movementY:Lx}}),b5=Ar(uy),eH=ot({},uy,{dataTransfer:0}),tH=Ar(eH),nH=ot({},yp,{relatedTarget:0}),zx=Ar(nH),rH=ot({},gf,{animationName:0,elapsedTime:0,pseudoElement:0}),iH=Ar(rH),oH=ot({},gf,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),sH=Ar(oH),aH=ot({},gf,{data:0}),E5=Ar(aH),lH={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},uH={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},cH={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fH(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=cH[e])?!!t[e]:!1}function o_(){return fH}var dH=ot({},yp,{key:function(e){if(e.key){var t=lH[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=S0(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?uH[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:o_,charCode:function(e){return e.type==="keypress"?S0(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?S0(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),hH=Ar(dH),pH=ot({},uy,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),S5=Ar(pH),gH=ot({},yp,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:o_}),mH=Ar(gH),yH=ot({},gf,{propertyName:0,elapsedTime:0,pseudoElement:0}),vH=Ar(yH),xH=ot({},uy,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),wH=Ar(xH),bH=[9,13,27,32],s_=as&&"CompositionEvent"in window,eh=null;as&&"documentMode"in document&&(eh=document.documentMode);var EH=as&&"TextEvent"in window&&!eh,PN=as&&(!s_||eh&&8<eh&&11>=eh),_5=" ",k5=!1;function LN(e,t){switch(e){case"keyup":return bH.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zN(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Hu=!1;function SH(e,t){switch(e){case"compositionend":return zN(t);case"keypress":return t.which!==32?null:(k5=!0,_5);case"textInput":return e=t.data,e===_5&&k5?null:e;default:return null}}function _H(e,t){if(Hu)return e==="compositionend"||!s_&&LN(e,t)?(e=ON(),E0=r_=Us=null,Hu=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return PN&&t.locale!=="ko"?null:t.data;default:return null}}var kH={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function C5(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!kH[e.type]:t==="textarea"}function IN(e,t,n,r){mN(r),t=um(t,"onChange"),0<t.length&&(n=new i_("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var th=null,$h=null;function CH(e){QN(e,0)}function cy(e){var t=Yu(e);if(uN(t))return e}function $H(e,t){if(e==="change")return t}var jN=!1;if(as){var Ix;if(as){var jx="oninput"in document;if(!jx){var $5=document.createElement("div");$5.setAttribute("oninput","return;"),jx=typeof $5.oninput=="function"}Ix=jx}else Ix=!1;jN=Ix&&(!document.documentMode||9<document.documentMode)}function A5(){th&&(th.detachEvent("onpropertychange",BN),$h=th=null)}function BN(e){if(e.propertyName==="value"&&cy($h)){var t=[];IN(t,$h,e,ZS(e)),wN(CH,t)}}function AH(e,t,n){e==="focusin"?(A5(),th=t,$h=n,th.attachEvent("onpropertychange",BN)):e==="focusout"&&A5()}function FH(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return cy($h)}function MH(e,t){if(e==="click")return cy(t)}function TH(e,t){if(e==="input"||e==="change")return cy(t)}function NH(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var _i=typeof Object.is=="function"?Object.is:NH;function Ah(e,t){if(_i(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Tw.call(t,i)||!_i(e[i],t[i]))return!1}return!0}function F5(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function M5(e,t){var n=F5(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=F5(n)}}function UN(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?UN(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function WN(){for(var e=window,t=nm();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=nm(e.document)}return t}function a_(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function RH(e){var t=WN(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&UN(n.ownerDocument.documentElement,n)){if(r!==null&&a_(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!e.extend&&o>r&&(i=r,r=o,o=i),i=M5(n,o);var s=M5(n,r);i&&s&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),o>r?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var DH=as&&"documentMode"in document&&11>=document.documentMode,Vu=null,Qw=null,nh=null,Kw=!1;function T5(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Kw||Vu==null||Vu!==nm(r)||(r=Vu,"selectionStart"in r&&a_(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),nh&&Ah(nh,r)||(nh=r,r=um(Qw,"onSelect"),0<r.length&&(t=new i_("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Vu)))}function bg(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Gu={animationend:bg("Animation","AnimationEnd"),animationiteration:bg("Animation","AnimationIteration"),animationstart:bg("Animation","AnimationStart"),transitionend:bg("Transition","TransitionEnd")},Bx={},qN={};as&&(qN=document.createElement("div").style,"AnimationEvent"in window||(delete Gu.animationend.animation,delete Gu.animationiteration.animation,delete Gu.animationstart.animation),"TransitionEvent"in window||delete Gu.transitionend.transition);function fy(e){if(Bx[e])return Bx[e];if(!Gu[e])return e;var t=Gu[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in qN)return Bx[e]=t[n];return e}var HN=fy("animationend"),VN=fy("animationiteration"),GN=fy("animationstart"),YN=fy("transitionend"),XN=new Map,N5="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ta(e,t){XN.set(e,t),au(t,[e])}for(var Ux=0;Ux<N5.length;Ux++){var Wx=N5[Ux],OH=Wx.toLowerCase(),PH=Wx[0].toUpperCase()+Wx.slice(1);Ta(OH,"on"+PH)}Ta(HN,"onAnimationEnd");Ta(VN,"onAnimationIteration");Ta(GN,"onAnimationStart");Ta("dblclick","onDoubleClick");Ta("focusin","onFocus");Ta("focusout","onBlur");Ta(YN,"onTransitionEnd");_c("onMouseEnter",["mouseout","mouseover"]);_c("onMouseLeave",["mouseout","mouseover"]);_c("onPointerEnter",["pointerout","pointerover"]);_c("onPointerLeave",["pointerout","pointerover"]);au("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));au("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));au("onBeforeInput",["compositionend","keypress","textInput","paste"]);au("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));au("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));au("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Cd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),LH=new Set("cancel close invalid load scroll toggle".split(" ").concat(Cd));function R5(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,Oq(r,t,void 0,e),e.currentTarget=null}function QN(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var s=r.length-1;0<=s;s--){var a=r[s],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==o&&i.isPropagationStopped())break e;R5(i,a,u),o=l}else for(s=0;s<r.length;s++){if(a=r[s],l=a.instance,u=a.currentTarget,a=a.listener,l!==o&&i.isPropagationStopped())break e;R5(i,a,u),o=l}}}if(im)throw e=Vw,im=!1,Vw=null,e}function Ge(e,t){var n=t[nb];n===void 0&&(n=t[nb]=new Set);var r=e+"__bubble";n.has(r)||(KN(t,e,2,!1),n.add(r))}function qx(e,t,n){var r=0;t&&(r|=4),KN(n,e,r,t)}var Eg="_reactListening"+Math.random().toString(36).slice(2);function Fh(e){if(!e[Eg]){e[Eg]=!0,iN.forEach(function(n){n!=="selectionchange"&&(LH.has(n)||qx(n,!1,e),qx(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Eg]||(t[Eg]=!0,qx("selectionchange",!1,t))}}function KN(e,t,n,r){switch(DN(t)){case 1:var i=Kq;break;case 4:i=Zq;break;default:i=n_}n=i.bind(null,t,n,e),i=void 0,!Hw||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),r?i!==void 0?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):i!==void 0?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Hx(e,t,n,r,i){var o=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(s===4)for(s=r.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;s=s.return}for(;a!==null;){if(s=gl(a),s===null)return;if(l=s.tag,l===5||l===6){r=o=s;continue e}a=a.parentNode}}r=r.return}wN(function(){var u=o,c=ZS(n),f=[];e:{var d=XN.get(e);if(d!==void 0){var h=i_,p=e;switch(e){case"keypress":if(S0(n)===0)break e;case"keydown":case"keyup":h=hH;break;case"focusin":p="focus",h=zx;break;case"focusout":p="blur",h=zx;break;case"beforeblur":case"afterblur":h=zx;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=b5;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=tH;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=mH;break;case HN:case VN:case GN:h=iH;break;case YN:h=vH;break;case"scroll":h=Jq;break;case"wheel":h=wH;break;case"copy":case"cut":case"paste":h=sH;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=S5}var g=(t&4)!==0,y=!g&&e==="scroll",m=g?d!==null?d+"Capture":null:d;g=[];for(var v=u,x;v!==null;){x=v;var w=x.stateNode;if(x.tag===5&&w!==null&&(x=w,m!==null&&(w=Sh(v,m),w!=null&&g.push(Mh(v,w,x)))),y)break;v=v.return}0<g.length&&(d=new h(d,p,null,n,c),f.push({event:d,listeners:g}))}}if(!(t&7)){e:{if(d=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",d&&n!==Ww&&(p=n.relatedTarget||n.fromElement)&&(gl(p)||p[ls]))break e;if((h||d)&&(d=c.window===c?c:(d=c.ownerDocument)?d.defaultView||d.parentWindow:window,h?(p=n.relatedTarget||n.toElement,h=u,p=p?gl(p):null,p!==null&&(y=lu(p),p!==y||p.tag!==5&&p.tag!==6)&&(p=null)):(h=null,p=u),h!==p)){if(g=b5,w="onMouseLeave",m="onMouseEnter",v="mouse",(e==="pointerout"||e==="pointerover")&&(g=S5,w="onPointerLeave",m="onPointerEnter",v="pointer"),y=h==null?d:Yu(h),x=p==null?d:Yu(p),d=new g(w,v+"leave",h,n,c),d.target=y,d.relatedTarget=x,w=null,gl(c)===u&&(g=new g(m,v+"enter",p,n,c),g.target=x,g.relatedTarget=y,w=g),y=w,h&&p)t:{for(g=h,m=p,v=0,x=g;x;x=$u(x))v++;for(x=0,w=m;w;w=$u(w))x++;for(;0<v-x;)g=$u(g),v--;for(;0<x-v;)m=$u(m),x--;for(;v--;){if(g===m||m!==null&&g===m.alternate)break t;g=$u(g),m=$u(m)}g=null}else g=null;h!==null&&D5(f,d,h,g,!1),p!==null&&y!==null&&D5(f,y,p,g,!0)}}e:{if(d=u?Yu(u):window,h=d.nodeName&&d.nodeName.toLowerCase(),h==="select"||h==="input"&&d.type==="file")var b=$H;else if(C5(d))if(jN)b=TH;else{b=FH;var S=AH}else(h=d.nodeName)&&h.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(b=MH);if(b&&(b=b(e,u))){IN(f,b,n,c);break e}S&&S(e,d,u),e==="focusout"&&(S=d._wrapperState)&&S.controlled&&d.type==="number"&&zw(d,"number",d.value)}switch(S=u?Yu(u):window,e){case"focusin":(C5(S)||S.contentEditable==="true")&&(Vu=S,Qw=u,nh=null);break;case"focusout":nh=Qw=Vu=null;break;case"mousedown":Kw=!0;break;case"contextmenu":case"mouseup":case"dragend":Kw=!1,T5(f,n,c);break;case"selectionchange":if(DH)break;case"keydown":case"keyup":T5(f,n,c)}var E;if(s_)e:{switch(e){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else Hu?LN(e,n)&&(_="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(_="onCompositionStart");_&&(PN&&n.locale!=="ko"&&(Hu||_!=="onCompositionStart"?_==="onCompositionEnd"&&Hu&&(E=ON()):(Us=c,r_="value"in Us?Us.value:Us.textContent,Hu=!0)),S=um(u,_),0<S.length&&(_=new E5(_,e,null,n,c),f.push({event:_,listeners:S}),E?_.data=E:(E=zN(n),E!==null&&(_.data=E)))),(E=EH?SH(e,n):_H(e,n))&&(u=um(u,"onBeforeInput"),0<u.length&&(c=new E5("onBeforeInput","beforeinput",null,n,c),f.push({event:c,listeners:u}),c.data=E))}QN(f,t)})}function Mh(e,t,n){return{instance:e,listener:t,currentTarget:n}}function um(e,t){for(var n=t+"Capture",r=[];e!==null;){var i=e,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=Sh(e,n),o!=null&&r.unshift(Mh(e,o,i)),o=Sh(e,t),o!=null&&r.push(Mh(e,o,i))),e=e.return}return r}function $u(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function D5(e,t,n,r,i){for(var o=t._reactName,s=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,i?(l=Sh(n,o),l!=null&&s.unshift(Mh(n,l,a))):i||(l=Sh(n,o),l!=null&&s.push(Mh(n,l,a)))),n=n.return}s.length!==0&&e.push({event:t,listeners:s})}var zH=/\r\n?/g,IH=/\u0000|\uFFFD/g;function O5(e){return(typeof e=="string"?e:""+e).replace(zH,`
`).replace(IH,"")}function Sg(e,t,n){if(t=O5(t),O5(e)!==t&&n)throw Error(V(425))}function cm(){}var Zw=null,Jw=null;function eb(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var tb=typeof setTimeout=="function"?setTimeout:void 0,jH=typeof clearTimeout=="function"?clearTimeout:void 0,P5=typeof Promise=="function"?Promise:void 0,BH=typeof queueMicrotask=="function"?queueMicrotask:typeof P5<"u"?function(e){return P5.resolve(null).then(e).catch(UH)}:tb;function UH(e){setTimeout(function(){throw e})}function Vx(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){e.removeChild(i),Ch(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Ch(t)}function na(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function L5(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var mf=Math.random().toString(36).slice(2),Qi="__reactFiber$"+mf,Th="__reactProps$"+mf,ls="__reactContainer$"+mf,nb="__reactEvents$"+mf,WH="__reactListeners$"+mf,qH="__reactHandles$"+mf;function gl(e){var t=e[Qi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ls]||n[Qi]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=L5(e);e!==null;){if(n=e[Qi])return n;e=L5(e)}return t}e=n,n=e.parentNode}return null}function vp(e){return e=e[Qi]||e[ls],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Yu(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(V(33))}function dy(e){return e[Th]||null}var rb=[],Xu=-1;function Na(e){return{current:e}}function Qe(e){0>Xu||(e.current=rb[Xu],rb[Xu]=null,Xu--)}function He(e,t){Xu++,rb[Xu]=e.current,e.current=t}var pa={},xn=Na(pa),Qn=Na(!1),Ol=pa;function kc(e,t){var n=e.type.contextTypes;if(!n)return pa;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in n)i[o]=t[o];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Kn(e){return e=e.childContextTypes,e!=null}function fm(){Qe(Qn),Qe(xn)}function z5(e,t,n){if(xn.current!==pa)throw Error(V(168));He(xn,t),He(Qn,n)}function ZN(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in t))throw Error(V(108,Aq(e)||"Unknown",i));return ot({},n,r)}function dm(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||pa,Ol=xn.current,He(xn,e),He(Qn,Qn.current),!0}function I5(e,t,n){var r=e.stateNode;if(!r)throw Error(V(169));n?(e=ZN(e,t,Ol),r.__reactInternalMemoizedMergedChildContext=e,Qe(Qn),Qe(xn),He(xn,e)):Qe(Qn),He(Qn,n)}var Io=null,hy=!1,Gx=!1;function JN(e){Io===null?Io=[e]:Io.push(e)}function HH(e){hy=!0,JN(e)}function Ra(){if(!Gx&&Io!==null){Gx=!0;var e=0,t=ze;try{var n=Io;for(ze=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Io=null,hy=!1}catch(i){throw Io!==null&&(Io=Io.slice(e+1)),_N(JS,Ra),i}finally{ze=t,Gx=!1}}return null}var Qu=[],Ku=0,hm=null,pm=0,Nr=[],Rr=0,Pl=null,qo=1,Ho="";function ol(e,t){Qu[Ku++]=pm,Qu[Ku++]=hm,hm=e,pm=t}function e7(e,t,n){Nr[Rr++]=qo,Nr[Rr++]=Ho,Nr[Rr++]=Pl,Pl=e;var r=qo;e=Ho;var i=32-wi(r)-1;r&=~(1<<i),n+=1;var o=32-wi(t)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,qo=1<<32-wi(t)+i|n<<i|r,Ho=o+e}else qo=1<<o|n<<i|r,Ho=e}function l_(e){e.return!==null&&(ol(e,1),e7(e,1,0))}function u_(e){for(;e===hm;)hm=Qu[--Ku],Qu[Ku]=null,pm=Qu[--Ku],Qu[Ku]=null;for(;e===Pl;)Pl=Nr[--Rr],Nr[Rr]=null,Ho=Nr[--Rr],Nr[Rr]=null,qo=Nr[--Rr],Nr[Rr]=null}var vr=null,pr=null,Ze=!1,fi=null;function t7(e,t){var n=Pr(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function j5(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,vr=e,pr=na(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,vr=e,pr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Pl!==null?{id:qo,overflow:Ho}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Pr(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,vr=e,pr=null,!0):!1;default:return!1}}function ib(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ob(e){if(Ze){var t=pr;if(t){var n=t;if(!j5(e,t)){if(ib(e))throw Error(V(418));t=na(n.nextSibling);var r=vr;t&&j5(e,t)?t7(r,n):(e.flags=e.flags&-4097|2,Ze=!1,vr=e)}}else{if(ib(e))throw Error(V(418));e.flags=e.flags&-4097|2,Ze=!1,vr=e}}}function B5(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;vr=e}function _g(e){if(e!==vr)return!1;if(!Ze)return B5(e),Ze=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!eb(e.type,e.memoizedProps)),t&&(t=pr)){if(ib(e))throw n7(),Error(V(418));for(;t;)t7(e,t),t=na(t.nextSibling)}if(B5(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(V(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){pr=na(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}pr=null}}else pr=vr?na(e.stateNode.nextSibling):null;return!0}function n7(){for(var e=pr;e;)e=na(e.nextSibling)}function Cc(){pr=vr=null,Ze=!1}function c_(e){fi===null?fi=[e]:fi.push(e)}var VH=ms.ReactCurrentBatchConfig;function Xf(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(V(309));var r=n.stateNode}if(!r)throw Error(V(147,e));var i=r,o=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(s){var a=i.refs;s===null?delete a[o]:a[o]=s},t._stringRef=o,t)}if(typeof e!="string")throw Error(V(284));if(!n._owner)throw Error(V(290,e))}return e}function kg(e,t){throw e=Object.prototype.toString.call(t),Error(V(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function U5(e){var t=e._init;return t(e._payload)}function r7(e){function t(m,v){if(e){var x=m.deletions;x===null?(m.deletions=[v],m.flags|=16):x.push(v)}}function n(m,v){if(!e)return null;for(;v!==null;)t(m,v),v=v.sibling;return null}function r(m,v){for(m=new Map;v!==null;)v.key!==null?m.set(v.key,v):m.set(v.index,v),v=v.sibling;return m}function i(m,v){return m=sa(m,v),m.index=0,m.sibling=null,m}function o(m,v,x){return m.index=x,e?(x=m.alternate,x!==null?(x=x.index,x<v?(m.flags|=2,v):x):(m.flags|=2,v)):(m.flags|=1048576,v)}function s(m){return e&&m.alternate===null&&(m.flags|=2),m}function a(m,v,x,w){return v===null||v.tag!==6?(v=e2(x,m.mode,w),v.return=m,v):(v=i(v,x),v.return=m,v)}function l(m,v,x,w){var b=x.type;return b===qu?c(m,v,x.props.children,w,x.key):v!==null&&(v.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===Ns&&U5(b)===v.type)?(w=i(v,x.props),w.ref=Xf(m,v,x),w.return=m,w):(w=M0(x.type,x.key,x.props,null,m.mode,w),w.ref=Xf(m,v,x),w.return=m,w)}function u(m,v,x,w){return v===null||v.tag!==4||v.stateNode.containerInfo!==x.containerInfo||v.stateNode.implementation!==x.implementation?(v=t2(x,m.mode,w),v.return=m,v):(v=i(v,x.children||[]),v.return=m,v)}function c(m,v,x,w,b){return v===null||v.tag!==7?(v=_l(x,m.mode,w,b),v.return=m,v):(v=i(v,x),v.return=m,v)}function f(m,v,x){if(typeof v=="string"&&v!==""||typeof v=="number")return v=e2(""+v,m.mode,x),v.return=m,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case pg:return x=M0(v.type,v.key,v.props,null,m.mode,x),x.ref=Xf(m,null,v),x.return=m,x;case Wu:return v=t2(v,m.mode,x),v.return=m,v;case Ns:var w=v._init;return f(m,w(v._payload),x)}if(_d(v)||qf(v))return v=_l(v,m.mode,x,null),v.return=m,v;kg(m,v)}return null}function d(m,v,x,w){var b=v!==null?v.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return b!==null?null:a(m,v,""+x,w);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case pg:return x.key===b?l(m,v,x,w):null;case Wu:return x.key===b?u(m,v,x,w):null;case Ns:return b=x._init,d(m,v,b(x._payload),w)}if(_d(x)||qf(x))return b!==null?null:c(m,v,x,w,null);kg(m,x)}return null}function h(m,v,x,w,b){if(typeof w=="string"&&w!==""||typeof w=="number")return m=m.get(x)||null,a(v,m,""+w,b);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case pg:return m=m.get(w.key===null?x:w.key)||null,l(v,m,w,b);case Wu:return m=m.get(w.key===null?x:w.key)||null,u(v,m,w,b);case Ns:var S=w._init;return h(m,v,x,S(w._payload),b)}if(_d(w)||qf(w))return m=m.get(x)||null,c(v,m,w,b,null);kg(v,w)}return null}function p(m,v,x,w){for(var b=null,S=null,E=v,_=v=0,k=null;E!==null&&_<x.length;_++){E.index>_?(k=E,E=null):k=E.sibling;var C=d(m,E,x[_],w);if(C===null){E===null&&(E=k);break}e&&E&&C.alternate===null&&t(m,E),v=o(C,v,_),S===null?b=C:S.sibling=C,S=C,E=k}if(_===x.length)return n(m,E),Ze&&ol(m,_),b;if(E===null){for(;_<x.length;_++)E=f(m,x[_],w),E!==null&&(v=o(E,v,_),S===null?b=E:S.sibling=E,S=E);return Ze&&ol(m,_),b}for(E=r(m,E);_<x.length;_++)k=h(E,m,_,x[_],w),k!==null&&(e&&k.alternate!==null&&E.delete(k.key===null?_:k.key),v=o(k,v,_),S===null?b=k:S.sibling=k,S=k);return e&&E.forEach(function($){return t(m,$)}),Ze&&ol(m,_),b}function g(m,v,x,w){var b=qf(x);if(typeof b!="function")throw Error(V(150));if(x=b.call(x),x==null)throw Error(V(151));for(var S=b=null,E=v,_=v=0,k=null,C=x.next();E!==null&&!C.done;_++,C=x.next()){E.index>_?(k=E,E=null):k=E.sibling;var $=d(m,E,C.value,w);if($===null){E===null&&(E=k);break}e&&E&&$.alternate===null&&t(m,E),v=o($,v,_),S===null?b=$:S.sibling=$,S=$,E=k}if(C.done)return n(m,E),Ze&&ol(m,_),b;if(E===null){for(;!C.done;_++,C=x.next())C=f(m,C.value,w),C!==null&&(v=o(C,v,_),S===null?b=C:S.sibling=C,S=C);return Ze&&ol(m,_),b}for(E=r(m,E);!C.done;_++,C=x.next())C=h(E,m,_,C.value,w),C!==null&&(e&&C.alternate!==null&&E.delete(C.key===null?_:C.key),v=o(C,v,_),S===null?b=C:S.sibling=C,S=C);return e&&E.forEach(function(O){return t(m,O)}),Ze&&ol(m,_),b}function y(m,v,x,w){if(typeof x=="object"&&x!==null&&x.type===qu&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case pg:e:{for(var b=x.key,S=v;S!==null;){if(S.key===b){if(b=x.type,b===qu){if(S.tag===7){n(m,S.sibling),v=i(S,x.props.children),v.return=m,m=v;break e}}else if(S.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===Ns&&U5(b)===S.type){n(m,S.sibling),v=i(S,x.props),v.ref=Xf(m,S,x),v.return=m,m=v;break e}n(m,S);break}else t(m,S);S=S.sibling}x.type===qu?(v=_l(x.props.children,m.mode,w,x.key),v.return=m,m=v):(w=M0(x.type,x.key,x.props,null,m.mode,w),w.ref=Xf(m,v,x),w.return=m,m=w)}return s(m);case Wu:e:{for(S=x.key;v!==null;){if(v.key===S)if(v.tag===4&&v.stateNode.containerInfo===x.containerInfo&&v.stateNode.implementation===x.implementation){n(m,v.sibling),v=i(v,x.children||[]),v.return=m,m=v;break e}else{n(m,v);break}else t(m,v);v=v.sibling}v=t2(x,m.mode,w),v.return=m,m=v}return s(m);case Ns:return S=x._init,y(m,v,S(x._payload),w)}if(_d(x))return p(m,v,x,w);if(qf(x))return g(m,v,x,w);kg(m,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,v!==null&&v.tag===6?(n(m,v.sibling),v=i(v,x),v.return=m,m=v):(n(m,v),v=e2(x,m.mode,w),v.return=m,m=v),s(m)):n(m,v)}return y}var $c=r7(!0),i7=r7(!1),gm=Na(null),mm=null,Zu=null,f_=null;function d_(){f_=Zu=mm=null}function h_(e){var t=gm.current;Qe(gm),e._currentValue=t}function sb(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function dc(e,t){mm=e,f_=Zu=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Yn=!0),e.firstContext=null)}function qr(e){var t=e._currentValue;if(f_!==e)if(e={context:e,memoizedValue:t,next:null},Zu===null){if(mm===null)throw Error(V(308));Zu=e,mm.dependencies={lanes:0,firstContext:e}}else Zu=Zu.next=e;return t}var ml=null;function p_(e){ml===null?ml=[e]:ml.push(e)}function o7(e,t,n,r){var i=t.interleaved;return i===null?(n.next=n,p_(t)):(n.next=i.next,i.next=n),t.interleaved=n,us(e,r)}function us(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Rs=!1;function g_(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function s7(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Zo(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ra(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Ae&2){var i=r.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),r.pending=t,us(e,n)}return i=r.interleaved,i===null?(t.next=t,p_(r)):(t.next=i.next,i.next=t),r.interleaved=t,us(e,n)}function _0(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,e_(e,n)}}function W5(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?i=o=s:o=o.next=s,n=n.next}while(n!==null);o===null?i=o=t:o=o.next=t}else i=o=t;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function ym(e,t,n,r){var i=e.updateQueue;Rs=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,s===null?o=u:s.next=u,s=l;var c=e.alternate;c!==null&&(c=c.updateQueue,a=c.lastBaseUpdate,a!==s&&(a===null?c.firstBaseUpdate=u:a.next=u,c.lastBaseUpdate=l))}if(o!==null){var f=i.baseState;s=0,c=u=l=null,a=o;do{var d=a.lane,h=a.eventTime;if((r&d)===d){c!==null&&(c=c.next={eventTime:h,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=e,g=a;switch(d=t,h=n,g.tag){case 1:if(p=g.payload,typeof p=="function"){f=p.call(h,f,d);break e}f=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=g.payload,d=typeof p=="function"?p.call(h,f,d):p,d==null)break e;f=ot({},f,d);break e;case 2:Rs=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,d=i.effects,d===null?i.effects=[a]:d.push(a))}else h={eventTime:h,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},c===null?(u=c=h,l=f):c=c.next=h,s|=d;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;d=a,a=d.next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}while(!0);if(c===null&&(l=f),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,t=i.shared.interleaved,t!==null){i=t;do s|=i.lane,i=i.next;while(i!==t)}else o===null&&(i.shared.lanes=0);zl|=s,e.lanes=s,e.memoizedState=f}}function q5(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(V(191,i));i.call(r)}}}var xp={},ro=Na(xp),Nh=Na(xp),Rh=Na(xp);function yl(e){if(e===xp)throw Error(V(174));return e}function m_(e,t){switch(He(Rh,t),He(Nh,e),He(ro,xp),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:jw(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=jw(t,e)}Qe(ro),He(ro,t)}function Ac(){Qe(ro),Qe(Nh),Qe(Rh)}function a7(e){yl(Rh.current);var t=yl(ro.current),n=jw(t,e.type);t!==n&&(He(Nh,e),He(ro,n))}function y_(e){Nh.current===e&&(Qe(ro),Qe(Nh))}var nt=Na(0);function vm(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Yx=[];function v_(){for(var e=0;e<Yx.length;e++)Yx[e]._workInProgressVersionPrimary=null;Yx.length=0}var k0=ms.ReactCurrentDispatcher,Xx=ms.ReactCurrentBatchConfig,Ll=0,it=null,xt=null,Mt=null,xm=!1,rh=!1,Dh=0,GH=0;function rn(){throw Error(V(321))}function x_(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!_i(e[n],t[n]))return!1;return!0}function w_(e,t,n,r,i,o){if(Ll=o,it=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,k0.current=e===null||e.memoizedState===null?KH:ZH,e=n(r,i),rh){o=0;do{if(rh=!1,Dh=0,25<=o)throw Error(V(301));o+=1,Mt=xt=null,t.updateQueue=null,k0.current=JH,e=n(r,i)}while(rh)}if(k0.current=wm,t=xt!==null&&xt.next!==null,Ll=0,Mt=xt=it=null,xm=!1,t)throw Error(V(300));return e}function b_(){var e=Dh!==0;return Dh=0,e}function Vi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Mt===null?it.memoizedState=Mt=e:Mt=Mt.next=e,Mt}function Hr(){if(xt===null){var e=it.alternate;e=e!==null?e.memoizedState:null}else e=xt.next;var t=Mt===null?it.memoizedState:Mt.next;if(t!==null)Mt=t,xt=e;else{if(e===null)throw Error(V(310));xt=e,e={memoizedState:xt.memoizedState,baseState:xt.baseState,baseQueue:xt.baseQueue,queue:xt.queue,next:null},Mt===null?it.memoizedState=Mt=e:Mt=Mt.next=e}return Mt}function Oh(e,t){return typeof t=="function"?t(e):t}function Qx(e){var t=Hr(),n=t.queue;if(n===null)throw Error(V(311));n.lastRenderedReducer=e;var r=xt,i=r.baseQueue,o=n.pending;if(o!==null){if(i!==null){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(i!==null){o=i.next,r=r.baseState;var a=s=null,l=null,u=o;do{var c=u.lane;if((Ll&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var f={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=f,s=r):l=l.next=f,it.lanes|=c,zl|=c}u=u.next}while(u!==null&&u!==o);l===null?s=r:l.next=a,_i(r,t.memoizedState)||(Yn=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=l,n.lastRenderedState=r}if(e=n.interleaved,e!==null){i=e;do o=i.lane,it.lanes|=o,zl|=o,i=i.next;while(i!==e)}else i===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Kx(e){var t=Hr(),n=t.queue;if(n===null)throw Error(V(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(i!==null){n.pending=null;var s=i=i.next;do o=e(o,s.action),s=s.next;while(s!==i);_i(o,t.memoizedState)||(Yn=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function l7(){}function u7(e,t){var n=it,r=Hr(),i=t(),o=!_i(r.memoizedState,i);if(o&&(r.memoizedState=i,Yn=!0),r=r.queue,E_(d7.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||Mt!==null&&Mt.memoizedState.tag&1){if(n.flags|=2048,Ph(9,f7.bind(null,n,r,i,t),void 0,null),Lt===null)throw Error(V(349));Ll&30||c7(n,t,i)}return i}function c7(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=it.updateQueue,t===null?(t={lastEffect:null,stores:null},it.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function f7(e,t,n,r){t.value=n,t.getSnapshot=r,h7(t)&&p7(e)}function d7(e,t,n){return n(function(){h7(t)&&p7(e)})}function h7(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!_i(e,n)}catch{return!0}}function p7(e){var t=us(e,1);t!==null&&bi(t,e,1,-1)}function H5(e){var t=Vi();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Oh,lastRenderedState:e},t.queue=e,e=e.dispatch=QH.bind(null,it,e),[t.memoizedState,e]}function Ph(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=it.updateQueue,t===null?(t={lastEffect:null,stores:null},it.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function g7(){return Hr().memoizedState}function C0(e,t,n,r){var i=Vi();it.flags|=e,i.memoizedState=Ph(1|t,n,void 0,r===void 0?null:r)}function py(e,t,n,r){var i=Hr();r=r===void 0?null:r;var o=void 0;if(xt!==null){var s=xt.memoizedState;if(o=s.destroy,r!==null&&x_(r,s.deps)){i.memoizedState=Ph(t,n,o,r);return}}it.flags|=e,i.memoizedState=Ph(1|t,n,o,r)}function V5(e,t){return C0(8390656,8,e,t)}function E_(e,t){return py(2048,8,e,t)}function m7(e,t){return py(4,2,e,t)}function y7(e,t){return py(4,4,e,t)}function v7(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function x7(e,t,n){return n=n!=null?n.concat([e]):null,py(4,4,v7.bind(null,t,e),n)}function S_(){}function w7(e,t){var n=Hr();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&x_(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function b7(e,t){var n=Hr();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&x_(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function E7(e,t,n){return Ll&21?(_i(n,t)||(n=$N(),it.lanes|=n,zl|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Yn=!0),e.memoizedState=n)}function YH(e,t){var n=ze;ze=n!==0&&4>n?n:4,e(!0);var r=Xx.transition;Xx.transition={};try{e(!1),t()}finally{ze=n,Xx.transition=r}}function S7(){return Hr().memoizedState}function XH(e,t,n){var r=oa(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},_7(e))k7(t,n);else if(n=o7(e,t,n,r),n!==null){var i=Rn();bi(n,e,r,i),C7(n,t,r)}}function QH(e,t,n){var r=oa(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(_7(e))k7(t,i);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var s=t.lastRenderedState,a=o(s,n);if(i.hasEagerState=!0,i.eagerState=a,_i(a,s)){var l=t.interleaved;l===null?(i.next=i,p_(t)):(i.next=l.next,l.next=i),t.interleaved=i;return}}catch{}finally{}n=o7(e,t,i,r),n!==null&&(i=Rn(),bi(n,e,r,i),C7(n,t,r))}}function _7(e){var t=e.alternate;return e===it||t!==null&&t===it}function k7(e,t){rh=xm=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function C7(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,e_(e,n)}}var wm={readContext:qr,useCallback:rn,useContext:rn,useEffect:rn,useImperativeHandle:rn,useInsertionEffect:rn,useLayoutEffect:rn,useMemo:rn,useReducer:rn,useRef:rn,useState:rn,useDebugValue:rn,useDeferredValue:rn,useTransition:rn,useMutableSource:rn,useSyncExternalStore:rn,useId:rn,unstable_isNewReconciler:!1},KH={readContext:qr,useCallback:function(e,t){return Vi().memoizedState=[e,t===void 0?null:t],e},useContext:qr,useEffect:V5,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,C0(4194308,4,v7.bind(null,t,e),n)},useLayoutEffect:function(e,t){return C0(4194308,4,e,t)},useInsertionEffect:function(e,t){return C0(4,2,e,t)},useMemo:function(e,t){var n=Vi();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Vi();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=XH.bind(null,it,e),[r.memoizedState,e]},useRef:function(e){var t=Vi();return e={current:e},t.memoizedState=e},useState:H5,useDebugValue:S_,useDeferredValue:function(e){return Vi().memoizedState=e},useTransition:function(){var e=H5(!1),t=e[0];return e=YH.bind(null,e[1]),Vi().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=it,i=Vi();if(Ze){if(n===void 0)throw Error(V(407));n=n()}else{if(n=t(),Lt===null)throw Error(V(349));Ll&30||c7(r,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,V5(d7.bind(null,r,o,e),[e]),r.flags|=2048,Ph(9,f7.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=Vi(),t=Lt.identifierPrefix;if(Ze){var n=Ho,r=qo;n=(r&~(1<<32-wi(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Dh++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=GH++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ZH={readContext:qr,useCallback:w7,useContext:qr,useEffect:E_,useImperativeHandle:x7,useInsertionEffect:m7,useLayoutEffect:y7,useMemo:b7,useReducer:Qx,useRef:g7,useState:function(){return Qx(Oh)},useDebugValue:S_,useDeferredValue:function(e){var t=Hr();return E7(t,xt.memoizedState,e)},useTransition:function(){var e=Qx(Oh)[0],t=Hr().memoizedState;return[e,t]},useMutableSource:l7,useSyncExternalStore:u7,useId:S7,unstable_isNewReconciler:!1},JH={readContext:qr,useCallback:w7,useContext:qr,useEffect:E_,useImperativeHandle:x7,useInsertionEffect:m7,useLayoutEffect:y7,useMemo:b7,useReducer:Kx,useRef:g7,useState:function(){return Kx(Oh)},useDebugValue:S_,useDeferredValue:function(e){var t=Hr();return xt===null?t.memoizedState=e:E7(t,xt.memoizedState,e)},useTransition:function(){var e=Kx(Oh)[0],t=Hr().memoizedState;return[e,t]},useMutableSource:l7,useSyncExternalStore:u7,useId:S7,unstable_isNewReconciler:!1};function si(e,t){if(e&&e.defaultProps){t=ot({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function ab(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:ot({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var gy={isMounted:function(e){return(e=e._reactInternals)?lu(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Rn(),i=oa(e),o=Zo(r,i);o.payload=t,n!=null&&(o.callback=n),t=ra(e,o,i),t!==null&&(bi(t,e,i,r),_0(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Rn(),i=oa(e),o=Zo(r,i);o.tag=1,o.payload=t,n!=null&&(o.callback=n),t=ra(e,o,i),t!==null&&(bi(t,e,i,r),_0(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Rn(),r=oa(e),i=Zo(n,r);i.tag=2,t!=null&&(i.callback=t),t=ra(e,i,r),t!==null&&(bi(t,e,r,n),_0(t,e,r))}};function G5(e,t,n,r,i,o,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,o,s):t.prototype&&t.prototype.isPureReactComponent?!Ah(n,r)||!Ah(i,o):!0}function $7(e,t,n){var r=!1,i=pa,o=t.contextType;return typeof o=="object"&&o!==null?o=qr(o):(i=Kn(t)?Ol:xn.current,r=t.contextTypes,o=(r=r!=null)?kc(e,i):pa),t=new t(n,o),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=gy,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function Y5(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&gy.enqueueReplaceState(t,t.state,null)}function lb(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},g_(e);var o=t.contextType;typeof o=="object"&&o!==null?i.context=qr(o):(o=Kn(t)?Ol:xn.current,i.context=kc(e,o)),i.state=e.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(ab(e,t,o,n),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&gy.enqueueReplaceState(i,i.state,null),ym(e,n,i,r),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function Fc(e,t){try{var n="",r=t;do n+=$q(r),r=r.return;while(r);var i=n}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:t,stack:i,digest:null}}function Zx(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function ub(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var eV=typeof WeakMap=="function"?WeakMap:Map;function A7(e,t,n){n=Zo(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Em||(Em=!0,xb=r),ub(e,t)},n}function F7(e,t,n){n=Zo(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){ub(e,t)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){ub(e,t),typeof r!="function"&&(ia===null?ia=new Set([this]):ia.add(this));var s=t.stack;this.componentDidCatch(t.value,{componentStack:s!==null?s:""})}),n}function X5(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new eV;var i=new Set;r.set(t,i)}else i=r.get(t),i===void 0&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=pV.bind(null,e,t,n),t.then(e,e))}function Q5(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function K5(e,t,n,r,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Zo(-1,1),t.tag=2,ra(n,t,1))),n.lanes|=1),e)}var tV=ms.ReactCurrentOwner,Yn=!1;function kn(e,t,n,r){t.child=e===null?i7(t,null,n,r):$c(t,e.child,n,r)}function Z5(e,t,n,r,i){n=n.render;var o=t.ref;return dc(t,i),r=w_(e,t,n,r,o,i),n=b_(),e!==null&&!Yn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,cs(e,t,i)):(Ze&&n&&l_(t),t.flags|=1,kn(e,t,r,i),t.child)}function J5(e,t,n,r,i){if(e===null){var o=n.type;return typeof o=="function"&&!T_(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=o,M7(e,t,o,r,i)):(e=M0(n.type,null,r,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,!(e.lanes&i)){var s=o.memoizedProps;if(n=n.compare,n=n!==null?n:Ah,n(s,r)&&e.ref===t.ref)return cs(e,t,i)}return t.flags|=1,e=sa(o,r),e.ref=t.ref,e.return=t,t.child=e}function M7(e,t,n,r,i){if(e!==null){var o=e.memoizedProps;if(Ah(o,r)&&e.ref===t.ref)if(Yn=!1,t.pendingProps=r=o,(e.lanes&i)!==0)e.flags&131072&&(Yn=!0);else return t.lanes=e.lanes,cs(e,t,i)}return cb(e,t,n,r,i)}function T7(e,t,n){var r=t.pendingProps,i=r.children,o=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},He(ec,cr),cr|=n;else{if(!(n&1073741824))return e=o!==null?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,He(ec,cr),cr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,He(ec,cr),cr|=r}else o!==null?(r=o.baseLanes|n,t.memoizedState=null):r=n,He(ec,cr),cr|=r;return kn(e,t,i,n),t.child}function N7(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function cb(e,t,n,r,i){var o=Kn(n)?Ol:xn.current;return o=kc(t,o),dc(t,i),n=w_(e,t,n,r,o,i),r=b_(),e!==null&&!Yn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,cs(e,t,i)):(Ze&&r&&l_(t),t.flags|=1,kn(e,t,n,i),t.child)}function e4(e,t,n,r,i){if(Kn(n)){var o=!0;dm(t)}else o=!1;if(dc(t,i),t.stateNode===null)$0(e,t),$7(t,n,r),lb(t,n,r,i),r=!0;else if(e===null){var s=t.stateNode,a=t.memoizedProps;s.props=a;var l=s.context,u=n.contextType;typeof u=="object"&&u!==null?u=qr(u):(u=Kn(n)?Ol:xn.current,u=kc(t,u));var c=n.getDerivedStateFromProps,f=typeof c=="function"||typeof s.getSnapshotBeforeUpdate=="function";f||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==r||l!==u)&&Y5(t,s,r,u),Rs=!1;var d=t.memoizedState;s.state=d,ym(t,r,s,i),l=t.memoizedState,a!==r||d!==l||Qn.current||Rs?(typeof c=="function"&&(ab(t,n,c,r),l=t.memoizedState),(a=Rs||G5(t,n,a,r,d,l,u))?(f||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),s.props=r,s.state=l,s.context=u,r=a):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,s7(e,t),a=t.memoizedProps,u=t.type===t.elementType?a:si(t.type,a),s.props=u,f=t.pendingProps,d=s.context,l=n.contextType,typeof l=="object"&&l!==null?l=qr(l):(l=Kn(n)?Ol:xn.current,l=kc(t,l));var h=n.getDerivedStateFromProps;(c=typeof h=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==f||d!==l)&&Y5(t,s,r,l),Rs=!1,d=t.memoizedState,s.state=d,ym(t,r,s,i);var p=t.memoizedState;a!==f||d!==p||Qn.current||Rs?(typeof h=="function"&&(ab(t,n,h,r),p=t.memoizedState),(u=Rs||G5(t,n,u,r,d,p,l)||!1)?(c||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,p,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,p,l)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),s.props=r,s.state=p,s.context=l,r=u):(typeof s.componentDidUpdate!="function"||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),r=!1)}return fb(e,t,n,r,o,i)}function fb(e,t,n,r,i,o){N7(e,t);var s=(t.flags&128)!==0;if(!r&&!s)return i&&I5(t,n,!1),cs(e,t,o);r=t.stateNode,tV.current=t;var a=s&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&s?(t.child=$c(t,e.child,null,o),t.child=$c(t,null,a,o)):kn(e,t,a,o),t.memoizedState=r.state,i&&I5(t,n,!0),t.child}function R7(e){var t=e.stateNode;t.pendingContext?z5(e,t.pendingContext,t.pendingContext!==t.context):t.context&&z5(e,t.context,!1),m_(e,t.containerInfo)}function t4(e,t,n,r,i){return Cc(),c_(i),t.flags|=256,kn(e,t,n,r),t.child}var db={dehydrated:null,treeContext:null,retryLane:0};function hb(e){return{baseLanes:e,cachePool:null,transitions:null}}function D7(e,t,n){var r=t.pendingProps,i=nt.current,o=!1,s=(t.flags&128)!==0,a;if((a=s)||(a=e!==null&&e.memoizedState===null?!1:(i&2)!==0),a?(o=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),He(nt,i&1),e===null)return ob(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(s=r.children,e=r.fallback,o?(r=t.mode,o=t.child,s={mode:"hidden",children:s},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=s):o=vy(s,r,0,null),e=_l(e,r,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=hb(n),t.memoizedState=db,e):__(t,s));if(i=e.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return nV(e,t,s,r,a,i,n);if(o){o=r.fallback,s=t.mode,i=e.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(s&1)&&t.child!==i?(r=t.child,r.childLanes=0,r.pendingProps=l,t.deletions=null):(r=sa(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?o=sa(a,o):(o=_l(o,s,n,null),o.flags|=2),o.return=t,r.return=t,r.sibling=o,t.child=r,r=o,o=t.child,s=e.child.memoizedState,s=s===null?hb(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},o.memoizedState=s,o.childLanes=e.childLanes&~n,t.memoizedState=db,r}return o=e.child,e=o.sibling,r=sa(o,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function __(e,t){return t=vy({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Cg(e,t,n,r){return r!==null&&c_(r),$c(t,e.child,null,n),e=__(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function nV(e,t,n,r,i,o,s){if(n)return t.flags&256?(t.flags&=-257,r=Zx(Error(V(422))),Cg(e,t,s,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(o=r.fallback,i=t.mode,r=vy({mode:"visible",children:r.children},i,0,null),o=_l(o,i,s,null),o.flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,t.mode&1&&$c(t,e.child,null,s),t.child.memoizedState=hb(s),t.memoizedState=db,o);if(!(t.mode&1))return Cg(e,t,s,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,o=Error(V(419)),r=Zx(o,r,void 0),Cg(e,t,s,r)}if(a=(s&e.childLanes)!==0,Yn||a){if(r=Lt,r!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|s)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,us(e,i),bi(r,e,i,-1))}return M_(),r=Zx(Error(V(421))),Cg(e,t,s,r)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=gV.bind(null,e),i._reactRetry=t,null):(e=o.treeContext,pr=na(i.nextSibling),vr=t,Ze=!0,fi=null,e!==null&&(Nr[Rr++]=qo,Nr[Rr++]=Ho,Nr[Rr++]=Pl,qo=e.id,Ho=e.overflow,Pl=t),t=__(t,r.children),t.flags|=4096,t)}function n4(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),sb(e.return,t,n)}function Jx(e,t,n,r,i){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function O7(e,t,n){var r=t.pendingProps,i=r.revealOrder,o=r.tail;if(kn(e,t,r.children,n),r=nt.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&n4(e,n,t);else if(e.tag===19)n4(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(He(nt,r),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;n!==null;)e=n.alternate,e!==null&&vm(e)===null&&(i=n),n=n.sibling;n=i,n===null?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Jx(t,!1,i,n,o);break;case"backwards":for(n=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&vm(e)===null){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Jx(t,!0,n,null,o);break;case"together":Jx(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function $0(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function cs(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),zl|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(V(153));if(t.child!==null){for(e=t.child,n=sa(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=sa(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function rV(e,t,n){switch(t.tag){case 3:R7(t),Cc();break;case 5:a7(t);break;case 1:Kn(t.type)&&dm(t);break;case 4:m_(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;He(gm,r._currentValue),r._currentValue=i;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(He(nt,nt.current&1),t.flags|=128,null):n&t.child.childLanes?D7(e,t,n):(He(nt,nt.current&1),e=cs(e,t,n),e!==null?e.sibling:null);He(nt,nt.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return O7(e,t,n);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),He(nt,nt.current),r)break;return null;case 22:case 23:return t.lanes=0,T7(e,t,n)}return cs(e,t,n)}var P7,pb,L7,z7;P7=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};pb=function(){};L7=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,yl(ro.current);var o=null;switch(n){case"input":i=Pw(e,i),r=Pw(e,r),o=[];break;case"select":i=ot({},i,{value:void 0}),r=ot({},r,{value:void 0}),o=[];break;case"textarea":i=Iw(e,i),r=Iw(e,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=cm)}Bw(n,r);var s;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(s in a)a.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(bh.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in r){var l=r[u];if(a=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(s in a)!a.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in l)l.hasOwnProperty(s)&&a[s]!==l[s]&&(n||(n={}),n[s]=l[s])}else n||(o||(o=[]),o.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(o=o||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(o=o||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(bh.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Ge("scroll",e),o||a===l||(o=[])):(o=o||[]).push(u,l))}n&&(o=o||[]).push("style",n);var u=o;(t.updateQueue=u)&&(t.flags|=4)}};z7=function(e,t,n,r){n!==r&&(t.flags|=4)};function Qf(e,t){if(!Ze)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function on(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function iV(e,t,n){var r=t.pendingProps;switch(u_(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return on(t),null;case 1:return Kn(t.type)&&fm(),on(t),null;case 3:return r=t.stateNode,Ac(),Qe(Qn),Qe(xn),v_(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(_g(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,fi!==null&&(Eb(fi),fi=null))),pb(e,t),on(t),null;case 5:y_(t);var i=yl(Rh.current);if(n=t.type,e!==null&&t.stateNode!=null)L7(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(V(166));return on(t),null}if(e=yl(ro.current),_g(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[Qi]=t,r[Th]=o,e=(t.mode&1)!==0,n){case"dialog":Ge("cancel",r),Ge("close",r);break;case"iframe":case"object":case"embed":Ge("load",r);break;case"video":case"audio":for(i=0;i<Cd.length;i++)Ge(Cd[i],r);break;case"source":Ge("error",r);break;case"img":case"image":case"link":Ge("error",r),Ge("load",r);break;case"details":Ge("toggle",r);break;case"input":f5(r,o),Ge("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Ge("invalid",r);break;case"textarea":h5(r,o),Ge("invalid",r)}Bw(n,o),i=null;for(var s in o)if(o.hasOwnProperty(s)){var a=o[s];s==="children"?typeof a=="string"?r.textContent!==a&&(o.suppressHydrationWarning!==!0&&Sg(r.textContent,a,e),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&Sg(r.textContent,a,e),i=["children",""+a]):bh.hasOwnProperty(s)&&a!=null&&s==="onScroll"&&Ge("scroll",r)}switch(n){case"input":gg(r),d5(r,o,!0);break;case"textarea":gg(r),p5(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=cm)}r=i,t.updateQueue=r,r!==null&&(t.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=dN(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=s.createElement(n,{is:r.is}):(e=s.createElement(n),n==="select"&&(s=e,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):e=s.createElementNS(e,n),e[Qi]=t,e[Th]=r,P7(e,t,!1,!1),t.stateNode=e;e:{switch(s=Uw(n,r),n){case"dialog":Ge("cancel",e),Ge("close",e),i=r;break;case"iframe":case"object":case"embed":Ge("load",e),i=r;break;case"video":case"audio":for(i=0;i<Cd.length;i++)Ge(Cd[i],e);i=r;break;case"source":Ge("error",e),i=r;break;case"img":case"image":case"link":Ge("error",e),Ge("load",e),i=r;break;case"details":Ge("toggle",e),i=r;break;case"input":f5(e,r),i=Pw(e,r),Ge("invalid",e);break;case"option":i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=ot({},r,{value:void 0}),Ge("invalid",e);break;case"textarea":h5(e,r),i=Iw(e,r),Ge("invalid",e);break;default:i=r}Bw(n,i),a=i;for(o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="style"?gN(e,l):o==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&hN(e,l)):o==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Eh(e,l):typeof l=="number"&&Eh(e,""+l):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(bh.hasOwnProperty(o)?l!=null&&o==="onScroll"&&Ge("scroll",e):l!=null&&YS(e,o,l,s))}switch(n){case"input":gg(e),d5(e,r,!1);break;case"textarea":gg(e),p5(e);break;case"option":r.value!=null&&e.setAttribute("value",""+ha(r.value));break;case"select":e.multiple=!!r.multiple,o=r.value,o!=null?lc(e,!!r.multiple,o,!1):r.defaultValue!=null&&lc(e,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=cm)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return on(t),null;case 6:if(e&&t.stateNode!=null)z7(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(V(166));if(n=yl(Rh.current),yl(ro.current),_g(t)){if(r=t.stateNode,n=t.memoizedProps,r[Qi]=t,(o=r.nodeValue!==n)&&(e=vr,e!==null))switch(e.tag){case 3:Sg(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Sg(r.nodeValue,n,(e.mode&1)!==0)}o&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Qi]=t,t.stateNode=r}return on(t),null;case 13:if(Qe(nt),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ze&&pr!==null&&t.mode&1&&!(t.flags&128))n7(),Cc(),t.flags|=98560,o=!1;else if(o=_g(t),r!==null&&r.dehydrated!==null){if(e===null){if(!o)throw Error(V(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(V(317));o[Qi]=t}else Cc(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;on(t),o=!1}else fi!==null&&(Eb(fi),fi=null),o=!0;if(!o)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||nt.current&1?Et===0&&(Et=3):M_())),t.updateQueue!==null&&(t.flags|=4),on(t),null);case 4:return Ac(),pb(e,t),e===null&&Fh(t.stateNode.containerInfo),on(t),null;case 10:return h_(t.type._context),on(t),null;case 17:return Kn(t.type)&&fm(),on(t),null;case 19:if(Qe(nt),o=t.memoizedState,o===null)return on(t),null;if(r=(t.flags&128)!==0,s=o.rendering,s===null)if(r)Qf(o,!1);else{if(Et!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(s=vm(e),s!==null){for(t.flags|=128,Qf(o,!1),r=s.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)o=n,e=r,o.flags&=14680066,s=o.alternate,s===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,e=s.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return He(nt,nt.current&1|2),t.child}e=e.sibling}o.tail!==null&&ht()>Mc&&(t.flags|=128,r=!0,Qf(o,!1),t.lanes=4194304)}else{if(!r)if(e=vm(s),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Qf(o,!0),o.tail===null&&o.tailMode==="hidden"&&!s.alternate&&!Ze)return on(t),null}else 2*ht()-o.renderingStartTime>Mc&&n!==1073741824&&(t.flags|=128,r=!0,Qf(o,!1),t.lanes=4194304);o.isBackwards?(s.sibling=t.child,t.child=s):(n=o.last,n!==null?n.sibling=s:t.child=s,o.last=s)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=ht(),t.sibling=null,n=nt.current,He(nt,r?n&1|2:n&1),t):(on(t),null);case 22:case 23:return F_(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?cr&1073741824&&(on(t),t.subtreeFlags&6&&(t.flags|=8192)):on(t),null;case 24:return null;case 25:return null}throw Error(V(156,t.tag))}function oV(e,t){switch(u_(t),t.tag){case 1:return Kn(t.type)&&fm(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ac(),Qe(Qn),Qe(xn),v_(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return y_(t),null;case 13:if(Qe(nt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(V(340));Cc()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Qe(nt),null;case 4:return Ac(),null;case 10:return h_(t.type._context),null;case 22:case 23:return F_(),null;case 24:return null;default:return null}}var $g=!1,fn=!1,sV=typeof WeakSet=="function"?WeakSet:Set,re=null;function Ju(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){lt(e,t,r)}else n.current=null}function gb(e,t,n){try{n()}catch(r){lt(e,t,r)}}var r4=!1;function aV(e,t){if(Zw=am,e=WN(),a_(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var s=0,a=-1,l=-1,u=0,c=0,f=e,d=null;t:for(;;){for(var h;f!==n||i!==0&&f.nodeType!==3||(a=s+i),f!==o||r!==0&&f.nodeType!==3||(l=s+r),f.nodeType===3&&(s+=f.nodeValue.length),(h=f.firstChild)!==null;)d=f,f=h;for(;;){if(f===e)break t;if(d===n&&++u===i&&(a=s),d===o&&++c===r&&(l=s),(h=f.nextSibling)!==null)break;f=d,d=f.parentNode}f=h}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Jw={focusedElem:e,selectionRange:n},am=!1,re=t;re!==null;)if(t=re,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,re=e;else for(;re!==null;){t=re;try{var p=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var g=p.memoizedProps,y=p.memoizedState,m=t.stateNode,v=m.getSnapshotBeforeUpdate(t.elementType===t.type?g:si(t.type,g),y);m.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var x=t.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(V(163))}}catch(w){lt(t,t.return,w)}if(e=t.sibling,e!==null){e.return=t.return,re=e;break}re=t.return}return p=r4,r4=!1,p}function ih(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&e)===e){var o=i.destroy;i.destroy=void 0,o!==void 0&&gb(t,n,o)}i=i.next}while(i!==r)}}function my(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function mb(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function I7(e){var t=e.alternate;t!==null&&(e.alternate=null,I7(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Qi],delete t[Th],delete t[nb],delete t[WH],delete t[qH])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function j7(e){return e.tag===5||e.tag===3||e.tag===4}function i4(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||j7(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function yb(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=cm));else if(r!==4&&(e=e.child,e!==null))for(yb(e,t,n),e=e.sibling;e!==null;)yb(e,t,n),e=e.sibling}function vb(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(vb(e,t,n),e=e.sibling;e!==null;)vb(e,t,n),e=e.sibling}var Wt=null,li=!1;function $s(e,t,n){for(n=n.child;n!==null;)B7(e,t,n),n=n.sibling}function B7(e,t,n){if(no&&typeof no.onCommitFiberUnmount=="function")try{no.onCommitFiberUnmount(ly,n)}catch{}switch(n.tag){case 5:fn||Ju(n,t);case 6:var r=Wt,i=li;Wt=null,$s(e,t,n),Wt=r,li=i,Wt!==null&&(li?(e=Wt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Wt.removeChild(n.stateNode));break;case 18:Wt!==null&&(li?(e=Wt,n=n.stateNode,e.nodeType===8?Vx(e.parentNode,n):e.nodeType===1&&Vx(e,n),Ch(e)):Vx(Wt,n.stateNode));break;case 4:r=Wt,i=li,Wt=n.stateNode.containerInfo,li=!0,$s(e,t,n),Wt=r,li=i;break;case 0:case 11:case 14:case 15:if(!fn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,s=o.destroy;o=o.tag,s!==void 0&&(o&2||o&4)&&gb(n,t,s),i=i.next}while(i!==r)}$s(e,t,n);break;case 1:if(!fn&&(Ju(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){lt(n,t,a)}$s(e,t,n);break;case 21:$s(e,t,n);break;case 22:n.mode&1?(fn=(r=fn)||n.memoizedState!==null,$s(e,t,n),fn=r):$s(e,t,n);break;default:$s(e,t,n)}}function o4(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new sV),t.forEach(function(r){var i=mV.bind(null,e,r);n.has(r)||(n.add(r),r.then(i,i))})}}function ni(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var o=e,s=t,a=s;e:for(;a!==null;){switch(a.tag){case 5:Wt=a.stateNode,li=!1;break e;case 3:Wt=a.stateNode.containerInfo,li=!0;break e;case 4:Wt=a.stateNode.containerInfo,li=!0;break e}a=a.return}if(Wt===null)throw Error(V(160));B7(o,s,i),Wt=null,li=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){lt(i,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)U7(t,e),t=t.sibling}function U7(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ni(t,e),Bi(e),r&4){try{ih(3,e,e.return),my(3,e)}catch(g){lt(e,e.return,g)}try{ih(5,e,e.return)}catch(g){lt(e,e.return,g)}}break;case 1:ni(t,e),Bi(e),r&512&&n!==null&&Ju(n,n.return);break;case 5:if(ni(t,e),Bi(e),r&512&&n!==null&&Ju(n,n.return),e.flags&32){var i=e.stateNode;try{Eh(i,"")}catch(g){lt(e,e.return,g)}}if(r&4&&(i=e.stateNode,i!=null)){var o=e.memoizedProps,s=n!==null?n.memoizedProps:o,a=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&cN(i,o),Uw(a,s);var u=Uw(a,o);for(s=0;s<l.length;s+=2){var c=l[s],f=l[s+1];c==="style"?gN(i,f):c==="dangerouslySetInnerHTML"?hN(i,f):c==="children"?Eh(i,f):YS(i,c,f,u)}switch(a){case"input":Lw(i,o);break;case"textarea":fN(i,o);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var h=o.value;h!=null?lc(i,!!o.multiple,h,!1):d!==!!o.multiple&&(o.defaultValue!=null?lc(i,!!o.multiple,o.defaultValue,!0):lc(i,!!o.multiple,o.multiple?[]:"",!1))}i[Th]=o}catch(g){lt(e,e.return,g)}}break;case 6:if(ni(t,e),Bi(e),r&4){if(e.stateNode===null)throw Error(V(162));i=e.stateNode,o=e.memoizedProps;try{i.nodeValue=o}catch(g){lt(e,e.return,g)}}break;case 3:if(ni(t,e),Bi(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ch(t.containerInfo)}catch(g){lt(e,e.return,g)}break;case 4:ni(t,e),Bi(e);break;case 13:ni(t,e),Bi(e),i=e.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||($_=ht())),r&4&&o4(e);break;case 22:if(c=n!==null&&n.memoizedState!==null,e.mode&1?(fn=(u=fn)||c,ni(t,e),fn=u):ni(t,e),Bi(e),r&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!c&&e.mode&1)for(re=e,c=e.child;c!==null;){for(f=re=c;re!==null;){switch(d=re,h=d.child,d.tag){case 0:case 11:case 14:case 15:ih(4,d,d.return);break;case 1:Ju(d,d.return);var p=d.stateNode;if(typeof p.componentWillUnmount=="function"){r=d,n=d.return;try{t=r,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(g){lt(r,n,g)}}break;case 5:Ju(d,d.return);break;case 22:if(d.memoizedState!==null){a4(f);continue}}h!==null?(h.return=d,re=h):a4(f)}c=c.sibling}e:for(c=null,f=e;;){if(f.tag===5){if(c===null){c=f;try{i=f.stateNode,u?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=f.stateNode,l=f.memoizedProps.style,s=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=pN("display",s))}catch(g){lt(e,e.return,g)}}}else if(f.tag===6){if(c===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(g){lt(e,e.return,g)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;c===f&&(c=null),f=f.return}c===f&&(c=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:ni(t,e),Bi(e),r&4&&o4(e);break;case 21:break;default:ni(t,e),Bi(e)}}function Bi(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(j7(n)){var r=n;break e}n=n.return}throw Error(V(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Eh(i,""),r.flags&=-33);var o=i4(e);vb(e,o,i);break;case 3:case 4:var s=r.stateNode.containerInfo,a=i4(e);yb(e,a,s);break;default:throw Error(V(161))}}catch(l){lt(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function lV(e,t,n){re=e,W7(e)}function W7(e,t,n){for(var r=(e.mode&1)!==0;re!==null;){var i=re,o=i.child;if(i.tag===22&&r){var s=i.memoizedState!==null||$g;if(!s){var a=i.alternate,l=a!==null&&a.memoizedState!==null||fn;a=$g;var u=fn;if($g=s,(fn=l)&&!u)for(re=i;re!==null;)s=re,l=s.child,s.tag===22&&s.memoizedState!==null?l4(i):l!==null?(l.return=s,re=l):l4(i);for(;o!==null;)re=o,W7(o),o=o.sibling;re=i,$g=a,fn=u}s4(e)}else i.subtreeFlags&8772&&o!==null?(o.return=i,re=o):s4(e)}}function s4(e){for(;re!==null;){var t=re;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:fn||my(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!fn)if(n===null)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:si(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&q5(t,o,r);break;case 3:var s=t.updateQueue;if(s!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}q5(t,s,n)}break;case 5:var a=t.stateNode;if(n===null&&t.flags&4){n=a;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var f=c.dehydrated;f!==null&&Ch(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(V(163))}fn||t.flags&512&&mb(t)}catch(d){lt(t,t.return,d)}}if(t===e){re=null;break}if(n=t.sibling,n!==null){n.return=t.return,re=n;break}re=t.return}}function a4(e){for(;re!==null;){var t=re;if(t===e){re=null;break}var n=t.sibling;if(n!==null){n.return=t.return,re=n;break}re=t.return}}function l4(e){for(;re!==null;){var t=re;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{my(4,t)}catch(l){lt(t,n,l)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var i=t.return;try{r.componentDidMount()}catch(l){lt(t,i,l)}}var o=t.return;try{mb(t)}catch(l){lt(t,o,l)}break;case 5:var s=t.return;try{mb(t)}catch(l){lt(t,s,l)}}}catch(l){lt(t,t.return,l)}if(t===e){re=null;break}var a=t.sibling;if(a!==null){a.return=t.return,re=a;break}re=t.return}}var uV=Math.ceil,bm=ms.ReactCurrentDispatcher,k_=ms.ReactCurrentOwner,Br=ms.ReactCurrentBatchConfig,Ae=0,Lt=null,yt=null,Qt=0,cr=0,ec=Na(0),Et=0,Lh=null,zl=0,yy=0,C_=0,oh=null,Hn=null,$_=0,Mc=1/0,Lo=null,Em=!1,xb=null,ia=null,Ag=!1,Ws=null,Sm=0,sh=0,wb=null,A0=-1,F0=0;function Rn(){return Ae&6?ht():A0!==-1?A0:A0=ht()}function oa(e){return e.mode&1?Ae&2&&Qt!==0?Qt&-Qt:VH.transition!==null?(F0===0&&(F0=$N()),F0):(e=ze,e!==0||(e=window.event,e=e===void 0?16:DN(e.type)),e):1}function bi(e,t,n,r){if(50<sh)throw sh=0,wb=null,Error(V(185));mp(e,n,r),(!(Ae&2)||e!==Lt)&&(e===Lt&&(!(Ae&2)&&(yy|=n),Et===4&&js(e,Qt)),Zn(e,r),n===1&&Ae===0&&!(t.mode&1)&&(Mc=ht()+500,hy&&Ra()))}function Zn(e,t){var n=e.callbackNode;Vq(e,t);var r=sm(e,e===Lt?Qt:0);if(r===0)n!==null&&y5(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&y5(n),t===1)e.tag===0?HH(u4.bind(null,e)):JN(u4.bind(null,e)),BH(function(){!(Ae&6)&&Ra()}),n=null;else{switch(AN(r)){case 1:n=JS;break;case 4:n=kN;break;case 16:n=om;break;case 536870912:n=CN;break;default:n=om}n=K7(n,q7.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function q7(e,t){if(A0=-1,F0=0,Ae&6)throw Error(V(327));var n=e.callbackNode;if(hc()&&e.callbackNode!==n)return null;var r=sm(e,e===Lt?Qt:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=_m(e,r);else{t=r;var i=Ae;Ae|=2;var o=V7();(Lt!==e||Qt!==t)&&(Lo=null,Mc=ht()+500,Sl(e,t));do try{dV();break}catch(a){H7(e,a)}while(!0);d_(),bm.current=o,Ae=i,yt!==null?t=0:(Lt=null,Qt=0,t=Et)}if(t!==0){if(t===2&&(i=Gw(e),i!==0&&(r=i,t=bb(e,i))),t===1)throw n=Lh,Sl(e,0),js(e,r),Zn(e,ht()),n;if(t===6)js(e,r);else{if(i=e.current.alternate,!(r&30)&&!cV(i)&&(t=_m(e,r),t===2&&(o=Gw(e),o!==0&&(r=o,t=bb(e,o))),t===1))throw n=Lh,Sl(e,0),js(e,r),Zn(e,ht()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(V(345));case 2:sl(e,Hn,Lo);break;case 3:if(js(e,r),(r&130023424)===r&&(t=$_+500-ht(),10<t)){if(sm(e,0)!==0)break;if(i=e.suspendedLanes,(i&r)!==r){Rn(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=tb(sl.bind(null,e,Hn,Lo),t);break}sl(e,Hn,Lo);break;case 4:if(js(e,r),(r&4194240)===r)break;for(t=e.eventTimes,i=-1;0<r;){var s=31-wi(r);o=1<<s,s=t[s],s>i&&(i=s),r&=~o}if(r=i,r=ht()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*uV(r/1960))-r,10<r){e.timeoutHandle=tb(sl.bind(null,e,Hn,Lo),r);break}sl(e,Hn,Lo);break;case 5:sl(e,Hn,Lo);break;default:throw Error(V(329))}}}return Zn(e,ht()),e.callbackNode===n?q7.bind(null,e):null}function bb(e,t){var n=oh;return e.current.memoizedState.isDehydrated&&(Sl(e,t).flags|=256),e=_m(e,t),e!==2&&(t=Hn,Hn=n,t!==null&&Eb(t)),e}function Eb(e){Hn===null?Hn=e:Hn.push.apply(Hn,e)}function cV(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!_i(o(),i))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function js(e,t){for(t&=~C_,t&=~yy,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-wi(t),r=1<<n;e[n]=-1,t&=~r}}function u4(e){if(Ae&6)throw Error(V(327));hc();var t=sm(e,0);if(!(t&1))return Zn(e,ht()),null;var n=_m(e,t);if(e.tag!==0&&n===2){var r=Gw(e);r!==0&&(t=r,n=bb(e,r))}if(n===1)throw n=Lh,Sl(e,0),js(e,t),Zn(e,ht()),n;if(n===6)throw Error(V(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,sl(e,Hn,Lo),Zn(e,ht()),null}function A_(e,t){var n=Ae;Ae|=1;try{return e(t)}finally{Ae=n,Ae===0&&(Mc=ht()+500,hy&&Ra())}}function Il(e){Ws!==null&&Ws.tag===0&&!(Ae&6)&&hc();var t=Ae;Ae|=1;var n=Br.transition,r=ze;try{if(Br.transition=null,ze=1,e)return e()}finally{ze=r,Br.transition=n,Ae=t,!(Ae&6)&&Ra()}}function F_(){cr=ec.current,Qe(ec)}function Sl(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,jH(n)),yt!==null)for(n=yt.return;n!==null;){var r=n;switch(u_(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&fm();break;case 3:Ac(),Qe(Qn),Qe(xn),v_();break;case 5:y_(r);break;case 4:Ac();break;case 13:Qe(nt);break;case 19:Qe(nt);break;case 10:h_(r.type._context);break;case 22:case 23:F_()}n=n.return}if(Lt=e,yt=e=sa(e.current,null),Qt=cr=t,Et=0,Lh=null,C_=yy=zl=0,Hn=oh=null,ml!==null){for(t=0;t<ml.length;t++)if(n=ml[t],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,o=n.pending;if(o!==null){var s=o.next;o.next=i,r.next=s}n.pending=r}ml=null}return e}function H7(e,t){do{var n=yt;try{if(d_(),k0.current=wm,xm){for(var r=it.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}xm=!1}if(Ll=0,Mt=xt=it=null,rh=!1,Dh=0,k_.current=null,n===null||n.return===null){Et=1,Lh=t,yt=null;break}e:{var o=e,s=n.return,a=n,l=t;if(t=Qt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=a,f=c.tag;if(!(c.mode&1)&&(f===0||f===11||f===15)){var d=c.alternate;d?(c.updateQueue=d.updateQueue,c.memoizedState=d.memoizedState,c.lanes=d.lanes):(c.updateQueue=null,c.memoizedState=null)}var h=Q5(s);if(h!==null){h.flags&=-257,K5(h,s,a,o,t),h.mode&1&&X5(o,u,t),t=h,l=u;var p=t.updateQueue;if(p===null){var g=new Set;g.add(l),t.updateQueue=g}else p.add(l);break e}else{if(!(t&1)){X5(o,u,t),M_();break e}l=Error(V(426))}}else if(Ze&&a.mode&1){var y=Q5(s);if(y!==null){!(y.flags&65536)&&(y.flags|=256),K5(y,s,a,o,t),c_(Fc(l,a));break e}}o=l=Fc(l,a),Et!==4&&(Et=2),oh===null?oh=[o]:oh.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var m=A7(o,l,t);W5(o,m);break e;case 1:a=l;var v=o.type,x=o.stateNode;if(!(o.flags&128)&&(typeof v.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(ia===null||!ia.has(x)))){o.flags|=65536,t&=-t,o.lanes|=t;var w=F7(o,a,t);W5(o,w);break e}}o=o.return}while(o!==null)}Y7(n)}catch(b){t=b,yt===n&&n!==null&&(yt=n=n.return);continue}break}while(!0)}function V7(){var e=bm.current;return bm.current=wm,e===null?wm:e}function M_(){(Et===0||Et===3||Et===2)&&(Et=4),Lt===null||!(zl&268435455)&&!(yy&268435455)||js(Lt,Qt)}function _m(e,t){var n=Ae;Ae|=2;var r=V7();(Lt!==e||Qt!==t)&&(Lo=null,Sl(e,t));do try{fV();break}catch(i){H7(e,i)}while(!0);if(d_(),Ae=n,bm.current=r,yt!==null)throw Error(V(261));return Lt=null,Qt=0,Et}function fV(){for(;yt!==null;)G7(yt)}function dV(){for(;yt!==null&&!Lq();)G7(yt)}function G7(e){var t=Q7(e.alternate,e,cr);e.memoizedProps=e.pendingProps,t===null?Y7(e):yt=t,k_.current=null}function Y7(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=oV(n,t),n!==null){n.flags&=32767,yt=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Et=6,yt=null;return}}else if(n=iV(n,t,cr),n!==null){yt=n;return}if(t=t.sibling,t!==null){yt=t;return}yt=t=e}while(t!==null);Et===0&&(Et=5)}function sl(e,t,n){var r=ze,i=Br.transition;try{Br.transition=null,ze=1,hV(e,t,n,r)}finally{Br.transition=i,ze=r}return null}function hV(e,t,n,r){do hc();while(Ws!==null);if(Ae&6)throw Error(V(327));n=e.finishedWork;var i=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(V(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(Gq(e,o),e===Lt&&(yt=Lt=null,Qt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ag||(Ag=!0,K7(om,function(){return hc(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=Br.transition,Br.transition=null;var s=ze;ze=1;var a=Ae;Ae|=4,k_.current=null,aV(e,n),U7(n,e),RH(Jw),am=!!Zw,Jw=Zw=null,e.current=n,lV(n),zq(),Ae=a,ze=s,Br.transition=o}else e.current=n;if(Ag&&(Ag=!1,Ws=e,Sm=i),o=e.pendingLanes,o===0&&(ia=null),Bq(n.stateNode),Zn(e,ht()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Em)throw Em=!1,e=xb,xb=null,e;return Sm&1&&e.tag!==0&&hc(),o=e.pendingLanes,o&1?e===wb?sh++:(sh=0,wb=e):sh=0,Ra(),null}function hc(){if(Ws!==null){var e=AN(Sm),t=Br.transition,n=ze;try{if(Br.transition=null,ze=16>e?16:e,Ws===null)var r=!1;else{if(e=Ws,Ws=null,Sm=0,Ae&6)throw Error(V(331));var i=Ae;for(Ae|=4,re=e.current;re!==null;){var o=re,s=o.child;if(re.flags&16){var a=o.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(re=u;re!==null;){var c=re;switch(c.tag){case 0:case 11:case 15:ih(8,c,o)}var f=c.child;if(f!==null)f.return=c,re=f;else for(;re!==null;){c=re;var d=c.sibling,h=c.return;if(I7(c),c===u){re=null;break}if(d!==null){d.return=h,re=d;break}re=h}}}var p=o.alternate;if(p!==null){var g=p.child;if(g!==null){p.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}re=o}}if(o.subtreeFlags&2064&&s!==null)s.return=o,re=s;else e:for(;re!==null;){if(o=re,o.flags&2048)switch(o.tag){case 0:case 11:case 15:ih(9,o,o.return)}var m=o.sibling;if(m!==null){m.return=o.return,re=m;break e}re=o.return}}var v=e.current;for(re=v;re!==null;){s=re;var x=s.child;if(s.subtreeFlags&2064&&x!==null)x.return=s,re=x;else e:for(s=v;re!==null;){if(a=re,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:my(9,a)}}catch(b){lt(a,a.return,b)}if(a===s){re=null;break e}var w=a.sibling;if(w!==null){w.return=a.return,re=w;break e}re=a.return}}if(Ae=i,Ra(),no&&typeof no.onPostCommitFiberRoot=="function")try{no.onPostCommitFiberRoot(ly,e)}catch{}r=!0}return r}finally{ze=n,Br.transition=t}}return!1}function c4(e,t,n){t=Fc(n,t),t=A7(e,t,1),e=ra(e,t,1),t=Rn(),e!==null&&(mp(e,1,t),Zn(e,t))}function lt(e,t,n){if(e.tag===3)c4(e,e,n);else for(;t!==null;){if(t.tag===3){c4(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ia===null||!ia.has(r))){e=Fc(n,e),e=F7(t,e,1),t=ra(t,e,1),e=Rn(),t!==null&&(mp(t,1,e),Zn(t,e));break}}t=t.return}}function pV(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Rn(),e.pingedLanes|=e.suspendedLanes&n,Lt===e&&(Qt&n)===n&&(Et===4||Et===3&&(Qt&130023424)===Qt&&500>ht()-$_?Sl(e,0):C_|=n),Zn(e,t)}function X7(e,t){t===0&&(e.mode&1?(t=vg,vg<<=1,!(vg&130023424)&&(vg=4194304)):t=1);var n=Rn();e=us(e,t),e!==null&&(mp(e,t,n),Zn(e,n))}function gV(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),X7(e,n)}function mV(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(V(314))}r!==null&&r.delete(t),X7(e,n)}var Q7;Q7=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Qn.current)Yn=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Yn=!1,rV(e,t,n);Yn=!!(e.flags&131072)}else Yn=!1,Ze&&t.flags&1048576&&e7(t,pm,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;$0(e,t),e=t.pendingProps;var i=kc(t,xn.current);dc(t,n),i=w_(null,t,r,e,i,n);var o=b_();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Kn(r)?(o=!0,dm(t)):o=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,g_(t),i.updater=gy,t.stateNode=i,i._reactInternals=t,lb(t,r,e,n),t=fb(null,t,r,!0,o,n)):(t.tag=0,Ze&&o&&l_(t),kn(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch($0(e,t),e=t.pendingProps,i=r._init,r=i(r._payload),t.type=r,i=t.tag=vV(r),e=si(r,e),i){case 0:t=cb(null,t,r,e,n);break e;case 1:t=e4(null,t,r,e,n);break e;case 11:t=Z5(null,t,r,e,n);break e;case 14:t=J5(null,t,r,si(r.type,e),n);break e}throw Error(V(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:si(r,i),cb(e,t,r,i,n);case 1:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:si(r,i),e4(e,t,r,i,n);case 3:e:{if(R7(t),e===null)throw Error(V(387));r=t.pendingProps,o=t.memoizedState,i=o.element,s7(e,t),ym(t,r,null,n);var s=t.memoizedState;if(r=s.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){i=Fc(Error(V(423)),t),t=t4(e,t,r,n,i);break e}else if(r!==i){i=Fc(Error(V(424)),t),t=t4(e,t,r,n,i);break e}else for(pr=na(t.stateNode.containerInfo.firstChild),vr=t,Ze=!0,fi=null,n=i7(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Cc(),r===i){t=cs(e,t,n);break e}kn(e,t,r,n)}t=t.child}return t;case 5:return a7(t),e===null&&ob(t),r=t.type,i=t.pendingProps,o=e!==null?e.memoizedProps:null,s=i.children,eb(r,i)?s=null:o!==null&&eb(r,o)&&(t.flags|=32),N7(e,t),kn(e,t,s,n),t.child;case 6:return e===null&&ob(t),null;case 13:return D7(e,t,n);case 4:return m_(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=$c(t,null,r,n):kn(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:si(r,i),Z5(e,t,r,i,n);case 7:return kn(e,t,t.pendingProps,n),t.child;case 8:return kn(e,t,t.pendingProps.children,n),t.child;case 12:return kn(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,o=t.memoizedProps,s=i.value,He(gm,r._currentValue),r._currentValue=s,o!==null)if(_i(o.value,s)){if(o.children===i.children&&!Qn.current){t=cs(e,t,n);break e}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var a=o.dependencies;if(a!==null){s=o.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(o.tag===1){l=Zo(-1,n&-n),l.tag=2;var u=o.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),sb(o.return,n,t),a.lanes|=n;break}l=l.next}}else if(o.tag===10)s=o.type===t.type?null:o.child;else if(o.tag===18){if(s=o.return,s===null)throw Error(V(341));s.lanes|=n,a=s.alternate,a!==null&&(a.lanes|=n),sb(s,n,t),s=o.sibling}else s=o.child;if(s!==null)s.return=o;else for(s=o;s!==null;){if(s===t){s=null;break}if(o=s.sibling,o!==null){o.return=s.return,s=o;break}s=s.return}o=s}kn(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,dc(t,n),i=qr(i),r=r(i),t.flags|=1,kn(e,t,r,n),t.child;case 14:return r=t.type,i=si(r,t.pendingProps),i=si(r.type,i),J5(e,t,r,i,n);case 15:return M7(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:si(r,i),$0(e,t),t.tag=1,Kn(r)?(e=!0,dm(t)):e=!1,dc(t,n),$7(t,r,i),lb(t,r,i,n),fb(null,t,r,!0,e,n);case 19:return O7(e,t,n);case 22:return T7(e,t,n)}throw Error(V(156,t.tag))};function K7(e,t){return _N(e,t)}function yV(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pr(e,t,n,r){return new yV(e,t,n,r)}function T_(e){return e=e.prototype,!(!e||!e.isReactComponent)}function vV(e){if(typeof e=="function")return T_(e)?1:0;if(e!=null){if(e=e.$$typeof,e===QS)return 11;if(e===KS)return 14}return 2}function sa(e,t){var n=e.alternate;return n===null?(n=Pr(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function M0(e,t,n,r,i,o){var s=2;if(r=e,typeof e=="function")T_(e)&&(s=1);else if(typeof e=="string")s=5;else e:switch(e){case qu:return _l(n.children,i,o,t);case XS:s=8,i|=8;break;case Nw:return e=Pr(12,n,t,i|2),e.elementType=Nw,e.lanes=o,e;case Rw:return e=Pr(13,n,t,i),e.elementType=Rw,e.lanes=o,e;case Dw:return e=Pr(19,n,t,i),e.elementType=Dw,e.lanes=o,e;case aN:return vy(n,i,o,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case oN:s=10;break e;case sN:s=9;break e;case QS:s=11;break e;case KS:s=14;break e;case Ns:s=16,r=null;break e}throw Error(V(130,e==null?e:typeof e,""))}return t=Pr(s,n,t,i),t.elementType=e,t.type=r,t.lanes=o,t}function _l(e,t,n,r){return e=Pr(7,e,r,t),e.lanes=n,e}function vy(e,t,n,r){return e=Pr(22,e,r,t),e.elementType=aN,e.lanes=n,e.stateNode={isHidden:!1},e}function e2(e,t,n){return e=Pr(6,e,null,t),e.lanes=n,e}function t2(e,t,n){return t=Pr(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function xV(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ox(0),this.expirationTimes=Ox(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ox(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function N_(e,t,n,r,i,o,s,a,l){return e=new xV(e,t,n,a,l),t===1?(t=1,o===!0&&(t|=8)):t=0,o=Pr(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},g_(o),e}function wV(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Wu,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function Z7(e){if(!e)return pa;e=e._reactInternals;e:{if(lu(e)!==e||e.tag!==1)throw Error(V(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Kn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(V(171))}if(e.tag===1){var n=e.type;if(Kn(n))return ZN(e,n,t)}return t}function J7(e,t,n,r,i,o,s,a,l){return e=N_(n,r,!0,e,i,o,s,a,l),e.context=Z7(null),n=e.current,r=Rn(),i=oa(n),o=Zo(r,i),o.callback=t??null,ra(n,o,i),e.current.lanes=i,mp(e,i,r),Zn(e,r),e}function xy(e,t,n,r){var i=t.current,o=Rn(),s=oa(i);return n=Z7(n),t.context===null?t.context=n:t.pendingContext=n,t=Zo(o,s),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=ra(i,t,s),e!==null&&(bi(e,i,s,o),_0(e,i,s)),s}function km(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function f4(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function R_(e,t){f4(e,t),(e=e.alternate)&&f4(e,t)}function bV(){return null}var eR=typeof reportError=="function"?reportError:function(e){console.error(e)};function D_(e){this._internalRoot=e}wy.prototype.render=D_.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(V(409));xy(e,t,null,null)};wy.prototype.unmount=D_.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Il(function(){xy(null,e,null,null)}),t[ls]=null}};function wy(e){this._internalRoot=e}wy.prototype.unstable_scheduleHydration=function(e){if(e){var t=TN();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Is.length&&t!==0&&t<Is[n].priority;n++);Is.splice(n,0,e),n===0&&RN(e)}};function O_(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function by(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function d4(){}function EV(e,t,n,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var u=km(s);o.call(u)}}var s=J7(t,r,e,0,null,!1,!1,"",d4);return e._reactRootContainer=s,e[ls]=s.current,Fh(e.nodeType===8?e.parentNode:e),Il(),s}for(;i=e.lastChild;)e.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var u=km(l);a.call(u)}}var l=N_(e,0,!1,null,null,!1,!1,"",d4);return e._reactRootContainer=l,e[ls]=l.current,Fh(e.nodeType===8?e.parentNode:e),Il(function(){xy(t,l,n,r)}),l}function Ey(e,t,n,r,i){var o=n._reactRootContainer;if(o){var s=o;if(typeof i=="function"){var a=i;i=function(){var l=km(s);a.call(l)}}xy(t,s,e,i)}else s=EV(n,t,e,i,r);return km(s)}FN=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=kd(t.pendingLanes);n!==0&&(e_(t,n|1),Zn(t,ht()),!(Ae&6)&&(Mc=ht()+500,Ra()))}break;case 13:Il(function(){var r=us(e,1);if(r!==null){var i=Rn();bi(r,e,1,i)}}),R_(e,1)}};t_=function(e){if(e.tag===13){var t=us(e,134217728);if(t!==null){var n=Rn();bi(t,e,134217728,n)}R_(e,134217728)}};MN=function(e){if(e.tag===13){var t=oa(e),n=us(e,t);if(n!==null){var r=Rn();bi(n,e,t,r)}R_(e,t)}};TN=function(){return ze};NN=function(e,t){var n=ze;try{return ze=e,t()}finally{ze=n}};qw=function(e,t,n){switch(t){case"input":if(Lw(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=dy(r);if(!i)throw Error(V(90));uN(r),Lw(r,i)}}}break;case"textarea":fN(e,n);break;case"select":t=n.value,t!=null&&lc(e,!!n.multiple,t,!1)}};vN=A_;xN=Il;var SV={usingClientEntryPoint:!1,Events:[vp,Yu,dy,mN,yN,A_]},Kf={findFiberByHostInstance:gl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},_V={bundleType:Kf.bundleType,version:Kf.version,rendererPackageName:Kf.rendererPackageName,rendererConfig:Kf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ms.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=EN(e),e===null?null:e.stateNode},findFiberByHostInstance:Kf.findFiberByHostInstance||bV,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Fg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Fg.isDisabled&&Fg.supportsFiber)try{ly=Fg.inject(_V),no=Fg}catch{}}$r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=SV;$r.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!O_(t))throw Error(V(200));return wV(e,t,null,n)};$r.createRoot=function(e,t){if(!O_(e))throw Error(V(299));var n=!1,r="",i=eR;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=N_(e,1,!1,null,null,n,!1,r,i),e[ls]=t.current,Fh(e.nodeType===8?e.parentNode:e),new D_(t)};$r.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(V(188)):(e=Object.keys(e).join(","),Error(V(268,e)));return e=EN(t),e=e===null?null:e.stateNode,e};$r.flushSync=function(e){return Il(e)};$r.hydrate=function(e,t,n){if(!by(t))throw Error(V(200));return Ey(null,e,t,!0,n)};$r.hydrateRoot=function(e,t,n){if(!O_(e))throw Error(V(405));var r=n!=null&&n.hydratedSources||null,i=!1,o="",s=eR;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(s=n.onRecoverableError)),t=J7(t,null,e,1,n??null,i,!1,o,s),e[ls]=t.current,Fh(e),r)for(e=0;e<r.length;e++)n=r[e],i=n._getVersion,i=i(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new wy(t)};$r.render=function(e,t,n){if(!by(t))throw Error(V(200));return Ey(null,e,t,!1,n)};$r.unmountComponentAtNode=function(e){if(!by(e))throw Error(V(40));return e._reactRootContainer?(Il(function(){Ey(null,null,e,!1,function(){e._reactRootContainer=null,e[ls]=null})}),!0):!1};$r.unstable_batchedUpdates=A_;$r.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!by(n))throw Error(V(200));if(e==null||e._reactInternals===void 0)throw Error(V(38));return Ey(e,t,n,!1,r)};$r.version="18.3.1-next-f1338f8080-20240426";function tR(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(tR)}catch(e){console.error(e)}}tR(),tN.exports=$r;var kV=tN.exports,nR,h4=kV;nR=h4.createRoot,h4.hydrateRoot;function CV(e){const t=e.size||24,n=e.color||"var(--color-secondary-1)";return M.jsxs("svg",{width:t,height:t,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[M.jsx("g",{id:"SVGRepo_bgCarrier",strokeWidth:"0"}),M.jsx("g",{id:"SVGRepo_tracerCarrier",strokeLinecap:"round",strokeLinejoin:"round"}),M.jsxs("g",{id:"SVGRepo_iconCarrier",children:[" ",M.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3 1L1.66667 5H0V8H1V15H3V13H13V15H15V8H16V5H14.3333L13 1H3ZM4 9C3.44772 9 3 9.44772 3 10C3 10.5523 3.44772 11 4 11C4.55228 11 5 10.5523 5 10C5 9.44772 4.55228 9 4 9ZM11.5585 3H4.44152L3.10819 7H12.8918L11.5585 3ZM12 9C11.4477 9 11 9.44772 11 10C11 10.5523 11.4477 11 12 11C12.5523 11 13 10.5523 13 10C13 9.44772 12.5523 9 12 9Z",fill:n})," "]})]})}function $V(e){const t=e.size||24,n=e.color||"var(--color-secondary-1)";return M.jsxs("svg",{width:t,height:t,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[M.jsx("g",{id:"SVGRepo_bgCarrier",strokeWidth:"0"}),M.jsx("g",{id:"SVGRepo_tracerCarrier",strokeLinecap:"round",strokeLinejoin:"round"}),M.jsxs("g",{id:"SVGRepo_iconCarrier",children:[" ",M.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10 0H0V10H10V0ZM3 4C3.55228 4 4 3.55228 4 3C4 2.44772 3.55228 2 3 2C2.44772 2 2 2.44772 2 3C2 3.55228 2.44772 4 3 4ZM8 7C8 7.55228 7.55228 8 7 8C6.44772 8 6 7.55228 6 7C6 6.44772 6.44772 6 7 6C7.55228 6 8 6.44772 8 7Z",fill:n})," ",M.jsx("path",{d:"M6 16V12H12V6H16V16H6Z",fill:n})," "]})]})}function AV(e){const t=e.size||24,n=e.color||"var(--color-secondary-1)";return M.jsxs("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[M.jsx("g",{id:"SVGRepo_bgCarrier",strokeWidth:"0"}),M.jsx("g",{id:"SVGRepo_tracerCarrier",strokeLinecap:"round",strokeLinejoin:"round"}),M.jsxs("g",{id:"SVGRepo_iconCarrier",children:[" ",M.jsx("path",{d:"M16 22V15M3 22V18M3 14V8C3 5.17157 3 3.75736 3.87868 2.87868C4.75736 2 6.17157 2 9 2H10C12.8284 2 14.2426 2 15.1213 2.87868C16 3.75736 16 5.17157 16 8V11",stroke:n,strokeWidth:"1.5",strokeLinecap:"round"})," ",M.jsx("path",{d:"M9.5 10L8 12.5H11L9.5 15",stroke:n,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})," ",M.jsx("path",{d:"M17 22H2",stroke:n,strokeWidth:"1.5",strokeLinecap:"round"})," ",M.jsx("path",{d:"M19.5 4L20.7331 4.98647C20.8709 5.09673 20.9398 5.15186 21.0025 5.20805C21.5937 5.73807 21.9508 6.48086 21.9953 7.27364C22 7.35769 22 7.44594 22 7.62244V18.5C22 19.3284 21.3284 20 20.5 20C19.6716 20 19 19.3284 19 18.5V18.4286C19 17.6396 18.3604 17 17.5714 17H16",stroke:n,strokeWidth:"1.5",strokeLinecap:"round"})," ",M.jsx("path",{d:"M22 8H20.5C19.6716 8 19 8.67157 19 9.5V11.9189C19 12.5645 19.4131 13.1377 20.0257 13.3419L22 14",stroke:n,strokeWidth:"1.5",strokeLinecap:"round"})," "]})]})}function FV(e){return new Promise(t=>setTimeout(t,e))}class MV{constructor(t,n){this.delayMs=t,this.onDequeue=n,this.queue=[]}enqueue(t){this.queue.push(t),this.startTimer()}startTimer(){this.ongoingTimeout&&clearTimeout(this.ongoingTimeout),this.ongoingTimeout=setTimeout(()=>{this.dequeue(),this.ongoingTimeout=void 0},this.delayMs)}dequeue(){this.queue.length>0&&(this.queue=this.onDequeue(this.queue))}}function TV(e,t){const n=uo.useRef();return n.current||(n.current=new MV(e,t)),n.current}class NV{static async simulate(t){console.log("start request ..."),await FV(1e3),console.log("... end request");const n=Object.values(t.nrChargePoints).reduce((i,o)=>i+o.count,0),r={};for(let i=1;i<=n;i++){const o=Math.random()*10;r[i]={day:o,week:o*7,month:o*31,year:o*365}}return{energyPerStation:r,averageDay:Array(24).fill(0).map((i,o)=>o).map(i=>{const o=Math.random()*10*Math.sin(Math.PI*i/24);return{time:i,min:Math.max(o-3*Math.random(),0),mean:o,max:o+3*Math.random()}}),totalEnergyCharged:Array(365).fill(0).map((i,o)=>{const s=Math.random()*30*Math.sin(Math.PI*o/365);return{day:o,kWh:s}}).map((i,o,s)=>(o>0&&(i.kWh+=s[o-1].kWh),i)),chargingEvents:{day:Math.random()*5,week:Math.random()*5*7,month:Math.random()*5*30,year:Math.random()*5*365}}}}const RV={input:{nrChargePoints:[{power:11,count:20}],arrivalProbabilityMultiplier:100,carConsumption:18,chargingPower:11},output:void 0};class DV{constructor(t){this.state=t,this.callbacks={}}currentState(){return this.state}watch(t,n){this.callbacks[n]=t}async onAction(t){const n=structuredClone(t);this.state=this.reduce(n,this.state);for(const r of Object.values(this.callbacks))r(this.state);await this.effects(t,this.state)}reduce(t,n){switch(t.type){case"form-submit":return{...n,input:{...n.input,...t.payload}};case"simulation-request":return{...n,output:void 0};case"simulation-success":return{...n,output:t.payload};default:return n}}async effects(t,n){switch(t.type){case"init":case"form-submit":this.onAction({type:"simulation-request",payload:n.input});return;case"simulation-request":{const r=await NV.simulate(t.payload);this.onAction({type:"simulation-success",payload:r});return}default:return}}}const Sb=new DV(RV);function yf(e,t){const n=()=>e(Sb.currentState()),[r,i]=uo.useState(n);return Sb.watch(o=>i(e(o)),t),r}function Cm(e){Sb.onAction(e)}function OV(e){const t=e.size||24,n=e.color||"var(--color-secondary-1)";return M.jsxs("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[M.jsx("g",{id:"SVGRepo_bgCarrier",strokeWidth:"0"}),M.jsx("g",{id:"SVGRepo_tracerCarrier",strokeLinecap:"round",strokeLinejoin:"round"}),M.jsxs("g",{id:"SVGRepo_iconCarrier",children:[" ",M.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12ZM8.96963 8.96965C9.26252 8.67676 9.73739 8.67676 10.0303 8.96965L12 10.9393L13.9696 8.96967C14.2625 8.67678 14.7374 8.67678 15.0303 8.96967C15.3232 9.26256 15.3232 9.73744 15.0303 10.0303L13.0606 12L15.0303 13.9696C15.3232 14.2625 15.3232 14.7374 15.0303 15.0303C14.7374 15.3232 14.2625 15.3232 13.9696 15.0303L12 13.0607L10.0303 15.0303C9.73742 15.3232 9.26254 15.3232 8.96965 15.0303C8.67676 14.7374 8.67676 14.2625 8.96965 13.9697L10.9393 12L8.96963 10.0303C8.67673 9.73742 8.67673 9.26254 8.96963 8.96965Z",fill:n})," "]})]})}function PV(e){const t=e.size||24,n=e.color||"var(--color-secondary-1)";return M.jsxs("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[M.jsx("g",{id:"SVGRepo_bgCarrier",strokeWidth:"0"}),M.jsx("g",{id:"SVGRepo_tracerCarrier",strokeLinecap:"round",strokeLinejoin:"round"}),M.jsx("g",{id:"SVGRepo_iconCarrier",children:M.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13 9C13 8.44772 12.5523 8 12 8C11.4477 8 11 8.44772 11 9V11H9C8.44772 11 8 11.4477 8 12C8 12.5523 8.44772 13 9 13H11V15C11 15.5523 11.4477 16 12 16C12.5523 16 13 15.5523 13 15V13H15C15.5523 13 16 12.5523 16 12C16 11.4477 15.5523 11 15 11H13V9ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12Z",fill:n})})]})}function LV(e){return M.jsxs("div",{children:[e.cp.count," x ",e.cp.power," kW"]})}function zV(e){return M.jsx("div",{style:{display:"grid",gridTemplateColumns:"50% 50%"},children:e.chargePoints.map((t,n)=>M.jsx(LV,{cp:t},n))})}function IV(e){return M.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100vh",backgroundColor:"#2222",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10},children:M.jsx("div",{style:{background:"white",outline:"1px solid gray",borderRadius:"0.5rem",padding:"1.5rem",pointerEvents:"all"},children:e.children})})}function jV(e,t){const n=[...e];return n.splice(t,1),n}const BV=(e,t,n,r)=>{const i=[];return t<=0&&i.push("There must be at least one station"),n<=0&&i.push("Power must be at least 1 kW"),jV(r,e).includes(n)&&i.push(`There is already a charge point with power ${n} kW`),i},p4=e=>{const t=[],n=e.map(r=>r.power);for(let r=0;r<e.length;r++){const i=e[r],o=BV(r,i.count,i.power,n);t.push({...i,errors:o})}return t},g4=e=>e.map(n=>({...n,errors:[]})),UV=e=>e.map(t=>({count:t.count,power:t.power}));function WV(e){return M.jsxs("div",{style:{padding:"0.25rem"},children:[M.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:"0.5rem"},children:[M.jsx("div",{children:M.jsx("input",{type:"number",name:"",id:"",defaultValue:e.count,onChange:t=>e.onChange(+t.currentTarget.value,e.power,e.errors)})}),M.jsx("div",{children:"x"}),M.jsx("div",{children:M.jsx("input",{type:"number",name:"",id:"",defaultValue:e.power,onChange:t=>e.onChange(e.count,+t.currentTarget.value,e.errors)})}),M.jsx("div",{children:"kW"}),!e.forbidDelete&&M.jsx("div",{onClick:e.onRemove,children:M.jsx(OV,{})}),e.forbidDelete&&M.jsx("div",{style:{width:"24px"}})]}),M.jsx("div",{style:{fontSize:"small",color:"red"},children:e.errors.map(t=>M.jsx("p",{children:t},t))})]})}function qV(e){return M.jsx("div",{onClick:e.onClick,children:M.jsx(PV,{})})}function HV(){const[e,t]=uo.useState(!1),n=yf(f=>f.input.nrChargePoints,"charge-point-edit-form"),[r,i]=uo.useState(g4(n)),o=r.map(f=>f.errors).reduce((f,d)=>f+d.length,0),s=(f,d,h)=>{i(p=>(p[f]={count:d,power:h,errors:[]},p4(p)))},a=f=>{i(d=>{const h=[...d];return h.splice(f,1),h.length<=0?[...d]:p4(h)})},l=()=>{i(f=>{const d=Math.max(...f.map(h=>h.power));return[...f,{count:1,power:d+1,errors:[]}]})},u=()=>{o>0||(Cm({type:"form-submit",payload:{nrChargePoints:UV(r)}}),t(!1))},c=()=>{i(g4(n)),t(!1)};return M.jsxs(M.Fragment,{children:[M.jsx(zV,{chargePoints:n}),M.jsx("div",{style:{float:"right"},children:M.jsx("button",{className:"buttonStandard",onClick:()=>t(!0),children:"Edit"})}),e&&M.jsx(IV,{children:M.jsxs("div",{children:[M.jsxs("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-evenly",gap:"0.5rem"},children:[M.jsx("div",{children:M.jsx("h3",{children:"Count"})}),M.jsx("div",{children:M.jsx("h3",{children:"Power"})})]}),M.jsxs("div",{children:[r.map((f,d)=>M.jsx(WV,{count:f.count,power:f.power,errors:f.errors,onChange:(h,p)=>s(d,h,p),onRemove:()=>a(d),forbidDelete:r.length<=1},d)),M.jsx(qV,{onClick:l})]}),M.jsxs("div",{style:{display:"flex",flexDirection:"row",justifyContent:"flex-end",gap:"0.5rem"},children:[M.jsx("button",{className:"buttonStandard",onClick:u,disabled:o>0,children:"OK"}),M.jsx("button",{className:"buttonStandard",onClick:c,children:"Cancel"})]})]})})]})}function n2(e){return M.jsxs("div",{className:"boxed",children:[M.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:"1rem",alignItems:"center"},children:[e.icon,M.jsx("h4",{children:e.title})]}),M.jsx("div",{className:"insetLeft",children:e.children})]})}function VV(e){const t=e.size||24,n=e.color||"var(--color-secondary-1)";return M.jsxs("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[M.jsx("g",{id:"SVGRepo_bgCarrier",strokeWidth:"0"}),M.jsx("g",{id:"SVGRepo_tracerCarrier",strokeLinecap:"round",strokeLinejoin:"round"}),M.jsxs("g",{id:"SVGRepo_iconCarrier",children:[" ",M.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.29289 8.79289C6.68342 8.40237 7.31658 8.40237 7.70711 8.79289L12 13.0858L16.2929 8.79289C16.6834 8.40237 17.3166 8.40237 17.7071 8.79289C18.0976 9.18342 18.0976 9.81658 17.7071 10.2071L12.7071 15.2071C12.3166 15.5976 11.6834 15.5976 11.2929 15.2071L6.29289 10.2071C5.90237 9.81658 5.90237 9.18342 6.29289 8.79289Z",fill:n})," "]})]})}function GV(e){const t=e.size||24,n=e.color||"var(--color-secondary-1)";return M.jsxs("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[M.jsx("g",{id:"SVGRepo_bgCarrier",strokeWidth:"0"}),M.jsx("g",{id:"SVGRepo_tracerCarrier",strokeLinecap:"round",strokeLinejoin:"round"}),M.jsxs("g",{id:"SVGRepo_iconCarrier",children:[" ",M.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11.2929 8.79289C11.6834 8.40237 12.3166 8.40237 12.7071 8.79289L17.7071 13.7929C18.0976 14.1834 18.0976 14.8166 17.7071 15.2071C17.3166 15.5976 16.6834 15.5976 16.2929 15.2071L12 10.9142L7.70711 15.2071C7.31658 15.5976 6.68342 15.5976 6.29289 15.2071C5.90237 14.8166 5.90237 14.1834 6.29289 13.7929L11.2929 8.79289Z",fill:n})," "]})]})}function YV(e){return M.jsxs("div",{style:{width:"100%",display:"flex",flexDirection:"row",gap:"1rem",justifyContent:"flex-end"},children:[M.jsx("div",{style:{fontSize:"xx-large",fontWeight:"bolder"},children:e.val}),M.jsx("div",{style:{fontSize:"xx-large",fontWeight:"bolder"},children:e.label}),M.jsxs("div",{children:[M.jsx("div",{onClick:()=>e.onChange?e.onChange(e.val+1):"",className:"hoverDark",children:M.jsx(GV,{size:30})}),M.jsx("div",{onClick:()=>e.onChange?e.onChange(e.val-1):"",className:"hoverDark",children:M.jsx(VV,{size:30})})]})]})}function XV(e){const[t,n]=uo.useState(e.defaultVal);return M.jsxs("div",{style:{width:"100%",display:"flex",flexDirection:"row",gap:"1rem",justifyContent:"flex-end"},children:[M.jsxs("div",{style:{fontSize:"xx-large",fontWeight:"bolder"},children:[t," ",e.label]}),M.jsx("input",{style:{width:"6rem"},type:"range",name:"",id:"",defaultValue:e.defaultVal,min:e.min,max:e.max,step:e.stepSize,onChange:r=>{const i=+r.target.value;n(i),e.callback(i)}})]})}function QV(e){const t=TV(e.notificationDelayMs,n=>{const r=n.pop();return r&&e.callback(r),[]});return M.jsx(XV,{callback:n=>t.enqueue(n),defaultVal:e.defaultVal,min:e.min,max:e.max,stepSize:e.stepSize,label:e.label})}function KV(){const e=yf(t=>t.input,"input-form");return M.jsxs("div",{className:"form",children:[M.jsx(n2,{title:"Charge points",icon:M.jsx(AV,{color:"white",size:30}),children:M.jsx(HV,{})}),M.jsx(n2,{title:"Arrival multiplier",icon:M.jsx($V,{color:"white",size:30}),children:M.jsx(QV,{label:"%",min:20,max:200,stepSize:10,defaultVal:e.arrivalProbabilityMultiplier,notificationDelayMs:500,callback:t=>Cm({type:"form-submit",payload:{arrivalProbabilityMultiplier:t}})})}),M.jsx(n2,{title:"Car consumption",icon:M.jsx(CV,{color:"white",size:30}),children:M.jsx(YV,{label:M.jsxs("div",{style:{display:"flex",alignItems:"flex-end"},children:[M.jsx("div",{children:"kWh"}),M.jsx("div",{style:{fontSize:"small"},children:"/100km"})]}),val:e.carConsumption,onChange:t=>Cm({type:"form-submit",payload:{carConsumption:t}})})})]})}function ZV(e){const t=e.size||24,n=e.color||"var(--color-secondary-1)";return M.jsxs("svg",{width:t,height:t,viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[M.jsx("rect",{className:"spinner_GmWz",x:"1",y:"4",width:"6",height:"14",fill:n}),M.jsx("rect",{className:"spinner_GmWz spinner_NuDr",x:"9",y:"4",width:"6",height:"14",fill:n}),M.jsx("rect",{className:"spinner_GmWz spinner_OlQ0",x:"17",y:"4",width:"6",height:"14",fill:n})]})}function Sy(e){return M.jsxs("div",{style:{position:"relative",height:"95%"},children:[M.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%"},className:"fadable"+(e.spinning?"":" fadeOutTwoWay"),children:M.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%"},children:M.jsx(ZV,{size:50,color:"gray"})})}),M.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%"},className:"fadable"+(e.spinning?" fadeOut":""),children:M.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%"},children:e.children})})]})}var rR={exports:{}},JV="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",eG=JV,tG=eG;function iR(){}function oR(){}oR.resetWarningCache=iR;var nG=function(){function e(r,i,o,s,a,l){if(l!==tG){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}e.isRequired=e;function t(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:oR,resetWarningCache:iR};return n.PropTypes=n,n};rR.exports=nG();var rG=rR.exports;const m4=sy(rG),y4={};function _b(e,t){e===void 0&&(e=y4),t===void 0&&(t=y4);const n=Object.keys(e),r=Object.keys(t);return e===t||n.length===r.length&&n.every(i=>e[i]===t[i])}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */var iG=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),oG=Object.prototype.hasOwnProperty;function kb(e,t){return oG.call(e,t)}function Cb(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);var r=[];for(var i in e)kb(e,i)&&r.push(i);return r}function gr(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function $b(e){for(var t=0,n=e.length,r;t<n;){if(r=e.charCodeAt(t),r>=48&&r<=57){t++;continue}return!1}return!0}function al(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function sR(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function Ab(e){if(e===void 0)return!0;if(e){if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(Ab(e[t]))return!0}else if(typeof e=="object"){for(var r=Cb(e),i=r.length,o=0;o<i;o++)if(Ab(e[r[o]]))return!0}}return!1}function v4(e,t){var n=[e];for(var r in t){var i=typeof t[r]=="object"?JSON.stringify(t[r],null,2):t[r];typeof i<"u"&&n.push(r+": "+i)}return n.join(`
`)}var aR=function(e){iG(t,e);function t(n,r,i,o,s){var a=this.constructor,l=e.call(this,v4(n,{name:r,index:i,operation:o,tree:s}))||this;return l.name=r,l.index=i,l.operation=o,l.tree=s,Object.setPrototypeOf(l,a.prototype),l.message=v4(n,{name:r,index:i,operation:o,tree:s}),l}return t}(Error),at=aR,sG=gr,tc={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var r=e[t];return delete e[t],{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:function(e,t,n){var r=$m(n,this.path);r&&(r=gr(r));var i=kl(n,{op:"remove",path:this.from}).removed;return kl(n,{op:"add",path:this.path,value:i}),{newDocument:n,removed:r}},copy:function(e,t,n){var r=$m(n,this.from);return kl(n,{op:"add",path:this.path,value:gr(r)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:zh(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},aG={add:function(e,t,n){return $b(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){var r=e.splice(t,1);return{newDocument:n,removed:r[0]}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:tc.move,copy:tc.copy,test:tc.test,_get:tc._get};function $m(e,t){if(t=="")return e;var n={op:"_get",path:t};return kl(e,n),n.value}function kl(e,t,n,r,i,o){if(n===void 0&&(n=!1),r===void 0&&(r=!0),i===void 0&&(i=!0),o===void 0&&(o=0),n&&(typeof n=="function"?n(t,0,e,t.path):Am(t,0)),t.path===""){var s={newDocument:e};if(t.op==="add")return s.newDocument=t.value,s;if(t.op==="replace")return s.newDocument=t.value,s.removed=e,s;if(t.op==="move"||t.op==="copy")return s.newDocument=$m(e,t.from),t.op==="move"&&(s.removed=e),s;if(t.op==="test"){if(s.test=zh(e,t.value),s.test===!1)throw new at("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return s.newDocument=e,s}else{if(t.op==="remove")return s.removed=e,s.newDocument=null,s;if(t.op==="_get")return t.value=e,s;if(n)throw new at("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",o,t,e);return s}}else{r||(e=gr(e));var a=t.path||"",l=a.split("/"),u=e,c=1,f=l.length,d=void 0,h=void 0,p=void 0;for(typeof n=="function"?p=n:p=Am;;){if(h=l[c],h&&h.indexOf("~")!=-1&&(h=sR(h)),i&&(h=="__proto__"||h=="prototype"&&c>0&&l[c-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&d===void 0&&(u[h]===void 0?d=l.slice(0,c).join("/"):c==f-1&&(d=t.path),d!==void 0&&p(t,0,e,d)),c++,Array.isArray(u)){if(h==="-")h=u.length;else{if(n&&!$b(h))throw new at("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",o,t,e);$b(h)&&(h=~~h)}if(c>=f){if(n&&t.op==="add"&&h>u.length)throw new at("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",o,t,e);var s=aG[t.op].call(t,u,h,e);if(s.test===!1)throw new at("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return s}}else if(c>=f){var s=tc[t.op].call(t,u,h,e);if(s.test===!1)throw new at("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return s}if(u=u[h],n&&c<f&&(!u||typeof u!="object"))throw new at("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",o,t,e)}}}function _y(e,t,n,r,i){if(r===void 0&&(r=!0),i===void 0&&(i=!0),n&&!Array.isArray(t))throw new at("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(e=gr(e));for(var o=new Array(t.length),s=0,a=t.length;s<a;s++)o[s]=kl(e,t[s],n,!0,i,s),e=o[s].newDocument;return o.newDocument=e,o}function lG(e,t,n){var r=kl(e,t);if(r.test===!1)throw new at("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return r.newDocument}function Am(e,t,n,r){if(typeof e!="object"||e===null||Array.isArray(e))throw new at("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(tc[e.op]){if(typeof e.path!="string")throw new at("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(e.path.indexOf("/")!==0&&e.path.length>0)throw new at('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if((e.op==="move"||e.op==="copy")&&typeof e.from!="string")throw new at("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===void 0)throw new at("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&Ab(e.value))throw new at("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n){if(e.op=="add"){var i=e.path.split("/").length,o=r.split("/").length;if(i!==o+1&&i!==o)throw new at("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==r)throw new at("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if(e.op==="move"||e.op==="copy"){var s={op:"_get",path:e.from,value:void 0},a=lR([s],n);if(a&&a.name==="OPERATION_PATH_UNRESOLVABLE")throw new at("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}}else throw new at("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n)}function lR(e,t,n){try{if(!Array.isArray(e))throw new at("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)_y(gr(t),gr(e),n||!0);else{n=n||Am;for(var r=0;r<e.length;r++)n(e[r],r,t,void 0)}}catch(i){if(i instanceof at)return i;throw i}}function zh(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Array.isArray(e),r=Array.isArray(t),i,o,s;if(n&&r){if(o=e.length,o!=t.length)return!1;for(i=o;i--!==0;)if(!zh(e[i],t[i]))return!1;return!0}if(n!=r)return!1;var a=Object.keys(e);if(o=a.length,o!==Object.keys(t).length)return!1;for(i=o;i--!==0;)if(!t.hasOwnProperty(a[i]))return!1;for(i=o;i--!==0;)if(s=a[i],!zh(e[s],t[s]))return!1;return!0}return e!==e&&t!==t}const uG=Object.freeze(Object.defineProperty({__proto__:null,JsonPatchError:at,_areEquals:zh,applyOperation:kl,applyPatch:_y,applyReducer:lG,deepClone:sG,getValueByPointer:$m,validate:lR,validator:Am},Symbol.toStringTag,{value:"Module"}));/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2021 Joachim Wester
 * MIT license
 */var P_=new WeakMap,cG=function(){function e(t){this.observers=new Map,this.obj=t}return e}(),fG=function(){function e(t,n){this.callback=t,this.observer=n}return e}();function dG(e){return P_.get(e)}function hG(e,t){return e.observers.get(t)}function pG(e,t){e.observers.delete(t.callback)}function gG(e,t){t.unobserve()}function mG(e,t){var n=[],r,i=dG(e);if(!i)i=new cG(e),P_.set(e,i);else{var o=hG(i,t);r=o&&o.observer}if(r)return r;if(r={},i.value=gr(e),t){r.callback=t,r.next=null;var s=function(){Fb(r)},a=function(){clearTimeout(r.next),r.next=setTimeout(s)};typeof window<"u"&&(window.addEventListener("mouseup",a),window.addEventListener("keyup",a),window.addEventListener("mousedown",a),window.addEventListener("keydown",a),window.addEventListener("change",a))}return r.patches=n,r.object=e,r.unobserve=function(){Fb(r),clearTimeout(r.next),pG(i,r),typeof window<"u"&&(window.removeEventListener("mouseup",a),window.removeEventListener("keyup",a),window.removeEventListener("mousedown",a),window.removeEventListener("keydown",a),window.removeEventListener("change",a))},i.observers.set(t,new fG(t,r)),r}function Fb(e,t){t===void 0&&(t=!1);var n=P_.get(e.object);L_(n.value,e.object,e.patches,"",t),e.patches.length&&_y(n.value,e.patches);var r=e.patches;return r.length>0&&(e.patches=[],e.callback&&e.callback(r)),r}function L_(e,t,n,r,i){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var o=Cb(t),s=Cb(e),a=!1,l=s.length-1;l>=0;l--){var u=s[l],c=e[u];if(kb(t,u)&&!(t[u]===void 0&&c!==void 0&&Array.isArray(t)===!1)){var f=t[u];typeof c=="object"&&c!=null&&typeof f=="object"&&f!=null&&Array.isArray(c)===Array.isArray(f)?L_(c,f,n,r+"/"+al(u),i):c!==f&&(i&&n.push({op:"test",path:r+"/"+al(u),value:gr(c)}),n.push({op:"replace",path:r+"/"+al(u),value:gr(f)}))}else Array.isArray(e)===Array.isArray(t)?(i&&n.push({op:"test",path:r+"/"+al(u),value:gr(c)}),n.push({op:"remove",path:r+"/"+al(u)}),a=!0):(i&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}))}if(!(!a&&o.length==s.length))for(var l=0;l<o.length;l++){var u=o[l];!kb(e,u)&&t[u]!==void 0&&n.push({op:"add",path:r+"/"+al(u),value:gr(t[u])})}}}function yG(e,t,n){n===void 0&&(n=!1);var r=[];return L_(e,t,r,"",n),r}const vG=Object.freeze(Object.defineProperty({__proto__:null,compare:yG,generate:Fb,observe:mG,unobserve:gG},Symbol.toStringTag,{value:"Module"}));Object.assign({},uG,vG,{JsonPatchError:aR,deepClone:gr,escapePathComponent:al,unescapePathComponent:sR});var xG=/("(?:[^\\"]|\\.)*")|[:,]/g,wG=function(t,n){var r,i,o;return n=n||{},r=JSON.stringify([1],void 0,n.indent===void 0?2:n.indent).slice(2,-3),i=r===""?1/0:n.maxLength===void 0?80:n.maxLength,o=n.replacer,function s(a,l,u){var c,f,d,h,p,g,y,m,v,x,w,b;if(a&&typeof a.toJSON=="function"&&(a=a.toJSON()),w=JSON.stringify(a,o),w===void 0)return w;if(y=i-l.length-u,w.length<=y&&(v=w.replace(xG,function(S,E){return E||S+" "}),v.length<=y))return v;if(o!=null&&(a=JSON.parse(w),o=void 0),typeof a=="object"&&a!==null){if(m=l+r,d=[],f=0,Array.isArray(a))for(x="[",c="]",y=a.length;f<y;f++)d.push(s(a[f],m,f===y-1?0:1)||"null");else for(x="{",c="}",g=Object.keys(a),y=g.length;f<y;f++)h=g[f],p=JSON.stringify(h)+": ",b=s(a[h],m,p.length+(f===y-1?0:1)),b!==void 0&&d.push(p+b);if(d.length>0)return[x,r+d.join(`,
`+m),c].join(`
`+l)}return w}(t,"",0)};const r2=sy(wG);function ar(e,t,n){return e.fields=t||[],e.fname=n,e}function ft(e){return e==null?null:e.fname}function gn(e){return e==null?null:e.fields}function uR(e){return e.length===1?bG(e[0]):EG(e)}const bG=e=>function(t){return t[e]},EG=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function I(e){throw Error(e)}function wo(e){const t=[],n=e.length;let r=null,i=0,o="",s,a,l;e=e+"";function u(){t.push(o+e.substring(s,a)),o="",s=a+1}for(s=a=0;a<n;++a)if(l=e[a],l==="\\")o+=e.substring(s,a++),s=a;else if(l===r)u(),r=null,i=-1;else{if(r)continue;s===i&&l==='"'||s===i&&l==="'"?(s=a+1,r=l):l==="."&&!i?a>s?u():s=a+1:l==="["?(a>s&&u(),i=s=a+1):l==="]"&&(i||I("Access path missing open bracket: "+e),i>0&&u(),i=0,s=a+1)}return i&&I("Access path missing closing bracket: "+e),r&&I("Access path missing closing quote: "+e),a>s&&(a++,u()),t}function Vr(e,t,n){const r=wo(e);return e=r.length===1?r[0]:e,ar((n&&n.get||uR)(r),[e],t||e)}const wp=Vr("id"),wn=ar(e=>e,[],"identity"),Bs=ar(()=>0,[],"zero"),vf=ar(()=>1,[],"one"),Gr=ar(()=>!0,[],"true"),Fs=ar(()=>!1,[],"false");function SG(e,t,n){const r=[t].concat([].slice.call(n));console[e].apply(console,r)}const cR=0,z_=1,I_=2,fR=3,dR=4;function j_(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:SG,r=e||cR;return{level(i){return arguments.length?(r=+i,this):r},error(){return r>=z_&&n(t||"error","ERROR",arguments),this},warn(){return r>=I_&&n(t||"warn","WARN",arguments),this},info(){return r>=fR&&n(t||"log","INFO",arguments),this},debug(){return r>=dR&&n(t||"log","DEBUG",arguments),this}}}var j=Array.isArray;function Z(e){return e===Object(e)}const x4=e=>e!=="__proto__";function xf(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((r,i)=>{for(const o in i)if(o==="signals")r.signals=_G(r.signals,i.signals);else{const s=o==="legend"?{layout:1}:o==="style"?!0:null;wf(r,o,i[o],s)}return r},{})}function wf(e,t,n,r){if(!x4(t))return;let i,o;if(Z(n)&&!j(n)){o=Z(e[t])?e[t]:e[t]={};for(i in n)r&&(r===!0||r[i])?wf(o,i,n[i]):x4(i)&&(o[i]=n[i])}else e[t]=n}function _G(e,t){if(e==null)return t;const n={},r=[];function i(o){n[o.name]||(n[o.name]=1,r.push(o))}return t.forEach(i),e.forEach(i),r}function Ce(e){return e[e.length-1]}function hn(e){return e==null||e===""?null:+e}const hR=e=>t=>e*Math.exp(t),pR=e=>t=>Math.log(e*t),gR=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),mR=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,Fm=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function ky(e,t,n,r){const i=n(e[0]),o=n(Ce(e)),s=(o-i)*t;return[r(i-s),r(o-s)]}function yR(e,t){return ky(e,t,hn,wn)}function vR(e,t){var n=Math.sign(e[0]);return ky(e,t,pR(n),hR(n))}function xR(e,t,n){return ky(e,t,Fm(n),Fm(1/n))}function wR(e,t,n){return ky(e,t,gR(n),mR(n))}function Cy(e,t,n,r,i){const o=r(e[0]),s=r(Ce(e)),a=t!=null?r(t):(o+s)/2;return[i(a+(o-a)*n),i(a+(s-a)*n)]}function B_(e,t,n){return Cy(e,t,n,hn,wn)}function U_(e,t,n){const r=Math.sign(e[0]);return Cy(e,t,n,pR(r),hR(r))}function Mm(e,t,n,r){return Cy(e,t,n,Fm(r),Fm(1/r))}function W_(e,t,n,r){return Cy(e,t,n,gR(r),mR(r))}function bR(e){return 1+~~(new Date(e).getMonth()/3)}function ER(e){return 1+~~(new Date(e).getUTCMonth()/3)}function J(e){return e!=null?j(e)?e:[e]:[]}function SR(e,t,n){let r=e[0],i=e[1],o;return i<r&&(o=i,i=r,r=o),o=i-r,o>=n-t?[t,n]:[r=Math.min(Math.max(r,t),n-o),r+o]}function me(e){return typeof e=="function"}const kG="descending";function q_(e,t,n){n=n||{},t=J(t)||[];const r=[],i=[],o={},s=n.comparator||CG;return J(e).forEach((a,l)=>{a!=null&&(r.push(t[l]===kG?-1:1),i.push(a=me(a)?a:Vr(a,null,n)),(gn(a)||[]).forEach(u=>o[u]=1))}),i.length===0?null:ar(s(i,r),Object.keys(o))}const $y=(e,t)=>(e<t||e==null)&&t!=null?-1:(e>t||t==null)&&e!=null?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0),CG=(e,t)=>e.length===1?$G(e[0],t[0]):AG(e,t,e.length),$G=(e,t)=>function(n,r){return $y(e(n),e(r))*t},AG=(e,t,n)=>(t.push(0),function(r,i){let o,s=0,a=-1;for(;s===0&&++a<n;)o=e[a],s=$y(o(r),o(i));return s*t[a]});function bn(e){return me(e)?e:()=>e}function H_(e,t){let n;return r=>{n&&clearTimeout(n),n=setTimeout(()=>(t(r),n=null),e)}}function ge(e){for(let t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t)e[n]=t[n]}return e}function co(e,t){let n=0,r,i,o,s;if(e&&(r=e.length))if(t==null){for(i=e[n];n<r&&(i==null||i!==i);i=e[++n]);for(o=s=i;n<r;++n)i=e[n],i!=null&&(i<o&&(o=i),i>s&&(s=i))}else{for(i=t(e[n]);n<r&&(i==null||i!==i);i=t(e[++n]));for(o=s=i;n<r;++n)i=t(e[n]),i!=null&&(i<o&&(o=i),i>s&&(s=i))}return[o,s]}function _R(e,t){const n=e.length;let r=-1,i,o,s,a,l;if(t==null){for(;++r<n;)if(o=e[r],o!=null&&o>=o){i=s=o;break}if(r===n)return[-1,-1];for(a=l=r;++r<n;)o=e[r],o!=null&&(i>o&&(i=o,a=r),s<o&&(s=o,l=r))}else{for(;++r<n;)if(o=t(e[r],r,e),o!=null&&o>=o){i=s=o;break}if(r===n)return[-1,-1];for(a=l=r;++r<n;)o=t(e[r],r,e),o!=null&&(i>o&&(i=o,a=r),s<o&&(s=o,l=r))}return[a,l]}const FG=Object.prototype.hasOwnProperty;function te(e,t){return FG.call(e,t)}const Mg={};function bf(e){let t={},n;function r(o){return te(t,o)&&t[o]!==Mg}const i={size:0,empty:0,object:t,has:r,get(o){return r(o)?t[o]:void 0},set(o,s){return r(o)||(++i.size,t[o]===Mg&&--i.empty),t[o]=s,this},delete(o){return r(o)&&(--i.size,++i.empty,t[o]=Mg),this},clear(){i.size=i.empty=0,i.object=t={}},test(o){return arguments.length?(n=o,i):n},clean(){const o={};let s=0;for(const a in t){const l=t[a];l!==Mg&&(!n||!n(l))&&(o[a]=l,++s)}i.size=s,i.empty=0,i.object=t=o}};return e&&Object.keys(e).forEach(o=>{i.set(o,e[o])}),i}function kR(e,t,n,r,i,o){if(!n&&n!==0)return o;const s=+n;let a=e[0],l=Ce(e),u;l<a&&(u=a,a=l,l=u),u=Math.abs(t-a);const c=Math.abs(l-t);return u<c&&u<=s?r:c<=s?i:o}function X(e,t,n){const r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),ge(r,n)}function nc(e,t,n,r){let i=t[0],o=t[t.length-1],s;return i>o&&(s=i,i=o,o=s),n=n===void 0||n,r=r===void 0||r,(n?i<=e:i<e)&&(r?e<=o:e<o)}function Da(e){return typeof e=="boolean"}function aa(e){return Object.prototype.toString.call(e)==="[object Date]"}function CR(e){return e&&me(e[Symbol.iterator])}function Me(e){return typeof e=="number"}function $R(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function ee(e){return typeof e=="string"}function V_(e,t,n){e&&(e=t?J(e).map(a=>a.replace(/\\(.)/g,"$1")):J(e));const r=e&&e.length,i=n&&n.get||uR,o=a=>i(t?[a]:wo(a));let s;if(!r)s=function(){return""};else if(r===1){const a=o(e[0]);s=function(l){return""+a(l)}}else{const a=e.map(o);s=function(l){let u=""+a[0](l),c=0;for(;++c<r;)u+="|"+a[c](l);return u}}return ar(s,e,"key")}function AR(e,t){const n=e[0],r=Ce(e),i=+t;return i?i===1?r:n+i*(r-n):n}const MG=1e4;function FR(e){e=+e||MG;let t,n,r;const i=()=>{t={},n={},r=0},o=(s,a)=>(++r>e&&(n=t,t={},r=1),t[s]=a);return i(),{clear:i,has:s=>te(t,s)||te(n,s),get:s=>te(t,s)?t[s]:te(n,s)?o(s,n[s]):void 0,set:(s,a)=>te(t,s)?t[s]=a:o(s,a)}}function MR(e,t,n,r){const i=t.length,o=n.length;if(!o)return t;if(!i)return n;const s=r||new t.constructor(i+o);let a=0,l=0,u=0;for(;a<i&&l<o;++u)s[u]=e(t[a],n[l])>0?n[l++]:t[a++];for(;a<i;++a,++u)s[u]=t[a];for(;l<o;++l,++u)s[u]=n[l];return s}function $d(e,t){let n="";for(;--t>=0;)n+=e;return n}function TR(e,t,n,r){const i=n||" ",o=e+"",s=t-o.length;return s<=0?o:r==="left"?$d(i,s)+o:r==="center"?$d(i,~~(s/2))+o+$d(i,Math.ceil(s/2)):o+$d(i,s)}function bp(e){return e&&Ce(e)-e[0]||0}function Y(e){return j(e)?"["+e.map(Y)+"]":Z(e)||ee(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function G_(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}const TG=e=>Me(e)||aa(e)?e:Date.parse(e);function Y_(e,t){return t=t||TG,e==null||e===""?null:t(e)}function X_(e){return e==null||e===""?null:e+""}function ki(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}function NR(e,t,n,r){const i=r??"…",o=e+"",s=o.length,a=Math.max(0,t-i.length);return s<=t?o:n==="left"?i+o.slice(s-a):n==="center"?o.slice(0,Math.ceil(a/2))+i+o.slice(s-~~(a/2)):o.slice(0,a)+i}function Ds(e,t,n){if(e)if(t){const r=e.length;for(let i=0;i<r;++i){const o=t(e[i]);o&&n(o,i,e)}}else e.forEach(n)}var w4={},i2={},o2=34,Zf=10,s2=13;function RR(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function NG(e,t){var n=RR(e);return function(r,i){return t(n(r),i,e)}}function b4(e){var t=Object.create(null),n=[];return e.forEach(function(r){for(var i in r)i in t||n.push(t[i]=i)}),n}function Wn(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function RG(e){return e<0?"-"+Wn(-e,6):e>9999?"+"+Wn(e,6):Wn(e,4)}function DG(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":RG(e.getUTCFullYear())+"-"+Wn(e.getUTCMonth()+1,2)+"-"+Wn(e.getUTCDate(),2)+(i?"T"+Wn(t,2)+":"+Wn(n,2)+":"+Wn(r,2)+"."+Wn(i,3)+"Z":r?"T"+Wn(t,2)+":"+Wn(n,2)+":"+Wn(r,2)+"Z":n||t?"T"+Wn(t,2)+":"+Wn(n,2)+"Z":"")}function OG(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function r(f,d){var h,p,g=i(f,function(y,m){if(h)return h(y,m-1);p=y,h=d?NG(y,d):RR(y)});return g.columns=p||[],g}function i(f,d){var h=[],p=f.length,g=0,y=0,m,v=p<=0,x=!1;f.charCodeAt(p-1)===Zf&&--p,f.charCodeAt(p-1)===s2&&--p;function w(){if(v)return i2;if(x)return x=!1,w4;var S,E=g,_;if(f.charCodeAt(E)===o2){for(;g++<p&&f.charCodeAt(g)!==o2||f.charCodeAt(++g)===o2;);return(S=g)>=p?v=!0:(_=f.charCodeAt(g++))===Zf?x=!0:_===s2&&(x=!0,f.charCodeAt(g)===Zf&&++g),f.slice(E+1,S-1).replace(/""/g,'"')}for(;g<p;){if((_=f.charCodeAt(S=g++))===Zf)x=!0;else if(_===s2)x=!0,f.charCodeAt(g)===Zf&&++g;else if(_!==n)continue;return f.slice(E,S)}return v=!0,f.slice(E,p)}for(;(m=w())!==i2;){for(var b=[];m!==w4&&m!==i2;)b.push(m),m=w();d&&(b=d(b,y++))==null||h.push(b)}return h}function o(f,d){return f.map(function(h){return d.map(function(p){return c(h[p])}).join(e)})}function s(f,d){return d==null&&(d=b4(f)),[d.map(c).join(e)].concat(o(f,d)).join(`
`)}function a(f,d){return d==null&&(d=b4(f)),o(f,d).join(`
`)}function l(f){return f.map(u).join(`
`)}function u(f){return f.map(c).join(e)}function c(f){return f==null?"":f instanceof Date?DG(f):t.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:r,parseRows:i,format:s,formatBody:a,formatRows:l,formatRow:u,formatValue:c}}function PG(e){return e}function LG(e){if(e==null)return PG;var t,n,r=e.scale[0],i=e.scale[1],o=e.translate[0],s=e.translate[1];return function(a,l){l||(t=n=0);var u=2,c=a.length,f=new Array(c);for(f[0]=(t+=a[0])*r+o,f[1]=(n+=a[1])*i+s;u<c;)f[u]=a[u],++u;return f}}function zG(e,t){for(var n,r=e.length,i=r-t;i<--r;)n=e[i],e[i++]=e[r],e[r]=n}function IG(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return E4(e,n)})}:E4(e,t)}function E4(e,t){var n=t.id,r=t.bbox,i=t.properties==null?{}:t.properties,o=DR(e,t);return n==null&&r==null?{type:"Feature",properties:i,geometry:o}:r==null?{type:"Feature",id:n,properties:i,geometry:o}:{type:"Feature",id:n,bbox:r,properties:i,geometry:o}}function DR(e,t){var n=LG(e.transform),r=e.arcs;function i(c,f){f.length&&f.pop();for(var d=r[c<0?~c:c],h=0,p=d.length;h<p;++h)f.push(n(d[h],h));c<0&&zG(f,p)}function o(c){return n(c)}function s(c){for(var f=[],d=0,h=c.length;d<h;++d)i(c[d],f);return f.length<2&&f.push(f[0]),f}function a(c){for(var f=s(c);f.length<4;)f.push(f[0]);return f}function l(c){return c.map(a)}function u(c){var f=c.type,d;switch(f){case"GeometryCollection":return{type:f,geometries:c.geometries.map(u)};case"Point":d=o(c.coordinates);break;case"MultiPoint":d=c.coordinates.map(o);break;case"LineString":d=s(c.arcs);break;case"MultiLineString":d=c.arcs.map(s);break;case"Polygon":d=l(c.arcs);break;case"MultiPolygon":d=c.arcs.map(l);break;default:return null}return{type:f,coordinates:d}}return u(t)}function jG(e,t){var n={},r={},i={},o=[],s=-1;t.forEach(function(u,c){var f=e.arcs[u<0?~u:u],d;f.length<3&&!f[1][0]&&!f[1][1]&&(d=t[++s],t[s]=u,t[c]=d)}),t.forEach(function(u){var c=a(u),f=c[0],d=c[1],h,p;if(h=i[f])if(delete i[h.end],h.push(u),h.end=d,p=r[d]){delete r[p.start];var g=p===h?h:h.concat(p);r[g.start=h.start]=i[g.end=p.end]=g}else r[h.start]=i[h.end]=h;else if(h=r[d])if(delete r[h.start],h.unshift(u),h.start=f,p=i[f]){delete i[p.end];var y=p===h?h:p.concat(h);r[y.start=p.start]=i[y.end=h.end]=y}else r[h.start]=i[h.end]=h;else h=[u],r[h.start=f]=i[h.end=d]=h});function a(u){var c=e.arcs[u<0?~u:u],f=c[0],d;return e.transform?(d=[0,0],c.forEach(function(h){d[0]+=h[0],d[1]+=h[1]})):d=c[c.length-1],u<0?[d,f]:[f,d]}function l(u,c){for(var f in u){var d=u[f];delete c[d.start],delete d.start,delete d.end,d.forEach(function(h){n[h<0?~h:h]=1}),o.push(d)}}return l(i,r),l(r,i),t.forEach(function(u){n[u<0?~u:u]||o.push([u])}),o}function BG(e){return DR(e,UG.apply(this,arguments))}function UG(e,t,n){var r,i,o;if(arguments.length>1)r=WG(e,t,n);else for(i=0,r=new Array(o=e.arcs.length);i<o;++i)r[i]=i;return{type:"MultiLineString",arcs:jG(e,r)}}function WG(e,t,n){var r=[],i=[],o;function s(f){var d=f<0?~f:f;(i[d]||(i[d]=[])).push({i:f,g:o})}function a(f){f.forEach(s)}function l(f){f.forEach(a)}function u(f){f.forEach(l)}function c(f){switch(o=f,f.type){case"GeometryCollection":f.geometries.forEach(c);break;case"LineString":a(f.arcs);break;case"MultiLineString":case"Polygon":l(f.arcs);break;case"MultiPolygon":u(f.arcs);break}}return c(t),i.forEach(n==null?function(f){r.push(f[0].i)}:function(f){n(f[0].g,f[f.length-1].g)&&r.push(f[0].i)}),r}function Jo(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function qG(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Ef(e){let t,n,r;e.length!==2?(t=Jo,n=(a,l)=>Jo(e(a),l),r=(a,l)=>e(a)-l):(t=e===Jo||e===qG?e:HG,n=e,r=e);function i(a,l,u=0,c=a.length){if(u<c){if(t(l,l)!==0)return c;do{const f=u+c>>>1;n(a[f],l)<0?u=f+1:c=f}while(u<c)}return u}function o(a,l,u=0,c=a.length){if(u<c){if(t(l,l)!==0)return c;do{const f=u+c>>>1;n(a[f],l)<=0?u=f+1:c=f}while(u<c)}return u}function s(a,l,u=0,c=a.length){const f=i(a,l,u,c-1);return f>u&&r(a[f-1],l)>-r(a[f],l)?f-1:f}return{left:i,center:s,right:o}}function HG(){return 0}function OR(e){return e===null?NaN:+e}function*VG(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)(r=t(r,++n,e))!=null&&(r=+r)>=r&&(yield r)}}const PR=Ef(Jo),ga=PR.right,GG=PR.left;Ef(OR).center;function YG(e,t){let n=0,r,i=0,o=0;if(t===void 0)for(let s of e)s!=null&&(s=+s)>=s&&(r=s-i,i+=r/++n,o+=r*(s-i));else{let s=-1;for(let a of e)(a=t(a,++s,e))!=null&&(a=+a)>=a&&(r=a-i,i+=r/++n,o+=r*(a-i))}if(n>1)return o/(n-1)}function XG(e,t){const n=YG(e,t);return n&&Math.sqrt(n)}class Dn{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const o=n[i],s=t+o,a=Math.abs(t)<Math.abs(o)?t-(s-o):o-(s-t);a&&(n[r++]=a),t=s}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,i,o,s=0;if(n>0){for(s=t[--n];n>0&&(r=s,i=t[--n],s=r+i,o=i-(s-r),!o););n>0&&(o<0&&t[n-1]<0||o>0&&t[n-1]>0)&&(i=o*2,r=s+i,i==r-s&&(s=r))}return s}}class S4 extends Map{constructor(t,n=IR){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[r,i]of t)this.set(r,i)}get(t){return super.get(Mb(this,t))}has(t){return super.has(Mb(this,t))}set(t,n){return super.set(LR(this,t),n)}delete(t){return super.delete(zR(this,t))}}class Tm extends Set{constructor(t,n=IR){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const r of t)this.add(r)}has(t){return super.has(Mb(this,t))}add(t){return super.add(LR(this,t))}delete(t){return super.delete(zR(this,t))}}function Mb({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function LR({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function zR({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function IR(e){return e!==null&&typeof e=="object"?e.valueOf():e}function QG(e,t){return Array.from(t,n=>e[n])}function KG(e=Jo){if(e===Jo)return jR;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||r===0?r:(e(n,n)===0)-(e(t,t)===0)}}function jR(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const ZG=Math.sqrt(50),JG=Math.sqrt(10),eY=Math.sqrt(2);function Nm(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),s=o>=ZG?10:o>=JG?5:o>=eY?2:1;let a,l,u;return i<0?(u=Math.pow(10,-i)/s,a=Math.round(e*u),l=Math.round(t*u),a/u<e&&++a,l/u>t&&--l,u=-u):(u=Math.pow(10,i)*s,a=Math.round(e/u),l=Math.round(t/u),a*u<e&&++a,l*u>t&&--l),l<a&&.5<=n&&n<2?Nm(e,t,n*2):[a,l,u]}function Tb(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const r=t<e,[i,o,s]=r?Nm(t,e,n):Nm(e,t,n);if(!(o>=i))return[];const a=o-i+1,l=new Array(a);if(r)if(s<0)for(let u=0;u<a;++u)l[u]=(o-u)/-s;else for(let u=0;u<a;++u)l[u]=(o-u)*s;else if(s<0)for(let u=0;u<a;++u)l[u]=(i+u)/-s;else for(let u=0;u<a;++u)l[u]=(i+u)*s;return l}function Nb(e,t,n){return t=+t,e=+e,n=+n,Nm(e,t,n)[2]}function ma(e,t,n){t=+t,e=+e,n=+n;const r=t<e,i=r?Nb(t,e,n):Nb(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function Cl(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function Rb(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function BR(e,t,n=0,r=1/0,i){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(i=i===void 0?jR:KG(i);r>n;){if(r-n>600){const l=r-n+1,u=t-n+1,c=Math.log(l),f=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*f*(l-f)/l)*(u-l/2<0?-1:1),h=Math.max(n,Math.floor(t-u*f/l+d)),p=Math.min(r,Math.floor(t+(l-u)*f/l+d));BR(e,t,h,p,i)}const o=e[t];let s=n,a=r;for(Jf(e,n,t),i(e[r],o)>0&&Jf(e,n,r);s<a;){for(Jf(e,s,a),++s,--a;i(e[s],o)<0;)++s;for(;i(e[a],o)>0;)--a}i(e[n],o)===0?Jf(e,n,a):(++a,Jf(e,a,r)),a<=t&&(n=a+1),t<=a&&(r=a-1)}return e}function Jf(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function Db(e,t,n){if(e=Float64Array.from(VG(e,n)),!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return Rb(e);if(t>=1)return Cl(e);var r,i=(r-1)*t,o=Math.floor(i),s=Cl(BR(e,o).subarray(0,o+1)),a=Rb(e.subarray(o+1));return s+(a-s)*(i-o)}}function UR(e,t,n=OR){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,o=Math.floor(i),s=+n(e[o],o,e),a=+n(e[o+1],o+1,e);return s+(a-s)*(i-o)}}function tY(e,t){let n=0,r=0;if(t===void 0)for(let i of e)i!=null&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let o of e)(o=t(o,++i,e))!=null&&(o=+o)>=o&&(++n,r+=o)}if(n)return r/n}function WR(e,t){return Db(e,.5,t)}function*nY(e){for(const t of e)yield*t}function qR(e){return Array.from(nY(e))}function mr(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,o=new Array(i);++r<i;)o[r]=e+r*n;return o}function HR(e,t){let n=0;for(let r of e)(r=+r)&&(n+=r);return n}function rY(e,...t){e=new Tm(e),t=t.map(iY);e:for(const n of e)for(const r of t)if(!r.has(n)){e.delete(n);continue e}return e}function iY(e){return e instanceof Tm?e:new Tm(e)}function oY(...e){const t=new Tm;for(const n of e)for(const r of n)t.add(r);return t}function sY(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Rm(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function Tc(e){return e=Rm(Math.abs(e)),e?e[1]:NaN}function aY(e,t){return function(n,r){for(var i=n.length,o=[],s=0,a=e[0],l=0;i>0&&a>0&&(l+a+1>r&&(a=Math.max(1,r-l)),o.push(n.substring(i-=a,i+a)),!((l+=a+1)>r));)a=e[s=(s+1)%e.length];return o.reverse().join(t)}}function lY(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var uY=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function jl(e){if(!(t=uY.exec(e)))throw new Error("invalid format: "+e);var t;return new Q_({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}jl.prototype=Q_.prototype;function Q_(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Q_.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function cY(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var VR;function fY(e,t){var n=Rm(e,t);if(!n)return e+"";var r=n[0],i=n[1],o=i-(VR=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,s=r.length;return o===s?r:o>s?r+new Array(o-s+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+Rm(e,Math.max(0,t+o-1))[0]}function _4(e,t){var n=Rm(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const k4={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:sY,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>_4(e*100,t),r:_4,s:fY,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function C4(e){return e}var $4=Array.prototype.map,A4=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function GR(e){var t=e.grouping===void 0||e.thousands===void 0?C4:aY($4.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?C4:lY($4.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"−":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function u(f){f=jl(f);var d=f.fill,h=f.align,p=f.sign,g=f.symbol,y=f.zero,m=f.width,v=f.comma,x=f.precision,w=f.trim,b=f.type;b==="n"?(v=!0,b="g"):k4[b]||(x===void 0&&(x=12),w=!0,b="g"),(y||d==="0"&&h==="=")&&(y=!0,d="0",h="=");var S=g==="$"?n:g==="#"&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",E=g==="$"?r:/[%p]/.test(b)?s:"",_=k4[b],k=/[defgprs%]/.test(b);x=x===void 0?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,x)):Math.max(0,Math.min(20,x));function C($){var O=S,A=E,T,F,R;if(b==="c")A=_($)+A,$="";else{$=+$;var L=$<0||1/$<0;if($=isNaN($)?l:_(Math.abs($),x),w&&($=cY($)),L&&+$==0&&p!=="+"&&(L=!1),O=(L?p==="("?p:a:p==="-"||p==="("?"":p)+O,A=(b==="s"?A4[8+VR/3]:"")+A+(L&&p==="("?")":""),k){for(T=-1,F=$.length;++T<F;)if(R=$.charCodeAt(T),48>R||R>57){A=(R===46?i+$.slice(T+1):$.slice(T))+A,$=$.slice(0,T);break}}}v&&!y&&($=t($,1/0));var N=O.length+$.length+A.length,D=N<m?new Array(m-N+1).join(d):"";switch(v&&y&&($=t(D+$,D.length?m-A.length:1/0),D=""),h){case"<":$=O+$+A+D;break;case"=":$=O+D+$+A;break;case"^":$=D.slice(0,N=D.length>>1)+O+$+A+D.slice(N);break;default:$=D+O+$+A;break}return o($)}return C.toString=function(){return f+""},C}function c(f,d){var h=u((f=jl(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(Tc(d)/3)))*3,g=Math.pow(10,-p),y=A4[8+p/3];return function(m){return h(g*m)+y}}return{format:u,formatPrefix:c}}var Tg,Ay,K_;dY({thousands:",",grouping:[3],currency:["$",""]});function dY(e){return Tg=GR(e),Ay=Tg.format,K_=Tg.formatPrefix,Tg}function YR(e){return Math.max(0,-Tc(Math.abs(e)))}function XR(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Tc(t)/3)))*3-Tc(Math.abs(e)))}function QR(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Tc(t)-Tc(e))+1}const a2=new Date,l2=new Date;function Ct(e,t,n,r){function i(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return i.floor=o=>(e(o=new Date(+o)),o),i.ceil=o=>(e(o=new Date(o-1)),t(o,1),e(o),o),i.round=o=>{const s=i(o),a=i.ceil(o);return o-s<a-o?s:a},i.offset=(o,s)=>(t(o=new Date(+o),s==null?1:Math.floor(s)),o),i.range=(o,s,a)=>{const l=[];if(o=i.ceil(o),a=a==null?1:Math.floor(a),!(o<s)||!(a>0))return l;let u;do l.push(u=new Date(+o)),t(o,a),e(o);while(u<o&&o<s);return l},i.filter=o=>Ct(s=>{if(s>=s)for(;e(s),!o(s);)s.setTime(s-1)},(s,a)=>{if(s>=s)if(a<0)for(;++a<=0;)for(;t(s,-1),!o(s););else for(;--a>=0;)for(;t(s,1),!o(s););}),n&&(i.count=(o,s)=>(a2.setTime(+o),l2.setTime(+s),e(a2),e(l2),Math.floor(n(a2,l2))),i.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?i.filter(r?s=>r(s)%o===0:s=>i.count(0,s)%o===0):i)),i}const Nc=Ct(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Nc.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Ct(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):Nc);Nc.range;const Vo=1e3,Lr=Vo*60,Go=Lr*60,fs=Go*24,Z_=fs*7,F4=fs*30,u2=fs*365,Yo=Ct(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Vo)},(e,t)=>(t-e)/Vo,e=>e.getUTCSeconds());Yo.range;const Fy=Ct(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Vo)},(e,t)=>{e.setTime(+e+t*Lr)},(e,t)=>(t-e)/Lr,e=>e.getMinutes());Fy.range;const My=Ct(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Lr)},(e,t)=>(t-e)/Lr,e=>e.getUTCMinutes());My.range;const Ty=Ct(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Vo-e.getMinutes()*Lr)},(e,t)=>{e.setTime(+e+t*Go)},(e,t)=>(t-e)/Go,e=>e.getHours());Ty.range;const Ny=Ct(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Go)},(e,t)=>(t-e)/Go,e=>e.getUTCHours());Ny.range;const es=Ct(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Lr)/fs,e=>e.getDate()-1);es.range;const la=Ct(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/fs,e=>e.getUTCDate()-1);la.range;const KR=Ct(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/fs,e=>Math.floor(e/fs));KR.range;function uu(e){return Ct(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Lr)/Z_)}const Sf=uu(0),Dm=uu(1),hY=uu(2),pY=uu(3),Rc=uu(4),gY=uu(5),mY=uu(6);Sf.range;Dm.range;hY.range;pY.range;Rc.range;gY.range;mY.range;function cu(e){return Ct(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/Z_)}const _f=cu(0),Om=cu(1),yY=cu(2),vY=cu(3),Dc=cu(4),xY=cu(5),wY=cu(6);_f.range;Om.range;yY.range;vY.range;Dc.range;xY.range;wY.range;const Ih=Ct(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());Ih.range;const jh=Ct(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());jh.range;const fo=Ct(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());fo.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Ct(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});fo.range;const ho=Ct(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());ho.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Ct(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});ho.range;function ZR(e,t,n,r,i,o){const s=[[Yo,1,Vo],[Yo,5,5*Vo],[Yo,15,15*Vo],[Yo,30,30*Vo],[o,1,Lr],[o,5,5*Lr],[o,15,15*Lr],[o,30,30*Lr],[i,1,Go],[i,3,3*Go],[i,6,6*Go],[i,12,12*Go],[r,1,fs],[r,2,2*fs],[n,1,Z_],[t,1,F4],[t,3,3*F4],[e,1,u2]];function a(u,c,f){const d=c<u;d&&([u,c]=[c,u]);const h=f&&typeof f.range=="function"?f:l(u,c,f),p=h?h.range(u,+c+1):[];return d?p.reverse():p}function l(u,c,f){const d=Math.abs(c-u)/f,h=Ef(([,,y])=>y).right(s,d);if(h===s.length)return e.every(ma(u/u2,c/u2,f));if(h===0)return Nc.every(Math.max(ma(u,c,f),1));const[p,g]=s[d/s[h-1][2]<s[h][2]/d?h-1:h];return p.every(g)}return[a,l]}const[bY,EY]=ZR(ho,jh,_f,KR,Ny,My),[SY,_Y]=ZR(fo,Ih,Sf,es,Ty,Fy),Kt="year",tr="quarter",mn="month",St="week",nr="date",dn="day",po="dayofyear",Sr="hours",_r="minutes",Yr="seconds",Ci="milliseconds",J_=[Kt,tr,mn,St,nr,dn,po,Sr,_r,Yr,Ci],c2=J_.reduce((e,t,n)=>(e[t]=1+n,e),{});function ek(e){const t=J(e).slice(),n={};return t.length||I("Missing time unit."),t.forEach(i=>{te(c2,i)?n[i]=1:I(`Invalid time unit: ${i}.`)}),(n[St]||n[dn]?1:0)+(n[tr]||n[mn]||n[nr]?1:0)+(n[po]?1:0)>1&&I(`Incompatible time units: ${e}`),t.sort((i,o)=>c2[i]-c2[o]),t}const kY={[Kt]:"%Y ",[tr]:"Q%q ",[mn]:"%b ",[nr]:"%d ",[St]:"W%U ",[dn]:"%a ",[po]:"%j ",[Sr]:"%H:00",[_r]:"00:%M",[Yr]:":%S",[Ci]:".%L",[`${Kt}-${mn}`]:"%Y-%m ",[`${Kt}-${mn}-${nr}`]:"%Y-%m-%d ",[`${Sr}-${_r}`]:"%H:%M"};function JR(e,t){const n=ge({},kY,t),r=ek(e),i=r.length;let o="",s=0,a,l;for(s=0;s<i;)for(a=r.length;a>s;--a)if(l=r.slice(s,a).join("-"),n[l]!=null){o+=n[l],s=a;break}return o.trim()}const cl=new Date;function tk(e){return cl.setFullYear(e),cl.setMonth(0),cl.setDate(1),cl.setHours(0,0,0,0),cl}function eD(e){return nD(new Date(e))}function tD(e){return Ob(new Date(e))}function nD(e){return es.count(tk(e.getFullYear())-1,e)}function Ob(e){return Sf.count(tk(e.getFullYear())-1,e)}function Pb(e){return tk(e).getDay()}function CY(e,t,n,r,i,o,s){if(0<=e&&e<100){const a=new Date(-1,t,n,r,i,o,s);return a.setFullYear(e),a}return new Date(e,t,n,r,i,o,s)}function rD(e){return oD(new Date(e))}function iD(e){return Lb(new Date(e))}function oD(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return la.count(t-1,e)}function Lb(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return _f.count(t-1,e)}function zb(e){return cl.setTime(Date.UTC(e,0,1)),cl.getUTCDay()}function $Y(e,t,n,r,i,o,s){if(0<=e&&e<100){const a=new Date(Date.UTC(-1,t,n,r,i,o,s));return a.setUTCFullYear(n.y),a}return new Date(Date.UTC(e,t,n,r,i,o,s))}function sD(e,t,n,r,i){const o=t||1,s=Ce(e),a=(m,v,x)=>(x=x||m,AY(n[x],r[x],m===s&&o,v)),l=new Date,u=ki(e),c=u[Kt]?a(Kt):bn(2012),f=u[mn]?a(mn):u[tr]?a(tr):Bs,d=u[St]&&u[dn]?a(dn,1,St+dn):u[St]?a(St,1):u[dn]?a(dn,1):u[nr]?a(nr,1):u[po]?a(po,1):vf,h=u[Sr]?a(Sr):Bs,p=u[_r]?a(_r):Bs,g=u[Yr]?a(Yr):Bs,y=u[Ci]?a(Ci):Bs;return function(m){l.setTime(+m);const v=c(l);return i(v,f(l),d(l,v),h(l),p(l),g(l),y(l))}}function AY(e,t,n,r){const i=n<=1?e:r?(o,s)=>r+n*Math.floor((e(o,s)-r)/n):(o,s)=>n*Math.floor(e(o,s)/n);return t?(o,s)=>t(i(o,s),s):i}function Oc(e,t,n){return t+e*7-(n+6)%7}const FY={[Kt]:e=>e.getFullYear(),[tr]:e=>Math.floor(e.getMonth()/3),[mn]:e=>e.getMonth(),[nr]:e=>e.getDate(),[Sr]:e=>e.getHours(),[_r]:e=>e.getMinutes(),[Yr]:e=>e.getSeconds(),[Ci]:e=>e.getMilliseconds(),[po]:e=>nD(e),[St]:e=>Ob(e),[St+dn]:(e,t)=>Oc(Ob(e),e.getDay(),Pb(t)),[dn]:(e,t)=>Oc(1,e.getDay(),Pb(t))},MY={[tr]:e=>3*e,[St]:(e,t)=>Oc(e,0,Pb(t))};function aD(e,t){return sD(e,t||1,FY,MY,CY)}const TY={[Kt]:e=>e.getUTCFullYear(),[tr]:e=>Math.floor(e.getUTCMonth()/3),[mn]:e=>e.getUTCMonth(),[nr]:e=>e.getUTCDate(),[Sr]:e=>e.getUTCHours(),[_r]:e=>e.getUTCMinutes(),[Yr]:e=>e.getUTCSeconds(),[Ci]:e=>e.getUTCMilliseconds(),[po]:e=>oD(e),[St]:e=>Lb(e),[dn]:(e,t)=>Oc(1,e.getUTCDay(),zb(t)),[St+dn]:(e,t)=>Oc(Lb(e),e.getUTCDay(),zb(t))},NY={[tr]:e=>3*e,[St]:(e,t)=>Oc(e,0,zb(t))};function lD(e,t){return sD(e,t||1,TY,NY,$Y)}const RY={[Kt]:fo,[tr]:Ih.every(3),[mn]:Ih,[St]:Sf,[nr]:es,[dn]:es,[po]:es,[Sr]:Ty,[_r]:Fy,[Yr]:Yo,[Ci]:Nc},DY={[Kt]:ho,[tr]:jh.every(3),[mn]:jh,[St]:_f,[nr]:la,[dn]:la,[po]:la,[Sr]:Ny,[_r]:My,[Yr]:Yo,[Ci]:Nc};function kf(e){return RY[e]}function Cf(e){return DY[e]}function uD(e,t,n){return e?e.offset(t,n):void 0}function cD(e,t,n){return uD(kf(e),t,n)}function fD(e,t,n){return uD(Cf(e),t,n)}function dD(e,t,n,r){return e?e.range(t,n,r):void 0}function hD(e,t,n,r){return dD(kf(e),t,n,r)}function pD(e,t,n,r){return dD(Cf(e),t,n,r)}const Ad=1e3,Fd=Ad*60,Md=Fd*60,Ry=Md*24,OY=Ry*7,M4=Ry*30,Ib=Ry*365,gD=[Kt,mn,nr,Sr,_r,Yr,Ci],Td=gD.slice(0,-1),Nd=Td.slice(0,-1),Rd=Nd.slice(0,-1),PY=Rd.slice(0,-1),LY=[Kt,St],T4=[Kt,mn],mD=[Kt],ed=[[Td,1,Ad],[Td,5,5*Ad],[Td,15,15*Ad],[Td,30,30*Ad],[Nd,1,Fd],[Nd,5,5*Fd],[Nd,15,15*Fd],[Nd,30,30*Fd],[Rd,1,Md],[Rd,3,3*Md],[Rd,6,6*Md],[Rd,12,12*Md],[PY,1,Ry],[LY,1,OY],[T4,1,M4],[T4,3,3*M4],[mD,1,Ib]];function yD(e){const t=e.extent,n=e.maxbins||40,r=Math.abs(bp(t))/n;let i=Ef(a=>a[2]).right(ed,r),o,s;return i===ed.length?(o=mD,s=ma(t[0]/Ib,t[1]/Ib,n)):i?(i=ed[r/ed[i-1][2]<ed[i][2]/r?i-1:i],o=i[0],s=i[1]):(o=gD,s=Math.max(ma(t[0],t[1],n),1)),{units:o,step:s}}function f2(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function d2(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function td(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function vD(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,o=e.days,s=e.shortDays,a=e.months,l=e.shortMonths,u=nd(i),c=rd(i),f=nd(o),d=rd(o),h=nd(s),p=rd(s),g=nd(a),y=rd(a),m=nd(l),v=rd(l),x={a:L,A:N,b:D,B:U,c:null,d:L4,e:L4,f:sX,g:mX,G:vX,H:rX,I:iX,j:oX,L:xD,m:aX,M:lX,p:K,q:se,Q:j4,s:B4,S:uX,u:cX,U:fX,V:dX,w:hX,W:pX,x:null,X:null,y:gX,Y:yX,Z:xX,"%":I4},w={a:be,A:pe,b:Re,B:At,c:null,d:z4,e:z4,f:SX,g:RX,G:OX,H:wX,I:bX,j:EX,L:bD,m:_X,M:kX,p:Fr,q:Cs,Q:j4,s:B4,S:CX,u:$X,U:AX,V:FX,w:MX,W:TX,x:null,X:null,y:NX,Y:DX,Z:PX,"%":I4},b={a:C,A:$,b:O,B:A,c:T,d:O4,e:O4,f:JY,g:D4,G:R4,H:P4,I:P4,j:XY,L:ZY,m:YY,M:QY,p:k,q:GY,Q:tX,s:nX,S:KY,u:UY,U:WY,V:qY,w:BY,W:HY,x:F,X:R,y:D4,Y:R4,Z:VY,"%":eX};x.x=S(n,x),x.X=S(r,x),x.c=S(t,x),w.x=S(n,w),w.X=S(r,w),w.c=S(t,w);function S(ne,ye){return function(xe){var G=[],Ut=-1,Pe=0,nn=ne.length,Ft,ji,dg;for(xe instanceof Date||(xe=new Date(+xe));++Ut<nn;)ne.charCodeAt(Ut)===37&&(G.push(ne.slice(Pe,Ut)),(ji=N4[Ft=ne.charAt(++Ut)])!=null?Ft=ne.charAt(++Ut):ji=Ft==="e"?" ":"0",(dg=ye[Ft])&&(Ft=dg(xe,ji)),G.push(Ft),Pe=Ut+1);return G.push(ne.slice(Pe,Ut)),G.join("")}}function E(ne,ye){return function(xe){var G=td(1900,void 0,1),Ut=_(G,ne,xe+="",0),Pe,nn;if(Ut!=xe.length)return null;if("Q"in G)return new Date(G.Q);if("s"in G)return new Date(G.s*1e3+("L"in G?G.L:0));if(ye&&!("Z"in G)&&(G.Z=0),"p"in G&&(G.H=G.H%12+G.p*12),G.m===void 0&&(G.m="q"in G?G.q:0),"V"in G){if(G.V<1||G.V>53)return null;"w"in G||(G.w=1),"Z"in G?(Pe=d2(td(G.y,0,1)),nn=Pe.getUTCDay(),Pe=nn>4||nn===0?Om.ceil(Pe):Om(Pe),Pe=la.offset(Pe,(G.V-1)*7),G.y=Pe.getUTCFullYear(),G.m=Pe.getUTCMonth(),G.d=Pe.getUTCDate()+(G.w+6)%7):(Pe=f2(td(G.y,0,1)),nn=Pe.getDay(),Pe=nn>4||nn===0?Dm.ceil(Pe):Dm(Pe),Pe=es.offset(Pe,(G.V-1)*7),G.y=Pe.getFullYear(),G.m=Pe.getMonth(),G.d=Pe.getDate()+(G.w+6)%7)}else("W"in G||"U"in G)&&("w"in G||(G.w="u"in G?G.u%7:"W"in G?1:0),nn="Z"in G?d2(td(G.y,0,1)).getUTCDay():f2(td(G.y,0,1)).getDay(),G.m=0,G.d="W"in G?(G.w+6)%7+G.W*7-(nn+5)%7:G.w+G.U*7-(nn+6)%7);return"Z"in G?(G.H+=G.Z/100|0,G.M+=G.Z%100,d2(G)):f2(G)}}function _(ne,ye,xe,G){for(var Ut=0,Pe=ye.length,nn=xe.length,Ft,ji;Ut<Pe;){if(G>=nn)return-1;if(Ft=ye.charCodeAt(Ut++),Ft===37){if(Ft=ye.charAt(Ut++),ji=b[Ft in N4?ye.charAt(Ut++):Ft],!ji||(G=ji(ne,xe,G))<0)return-1}else if(Ft!=xe.charCodeAt(G++))return-1}return G}function k(ne,ye,xe){var G=u.exec(ye.slice(xe));return G?(ne.p=c.get(G[0].toLowerCase()),xe+G[0].length):-1}function C(ne,ye,xe){var G=h.exec(ye.slice(xe));return G?(ne.w=p.get(G[0].toLowerCase()),xe+G[0].length):-1}function $(ne,ye,xe){var G=f.exec(ye.slice(xe));return G?(ne.w=d.get(G[0].toLowerCase()),xe+G[0].length):-1}function O(ne,ye,xe){var G=m.exec(ye.slice(xe));return G?(ne.m=v.get(G[0].toLowerCase()),xe+G[0].length):-1}function A(ne,ye,xe){var G=g.exec(ye.slice(xe));return G?(ne.m=y.get(G[0].toLowerCase()),xe+G[0].length):-1}function T(ne,ye,xe){return _(ne,t,ye,xe)}function F(ne,ye,xe){return _(ne,n,ye,xe)}function R(ne,ye,xe){return _(ne,r,ye,xe)}function L(ne){return s[ne.getDay()]}function N(ne){return o[ne.getDay()]}function D(ne){return l[ne.getMonth()]}function U(ne){return a[ne.getMonth()]}function K(ne){return i[+(ne.getHours()>=12)]}function se(ne){return 1+~~(ne.getMonth()/3)}function be(ne){return s[ne.getUTCDay()]}function pe(ne){return o[ne.getUTCDay()]}function Re(ne){return l[ne.getUTCMonth()]}function At(ne){return a[ne.getUTCMonth()]}function Fr(ne){return i[+(ne.getUTCHours()>=12)]}function Cs(ne){return 1+~~(ne.getUTCMonth()/3)}return{format:function(ne){var ye=S(ne+="",x);return ye.toString=function(){return ne},ye},parse:function(ne){var ye=E(ne+="",!1);return ye.toString=function(){return ne},ye},utcFormat:function(ne){var ye=S(ne+="",w);return ye.toString=function(){return ne},ye},utcParse:function(ne){var ye=E(ne+="",!0);return ye.toString=function(){return ne},ye}}}var N4={"-":"",_:" ",0:"0"},jt=/^\s*\d+/,zY=/^%/,IY=/[\\^$*+?|[\]().{}]/g;function Te(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(t)+i:i)}function jY(e){return e.replace(IY,"\\$&")}function nd(e){return new RegExp("^(?:"+e.map(jY).join("|")+")","i")}function rd(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function BY(e,t,n){var r=jt.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function UY(e,t,n){var r=jt.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function WY(e,t,n){var r=jt.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function qY(e,t,n){var r=jt.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function HY(e,t,n){var r=jt.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function R4(e,t,n){var r=jt.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function D4(e,t,n){var r=jt.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function VY(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function GY(e,t,n){var r=jt.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function YY(e,t,n){var r=jt.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function O4(e,t,n){var r=jt.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function XY(e,t,n){var r=jt.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function P4(e,t,n){var r=jt.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function QY(e,t,n){var r=jt.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function KY(e,t,n){var r=jt.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function ZY(e,t,n){var r=jt.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function JY(e,t,n){var r=jt.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function eX(e,t,n){var r=zY.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function tX(e,t,n){var r=jt.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function nX(e,t,n){var r=jt.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function L4(e,t){return Te(e.getDate(),t,2)}function rX(e,t){return Te(e.getHours(),t,2)}function iX(e,t){return Te(e.getHours()%12||12,t,2)}function oX(e,t){return Te(1+es.count(fo(e),e),t,3)}function xD(e,t){return Te(e.getMilliseconds(),t,3)}function sX(e,t){return xD(e,t)+"000"}function aX(e,t){return Te(e.getMonth()+1,t,2)}function lX(e,t){return Te(e.getMinutes(),t,2)}function uX(e,t){return Te(e.getSeconds(),t,2)}function cX(e){var t=e.getDay();return t===0?7:t}function fX(e,t){return Te(Sf.count(fo(e)-1,e),t,2)}function wD(e){var t=e.getDay();return t>=4||t===0?Rc(e):Rc.ceil(e)}function dX(e,t){return e=wD(e),Te(Rc.count(fo(e),e)+(fo(e).getDay()===4),t,2)}function hX(e){return e.getDay()}function pX(e,t){return Te(Dm.count(fo(e)-1,e),t,2)}function gX(e,t){return Te(e.getFullYear()%100,t,2)}function mX(e,t){return e=wD(e),Te(e.getFullYear()%100,t,2)}function yX(e,t){return Te(e.getFullYear()%1e4,t,4)}function vX(e,t){var n=e.getDay();return e=n>=4||n===0?Rc(e):Rc.ceil(e),Te(e.getFullYear()%1e4,t,4)}function xX(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Te(t/60|0,"0",2)+Te(t%60,"0",2)}function z4(e,t){return Te(e.getUTCDate(),t,2)}function wX(e,t){return Te(e.getUTCHours(),t,2)}function bX(e,t){return Te(e.getUTCHours()%12||12,t,2)}function EX(e,t){return Te(1+la.count(ho(e),e),t,3)}function bD(e,t){return Te(e.getUTCMilliseconds(),t,3)}function SX(e,t){return bD(e,t)+"000"}function _X(e,t){return Te(e.getUTCMonth()+1,t,2)}function kX(e,t){return Te(e.getUTCMinutes(),t,2)}function CX(e,t){return Te(e.getUTCSeconds(),t,2)}function $X(e){var t=e.getUTCDay();return t===0?7:t}function AX(e,t){return Te(_f.count(ho(e)-1,e),t,2)}function ED(e){var t=e.getUTCDay();return t>=4||t===0?Dc(e):Dc.ceil(e)}function FX(e,t){return e=ED(e),Te(Dc.count(ho(e),e)+(ho(e).getUTCDay()===4),t,2)}function MX(e){return e.getUTCDay()}function TX(e,t){return Te(Om.count(ho(e)-1,e),t,2)}function NX(e,t){return Te(e.getUTCFullYear()%100,t,2)}function RX(e,t){return e=ED(e),Te(e.getUTCFullYear()%100,t,2)}function DX(e,t){return Te(e.getUTCFullYear()%1e4,t,4)}function OX(e,t){var n=e.getUTCDay();return e=n>=4||n===0?Dc(e):Dc.ceil(e),Te(e.getUTCFullYear()%1e4,t,4)}function PX(){return"+0000"}function I4(){return"%"}function j4(e){return+e}function B4(e){return Math.floor(+e/1e3)}var Au,nk,SD,rk,_D;LX({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function LX(e){return Au=vD(e),nk=Au.format,SD=Au.parse,rk=Au.utcFormat,_D=Au.utcParse,Au}function Dd(e){const t={};return n=>t[n]||(t[n]=e(n))}function zX(e,t){return n=>{const r=e(n),i=r.indexOf(t);if(i<0)return r;let o=IX(r,i);const s=o<r.length?r.slice(o):"";for(;--o>i;)if(r[o]!=="0"){++o;break}return r.slice(0,o)+s}}function IX(e,t){let n=e.lastIndexOf("e"),r;if(n>0)return n;for(n=e.length;--n>t;)if(r=e.charCodeAt(n),r>=48&&r<=57)return n+1}function kD(e){const t=Dd(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(r){const i=jl(r||",");if(i.precision==null){switch(i.precision=12,i.type){case"%":i.precision-=2;break;case"e":i.precision-=1;break}return zX(t(i),t(".1f")(1)[1])}else return t(i)},formatSpan(r,i,o,s){s=jl(s??",f");const a=ma(r,i,o),l=Math.max(Math.abs(r),Math.abs(i));let u;if(s.precision==null)switch(s.type){case"s":return isNaN(u=XR(a,l))||(s.precision=u),n(s,l);case"":case"e":case"g":case"p":case"r":{isNaN(u=QR(a,l))||(s.precision=u-(s.type==="e"));break}case"f":case"%":{isNaN(u=YR(a))||(s.precision=u-(s.type==="%")*2);break}}return t(s)}}}let jb;CD();function CD(){return jb=kD({format:Ay,formatPrefix:K_})}function $D(e){return kD(GR(e))}function Pm(e){return arguments.length?jb=$D(e):jb}function U4(e,t,n){n=n||{},Z(n)||I(`Invalid time multi-format specifier: ${n}`);const r=t(Yr),i=t(_r),o=t(Sr),s=t(nr),a=t(St),l=t(mn),u=t(tr),c=t(Kt),f=e(n[Ci]||".%L"),d=e(n[Yr]||":%S"),h=e(n[_r]||"%I:%M"),p=e(n[Sr]||"%I %p"),g=e(n[nr]||n[dn]||"%a %d"),y=e(n[St]||"%b %d"),m=e(n[mn]||"%B"),v=e(n[tr]||"%B"),x=e(n[Kt]||"%Y");return w=>(r(w)<w?f:i(w)<w?d:o(w)<w?h:s(w)<w?p:l(w)<w?a(w)<w?g:y:c(w)<w?u(w)<w?m:v:x)(w)}function AD(e){const t=Dd(e.format),n=Dd(e.utcFormat);return{timeFormat:r=>ee(r)?t(r):U4(t,kf,r),utcFormat:r=>ee(r)?n(r):U4(n,Cf,r),timeParse:Dd(e.parse),utcParse:Dd(e.utcParse)}}let Bb;FD();function FD(){return Bb=AD({format:nk,parse:SD,utcFormat:rk,utcParse:_D})}function MD(e){return AD(vD(e))}function Bh(e){return arguments.length?Bb=MD(e):Bb}const Ub=(e,t)=>ge({},e,t);function TD(e,t){const n=e?$D(e):Pm(),r=t?MD(t):Bh();return Ub(n,r)}function ik(e,t){const n=arguments.length;return n&&n!==2&&I("defaultLocale expects either zero or two arguments."),n?Ub(Pm(e),Bh(t)):Ub(Pm(),Bh())}function jX(){return CD(),FD(),ik()}const BX=/^(data:|([A-Za-z]+:)?\/\/)/,UX=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,WX=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,W4="file://";function qX(e,t){return n=>({options:n||{},sanitize:VX,load:HX,fileAccess:!!t,file:GX(t),http:XX(e)})}async function HX(e,t){const n=await this.sanitize(e,t),r=n.href;return n.localFile?this.file(r):this.http(r,t)}async function VX(e,t){t=ge({},this.options,t);const n=this.fileAccess,r={href:null};let i,o,s;const a=UX.test(e.replace(WX,""));(e==null||typeof e!="string"||!a)&&I("Sanitize failure, invalid URI: "+Y(e));const l=BX.test(e);return(s=t.baseURL)&&!l&&(!e.startsWith("/")&&!s.endsWith("/")&&(e="/"+e),e=s+e),o=(i=e.startsWith(W4))||t.mode==="file"||t.mode!=="http"&&!l&&n,i?e=e.slice(W4.length):e.startsWith("//")&&(t.defaultProtocol==="file"?(e=e.slice(2),o=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(r,"localFile",{value:!!o}),r.href=e,t.target&&(r.target=t.target+""),t.rel&&(r.rel=t.rel+""),t.context==="image"&&t.crossOrigin&&(r.crossOrigin=t.crossOrigin+""),r}function GX(e){return e?t=>new Promise((n,r)=>{e.readFile(t,(i,o)=>{i?r(i):n(o)})}):YX}async function YX(){I("No file system access.")}function XX(e){return e?async function(t,n){const r=ge({},this.options.http,n),i=n&&n.response,o=await e(t,r);return o.ok?me(o[i])?o[i]():o.text():I(o.status+""+o.statusText)}:QX}async function QX(){I("No HTTP fetch method available.")}const KX=e=>e!=null&&e===e,ZX=e=>e==="true"||e==="false"||e===!0||e===!1,JX=e=>!Number.isNaN(Date.parse(e)),ND=e=>!Number.isNaN(+e)&&!(e instanceof Date),eQ=e=>ND(e)&&Number.isInteger(+e),Wb={boolean:G_,integer:hn,number:hn,date:Y_,string:X_,unknown:wn},Ng=[ZX,eQ,ND,JX],tQ=["boolean","integer","number","date"];function RD(e,t){if(!e||!e.length)return"unknown";const n=e.length,r=Ng.length,i=Ng.map((o,s)=>s+1);for(let o=0,s=0,a,l;o<n;++o)for(l=t?e[o][t]:e[o],a=0;a<r;++a)if(i[a]&&KX(l)&&!Ng[a](l)&&(i[a]=0,++s,s===Ng.length))return"string";return tQ[i.reduce((o,s)=>o===0?s:o,0)-1]}function DD(e,t){return t.reduce((n,r)=>(n[r]=RD(e,r),n),{})}function q4(e){const t=function(n,r){const i={delimiter:e};return ok(n,r?ge(r,i):i)};return t.responseType="text",t}function ok(e,t){return t.header&&(e=t.header.map(Y).join(t.delimiter)+`
`+e),OG(t.delimiter).parse(e+"")}ok.responseType="text";function nQ(e){return typeof Buffer=="function"&&me(Buffer.isBuffer)?Buffer.isBuffer(e):!1}function sk(e,t){const n=t&&t.property?Vr(t.property):wn;return Z(e)&&!nQ(e)?rQ(n(e),t):n(JSON.parse(e))}sk.responseType="json";function rQ(e,t){return!j(e)&&CR(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}const iQ={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function OD(e,t){let n,r,i,o;return e=sk(e,t),t&&t.feature?(n=IG,i=t.feature):t&&t.mesh?(n=BG,i=t.mesh,o=iQ[t.filter]):I("Missing TopoJSON feature or mesh parameter."),r=(r=e.objects[i])?n(e,r,o):I("Invalid TopoJSON object: "+i),r&&r.features||[r]}OD.responseType="json";const T0={dsv:ok,csv:q4(","),tsv:q4("	"),json:sk,topojson:OD};function ak(e,t){return arguments.length>1?(T0[e]=t,this):te(T0,e)?T0[e]:null}function PD(e){const t=ak(e);return t&&t.responseType||"text"}function LD(e,t,n,r){t=t||{};const i=ak(t.type||"json");return i||I("Unknown data format type: "+t.type),e=i(e,t),t.parse&&oQ(e,t.parse,n,r),te(e,"columns")&&delete e.columns,e}function oQ(e,t,n,r){if(!e.length)return;const i=Bh();n=n||i.timeParse,r=r||i.utcParse;let o=e.columns||Object.keys(e[0]),s,a,l,u,c,f;t==="auto"&&(t=DD(e,o)),o=Object.keys(t);const d=o.map(h=>{const p=t[h];let g,y;if(p&&(p.startsWith("date:")||p.startsWith("utc:")))return g=p.split(/:(.+)?/,2),y=g[1],(y[0]==="'"&&y[y.length-1]==="'"||y[0]==='"'&&y[y.length-1]==='"')&&(y=y.slice(1,-1)),(g[0]==="utc"?r:n)(y);if(!Wb[p])throw Error("Illegal format pattern: "+h+":"+p);return Wb[p]});for(l=0,c=e.length,f=o.length;l<c;++l)for(s=e[l],u=0;u<f;++u)a=o[u],s[a]=d[u](s[a])}const Dy=qX(typeof fetch<"u"&&fetch,null);function Oy(e){const t=e||wn,n=[],r={};return n.add=i=>{const o=t(i);return r[o]||(r[o]=1,n.push(i)),n},n.remove=i=>{const o=t(i);if(r[o]){r[o]=0;const s=n.indexOf(i);s>=0&&n.splice(s,1)}return n},n}async function N0(e,t){try{await t(e)}catch(n){e.error(n)}}const zD=Symbol("vega_id");let sQ=1;function Py(e){return!!(e&&le(e))}function le(e){return e[zD]}function ID(e,t){return e[zD]=t,e}function De(e){const t=e===Object(e)?e:{data:e};return le(t)?t:ID(t,sQ++)}function lk(e){return Ly(e,De({}))}function Ly(e,t){for(const n in e)t[n]=e[n];return t}function jD(e,t){return ID(t,le(e))}function fu(e,t){return e?t?(n,r)=>e(n,r)||le(t(n))-le(t(r)):(n,r)=>e(n,r)||le(n)-le(r):null}function BD(e){return e&&e.constructor===du}function du(){const e=[],t=[],n=[],r=[],i=[];let o=null,s=!1;return{constructor:du,insert(a){const l=J(a),u=l.length;for(let c=0;c<u;++c)e.push(l[c]);return this},remove(a){const l=me(a)?r:t,u=J(a),c=u.length;for(let f=0;f<c;++f)l.push(u[f]);return this},modify(a,l,u){const c={field:l,value:bn(u)};return me(a)?(c.filter=a,i.push(c)):(c.tuple=a,n.push(c)),this},encode(a,l){return me(a)?i.push({filter:a,field:l}):n.push({tuple:a,field:l}),this},clean(a){return o=a,this},reflow(){return s=!0,this},pulse(a,l){const u={},c={};let f,d,h,p,g,y;for(f=0,d=l.length;f<d;++f)u[le(l[f])]=1;for(f=0,d=t.length;f<d;++f)g=t[f],u[le(g)]=-1;for(f=0,d=r.length;f<d;++f)p=r[f],l.forEach(v=>{p(v)&&(u[le(v)]=-1)});for(f=0,d=e.length;f<d;++f)g=e[f],y=le(g),u[y]?u[y]=1:a.add.push(De(e[f]));for(f=0,d=l.length;f<d;++f)g=l[f],u[le(g)]<0&&a.rem.push(g);function m(v,x,w){w?v[x]=w(v):a.encode=x,s||(c[le(v)]=v)}for(f=0,d=n.length;f<d;++f)h=n[f],g=h.tuple,p=h.field,y=u[le(g)],y>0&&(m(g,p,h.value),a.modifies(p));for(f=0,d=i.length;f<d;++f)h=i[f],p=h.filter,l.forEach(v=>{p(v)&&u[le(v)]>0&&m(v,h.field,h.value)}),a.modifies(h.field);if(s)a.mod=t.length||r.length?l.filter(v=>u[le(v)]>0):l.slice();else for(y in c)a.mod.push(c[y]);return(o||o==null&&(t.length||r.length))&&a.clean(!0),a}}}const R0="_:mod:_";function zy(){Object.defineProperty(this,R0,{writable:!0,value:{}})}zy.prototype={set(e,t,n,r){const i=this,o=i[e],s=i[R0];return t!=null&&t>=0?(o[t]!==n||r)&&(o[t]=n,s[t+":"+e]=-1,s[e]=-1):(o!==n||r)&&(i[e]=n,s[e]=j(n)?1+n.length:-1),i},modified(e,t){const n=this[R0];if(arguments.length){if(j(e)){for(let r=0;r<e.length;++r)if(n[e[r]])return!0;return!1}}else{for(const r in n)if(n[r])return!0;return!1}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear(){return this[R0]={},this}};let aQ=0;const lQ="pulse",uQ=new zy,cQ=1,fQ=2;function qe(e,t,n,r){this.id=++aQ,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,r)}function H4(e){return function(t){const n=this.flags;return arguments.length===0?!!(n&e):(this.flags=t?n|e:n&~e,this)}}qe.prototype={targets(){return this._targets||(this._targets=Oy(wp))},set(e){return this.value!==e?(this.value=e,1):0},skip:H4(cQ),modified:H4(fQ),parameters(e,t,n){t=t!==!1;const r=this._argval=this._argval||new zy,i=this._argops=this._argops||[],o=[];let s,a,l,u;const c=(f,d,h)=>{h instanceof qe?(h!==this&&(t&&h.targets().add(this),o.push(h)),i.push({op:h,name:f,index:d})):r.set(f,d,h)};for(s in e)if(a=e[s],s===lQ)J(a).forEach(f=>{f instanceof qe?f!==this&&(f.targets().add(this),o.push(f)):I("Pulse parameters must be operator instances.")}),this.source=a;else if(j(a))for(r.set(s,-1,Array(l=a.length)),u=0;u<l;++u)c(s,u,a[u]);else c(s,-1,a);return this.marshall().clear(),n&&(i.initonly=!0),o},marshall(e){const t=this._argval||uQ,n=this._argops;let r,i,o,s;if(n){const a=n.length;for(i=0;i<a;++i)r=n[i],o=r.op,s=o.modified()&&o.stamp===e,t.set(r.name,r.index,o.value,s);if(n.initonly){for(i=0;i<a;++i)r=n[i],r.op.targets().remove(this);this._argops=null,this._update=null}}return t},detach(){const e=this._argops;let t,n,r,i;if(e)for(t=0,n=e.length;t<n;++t)r=e[t],i=r.op,i._targets&&i._targets.remove(this);this.pulse=null,this.source=null},evaluate(e){const t=this._update;if(t){const n=this.marshall(e.stamp),r=t.call(this,n,e);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return e.StopPropagation}},run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e}};function dQ(e,t,n,r){let i=1,o;return e instanceof qe?o=e:e&&e.prototype instanceof qe?o=new e:me(e)?o=new qe(null,e):(i=0,o=new qe(e,t)),this.rank(o),i&&(r=n,n=t),n&&this.connect(o,o.parameters(n,r)),this.touch(o),o}function hQ(e,t){const n=e.rank,r=t.length;for(let i=0;i<r;++i)if(n<t[i].rank){this.rerank(e);return}}let pQ=0;function Iy(e,t,n){this.id=++pQ,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function Ms(e,t,n){return new Iy(e,t,n)}Iy.prototype={_filter:Gr,_apply:wn,targets(){return this._targets||(this._targets=Oy(wp))},consume(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive(e){if(this._filter(e)){const t=this.value=this._apply(e),n=this._targets,r=n?n.length:0;for(let i=0;i<r;++i)n[i].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter(e){const t=Ms(e);return this.targets().add(t),t},apply(e){const t=Ms(null,e);return this.targets().add(t),t},merge(){const e=Ms();this.targets().add(e);for(let t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle(e){let t=-1;return this.filter(()=>{const n=Date.now();return n-t>e?(t=n,1):0})},debounce(e){const t=Ms();return this.targets().add(Ms(null,null,H_(e,n=>{const r=n.dataflow;t.receive(n),r&&r.run&&r.run()}))),t},between(e,t){let n=!1;return e.targets().add(Ms(null,null,()=>n=!0)),t.targets().add(Ms(null,null,()=>n=!1)),this.filter(()=>n)},detach(){this._filter=Gr,this._targets=null}};function gQ(e,t,n,r){const i=this,o=Ms(n,r),s=function(u){u.dataflow=i;try{o.receive(u)}catch(c){i.error(c)}finally{i.run()}};let a;typeof e=="string"&&typeof document<"u"?a=document.querySelectorAll(e):a=J(e);const l=a.length;for(let u=0;u<l;++u)a[u].addEventListener(t,s);return o}function mQ(e,t){const n=this.locale();return LD(e,t,n.timeParse,n.utcParse)}function yQ(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))}async function vQ(e,t){const n=this;let r=0,i;try{i=await n.loader().load(e,{context:"dataflow",response:PD(t&&t.type)});try{i=n.parse(i,t)}catch(o){r=-2,n.warn("Data ingestion failed",e,o)}}catch(o){r=-1,n.warn("Loading failed",e,o)}return{data:i,status:r}}async function xQ(e,t,n){const r=this,i=r._pending||wQ(r);i.requests+=1;const o=await r.request(t,n);return r.pulse(e,r.changeset().remove(Gr).insert(o.data||[])),i.done(),o}function wQ(e){let t;const n=new Promise(r=>t=r);return n.requests=0,n.done=()=>{--n.requests===0&&(e._pending=null,t(e))},e._pending=n}const bQ={skip:!0};function EQ(e,t,n,r,i){return(e instanceof qe?_Q:SQ)(this,e,t,n,r,i),this}function SQ(e,t,n,r,i,o){const s=ge({},o,bQ);let a,l;me(n)||(n=bn(n)),r===void 0?a=u=>e.touch(n(u)):me(r)?(l=new qe(null,r,i,!1),a=u=>{l.evaluate(u);const c=n(u),f=l.value;BD(f)?e.pulse(c,f,o):e.update(c,f,s)}):a=u=>e.update(n(u),r,s),t.apply(a)}function _Q(e,t,n,r,i,o){if(r===void 0)t.targets().add(n);else{const s=o||{},a=new qe(null,kQ(n,r),i,!1);a.modified(s.force),a.rank=t.rank,t.targets().add(a),n&&(a.skip(!0),a.value=n.value,a.targets().add(n),e.connect(n,[a]))}}function kQ(e,t){return t=me(t)?t:bn(t),e?function(n,r){const i=t(n,r);return e.skip()||(e.skip(i!==this.value).value=i),i}:t}function CQ(e){e.rank=++this._rank}function $Q(e){const t=[e];let n,r,i;for(;t.length;)if(this.rank(n=t.pop()),r=n._targets)for(i=r.length;--i>=0;)t.push(n=r[i]),n===e&&I("Cycle detected in dataflow graph.")}const Lm={},Gi=1,Os=2,zo=4,AQ=Gi|Os,V4=Gi|zo,Fu=Gi|Os|zo,G4=8,id=16,Y4=32,X4=64;function ua(e,t,n){this.dataflow=e,this.stamp=t??-1,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function h2(e,t){const n=[];return Ds(e,t,r=>n.push(r)),n}function Q4(e,t){const n={};return e.visit(t,r=>{n[le(r)]=1}),r=>n[le(r)]?null:r}function Rg(e,t){return e?(n,r)=>e(n,r)&&t(n,r):t}ua.prototype={StopPropagation:Lm,ADD:Gi,REM:Os,MOD:zo,ADD_REM:AQ,ADD_MOD:V4,ALL:Fu,REFLOW:G4,SOURCE:id,NO_SOURCE:Y4,NO_FIELDS:X4,fork(e){return new ua(this.dataflow).init(this,e)},clone(){const e=this.fork(Fu);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(Fu|id)},addAll(){let e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||(e=new ua(this.dataflow).init(this),e.add=e.source,e.rem=[]),e},init(e,t){const n=this;return n.stamp=e.stamp,n.encode=e.encode,e.fields&&!(t&X4)&&(n.fields=e.fields),t&Gi?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),t&Os?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),t&zo?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),t&Y4?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter(e){this.dataflow.runAfter(e)},changed(e){const t=e||Fu;return t&Gi&&this.add.length||t&Os&&this.rem.length||t&zo&&this.mod.length},reflow(e){if(e)return this.fork(Fu).reflow();const t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(zo,Q4(this,Gi))),this},clean(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies(e){const t=this.fields||(this.fields={});return j(e)?e.forEach(n=>t[n]=!0):t[e]=!0,this},modified(e,t){const n=this.fields;return(t||this.mod.length)&&n?arguments.length?j(e)?e.some(r=>n[r]):n[e]:!!n:!1},filter(e,t){const n=this;return e&Gi&&(n.addF=Rg(n.addF,t)),e&Os&&(n.remF=Rg(n.remF,t)),e&zo&&(n.modF=Rg(n.modF,t)),e&id&&(n.srcF=Rg(n.srcF,t)),n},materialize(e){e=e||Fu;const t=this;return e&Gi&&t.addF&&(t.add=h2(t.add,t.addF),t.addF=null),e&Os&&t.remF&&(t.rem=h2(t.rem,t.remF),t.remF=null),e&zo&&t.modF&&(t.mod=h2(t.mod,t.modF),t.modF=null),e&id&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit(e,t){const n=this,r=t;if(e&id)return Ds(n.source,n.srcF,r),n;e&Gi&&Ds(n.add,n.addF,r),e&Os&&Ds(n.rem,n.remF,r),e&zo&&Ds(n.mod,n.modF,r);const i=n.source;if(e&G4&&i){const o=n.add.length+n.mod.length;o===i.length||(o?Ds(i,Q4(n,V4),r):Ds(i,n.srcF,r))}return n}};function uk(e,t,n,r){const i=this;let o=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=r||null,this.pulses=n;for(const s of n)if(s.stamp===t){if(s.fields){const a=i.fields||(i.fields={});for(const l in s.fields)a[l]=1}s.changed(i.ADD)&&(o|=i.ADD),s.changed(i.REM)&&(o|=i.REM),s.changed(i.MOD)&&(o|=i.MOD)}this.changes=o}X(uk,ua,{fork(e){const t=new ua(this.dataflow).init(this,e&this.NO_FIELDS);return e!==void 0&&(e&t.ADD&&this.visit(t.ADD,n=>t.add.push(n)),e&t.REM&&this.visit(t.REM,n=>t.rem.push(n)),e&t.MOD&&this.visit(t.MOD,n=>t.mod.push(n))),t},changed(e){return this.changes&e},modified(e){const t=this,n=t.fields;return n&&t.changes&t.MOD?j(e)?e.some(r=>n[r]):n[e]:0},filter(){I("MultiPulse does not support filtering.")},materialize(){I("MultiPulse does not support materialization.")},visit(e,t){const n=this,r=n.pulses,i=r.length;let o=0;if(e&n.SOURCE)for(;o<i;++o)r[o].visit(e,t);else for(;o<i;++o)r[o].stamp===n.stamp&&r[o].visit(e,t);return n}});async function FQ(e,t,n){const r=this,i=[];if(r._pulse)return UD(r);if(r._pending&&await r._pending,t&&await N0(r,t),!r._touched.length)return r.debug("Dataflow invoked, but nothing to do."),r;const o=++r._clock;r._pulse=new ua(r,o,e),r._touched.forEach(c=>r._enqueue(c,!0)),r._touched=Oy(wp);let s=0,a,l,u;try{for(;r._heap.size()>0;){if(a=r._heap.pop(),a.rank!==a.qrank){r._enqueue(a,!0);continue}l=a.run(r._getPulse(a,e)),l.then?l=await l:l.async&&(i.push(l.async),l=Lm),l!==Lm&&a._targets&&a._targets.forEach(c=>r._enqueue(c)),++s}}catch(c){r._heap.clear(),u=c}if(r._input={},r._pulse=null,r.debug(`Pulse ${o}: ${s} operators`),u&&(r._postrun=[],r.error(u)),r._postrun.length){const c=r._postrun.sort((f,d)=>d.priority-f.priority);r._postrun=[];for(let f=0;f<c.length;++f)await N0(r,c[f].callback)}return n&&await N0(r,n),i.length&&Promise.all(i).then(c=>r.runAsync(null,()=>{c.forEach(f=>{try{f(r)}catch(d){r.error(d)}})})),r}async function MQ(e,t,n){for(;this._running;)await this._running;const r=()=>this._running=null;return(this._running=this.evaluate(e,t,n)).then(r,r),this._running}function TQ(e,t,n){return this._pulse?UD(this):(this.evaluate(e,t,n),this)}function NQ(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(r){this.error(r)}}function UD(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}function RQ(e,t){const n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))}function DQ(e,t){const n=e.source,r=this._clock;return n&&j(n)?new uk(this,r,n.map(i=>i.pulse),t):this._input[e.id]||OQ(this._pulse,n&&n.pulse)}function OQ(e,t){return t&&t.stamp===e.stamp?t:(e=e.fork(),t&&t!==Lm&&(e.source=t.source),e)}const ck={skip:!1,force:!1};function PQ(e,t){const n=t||ck;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this}function LQ(e,t,n){const r=n||ck;return(e.set(t)||r.force)&&this.touch(e,r),this}function zQ(e,t,n){this.touch(e,n||ck);const r=new ua(this,this._clock+(this._pulse?0:1)),i=e.pulse&&e.pulse.source||[];return r.target=e,this._input[e.id]=t.pulse(r,i),this}function IQ(e){let t=[];return{clear:()=>t=[],size:()=>t.length,peek:()=>t[0],push:n=>(t.push(n),WD(t,0,t.length-1,e)),pop:()=>{const n=t.pop();let r;return t.length?(r=t[0],t[0]=n,jQ(t,0,e)):r=n,r}}}function WD(e,t,n,r){let i,o;const s=e[n];for(;n>t;){if(o=n-1>>1,i=e[o],r(s,i)<0){e[n]=i,n=o;continue}break}return e[n]=s}function jQ(e,t,n){const r=t,i=e.length,o=e[t];let s=(t<<1)+1,a;for(;s<i;)a=s+1,a<i&&n(e[s],e[a])>=0&&(s=a),e[t]=e[s],t=s,s=(t<<1)+1;return e[t]=o,WD(e,r,t,n)}function pc(){this.logger(j_()),this.logLevel(z_),this._clock=0,this._rank=0,this._locale=ik();try{this._loader=Dy()}catch{}this._touched=Oy(wp),this._input={},this._pulse=null,this._heap=IQ((e,t)=>e.qrank-t.qrank),this._postrun=[]}function od(e){return function(){return this._log[e].apply(this,arguments)}}pc.prototype={stamp(){return this._clock},loader(e){return arguments.length?(this._loader=e,this):this._loader},locale(e){return arguments.length?(this._locale=e,this):this._locale},logger(e){return arguments.length?(this._log=e,this):this._log},error:od("error"),warn:od("warn"),info:od("info"),debug:od("debug"),logLevel:od("level"),cleanThreshold:1e4,add:dQ,connect:hQ,rank:CQ,rerank:$Q,pulse:zQ,touch:PQ,update:LQ,changeset:du,ingest:yQ,parse:mQ,preload:xQ,request:vQ,events:gQ,on:EQ,evaluate:FQ,run:TQ,runAsync:MQ,runAfter:NQ,_enqueue:RQ,_getPulse:DQ};function P(e,t){qe.call(this,e,null,t)}X(P,qe,{run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t.then?t=t.then(n=>this.pulse=n):t!==e.StopPropagation&&(this.pulse=t),t},evaluate(e){const t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform(){}});const Pc={};function qD(e){const t=HD(e);return t&&t.Definition||null}function HD(e){return e=e&&e.toLowerCase(),te(Pc,e)?Pc[e]:null}function*VD(e,t){if(t==null)for(let n of e)n!=null&&n!==""&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)r=t(r,++n,e),r!=null&&r!==""&&(r=+r)>=r&&(yield r)}}function fk(e,t,n){const r=Float64Array.from(VD(e,n));return r.sort(Jo),t.map(i=>UR(r,i))}function dk(e,t){return fk(e,[.25,.5,.75],t)}function hk(e,t){const n=e.length,r=XG(e,t),i=dk(e,t),o=(i[2]-i[0])/1.34;return 1.06*(Math.min(r,o)||r||Math.abs(i[0])||1)*Math.pow(n,-.2)}function GD(e){const t=e.maxbins||20,n=e.base||10,r=Math.log(n),i=e.divide||[5,2];let o=e.extent[0],s=e.extent[1],a,l,u,c,f,d;const h=e.span||s-o||Math.abs(o)||1;if(e.step)a=e.step;else if(e.steps){for(c=h/t,f=0,d=e.steps.length;f<d&&e.steps[f]<c;++f);a=e.steps[Math.max(0,f-1)]}else{for(l=Math.ceil(Math.log(t)/r),u=e.minstep||0,a=Math.max(u,Math.pow(n,Math.round(Math.log(h)/r)-l));Math.ceil(h/a)>t;)a*=n;for(f=0,d=i.length;f<d;++f)c=a/i[f],c>=u&&h/c<=t&&(a=c)}c=Math.log(a);const p=c>=0?0:~~(-c/r)+1,g=Math.pow(n,-p-1);return(e.nice||e.nice===void 0)&&(c=Math.floor(o/a+g)*a,o=o<c?c-a:c,s=Math.ceil(s/a)*a),{start:o,stop:s===o?o+a:s,step:a}}var Xr=Math.random;function BQ(e){Xr=e}function YD(e,t,n,r){if(!e.length)return[void 0,void 0];const i=Float64Array.from(VD(e,r)),o=i.length,s=t;let a,l,u,c;for(u=0,c=Array(s);u<s;++u){for(a=0,l=0;l<o;++l)a+=i[~~(Xr()*o)];c[u]=a/o}return c.sort(Jo),[Db(c,n/2),Db(c,1-n/2)]}function XD(e,t,n,r){r=r||(d=>d);const i=e.length,o=new Float64Array(i);let s=0,a=1,l=r(e[0]),u=l,c=l+t,f;for(;a<i;++a){if(f=r(e[a]),f>=c){for(u=(l+u)/2;s<a;++s)o[s]=u;c=f+t,l=f}u=f}for(u=(l+u)/2;s<a;++s)o[s]=u;return n?UQ(o,t+t/4):o}function UQ(e,t){const n=e.length;let r=0,i=1,o,s;for(;e[r]===e[i];)++i;for(;i<n;){for(o=i+1;e[i]===e[o];)++o;if(e[i]-e[i-1]<t){for(s=i+(r+o-i-i>>1);s<i;)e[s++]=e[i];for(;s>i;)e[s--]=e[r]}r=i,i=o}return e}function WQ(e){return function(){return e=(1103515245*e+12345)%2147483647,e/2147483647}}function qQ(e,t){t==null&&(t=e,e=0);let n,r,i;const o={min(s){return arguments.length?(n=s||0,i=r-n,o):n},max(s){return arguments.length?(r=s||0,i=r-n,o):r},sample(){return n+Math.floor(i*Xr())},pdf(s){return s===Math.floor(s)&&s>=n&&s<r?1/i:0},cdf(s){const a=Math.floor(s);return a<n?0:a>=r?1:(a-n+1)/i},icdf(s){return s>=0&&s<=1?n-1+Math.floor(s*i):NaN}};return o.min(e).max(t)}const QD=Math.sqrt(2*Math.PI),HQ=Math.SQRT2;let sd=NaN;function jy(e,t){e=e||0,t=t??1;let n=0,r=0,i,o;if(sd===sd)n=sd,sd=NaN;else{do n=Xr()*2-1,r=Xr()*2-1,i=n*n+r*r;while(i===0||i>1);o=Math.sqrt(-2*Math.log(i)/i),n*=o,sd=r*o}return e+n*t}function pk(e,t,n){n=n??1;const r=(e-(t||0))/n;return Math.exp(-.5*r*r)/(n*QD)}function By(e,t,n){t=t||0,n=n??1;const r=(e-t)/n,i=Math.abs(r);let o;if(i>37)o=0;else{const s=Math.exp(-i*i/2);let a;i<7.07106781186547?(a=.0352624965998911*i+.700383064443688,a=a*i+6.37396220353165,a=a*i+33.912866078383,a=a*i+112.079291497871,a=a*i+221.213596169931,a=a*i+220.206867912376,o=s*a,a=.0883883476483184*i+1.75566716318264,a=a*i+16.064177579207,a=a*i+86.7807322029461,a=a*i+296.564248779674,a=a*i+637.333633378831,a=a*i+793.826512519948,a=a*i+440.413735824752,o=o/a):(a=i+.65,a=i+4/a,a=i+3/a,a=i+2/a,a=i+1/a,o=s/a/2.506628274631)}return r>0?1-o:o}function Uy(e,t,n){return e<0||e>1?NaN:(t||0)+(n??1)*HQ*VQ(2*e-1)}function VQ(e){let t=-Math.log((1-e)*(1+e)),n;return t<6.25?(t-=3.125,n=-364441206401782e-35,n=-16850591381820166e-35+n*t,n=128584807152564e-32+n*t,n=11157877678025181e-33+n*t,n=-1333171662854621e-31+n*t,n=20972767875968562e-33+n*t,n=6637638134358324e-30+n*t,n=-4054566272975207e-29+n*t,n=-8151934197605472e-29+n*t,n=26335093153082323e-28+n*t,n=-12975133253453532e-27+n*t,n=-5415412054294628e-26+n*t,n=10512122733215323e-25+n*t,n=-4112633980346984e-24+n*t,n=-29070369957882005e-24+n*t,n=42347877827932404e-23+n*t,n=-13654692000834679e-22+n*t,n=-13882523362786469e-21+n*t,n=.00018673420803405714+n*t,n=-.000740702534166267+n*t,n=-.006033670871430149+n*t,n=.24015818242558962+n*t,n=1.6536545626831027+n*t):t<16?(t=Math.sqrt(t)-3.25,n=22137376921775787e-25,n=9075656193888539e-23+n*t,n=-27517406297064545e-23+n*t,n=18239629214389228e-24+n*t,n=15027403968909828e-22+n*t,n=-4013867526981546e-21+n*t,n=29234449089955446e-22+n*t,n=12475304481671779e-21+n*t,n=-47318229009055734e-21+n*t,n=6828485145957318e-20+n*t,n=24031110387097894e-21+n*t,n=-.0003550375203628475+n*t,n=.0009532893797373805+n*t,n=-.0016882755560235047+n*t,n=.002491442096107851+n*t,n=-.003751208507569241+n*t,n=.005370914553590064+n*t,n=1.0052589676941592+n*t,n=3.0838856104922208+n*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,n=-27109920616438573e-27,n=-2555641816996525e-25+n*t,n=15076572693500548e-25+n*t,n=-3789465440126737e-24+n*t,n=761570120807834e-23+n*t,n=-1496002662714924e-23+n*t,n=2914795345090108e-23+n*t,n=-6771199775845234e-23+n*t,n=22900482228026655e-23+n*t,n=-99298272942317e-20+n*t,n=4526062597223154e-21+n*t,n=-1968177810553167e-20+n*t,n=7599527703001776e-20+n*t,n=-.00021503011930044477+n*t,n=-.00013871931833623122+n*t,n=1.0103004648645344+n*t,n=4.849906401408584+n*t):n=1/0,n*e}function gk(e,t){let n,r;const i={mean(o){return arguments.length?(n=o||0,i):n},stdev(o){return arguments.length?(r=o??1,i):r},sample:()=>jy(n,r),pdf:o=>pk(o,n,r),cdf:o=>By(o,n,r),icdf:o=>Uy(o,n,r)};return i.mean(e).stdev(t)}function mk(e,t){const n=gk();let r=0;const i={data(o){return arguments.length?(e=o,r=o?o.length:0,i.bandwidth(t)):e},bandwidth(o){return arguments.length?(t=o,!t&&e&&(t=hk(e)),i):t},sample(){return e[~~(Xr()*r)]+t*n.sample()},pdf(o){let s=0,a=0;for(;a<r;++a)s+=n.pdf((o-e[a])/t);return s/t/r},cdf(o){let s=0,a=0;for(;a<r;++a)s+=n.cdf((o-e[a])/t);return s/r},icdf(){throw Error("KDE icdf not supported.")}};return i.data(e)}function yk(e,t){return e=e||0,t=t??1,Math.exp(e+jy()*t)}function vk(e,t,n){if(e<=0)return 0;t=t||0,n=n??1;const r=(Math.log(e)-t)/n;return Math.exp(-.5*r*r)/(n*QD*e)}function xk(e,t,n){return By(Math.log(e),t,n)}function wk(e,t,n){return Math.exp(Uy(e,t,n))}function KD(e,t){let n,r;const i={mean(o){return arguments.length?(n=o||0,i):n},stdev(o){return arguments.length?(r=o??1,i):r},sample:()=>yk(n,r),pdf:o=>vk(o,n,r),cdf:o=>xk(o,n,r),icdf:o=>wk(o,n,r)};return i.mean(e).stdev(t)}function ZD(e,t){let n=0,r;function i(s){const a=[];let l=0,u;for(u=0;u<n;++u)l+=a[u]=s[u]==null?1:+s[u];for(u=0;u<n;++u)a[u]/=l;return a}const o={weights(s){return arguments.length?(r=i(t=s||[]),o):t},distributions(s){return arguments.length?(s?(n=s.length,e=s):(n=0,e=[]),o.weights(t)):e},sample(){const s=Xr();let a=e[n-1],l=r[0],u=0;for(;u<n-1;l+=r[++u])if(s<l){a=e[u];break}return a.sample()},pdf(s){let a=0,l=0;for(;l<n;++l)a+=r[l]*e[l].pdf(s);return a},cdf(s){let a=0,l=0;for(;l<n;++l)a+=r[l]*e[l].cdf(s);return a},icdf(){throw Error("Mixture icdf not supported.")}};return o.distributions(e).weights(t)}function bk(e,t){return t==null&&(t=e??1,e=0),e+(t-e)*Xr()}function Ek(e,t,n){return n==null&&(n=t??1,t=0),e>=t&&e<=n?1/(n-t):0}function Sk(e,t,n){return n==null&&(n=t??1,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function _k(e,t,n){return n==null&&(n=t??1,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function JD(e,t){let n,r;const i={min(o){return arguments.length?(n=o||0,i):n},max(o){return arguments.length?(r=o??1,i):r},sample:()=>bk(n,r),pdf:o=>Ek(o,n,r),cdf:o=>Sk(o,n,r),icdf:o=>_k(o,n,r)};return t==null&&(t=e??1,e=0),i.min(e).max(t)}function kk(e,t,n){let r=0,i=0;for(const o of e){const s=n(o);t(o)==null||s==null||isNaN(s)||(r+=(s-r)/++i)}return{coef:[r],predict:()=>r,rSquared:0}}function Ep(e,t,n,r){const i=r-e*e,o=Math.abs(i)<1e-24?0:(n-e*t)/i;return[t-o*e,o]}function Wy(e,t,n,r){e=e.filter(h=>{let p=t(h),g=n(h);return p!=null&&(p=+p)>=p&&g!=null&&(g=+g)>=g}),r&&e.sort((h,p)=>t(h)-t(p));const i=e.length,o=new Float64Array(i),s=new Float64Array(i);let a=0,l=0,u=0,c,f,d;for(d of e)o[a]=c=+t(d),s[a]=f=+n(d),++a,l+=(c-l)/a,u+=(f-u)/a;for(a=0;a<i;++a)o[a]-=l,s[a]-=u;return[o,s,l,u]}function Sp(e,t,n,r){let i=-1,o,s;for(const a of e)o=t(a),s=n(a),o!=null&&(o=+o)>=o&&s!=null&&(s=+s)>=s&&r(o,s,++i)}function $f(e,t,n,r,i){let o=0,s=0;return Sp(e,t,n,(a,l)=>{const u=l-i(a),c=l-r;o+=u*u,s+=c*c}),1-o/s}function Ck(e,t,n){let r=0,i=0,o=0,s=0,a=0;Sp(e,t,n,(c,f)=>{++a,r+=(c-r)/a,i+=(f-i)/a,o+=(c*f-o)/a,s+=(c*c-s)/a});const l=Ep(r,i,o,s),u=c=>l[0]+l[1]*c;return{coef:l,predict:u,rSquared:$f(e,t,n,i,u)}}function e9(e,t,n){let r=0,i=0,o=0,s=0,a=0;Sp(e,t,n,(c,f)=>{++a,c=Math.log(c),r+=(c-r)/a,i+=(f-i)/a,o+=(c*f-o)/a,s+=(c*c-s)/a});const l=Ep(r,i,o,s),u=c=>l[0]+l[1]*Math.log(c);return{coef:l,predict:u,rSquared:$f(e,t,n,i,u)}}function t9(e,t,n){const[r,i,o,s]=Wy(e,t,n);let a=0,l=0,u=0,c=0,f=0,d,h,p;Sp(e,t,n,(v,x)=>{d=r[f++],h=Math.log(x),p=d*x,a+=(x*h-a)/f,l+=(p-l)/f,u+=(p*h-u)/f,c+=(d*p-c)/f});const[g,y]=Ep(l/s,a/s,u/s,c/s),m=v=>Math.exp(g+y*(v-o));return{coef:[Math.exp(g-y*o),y],predict:m,rSquared:$f(e,t,n,s,m)}}function n9(e,t,n){let r=0,i=0,o=0,s=0,a=0,l=0;Sp(e,t,n,(f,d)=>{const h=Math.log(f),p=Math.log(d);++l,r+=(h-r)/l,i+=(p-i)/l,o+=(h*p-o)/l,s+=(h*h-s)/l,a+=(d-a)/l});const u=Ep(r,i,o,s),c=f=>u[0]*Math.pow(f,u[1]);return u[0]=Math.exp(u[0]),{coef:u,predict:c,rSquared:$f(e,t,n,a,c)}}function $k(e,t,n){const[r,i,o,s]=Wy(e,t,n),a=r.length;let l=0,u=0,c=0,f=0,d=0,h,p,g,y;for(h=0;h<a;)p=r[h],g=i[h++],y=p*p,l+=(y-l)/h,u+=(y*p-u)/h,c+=(y*y-c)/h,f+=(p*g-f)/h,d+=(y*g-d)/h;const m=c-l*l,v=l*m-u*u,x=(d*l-f*u)/v,w=(f*m-d*u)/v,b=-x*l,S=E=>(E=E-o,x*E*E+w*E+b+s);return{coef:[b-w*o+x*o*o+s,w-2*x*o,x],predict:S,rSquared:$f(e,t,n,s,S)}}function r9(e,t,n,r){if(r===0)return kk(e,t,n);if(r===1)return Ck(e,t,n);if(r===2)return $k(e,t,n);const[i,o,s,a]=Wy(e,t,n),l=i.length,u=[],c=[],f=r+1;let d,h,p,g,y;for(d=0;d<f;++d){for(p=0,g=0;p<l;++p)g+=Math.pow(i[p],d)*o[p];for(u.push(g),y=new Float64Array(f),h=0;h<f;++h){for(p=0,g=0;p<l;++p)g+=Math.pow(i[p],d+h);y[h]=g}c.push(y)}c.push(u);const m=YQ(c),v=x=>{x-=s;let w=a+m[0]+m[1]*x+m[2]*x*x;for(d=3;d<f;++d)w+=m[d]*Math.pow(x,d);return w};return{coef:GQ(f,m,-s,a),predict:v,rSquared:$f(e,t,n,a,v)}}function GQ(e,t,n,r){const i=Array(e);let o,s,a,l;for(o=0;o<e;++o)i[o]=0;for(o=e-1;o>=0;--o)for(a=t[o],l=1,i[o]+=a,s=1;s<=o;++s)l*=(o+1-s)/s,i[o-s]+=a*Math.pow(n,s)*l;return i[0]+=r,i}function YQ(e){const t=e.length-1,n=[];let r,i,o,s,a;for(r=0;r<t;++r){for(s=r,i=r+1;i<t;++i)Math.abs(e[r][i])>Math.abs(e[r][s])&&(s=i);for(o=r;o<t+1;++o)a=e[o][r],e[o][r]=e[o][s],e[o][s]=a;for(i=r+1;i<t;++i)for(o=t;o>=r;o--)e[o][i]-=e[o][r]*e[r][i]/e[r][r]}for(i=t-1;i>=0;--i){for(a=0,o=i+1;o<t;++o)a+=e[o][i]*n[o];n[i]=(e[t][i]-a)/e[i][i]}return n}const K4=2,Z4=1e-12;function i9(e,t,n,r){const[i,o,s,a]=Wy(e,t,n,!0),l=i.length,u=Math.max(2,~~(r*l)),c=new Float64Array(l),f=new Float64Array(l),d=new Float64Array(l).fill(1);for(let h=-1;++h<=K4;){const p=[0,u-1];for(let y=0;y<l;++y){const m=i[y],v=p[0],x=p[1],w=m-i[v]>i[x]-m?v:x;let b=0,S=0,E=0,_=0,k=0;const C=1/Math.abs(i[w]-m||1);for(let A=v;A<=x;++A){const T=i[A],F=o[A],R=XQ(Math.abs(m-T)*C)*d[A],L=T*R;b+=R,S+=L,E+=F*R,_+=F*L,k+=T*L}const[$,O]=Ep(S/b,E/b,_/b,k/b);c[y]=$+O*m,f[y]=Math.abs(o[y]-c[y]),QQ(i,y+1,p)}if(h===K4)break;const g=WR(f);if(Math.abs(g)<Z4)break;for(let y=0,m,v;y<l;++y)m=f[y]/(6*g),d[y]=m>=1?Z4:(v=1-m*m)*v}return KQ(i,c,s,a)}function XQ(e){return(e=1-e*e*e)*e*e}function QQ(e,t,n){const r=e[t];let i=n[0],o=n[1]+1;if(!(o>=e.length))for(;t>i&&e[o]-r<=r-e[i];)n[0]=++i,n[1]=o,++o}function KQ(e,t,n,r){const i=e.length,o=[];let s=0,a=0,l=[],u;for(;s<i;++s)u=e[s]+n,l[0]===u?l[1]+=(t[s]-l[1])/++a:(a=0,l[1]+=r,l=[u,t[s]],o.push(l));return l[1]+=r,o}const ZQ=.5*Math.PI/180;function qy(e,t,n,r){n=n||25,r=Math.max(n,r||200);const i=g=>[g,e(g)],o=t[0],s=t[1],a=s-o,l=a/r,u=[i(o)],c=[];if(n===r){for(let g=1;g<r;++g)u.push(i(o+g/n*a));return u.push(i(s)),u}else{c.push(i(s));for(let g=n;--g>0;)c.push(i(o+g/n*a))}let f=u[0],d=c[c.length-1];const h=1/a,p=JQ(f[1],c);for(;d;){const g=i((f[0]+d[0])/2);g[0]-f[0]>=l&&eK(f,g,d,h,p)>ZQ?c.push(g):(f=d,u.push(d),c.pop()),d=c[c.length-1]}return u}function JQ(e,t){let n=e,r=e;const i=t.length;for(let o=0;o<i;++o){const s=t[o][1];s<n&&(n=s),s>r&&(r=s)}return 1/(r-n)}function eK(e,t,n,r,i){const o=Math.atan2(i*(n[1]-e[1]),r*(n[0]-e[0])),s=Math.atan2(i*(t[1]-e[1]),r*(t[0]-e[0]));return Math.abs(o-s)}function tK(e){return t=>{const n=e.length;let r=1,i=String(e[0](t));for(;r<n;++r)i+="|"+e[r](t);return i}}function qb(e){return!e||!e.length?function(){return""}:e.length===1?e[0]:tK(e)}function o9(e,t,n){return n||e+(t?"_"+t:"")}const p2=()=>{},nK={init:p2,add:p2,rem:p2,idx:0},Uh={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.valid?e.sum:void 0,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||e.min===void 0)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||e.max===void 0)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3},exponential:{init:(e,t)=>{e.exp=0,e.exp_r=t},value:e=>e.valid?e.exp*(1-e.exp_r)/(1-e.exp_r**e.valid):void 0,add:(e,t)=>e.exp=e.exp_r*e.exp+t,rem:(e,t)=>e.exp=(e.exp-t/e.exp_r**(e.valid-1))/e.exp_r},exponentialb:{value:e=>e.valid?e.exp*(1-e.exp_r):void 0,req:["exponential"],idx:1}},_p=Object.keys(Uh).filter(e=>e!=="__count__");function rK(e,t){return(n,r)=>ge({name:e,aggregate_param:r,out:n||e},nK,t)}[..._p,"__count__"].forEach(e=>{Uh[e]=rK(e,Uh[e])});function s9(e,t,n){return Uh[e](n,t)}function a9(e,t){return e.idx-t.idx}function iK(e){const t={};e.forEach(r=>t[r.name]=r);const n=r=>{r.req&&r.req.forEach(i=>{t[i]||n(t[i]=Uh[i]())})};return e.forEach(n),Object.values(t).sort(a9)}function oK(){this.valid=0,this.missing=0,this._ops.forEach(e=>e.aggregate_param==null?e.init(this):e.init(this,e.aggregate_param))}function sK(e,t){if(e==null||e===""){++this.missing;return}e===e&&(++this.valid,this._ops.forEach(n=>n.add(this,e,t)))}function aK(e,t){if(e==null||e===""){--this.missing;return}e===e&&(--this.valid,this._ops.forEach(n=>n.rem(this,e,t)))}function lK(e){return this._out.forEach(t=>e[t.out]=t.value(this)),e}function l9(e,t){const n=t||wn,r=iK(e),i=e.slice().sort(a9);function o(s){this._ops=r,this._out=i,this.cell=s,this.init()}return o.prototype.init=oK,o.prototype.add=sK,o.prototype.rem=aK,o.prototype.set=lK,o.prototype.get=n,o.fields=e.map(s=>s.out),o}function Ak(e){this._key=e?Vr(e):le,this.reset()}const tn=Ak.prototype;tn.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null};tn.add=function(e){this._add.push(e)};tn.rem=function(e){this._rem.push(e)};tn.values=function(){if(this._get=null,this._rem.length===0)return this._add;const e=this._add,t=this._rem,n=this._key,r=e.length,i=t.length,o=Array(r-i),s={};let a,l,u;for(a=0;a<i;++a)s[n(t[a])]=1;for(a=0,l=0;a<r;++a)s[n(u=e[a])]?s[n(u)]=0:o[l++]=u;return this._rem=[],this._add=o};tn.distinct=function(e){const t=this.values(),n={};let r=t.length,i=0,o;for(;--r>=0;)o=e(t[r])+"",te(n,o)||(n[o]=1,++i);return i};tn.extent=function(e){if(this._get!==e||!this._ext){const t=this.values(),n=_R(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext};tn.argmin=function(e){return this.extent(e)[0]||{}};tn.argmax=function(e){return this.extent(e)[1]||{}};tn.min=function(e){const t=this.extent(e)[0];return t!=null?e(t):void 0};tn.max=function(e){const t=this.extent(e)[1];return t!=null?e(t):void 0};tn.quartile=function(e){return(this._get!==e||!this._q)&&(this._q=dk(this.values(),e),this._get=e),this._q};tn.q1=function(e){return this.quartile(e)[0]};tn.q2=function(e){return this.quartile(e)[1]};tn.q3=function(e){return this.quartile(e)[2]};tn.ci=function(e){return(this._get!==e||!this._ci)&&(this._ci=YD(this.values(),1e3,.05,e),this._get=e),this._ci};tn.ci0=function(e){return this.ci(e)[0]};tn.ci1=function(e){return this.ci(e)[1]};function ya(e){P.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}ya.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:_p},{name:"aggregate_params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]};X(ya,P,{transform(e,t){const n=this,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.modified();return n.stamp=r.stamp,n.value&&(i||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=i?n.init(e):Object.create(null),t.visit(t.SOURCE,o=>n.add(o))):(n.value=n.value||n.init(e),t.visit(t.REM,o=>n.rem(o)),t.visit(t.ADD,o=>n.add(o))),r.modifies(n._outputs),n._drop=e.drop!==!1,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&r.clean(!0).runAfter(()=>this.clean()),n.changes(r)},cross(){const e=this,t=e.value,n=e._dnames,r=n.map(()=>({})),i=n.length;function o(a){let l,u,c,f;for(l in a)for(c=a[l].tuple,u=0;u<i;++u)r[u][f=c[n[u]]]=f}o(e._prev),o(t);function s(a,l,u){const c=n[u],f=r[u++];for(const d in f){const h=a?a+"|"+d:d;l[c]=f[d],u<i?s(h,l,u):t[h]||e.cell(h,l)}}s("",{},0)},init(e){const t=this._inputs=[],n=this._outputs=[],r={};function i(v){const x=J(gn(v)),w=x.length;let b=0,S;for(;b<w;++b)r[S=x[b]]||(r[S]=1,t.push(S))}this._dims=J(e.groupby),this._dnames=this._dims.map(v=>{const x=ft(v);return i(v),n.push(x),x}),this.cellkey=e.key?e.key:qb(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const o=e.fields||[null],s=e.ops||["count"],a=e.aggregate_params||[null],l=e.as||[],u=o.length,c={};let f,d,h,p,g,y,m;for(u!==s.length&&I("Unmatched number of fields and aggregate ops."),m=0;m<u;++m){if(f=o[m],d=s[m],h=a[m]||null,f==null&&d!=="count"&&I("Null aggregate field specified."),g=ft(f),y=o9(d,g,l[m]),n.push(y),d==="count"){this._counts.push(y);continue}p=c[g],p||(i(f),p=c[g]=[],p.field=f,this._measures.push(p)),d!=="count"&&(this._countOnly=!1),p.push(s9(d,h,y))}return this._measures=this._measures.map(v=>l9(v,v.field)),Object.create(null)},cellkey:qb(),cell(e,t){let n=this.value[e];return n?n.num===0&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell(e,t){const n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){const r=this._measures,i=r.length;n.agg=Array(i);for(let o=0;o<i;++o)n.agg[o]=new r[o](n)}return n.store&&(n.data=new Ak),n},newtuple(e,t){const n=this._dnames,r=this._dims,i=r.length,o={};for(let s=0;s<i;++s)o[n[s]]=r[s](e);return t?jD(t.tuple,o):De(o)},clean(){const e=this.value;for(const t in e)e[t].num===0&&delete e[t]},add(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(e);const r=n.agg;for(let i=0,o=r.length;i<o;++i)r[i].add(r[i].get(e),e)},rem(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(e);const r=n.agg;for(let i=0,o=r.length;i<o;++i)r[i].rem(r[i].get(e),e)},celltuple(e){const t=e.tuple,n=this._counts;e.store&&e.data.values();for(let r=0,i=n.length;r<i;++r)t[n[r]]=e.num;if(!this._countOnly){const r=e.agg;for(let i=0,o=r.length;i<o;++i)r[i].set(t)}return t},changes(e){const t=this._adds,n=this._mods,r=this._prev,i=this._drop,o=e.add,s=e.rem,a=e.mod;let l,u,c,f;if(r)for(u in r)l=r[u],(!i||l.num)&&s.push(l.tuple);for(c=0,f=this._alen;c<f;++c)o.push(this.celltuple(t[c])),t[c]=null;for(c=0,f=this._mlen;c<f;++c)l=n[c],(l.num===0&&i?s:a).push(this.celltuple(l)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,e}});const uK=1e-14;function Fk(e){P.call(this,null,e)}Fk.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]};X(Fk,P,{transform(e,t){const n=e.interval!==!1,r=this._bins(e),i=r.start,o=r.step,s=e.as||["bin0","bin1"],a=s[0],l=s[1];let u;return e.modified()?(t=t.reflow(!0),u=t.SOURCE):u=t.modified(gn(e.field))?t.ADD_MOD:t.ADD,t.visit(u,n?c=>{const f=r(c);c[a]=f,c[l]=f==null?null:i+o*(1+(f-i)/o)}:c=>c[a]=r(c)),t.modifies(n?s:a)},_bins(e){if(this.value&&!e.modified())return this.value;const t=e.field,n=GD(e),r=n.step;let i=n.start,o=i+Math.ceil((n.stop-i)/r)*r,s,a;(s=e.anchor)!=null&&(a=s-(i+r*Math.floor((s-i)/r)),i+=a,o+=a);const l=function(u){let c=hn(t(u));return c==null?null:c<i?-1/0:c>o?1/0:(c=Math.max(i,Math.min(c,o-r)),i+r*Math.floor(uK+(c-i)/r))};return l.start=i,l.stop=n.stop,l.step=r,this.value=ar(l,gn(t),e.name||"bin_"+ft(t))}});function u9(e,t,n){const r=e;let i=t||[],o=n||[],s={},a=0;return{add:l=>o.push(l),remove:l=>s[r(l)]=++a,size:()=>i.length,data:(l,u)=>(a&&(i=i.filter(c=>!s[r(c)]),s={},a=0),u&&l&&i.sort(l),o.length&&(i=l?MR(l,i,o.sort(l)):i.concat(o),o=[]),i)}}function Mk(e){P.call(this,[],e)}Mk.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]};X(Mk,P,{transform(e,t){const n=t.fork(t.ALL),r=u9(le,this.value,n.materialize(n.ADD).add),i=e.sort,o=t.changed()||i&&(e.modified("sort")||t.modified(i.fields));return n.visit(n.REM,r.remove),this.modified(o),this.value=n.source=r.data(fu(i),o),t.source&&t.source.root&&(this.value.root=t.source.root),n}});function c9(e){qe.call(this,null,cK,e)}X(c9,qe);function cK(e){return this.value&&!e.modified()?this.value:q_(e.fields,e.orders)}function Tk(e){P.call(this,null,e)}Tk.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};function fK(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase();break}return e.match(n)}X(Tk,P,{transform(e,t){const n=f=>d=>{for(var h=fK(a(d),e.case,o)||[],p,g=0,y=h.length;g<y;++g)s.test(p=h[g])||f(p)},r=this._parameterCheck(e,t),i=this._counts,o=this._match,s=this._stop,a=e.field,l=e.as||["text","count"],u=n(f=>i[f]=1+(i[f]||0)),c=n(f=>i[f]-=1);return r?t.visit(t.SOURCE,u):(t.visit(t.ADD,u),t.visit(t.REM,c)),this._finish(t,l)},_parameterCheck(e,t){let n=!1;return(e.modified("stopwords")||!this._stop)&&(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),(e.modified("pattern")||!this._match)&&(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(e,t){const n=this._counts,r=this._tuples||(this._tuples={}),i=t[0],o=t[1],s=e.fork(e.NO_SOURCE|e.NO_FIELDS);let a,l,u;for(a in n)l=r[a],u=n[a]||0,!l&&u?(r[a]=l=De({}),l[i]=a,l[o]=u,s.add.push(l)):u===0?(l&&s.rem.push(l),n[a]=null,r[a]=null):l[o]!==u&&(l[o]=u,s.mod.push(l));return s.modifies(t)}});function Nk(e){P.call(this,null,e)}Nk.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]};X(Nk,P,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.as||["a","b"],i=r[0],o=r[1],s=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");let a=this.value;return s?(a&&(n.rem=a),a=t.materialize(t.SOURCE).source,n.add=this.value=dK(a,i,o,e.filter||Gr)):n.mod=a,n.source=this.value,n.modifies(r)}});function dK(e,t,n,r){for(var i=[],o={},s=e.length,a=0,l,u;a<s;++a)for(o[t]=u=e[a],l=0;l<s;++l)o[n]=e[l],r(o)&&(i.push(De(o)),o={},o[t]=u);return i}const J4={kde:mk,mixture:ZD,normal:gk,lognormal:KD,uniform:JD},hK="distributions",e6="function",pK="field";function f9(e,t){const n=e[e6];te(J4,n)||I("Unknown distribution function: "+n);const r=J4[n]();for(const i in e)i===pK?r.data((e.from||t()).map(e[i])):i===hK?r[i](e[i].map(o=>f9(o,t))):typeof r[i]===e6&&r[i](e[i]);return r}function Rk(e){P.call(this,null,e)}const d9=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],gK={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:d9},{name:"weights",type:"number",array:!0}]};Rk.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:d9.concat(gK)},{name:"as",type:"string",array:!0,default:["value","density"]}]};X(Rk,P,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=f9(e.distribution,mK(t)),i=e.steps||e.minsteps||25,o=e.steps||e.maxsteps||200;let s=e.method||"pdf";s!=="pdf"&&s!=="cdf"&&I("Invalid density method: "+s),!e.extent&&!r.data&&I("Missing density extent parameter."),s=r[s];const a=e.as||["value","density"],l=e.extent||co(r.data()),u=qy(s,l,i,o).map(c=>{const f={};return f[a[0]]=c[0],f[a[1]]=c[1],De(f)});this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});function mK(e){return()=>e.materialize(e.SOURCE).source}function h9(e,t){return e?e.map((n,r)=>t[r]||ft(n)):null}function Dk(e,t,n){const r=[],i=f=>f(l);let o,s,a,l,u,c;if(t==null)r.push(e.map(n));else for(o={},s=0,a=e.length;s<a;++s)l=e[s],u=t.map(i),c=o[u],c||(o[u]=c=[],c.dims=u,r.push(c)),c.push(n(l));return r}const p9="bin";function Ok(e){P.call(this,null,e)}Ok.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:p9}]};const yK=(e,t)=>bp(co(e,t))/30;X(Ok,P,{transform(e,t){if(this.value&&!(e.modified()||t.changed()))return t;const n=t.materialize(t.SOURCE).source,r=Dk(t.source,e.groupby,wn),i=e.smooth||!1,o=e.field,s=e.step||yK(n,o),a=fu((p,g)=>o(p)-o(g)),l=e.as||p9,u=r.length;let c=1/0,f=-1/0,d=0,h;for(;d<u;++d){const p=r[d].sort(a);h=-1;for(const g of XD(p,s,i,o))g<c&&(c=g),g>f&&(f=g),p[++h][l]=g}return this.value={start:c,stop:f,step:s},t.reflow(!0).modifies(l)}});function g9(e){qe.call(this,null,vK,e),this.modified(!0)}X(g9,qe);function vK(e){const t=e.expr;return this.value&&!e.modified("expr")?this.value:ar(n=>t(n,e),gn(t),ft(t))}function Pk(e){P.call(this,[void 0,void 0],e)}Pk.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]};X(Pk,P,{transform(e,t){const n=this.value,r=e.field,i=t.changed()||t.modified(r.fields)||e.modified("field");let o=n[0],s=n[1];if((i||o==null)&&(o=1/0,s=-1/0),t.visit(i?t.SOURCE:t.ADD,a=>{const l=hn(r(a));l!=null&&(l<o&&(o=l),l>s&&(s=l))}),!Number.isFinite(o)||!Number.isFinite(s)){let a=ft(r);a&&(a=` for field "${a}"`),t.dataflow.warn(`Infinite extent${a}: [${o}, ${s}]`),o=s=void 0}this.value=[o,s]}});function Lk(e,t){qe.call(this,e),this.parent=t,this.count=0}X(Lk,qe,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add(e){this.count+=1,this.value.add.push(e)},rem(e){this.count-=1,this.value.rem.push(e)},mod(e){this.value.mod.push(e)},init(e){this.value.init(e,e.NO_SOURCE)},evaluate(){return this.value}});function Hy(e){P.call(this,{},e),this._keys=bf();const t=this._targets=[];t.active=0,t.forEach=n=>{for(let r=0,i=t.active;r<i;++r)n(t[r],r,t)}}X(Hy,P,{activate(e){this._targets[this._targets.active++]=e},subflow(e,t,n,r){const i=this.value;let o=te(i,e)&&i[e],s,a;return o?o.value.stamp<n.stamp&&(o.init(n),this.activate(o)):(a=r||(a=this._group[e])&&a.tuple,s=n.dataflow,o=new Lk(n.fork(n.NO_SOURCE),this),s.add(o).connect(t(s,e,a)),i[e]=o,this.activate(o)),o},clean(){const e=this.value;let t=0;for(const n in e)if(e[n].count===0){const r=e[n].detachSubflow;r&&r(),delete e[n],++t}if(t){const n=this._targets.filter(r=>r&&r.count>0);this.initTargets(n)}},initTargets(e){const t=this._targets,n=t.length,r=e?e.length:0;let i=0;for(;i<r;++i)t[i]=e[i];for(;i<n&&t[i]!=null;++i)t[i]=null;t.active=r},transform(e,t){const n=t.dataflow,r=e.key,i=e.subflow,o=this._keys,s=e.modified("key"),a=l=>this.subflow(l,i,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,l=>{const u=le(l),c=o.get(u);c!==void 0&&(o.delete(u),a(c).rem(l))}),t.visit(t.ADD,l=>{const u=r(l);o.set(le(l),u),a(u).add(l)}),s||t.modified(r.fields)?t.visit(t.MOD,l=>{const u=le(l),c=o.get(u),f=r(l);c===f?a(f).mod(l):(o.set(u,f),a(c).rem(l),a(f).add(l))}):t.changed(t.MOD)&&t.visit(t.MOD,l=>{a(o.get(le(l))).mod(l)}),s&&t.visit(t.REFLOW,l=>{const u=le(l),c=o.get(u),f=r(l);c!==f&&(o.set(u,f),a(c).rem(l),a(f).add(l))}),t.clean()?n.runAfter(()=>{this.clean(),o.clean()}):o.empty>n.cleanThreshold&&n.runAfter(o.clean),t}});function m9(e){qe.call(this,null,xK,e)}X(m9,qe);function xK(e){return this.value&&!e.modified()?this.value:j(e.name)?J(e.name).map(t=>Vr(t)):Vr(e.name,e.as)}function zk(e){P.call(this,bf(),e)}zk.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]};X(zk,P,{transform(e,t){const n=t.dataflow,r=this.value,i=t.fork(),o=i.add,s=i.rem,a=i.mod,l=e.expr;let u=!0;t.visit(t.REM,f=>{const d=le(f);r.has(d)?r.delete(d):s.push(f)}),t.visit(t.ADD,f=>{l(f,e)?o.push(f):r.set(le(f),1)});function c(f){const d=le(f),h=l(f,e),p=r.get(d);h&&p?(r.delete(d),o.push(f)):!h&&!p?(r.set(d,1),s.push(f)):u&&h&&!p&&a.push(f)}return t.visit(t.MOD,c),e.modified()&&(u=!1,t.visit(t.REFLOW,c)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),i}});function Ik(e){P.call(this,[],e)}Ik.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]};X(Ik,P,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=h9(r,e.as||[]),o=e.index||null,s=i.length;return n.rem=this.value,t.visit(t.SOURCE,a=>{const l=r.map(p=>p(a)),u=l.reduce((p,g)=>Math.max(p,g.length),0);let c=0,f,d,h;for(;c<u;++c){for(d=lk(a),f=0;f<s;++f)d[i[f]]=(h=l[f][c])==null?null:h;o&&(d[o]=c),n.add.push(d)}}),this.value=n.source=n.add,o&&n.modifies(o),n.modifies(i)}});function jk(e){P.call(this,[],e)}jk.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]};X(jk,P,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=r.map(ft),o=e.as||["key","value"],s=o[0],a=o[1],l=r.length;return n.rem=this.value,t.visit(t.SOURCE,u=>{for(let c=0,f;c<l;++c)f=lk(u),f[s]=i[c],f[a]=r[c](u),n.add.push(f)}),this.value=n.source=n.add,n.modifies(o)}});function Bk(e){P.call(this,null,e)}Bk.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]};X(Bk,P,{transform(e,t){const n=e.expr,r=e.as,i=e.modified(),o=e.initonly?t.ADD:i?t.SOURCE:t.modified(n.fields)||t.modified(r)?t.ADD_MOD:t.ADD;return i&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(r),t.visit(o,s=>s[r]=n(s,e))}});function y9(e){P.call(this,[],e)}X(y9,P,{transform(e,t){const n=t.fork(t.ALL),r=e.generator;let i=this.value,o=e.size-i.length,s,a,l;if(o>0){for(s=[];--o>=0;)s.push(l=De(r(e))),i.push(l);n.add=n.add.length?n.materialize(n.ADD).add.concat(s):s}else a=i.slice(0,-o),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(a):a,i=i.slice(-o);return n.source=this.value=i,n}});const Dg={value:"value",median:WR,mean:tY,min:Rb,max:Cl},wK=[];function Uk(e){P.call(this,[],e)}Uk.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};function bK(e){var t=e.method||Dg.value,n;if(Dg[t]==null)I("Unrecognized imputation method: "+t);else return t===Dg.value?(n=e.value!==void 0?e.value:0,()=>n):Dg[t]}function EK(e){const t=e.field;return n=>n?t(n):NaN}X(Uk,P,{transform(e,t){var n=t.fork(t.ALL),r=bK(e),i=EK(e),o=ft(e.field),s=ft(e.key),a=(e.groupby||[]).map(ft),l=SK(t.source,e.groupby,e.key,e.keyvals),u=[],c=this.value,f=l.domain.length,d,h,p,g,y,m,v,x,w,b;for(y=0,x=l.length;y<x;++y)for(d=l[y],p=d.values,h=NaN,v=0;v<f;++v)if(d[v]==null){for(g=l.domain[v],b={_impute:!0},m=0,w=p.length;m<w;++m)b[a[m]]=p[m];b[s]=g,b[o]=Number.isNaN(h)?h=r(d,i):h,u.push(De(b))}return u.length&&(n.add=n.materialize(n.ADD).add.concat(u)),c.length&&(n.rem=n.materialize(n.REM).rem.concat(c)),this.value=u,n}});function SK(e,t,n,r){var i=m=>m(y),o=[],s=r?r.slice():[],a={},l={},u,c,f,d,h,p,g,y;for(s.forEach((m,v)=>a[m]=v+1),d=0,g=e.length;d<g;++d)y=e[d],p=n(y),h=a[p]||(a[p]=s.push(p)),c=(u=t?t.map(i):wK)+"",(f=l[c])||(f=l[c]=[],o.push(f),f.values=u),f[h-1]=y;return o.domain=s,o}function Wk(e){ya.call(this,e)}Wk.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:_p},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]};X(Wk,ya,{transform(e,t){const n=this,r=e.modified();let i;return n.value&&(r||t.modified(n._inputs,!0))?(i=n.value=r?n.init(e):{},t.visit(t.SOURCE,o=>n.add(o))):(i=n.value=n.value||this.init(e),t.visit(t.REM,o=>n.rem(o)),t.visit(t.ADD,o=>n.add(o))),n.changes(),t.visit(t.SOURCE,o=>{ge(o,i[n.cellkey(o)].tuple)}),t.reflow(r).modifies(this._outputs)},changes(){const e=this._adds,t=this._mods;let n,r;for(n=0,r=this._alen;n<r;++n)this.celltuple(e[n]),e[n]=null;for(n=0,r=this._mlen;n<r;++n)this.celltuple(t[n]),t[n]=null;this._alen=this._mlen=0}});function qk(e){P.call(this,null,e)}qk.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]};X(qk,P,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=Dk(r,e.groupby,e.field),o=(e.groupby||[]).map(ft),s=e.bandwidth,a=e.cumulative?"cdf":"pdf",l=e.as||["value","density"],u=[];let c=e.extent,f=e.steps||e.minsteps||25,d=e.steps||e.maxsteps||200;a!=="pdf"&&a!=="cdf"&&I("Invalid density method: "+a),e.resolve==="shared"&&(c||(c=co(r,e.field)),f=d=e.steps||d),i.forEach(h=>{const p=mk(h,s)[a],g=e.counts?h.length:1,y=c||co(h);qy(p,y,f,d).forEach(m=>{const v={};for(let x=0;x<o.length;++x)v[o[x]]=h.dims[x];v[l[0]]=m[0],v[l[1]]=m[1]*g,u.push(De(v))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});function v9(e){qe.call(this,null,_K,e)}X(v9,qe);function _K(e){return this.value&&!e.modified()?this.value:V_(e.fields,e.flat)}function x9(e){P.call(this,[],e),this._pending=null}X(x9,P,{transform(e,t){const n=t.dataflow;return this._pending?g2(this,t,this._pending):kK(e)?t.StopPropagation:e.values?g2(this,t,n.parse(e.values,e.format)):e.async?{async:n.request(e.url,e.format).then(i=>(this._pending=J(i.data),o=>o.touch(this)))}:n.request(e.url,e.format).then(r=>g2(this,t,J(r.data)))}});function kK(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}function g2(e,t,n){n.forEach(De);const r=t.fork(t.NO_FIELDS&t.NO_SOURCE);return r.rem=e.value,e.value=r.source=r.add=n,e._pending=null,r.rem.length&&r.clean(!0),r}function Hk(e){P.call(this,{},e)}Hk.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]};X(Hk,P,{transform(e,t){const n=e.fields,r=e.index,i=e.values,o=e.default==null?null:e.default,s=e.modified(),a=n.length;let l=s?t.SOURCE:t.ADD,u=t,c=e.as,f,d,h;return i?(d=i.length,a>1&&!c&&I('Multi-field lookup requires explicit "as" parameter.'),c&&c.length!==a*d&&I('The "as" parameter has too few output field names.'),c=c||i.map(ft),f=function(p){for(var g=0,y=0,m,v;g<a;++g)if(v=r.get(n[g](p)),v==null)for(m=0;m<d;++m,++y)p[c[y]]=o;else for(m=0;m<d;++m,++y)p[c[y]]=i[m](v)}):(c||I("Missing output field names."),f=function(p){for(var g=0,y;g<a;++g)y=r.get(n[g](p)),p[c[g]]=y??o}),s?u=t.reflow(!0):(h=n.some(p=>t.modified(p.fields)),l|=h?t.MOD:0),t.visit(l,f),u.modifies(c)}});function w9(e){qe.call(this,null,CK,e)}X(w9,qe);function CK(e){if(this.value&&!e.modified())return this.value;const t=e.extents,n=t.length;let r=1/0,i=-1/0,o,s;for(o=0;o<n;++o)s=t[o],s[0]<r&&(r=s[0]),s[1]>i&&(i=s[1]);return[r,i]}function b9(e){qe.call(this,null,$K,e)}X(b9,qe);function $K(e){return this.value&&!e.modified()?this.value:e.values.reduce((t,n)=>t.concat(n),[])}function E9(e){P.call(this,null,e)}X(E9,P,{transform(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function Vk(e){ya.call(this,e)}Vk.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:_p,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]};X(Vk,ya,{_transform:ya.prototype.transform,transform(e,t){return this._transform(AK(e,t),t)}});function AK(e,t){const n=e.field,r=e.value,i=(e.op==="count"?"__count__":e.op)||"sum",o=gn(n).concat(gn(r)),s=MK(n,e.limit||0,t);return t.changed()&&e.set("__pivot__",null,null,!0),{key:e.key,groupby:e.groupby,ops:s.map(()=>i),fields:s.map(a=>FK(a,n,r,o)),as:s.map(a=>a+""),modified:e.modified.bind(e)}}function FK(e,t,n,r){return ar(i=>t(i)===e?n(i):NaN,r,e+"")}function MK(e,t,n){const r={},i=[];return n.visit(n.SOURCE,o=>{const s=e(o);r[s]||(r[s]=1,i.push(s))}),i.sort($y),t?i.slice(0,t):i}function S9(e){Hy.call(this,e)}X(S9,Hy,{transform(e,t){const n=e.subflow,r=e.field,i=o=>this.subflow(le(o),n,t,o);return(e.modified("field")||r&&t.modified(gn(r)))&&I("PreFacet does not support field modification."),this.initTargets(),r?(t.visit(t.MOD,o=>{const s=i(o);r(o).forEach(a=>s.mod(a))}),t.visit(t.ADD,o=>{const s=i(o);r(o).forEach(a=>s.add(De(a)))}),t.visit(t.REM,o=>{const s=i(o);r(o).forEach(a=>s.rem(a))})):(t.visit(t.MOD,o=>i(o).mod(o)),t.visit(t.ADD,o=>i(o).add(o)),t.visit(t.REM,o=>i(o).rem(o))),t.clean()&&t.runAfter(()=>this.clean()),t}});function Gk(e){P.call(this,null,e)}Gk.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]};X(Gk,P,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=h9(e.fields,e.as||[]),o=r?(a,l)=>TK(a,l,r,i):Ly;let s;return this.value?s=this.value:(t=t.addAll(),s=this.value={}),t.visit(t.REM,a=>{const l=le(a);n.rem.push(s[l]),s[l]=null}),t.visit(t.ADD,a=>{const l=o(a,De({}));s[le(a)]=l,n.add.push(l)}),t.visit(t.MOD,a=>{n.mod.push(o(a,s[le(a)]))}),n}});function TK(e,t,n,r){for(let i=0,o=n.length;i<o;++i)t[r[i]]=n[i](e);return t}function _9(e){P.call(this,null,e)}X(_9,P,{transform(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function Yk(e){P.call(this,null,e)}Yk.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};const NK=1e-14;X(Yk,P,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;const i=t.materialize(t.SOURCE).source,o=Dk(i,e.groupby,e.field),s=(e.groupby||[]).map(ft),a=[],l=e.step||.01,u=e.probs||mr(l/2,1-NK,l),c=u.length;return o.forEach(f=>{const d=fk(f,u);for(let h=0;h<c;++h){const p={};for(let g=0;g<s.length;++g)p[s[g]]=f.dims[g];p[r[0]]=u[h],p[r[1]]=d[h],a.push(De(p))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=a,n}});function k9(e){P.call(this,null,e)}X(k9,P,{transform(e,t){let n,r;return this.value?r=this.value:(n=t=t.addAll(),r=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,i=>{const o=le(i);n.rem.push(r[o]),r[o]=null}),t.visit(t.ADD,i=>{const o=lk(i);r[le(i)]=o,n.add.push(o)}),t.visit(t.MOD,i=>{const o=r[le(i)];for(const s in i)o[s]=i[s],n.modifies(s);n.mod.push(o)})),n}});function Xk(e){P.call(this,[],e),this.count=0}Xk.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]};X(Xk,P,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.modified("size"),i=e.size,o=this.value.reduce((c,f)=>(c[le(f)]=1,c),{});let s=this.value,a=this.count,l=0;function u(c){let f,d;s.length<i?s.push(c):(d=~~((a+1)*Xr()),d<s.length&&d>=l&&(f=s[d],o[le(f)]&&n.rem.push(f),s[d]=c)),++a}if(t.rem.length&&(t.visit(t.REM,c=>{const f=le(c);o[f]&&(o[f]=-1,n.rem.push(c)),--a}),s=s.filter(c=>o[le(c)]!==-1)),(t.rem.length||r)&&s.length<i&&t.source&&(l=a=s.length,t.visit(t.SOURCE,c=>{o[le(c)]||u(c)}),l=-1),r&&s.length>i){const c=s.length-i;for(let f=0;f<c;++f)o[le(s[f])]=-1,n.rem.push(s[f]);s=s.slice(c)}return t.mod.length&&t.visit(t.MOD,c=>{o[le(c)]&&n.mod.push(c)}),t.add.length&&t.visit(t.ADD,u),(t.add.length||l<0)&&(n.add=s.filter(c=>!o[le(c)])),this.count=a,this.value=n.source=s,n}});function Qk(e){P.call(this,null,e)}Qk.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]};X(Qk,P,{transform(e,t){if(this.value&&!e.modified())return;const n=t.materialize().fork(t.MOD),r=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=mr(e.start,e.stop,e.step||1).map(i=>{const o={};return o[r]=i,De(o)}),n.add=t.add.concat(this.value),n}});function C9(e){P.call(this,null,e),this.modified(!0)}X(C9,P,{transform(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function Kk(e){P.call(this,null,e)}const $9=["unit0","unit1"];Kk.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:J_,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:$9}]};X(Kk,P,{transform(e,t){const n=e.field,r=e.interval!==!1,i=e.timezone==="utc",o=this._floor(e,t),s=(i?Cf:kf)(o.unit).offset,a=e.as||$9,l=a[0],u=a[1],c=o.step;let f=o.start||1/0,d=o.stop||-1/0,h=t.ADD;return(e.modified()||t.changed(t.REM)||t.modified(gn(n)))&&(t=t.reflow(!0),h=t.SOURCE,f=1/0,d=-1/0),t.visit(h,p=>{const g=n(p);let y,m;g==null?(p[l]=null,r&&(p[u]=null)):(p[l]=y=m=o(g),r&&(p[u]=m=s(y,c)),y<f&&(f=y),m>d&&(d=m))}),o.start=f,o.stop=d,t.modifies(r?a:l)},_floor(e,t){const n=e.timezone==="utc",{units:r,step:i}=e.units?{units:e.units,step:e.step||1}:yD({extent:e.extent||co(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),o=ek(r),s=this.value||{},a=(n?lD:aD)(o,i);return a.unit=Ce(o),a.units=o,a.step=i,a.start=s.start,a.stop=s.stop,this.value=a}});function A9(e){P.call(this,bf(),e)}X(A9,P,{transform(e,t){const n=t.dataflow,r=e.field,i=this.value,o=a=>i.set(r(a),a);let s=!0;return e.modified("field")||t.modified(r.fields)?(i.clear(),t.visit(t.SOURCE,o)):t.changed()?(t.visit(t.REM,a=>i.delete(r(a))),t.visit(t.ADD,o)):s=!1,this.modified(s),i.empty>n.cleanThreshold&&n.runAfter(i.clean),t.fork()}});function F9(e){P.call(this,null,e)}X(F9,P,{transform(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(fu(e.sort)):t.source).map(e.field))}});function RK(e,t,n,r){const i=Wh[e](t,n);return{init:i.init||Bs,update:function(o,s){s[r]=i.next(o)}}}const Wh={row_number:function(){return{next:e=>e.index+1}},rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?e=n+1:e}}},dense_rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?++e:e}}},percent_rank:function(){const e=Wh.rank(),t=e.next;return{init:e.init,next:n=>(t(n)-1)/(n.data.length-1)}},cume_dist:function(){let e;return{init:()=>e=0,next:t=>{const n=t.data,r=t.compare;let i=t.index;if(e<i){for(;i+1<n.length&&!r(n[i],n[i+1]);)++i;e=i}return(1+e)/n.length}}},ntile:function(e,t){t=+t,t>0||I("ntile num must be greater than zero.");const n=Wh.cume_dist(),r=n.next;return{init:n.init,next:i=>Math.ceil(t*r(i))}},lag:function(e,t){return t=+t||1,{next:n=>{const r=n.index-t;return r>=0?e(n.data[r]):null}}},lead:function(e,t){return t=+t||1,{next:n=>{const r=n.index+t,i=n.data;return r<i.length?e(i[r]):null}}},first_value:function(e){return{next:t=>e(t.data[t.i0])}},last_value:function(e){return{next:t=>e(t.data[t.i1-1])}},nth_value:function(e,t){return t=+t,t>0||I("nth_value nth must be greater than zero."),{next:n=>{const r=n.i0+(t-1);return r<n.i1?e(n.data[r]):null}}},prev_value:function(e){let t;return{init:()=>t=null,next:n=>{const r=e(n.data[n.index]);return r!=null?t=r:t}}},next_value:function(e){let t,n;return{init:()=>(t=null,n=-1),next:r=>{const i=r.data;return r.index<=n?t:(n=DK(e,i,r.index))<0?(n=i.length,t=null):t=e(i[n])}}}};function DK(e,t,n){for(let r=t.length;n<r;++n)if(e(t[n])!=null)return n;return-1}const OK=Object.keys(Wh);function M9(e){const t=J(e.ops),n=J(e.fields),r=J(e.params),i=J(e.aggregate_params),o=J(e.as),s=this.outputs=[],a=this.windows=[],l={},u={},c=[],f=[];let d=!0;function h(p){J(gn(p)).forEach(g=>l[g]=1)}h(e.sort),t.forEach((p,g)=>{const y=n[g],m=r[g],v=i[g]||null,x=ft(y),w=o9(p,x,o[g]);if(h(y),s.push(w),te(Wh,p))a.push(RK(p,y,m,w));else{if(y==null&&p!=="count"&&I("Null aggregate field specified."),p==="count"){c.push(w);return}d=!1;let b=u[x];b||(b=u[x]=[],b.field=y,f.push(b)),b.push(s9(p,v,w))}}),(c.length||f.length)&&(this.cell=PK(f,c,d)),this.inputs=Object.keys(l)}const T9=M9.prototype;T9.init=function(){this.windows.forEach(e=>e.init()),this.cell&&this.cell.init()};T9.update=function(e,t){const n=this.cell,r=this.windows,i=e.data,o=r&&r.length;let s;if(n){for(s=e.p0;s<e.i0;++s)n.rem(i[s]);for(s=e.p1;s<e.i1;++s)n.add(i[s]);n.set(t)}for(s=0;s<o;++s)r[s].update(e,t)};function PK(e,t,n){e=e.map(l=>l9(l,l.field));const r={num:0,agg:null,store:!1,count:t};if(!n)for(var i=e.length,o=r.agg=Array(i),s=0;s<i;++s)o[s]=new e[s](r);if(r.store)var a=r.data=new Ak;return r.add=function(l){if(r.num+=1,!n){a&&a.add(l);for(let u=0;u<i;++u)o[u].add(o[u].get(l),l)}},r.rem=function(l){if(r.num-=1,!n){a&&a.rem(l);for(let u=0;u<i;++u)o[u].rem(o[u].get(l),l)}},r.set=function(l){let u,c;for(a&&a.values(),u=0,c=t.length;u<c;++u)l[t[u]]=r.num;if(!n)for(u=0,c=o.length;u<c;++u)o[u].set(l)},r.init=function(){r.num=0,a&&a.reset();for(let l=0;l<i;++l)o[l].init()},r}function Zk(e){P.call(this,{},e),this._mlen=0,this._mods=[]}Zk.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:OK.concat(_p)},{name:"params",type:"number",null:!0,array:!0},{name:"aggregate_params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]};X(Zk,P,{transform(e,t){this.stamp=t.stamp;const n=e.modified(),r=fu(e.sort),i=qb(e.groupby),o=a=>this.group(i(a));let s=this.state;(!s||n)&&(s=this.state=new M9(e)),n||t.modified(s.inputs)?(this.value={},t.visit(t.SOURCE,a=>o(a).add(a))):(t.visit(t.REM,a=>o(a).remove(a)),t.visit(t.ADD,a=>o(a).add(a)));for(let a=0,l=this._mlen;a<l;++a)LK(this._mods[a],s,r,e);return this._mlen=0,this._mods=[],t.reflow(n).modifies(s.outputs)},group(e){let t=this.value[e];return t||(t=this.value[e]=u9(le),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}});function LK(e,t,n,r){const i=r.sort,o=i&&!r.ignorePeers,s=r.frame||[null,0],a=e.data(n),l=a.length,u=o?Ef(i):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:a,compare:i||bn(-1)};t.init();for(let f=0;f<l;++f)zK(c,s,f,l),o&&IK(c,u),t.update(c,a[f])}function zK(e,t,n,r){e.p0=e.i0,e.p1=e.i1,e.i0=t[0]==null?0:Math.max(0,n-Math.abs(t[0])),e.i1=t[1]==null?r:Math.min(r,n+Math.abs(t[1])+1),e.index=n}function IK(e,t){const n=e.i0,r=e.i1-1,i=e.compare,o=e.data,s=o.length-1;n>0&&!i(o[n],o[n-1])&&(e.i0=t.left(o,o[n])),r<s&&!i(o[r],o[r+1])&&(e.i1=t.right(o,o[r]))}const jK=Object.freeze(Object.defineProperty({__proto__:null,aggregate:ya,bin:Fk,collect:Mk,compare:c9,countpattern:Tk,cross:Nk,density:Rk,dotbin:Ok,expression:g9,extent:Pk,facet:Hy,field:m9,filter:zk,flatten:Ik,fold:jk,formula:Bk,generate:y9,impute:Uk,joinaggregate:Wk,kde:qk,key:v9,load:x9,lookup:Hk,multiextent:w9,multivalues:b9,params:E9,pivot:Vk,prefacet:S9,project:Gk,proxy:_9,quantile:Yk,relay:k9,sample:Xk,sequence:Qk,sieve:C9,subflow:Lk,timeunit:Kk,tupleindex:A9,values:F9,window:Zk},Symbol.toStringTag,{value:"Module"}));function Oe(e){return function(){return e}}const t6=Math.abs,sn=Math.atan2,Ya=Math.cos,BK=Math.max,m2=Math.min,Ui=Math.sin,vl=Math.sqrt,ln=1e-12,Lc=Math.PI,zm=Lc/2,N9=2*Lc;function UK(e){return e>1?0:e<-1?Lc:Math.acos(e)}function n6(e){return e>=1?zm:e<=-1?-zm:Math.asin(e)}const Hb=Math.PI,Vb=2*Hb,ll=1e-6,WK=Vb-ll;function R9(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function qK(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return R9;const n=10**t;return function(r){this._+=r[0];for(let i=1,o=r.length;i<o;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}let Jk=class{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?R9:qK(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,i){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(t,n,r,i,o,s){this._append`C${+t},${+n},${+r},${+i},${this._x1=+o},${this._y1=+s}`}arcTo(t,n,r,i,o){if(t=+t,n=+n,r=+r,i=+i,o=+o,o<0)throw new Error(`negative radius: ${o}`);let s=this._x1,a=this._y1,l=r-t,u=i-n,c=s-t,f=a-n,d=c*c+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(d>ll)if(!(Math.abs(f*l-u*c)>ll)||!o)this._append`L${this._x1=t},${this._y1=n}`;else{let h=r-s,p=i-a,g=l*l+u*u,y=h*h+p*p,m=Math.sqrt(g),v=Math.sqrt(d),x=o*Math.tan((Hb-Math.acos((g+d-y)/(2*m*v)))/2),w=x/v,b=x/m;Math.abs(w-1)>ll&&this._append`L${t+w*c},${n+w*f}`,this._append`A${o},${o},0,0,${+(f*h>c*p)},${this._x1=t+b*l},${this._y1=n+b*u}`}}arc(t,n,r,i,o,s){if(t=+t,n=+n,r=+r,s=!!s,r<0)throw new Error(`negative radius: ${r}`);let a=r*Math.cos(i),l=r*Math.sin(i),u=t+a,c=n+l,f=1^s,d=s?i-o:o-i;this._x1===null?this._append`M${u},${c}`:(Math.abs(this._x1-u)>ll||Math.abs(this._y1-c)>ll)&&this._append`L${u},${c}`,r&&(d<0&&(d=d%Vb+Vb),d>WK?this._append`A${r},${r},0,1,${f},${t-a},${n-l}A${r},${r},0,1,${f},${this._x1=u},${this._y1=c}`:d>ll&&this._append`A${r},${r},0,${+(d>=Hb)},${f},${this._x1=t+r*Math.cos(o)},${this._y1=n+r*Math.sin(o)}`)}rect(t,n,r,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}};function Vy(){return new Jk}Vy.prototype=Jk.prototype;function Gy(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new Jk(t)}function HK(e){return e.innerRadius}function VK(e){return e.outerRadius}function GK(e){return e.startAngle}function YK(e){return e.endAngle}function XK(e){return e&&e.padAngle}function QK(e,t,n,r,i,o,s,a){var l=n-e,u=r-t,c=s-i,f=a-o,d=f*l-c*u;if(!(d*d<ln))return d=(c*(t-o)-f*(e-i))/d,[e+d*l,t+d*u]}function Og(e,t,n,r,i,o,s){var a=e-n,l=t-r,u=(s?o:-o)/vl(a*a+l*l),c=u*l,f=-u*a,d=e+c,h=t+f,p=n+c,g=r+f,y=(d+p)/2,m=(h+g)/2,v=p-d,x=g-h,w=v*v+x*x,b=i-o,S=d*g-p*h,E=(x<0?-1:1)*vl(BK(0,b*b*w-S*S)),_=(S*x-v*E)/w,k=(-S*v-x*E)/w,C=(S*x+v*E)/w,$=(-S*v+x*E)/w,O=_-y,A=k-m,T=C-y,F=$-m;return O*O+A*A>T*T+F*F&&(_=C,k=$),{cx:_,cy:k,x01:-c,y01:-f,x11:_*(i/b-1),y11:k*(i/b-1)}}function KK(){var e=HK,t=VK,n=Oe(0),r=null,i=GK,o=YK,s=XK,a=null,l=Gy(u);function u(){var c,f,d=+e.apply(this,arguments),h=+t.apply(this,arguments),p=i.apply(this,arguments)-zm,g=o.apply(this,arguments)-zm,y=t6(g-p),m=g>p;if(a||(a=c=l()),h<d&&(f=h,h=d,d=f),!(h>ln))a.moveTo(0,0);else if(y>N9-ln)a.moveTo(h*Ya(p),h*Ui(p)),a.arc(0,0,h,p,g,!m),d>ln&&(a.moveTo(d*Ya(g),d*Ui(g)),a.arc(0,0,d,g,p,m));else{var v=p,x=g,w=p,b=g,S=y,E=y,_=s.apply(this,arguments)/2,k=_>ln&&(r?+r.apply(this,arguments):vl(d*d+h*h)),C=m2(t6(h-d)/2,+n.apply(this,arguments)),$=C,O=C,A,T;if(k>ln){var F=n6(k/d*Ui(_)),R=n6(k/h*Ui(_));(S-=F*2)>ln?(F*=m?1:-1,w+=F,b-=F):(S=0,w=b=(p+g)/2),(E-=R*2)>ln?(R*=m?1:-1,v+=R,x-=R):(E=0,v=x=(p+g)/2)}var L=h*Ya(v),N=h*Ui(v),D=d*Ya(b),U=d*Ui(b);if(C>ln){var K=h*Ya(x),se=h*Ui(x),be=d*Ya(w),pe=d*Ui(w),Re;if(y<Lc)if(Re=QK(L,N,be,pe,K,se,D,U)){var At=L-Re[0],Fr=N-Re[1],Cs=K-Re[0],ne=se-Re[1],ye=1/Ui(UK((At*Cs+Fr*ne)/(vl(At*At+Fr*Fr)*vl(Cs*Cs+ne*ne)))/2),xe=vl(Re[0]*Re[0]+Re[1]*Re[1]);$=m2(C,(d-xe)/(ye-1)),O=m2(C,(h-xe)/(ye+1))}else $=O=0}E>ln?O>ln?(A=Og(be,pe,L,N,h,O,m),T=Og(K,se,D,U,h,O,m),a.moveTo(A.cx+A.x01,A.cy+A.y01),O<C?a.arc(A.cx,A.cy,O,sn(A.y01,A.x01),sn(T.y01,T.x01),!m):(a.arc(A.cx,A.cy,O,sn(A.y01,A.x01),sn(A.y11,A.x11),!m),a.arc(0,0,h,sn(A.cy+A.y11,A.cx+A.x11),sn(T.cy+T.y11,T.cx+T.x11),!m),a.arc(T.cx,T.cy,O,sn(T.y11,T.x11),sn(T.y01,T.x01),!m))):(a.moveTo(L,N),a.arc(0,0,h,v,x,!m)):a.moveTo(L,N),!(d>ln)||!(S>ln)?a.lineTo(D,U):$>ln?(A=Og(D,U,K,se,d,-$,m),T=Og(L,N,be,pe,d,-$,m),a.lineTo(A.cx+A.x01,A.cy+A.y01),$<C?a.arc(A.cx,A.cy,$,sn(A.y01,A.x01),sn(T.y01,T.x01),!m):(a.arc(A.cx,A.cy,$,sn(A.y01,A.x01),sn(A.y11,A.x11),!m),a.arc(0,0,d,sn(A.cy+A.y11,A.cx+A.x11),sn(T.cy+T.y11,T.cx+T.x11),m),a.arc(T.cx,T.cy,$,sn(T.y11,T.x11),sn(T.y01,T.x01),!m))):a.arc(0,0,d,b,w,m)}if(a.closePath(),c)return a=null,c+""||null}return u.centroid=function(){var c=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,f=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-Lc/2;return[Ya(f)*c,Ui(f)*c]},u.innerRadius=function(c){return arguments.length?(e=typeof c=="function"?c:Oe(+c),u):e},u.outerRadius=function(c){return arguments.length?(t=typeof c=="function"?c:Oe(+c),u):t},u.cornerRadius=function(c){return arguments.length?(n=typeof c=="function"?c:Oe(+c),u):n},u.padRadius=function(c){return arguments.length?(r=c==null?null:typeof c=="function"?c:Oe(+c),u):r},u.startAngle=function(c){return arguments.length?(i=typeof c=="function"?c:Oe(+c),u):i},u.endAngle=function(c){return arguments.length?(o=typeof c=="function"?c:Oe(+c),u):o},u.padAngle=function(c){return arguments.length?(s=typeof c=="function"?c:Oe(+c),u):s},u.context=function(c){return arguments.length?(a=c??null,u):a},u}function D9(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function O9(e){this._context=e}O9.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function eC(e){return new O9(e)}function P9(e){return e[0]}function L9(e){return e[1]}function z9(e,t){var n=Oe(!0),r=null,i=eC,o=null,s=Gy(a);e=typeof e=="function"?e:e===void 0?P9:Oe(e),t=typeof t=="function"?t:t===void 0?L9:Oe(t);function a(l){var u,c=(l=D9(l)).length,f,d=!1,h;for(r==null&&(o=i(h=s())),u=0;u<=c;++u)!(u<c&&n(f=l[u],u,l))===d&&((d=!d)?o.lineStart():o.lineEnd()),d&&o.point(+e(f,u,l),+t(f,u,l));if(h)return o=null,h+""||null}return a.x=function(l){return arguments.length?(e=typeof l=="function"?l:Oe(+l),a):e},a.y=function(l){return arguments.length?(t=typeof l=="function"?l:Oe(+l),a):t},a.defined=function(l){return arguments.length?(n=typeof l=="function"?l:Oe(!!l),a):n},a.curve=function(l){return arguments.length?(i=l,r!=null&&(o=i(r)),a):i},a.context=function(l){return arguments.length?(l==null?r=o=null:o=i(r=l),a):r},a}function I9(e,t,n){var r=null,i=Oe(!0),o=null,s=eC,a=null,l=Gy(u);e=typeof e=="function"?e:e===void 0?P9:Oe(+e),t=typeof t=="function"?t:Oe(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?L9:Oe(+n);function u(f){var d,h,p,g=(f=D9(f)).length,y,m=!1,v,x=new Array(g),w=new Array(g);for(o==null&&(a=s(v=l())),d=0;d<=g;++d){if(!(d<g&&i(y=f[d],d,f))===m)if(m=!m)h=d,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),p=d-1;p>=h;--p)a.point(x[p],w[p]);a.lineEnd(),a.areaEnd()}m&&(x[d]=+e(y,d,f),w[d]=+t(y,d,f),a.point(r?+r(y,d,f):x[d],n?+n(y,d,f):w[d]))}if(v)return a=null,v+""||null}function c(){return z9().defined(i).curve(s).context(o)}return u.x=function(f){return arguments.length?(e=typeof f=="function"?f:Oe(+f),r=null,u):e},u.x0=function(f){return arguments.length?(e=typeof f=="function"?f:Oe(+f),u):e},u.x1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:Oe(+f),u):r},u.y=function(f){return arguments.length?(t=typeof f=="function"?f:Oe(+f),n=null,u):t},u.y0=function(f){return arguments.length?(t=typeof f=="function"?f:Oe(+f),u):t},u.y1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:Oe(+f),u):n},u.lineX0=u.lineY0=function(){return c().x(e).y(t)},u.lineY1=function(){return c().x(e).y(n)},u.lineX1=function(){return c().x(r).y(t)},u.defined=function(f){return arguments.length?(i=typeof f=="function"?f:Oe(!!f),u):i},u.curve=function(f){return arguments.length?(s=f,o!=null&&(a=s(o)),u):s},u.context=function(f){return arguments.length?(f==null?o=a=null:a=s(o=f),u):o},u}const ZK={draw(e,t){const n=vl(t/Lc);e.moveTo(n,0),e.arc(0,0,n,0,N9)}};function JK(e,t){let n=null,r=Gy(i);e=typeof e=="function"?e:Oe(e||ZK),t=typeof t=="function"?t:Oe(t===void 0?64:+t);function i(){let o;if(n||(n=o=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),o)return n=null,o+""||null}return i.type=function(o){return arguments.length?(e=typeof o=="function"?o:Oe(o),i):e},i.size=function(o){return arguments.length?(t=typeof o=="function"?o:Oe(+o),i):t},i.context=function(o){return arguments.length?(n=o??null,i):n},i}function va(){}function Im(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function Yy(e){this._context=e}Yy.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Im(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Im(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function eZ(e){return new Yy(e)}function j9(e){this._context=e}j9.prototype={areaStart:va,areaEnd:va,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Im(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function tZ(e){return new j9(e)}function B9(e){this._context=e}B9.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:Im(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function nZ(e){return new B9(e)}function U9(e,t){this._basis=new Yy(e),this._beta=t}U9.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r=e[0],i=t[0],o=e[n]-r,s=t[n]-i,a=-1,l;++a<=n;)l=a/n,this._basis.point(this._beta*e[a]+(1-this._beta)*(r+l*o),this._beta*t[a]+(1-this._beta)*(i+l*s));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const rZ=function e(t){function n(r){return t===1?new Yy(r):new U9(r,t)}return n.beta=function(r){return e(+r)},n}(.85);function jm(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function tC(e,t){this._context=e,this._k=(1-t)/6}tC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:jm(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:jm(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const iZ=function e(t){function n(r){return new tC(r,t)}return n.tension=function(r){return e(+r)},n}(0);function nC(e,t){this._context=e,this._k=(1-t)/6}nC.prototype={areaStart:va,areaEnd:va,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:jm(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const oZ=function e(t){function n(r){return new nC(r,t)}return n.tension=function(r){return e(+r)},n}(0);function rC(e,t){this._context=e,this._k=(1-t)/6}rC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:jm(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const sZ=function e(t){function n(r){return new rC(r,t)}return n.tension=function(r){return e(+r)},n}(0);function iC(e,t,n){var r=e._x1,i=e._y1,o=e._x2,s=e._y2;if(e._l01_a>ln){var a=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,l=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*a-e._x0*e._l12_2a+e._x2*e._l01_2a)/l,i=(i*a-e._y0*e._l12_2a+e._y2*e._l01_2a)/l}if(e._l23_a>ln){var u=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);o=(o*u+e._x1*e._l23_2a-t*e._l12_2a)/c,s=(s*u+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(r,i,o,s,e._x2,e._y2)}function W9(e,t){this._context=e,this._alpha=t}W9.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:iC(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const aZ=function e(t){function n(r){return t?new W9(r,t):new tC(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function q9(e,t){this._context=e,this._alpha=t}q9.prototype={areaStart:va,areaEnd:va,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:iC(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const lZ=function e(t){function n(r){return t?new q9(r,t):new nC(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function H9(e,t){this._context=e,this._alpha=t}H9.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:iC(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const uZ=function e(t){function n(r){return t?new H9(r,t):new rC(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function V9(e){this._context=e}V9.prototype={areaStart:va,areaEnd:va,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function cZ(e){return new V9(e)}function r6(e){return e<0?-1:1}function i6(e,t,n){var r=e._x1-e._x0,i=t-e._x1,o=(e._y1-e._y0)/(r||i<0&&-0),s=(n-e._y1)/(i||r<0&&-0),a=(o*i+s*r)/(r+i);return(r6(o)+r6(s))*Math.min(Math.abs(o),Math.abs(s),.5*Math.abs(a))||0}function o6(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function y2(e,t,n){var r=e._x0,i=e._y0,o=e._x1,s=e._y1,a=(o-r)/3;e._context.bezierCurveTo(r+a,i+a*t,o-a,s-a*n,o,s)}function Bm(e){this._context=e}Bm.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:y2(this,this._t0,o6(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,y2(this,o6(this,n=i6(this,e,t)),n);break;default:y2(this,this._t0,n=i6(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function G9(e){this._context=new Y9(e)}(G9.prototype=Object.create(Bm.prototype)).point=function(e,t){Bm.prototype.point.call(this,t,e)};function Y9(e){this._context=e}Y9.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,o){this._context.bezierCurveTo(t,e,r,n,o,i)}};function fZ(e){return new Bm(e)}function dZ(e){return new G9(e)}function X9(e){this._context=e}X9.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=s6(e),i=s6(t),o=0,s=1;s<n;++o,++s)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],e[s],t[s]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function s6(e){var t,n=e.length-1,r,i=new Array(n),o=new Array(n),s=new Array(n);for(i[0]=0,o[0]=2,s[0]=e[0]+2*e[1],t=1;t<n-1;++t)i[t]=1,o[t]=4,s[t]=4*e[t]+2*e[t+1];for(i[n-1]=2,o[n-1]=7,s[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=i[t]/o[t-1],o[t]-=r,s[t]-=r*s[t-1];for(i[n-1]=s[n-1]/o[n-1],t=n-2;t>=0;--t)i[t]=(s[t]-i[t+1])/o[t];for(o[n-1]=(e[n]+i[n-1])/2,t=0;t<n-1;++t)o[t]=2*e[t+1]-i[t+1];return[i,o]}function hZ(e){return new X9(e)}function Xy(e,t){this._context=e,this._t=t}Xy.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function pZ(e){return new Xy(e,.5)}function gZ(e){return new Xy(e,0)}function mZ(e){return new Xy(e,1)}function ca(e,t){if(typeof document<"u"&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}const yZ=()=>typeof Image<"u"?Image:null;function bo(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Oa(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Gb=Symbol("implicit");function oC(){var e=new S4,t=[],n=[],r=Gb;function i(o){let s=e.get(o);if(s===void 0){if(r!==Gb)return r;e.set(o,s=t.push(o)-1)}return n[s%n.length]}return i.domain=function(o){if(!arguments.length)return t.slice();t=[],e=new S4;for(const s of o)e.has(s)||e.set(s,t.push(s)-1);return i},i.range=function(o){return arguments.length?(n=Array.from(o),i):n.slice()},i.unknown=function(o){return arguments.length?(r=o,i):r},i.copy=function(){return oC(t,n).unknown(r)},bo.apply(i,arguments),i}function Af(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function kp(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Pa(){}var Bl=.7,zc=1/Bl,gc="\\s*([+-]?\\d+)\\s*",qh="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",io="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",vZ=/^#([0-9a-f]{3,8})$/,xZ=new RegExp(`^rgb\\(${gc},${gc},${gc}\\)$`),wZ=new RegExp(`^rgb\\(${io},${io},${io}\\)$`),bZ=new RegExp(`^rgba\\(${gc},${gc},${gc},${qh}\\)$`),EZ=new RegExp(`^rgba\\(${io},${io},${io},${qh}\\)$`),SZ=new RegExp(`^hsl\\(${qh},${io},${io}\\)$`),_Z=new RegExp(`^hsla\\(${qh},${io},${io},${qh}\\)$`),a6={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Af(Pa,Hh,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:l6,formatHex:l6,formatHex8:kZ,formatHsl:CZ,formatRgb:u6,toString:u6});function l6(){return this.rgb().formatHex()}function kZ(){return this.rgb().formatHex8()}function CZ(){return Q9(this).formatHsl()}function u6(){return this.rgb().formatRgb()}function Hh(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=vZ.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?c6(t):n===3?new Nt(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Pg(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Pg(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=xZ.exec(e))?new Nt(t[1],t[2],t[3],1):(t=wZ.exec(e))?new Nt(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=bZ.exec(e))?Pg(t[1],t[2],t[3],t[4]):(t=EZ.exec(e))?Pg(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=SZ.exec(e))?h6(t[1],t[2]/100,t[3]/100,1):(t=_Z.exec(e))?h6(t[1],t[2]/100,t[3]/100,t[4]):a6.hasOwnProperty(e)?c6(a6[e]):e==="transparent"?new Nt(NaN,NaN,NaN,0):null}function c6(e){return new Nt(e>>16&255,e>>8&255,e&255,1)}function Pg(e,t,n,r){return r<=0&&(e=t=n=NaN),new Nt(e,t,n,r)}function sC(e){return e instanceof Pa||(e=Hh(e)),e?(e=e.rgb(),new Nt(e.r,e.g,e.b,e.opacity)):new Nt}function xa(e,t,n,r){return arguments.length===1?sC(e):new Nt(e,t,n,r??1)}function Nt(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Af(Nt,xa,kp(Pa,{brighter(e){return e=e==null?zc:Math.pow(zc,e),new Nt(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Bl:Math.pow(Bl,e),new Nt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Nt($l(this.r),$l(this.g),$l(this.b),Um(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:f6,formatHex:f6,formatHex8:$Z,formatRgb:d6,toString:d6}));function f6(){return`#${xl(this.r)}${xl(this.g)}${xl(this.b)}`}function $Z(){return`#${xl(this.r)}${xl(this.g)}${xl(this.b)}${xl((isNaN(this.opacity)?1:this.opacity)*255)}`}function d6(){const e=Um(this.opacity);return`${e===1?"rgb(":"rgba("}${$l(this.r)}, ${$l(this.g)}, ${$l(this.b)}${e===1?")":`, ${e})`}`}function Um(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function $l(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function xl(e){return e=$l(e),(e<16?"0":"")+e.toString(16)}function h6(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new pi(e,t,n,r)}function Q9(e){if(e instanceof pi)return new pi(e.h,e.s,e.l,e.opacity);if(e instanceof Pa||(e=Hh(e)),!e)return new pi;if(e instanceof pi)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),s=NaN,a=o-i,l=(o+i)/2;return a?(t===o?s=(n-r)/a+(n<r)*6:n===o?s=(r-t)/a+2:s=(t-n)/a+4,a/=l<.5?o+i:2-o-i,s*=60):a=l>0&&l<1?0:s,new pi(s,a,l,e.opacity)}function Wm(e,t,n,r){return arguments.length===1?Q9(e):new pi(e,t,n,r??1)}function pi(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Af(pi,Wm,kp(Pa,{brighter(e){return e=e==null?zc:Math.pow(zc,e),new pi(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Bl:Math.pow(Bl,e),new pi(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Nt(v2(e>=240?e-240:e+120,i,r),v2(e,i,r),v2(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new pi(p6(this.h),Lg(this.s),Lg(this.l),Um(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Um(this.opacity);return`${e===1?"hsl(":"hsla("}${p6(this.h)}, ${Lg(this.s)*100}%, ${Lg(this.l)*100}%${e===1?")":`, ${e})`}`}}));function p6(e){return e=(e||0)%360,e<0?e+360:e}function Lg(e){return Math.max(0,Math.min(1,e||0))}function v2(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const K9=Math.PI/180,Z9=180/Math.PI,qm=18,J9=.96422,eO=1,tO=.82521,nO=4/29,mc=6/29,rO=3*mc*mc,AZ=mc*mc*mc;function iO(e){if(e instanceof oo)return new oo(e.l,e.a,e.b,e.opacity);if(e instanceof Xo)return oO(e);e instanceof Nt||(e=sC(e));var t=E2(e.r),n=E2(e.g),r=E2(e.b),i=x2((.2225045*t+.7168786*n+.0606169*r)/eO),o,s;return t===n&&n===r?o=s=i:(o=x2((.4360747*t+.3850649*n+.1430804*r)/J9),s=x2((.0139322*t+.0971045*n+.7141733*r)/tO)),new oo(116*i-16,500*(o-i),200*(i-s),e.opacity)}function Hm(e,t,n,r){return arguments.length===1?iO(e):new oo(e,t,n,r??1)}function oo(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}Af(oo,Hm,kp(Pa,{brighter(e){return new oo(this.l+qm*(e??1),this.a,this.b,this.opacity)},darker(e){return new oo(this.l-qm*(e??1),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=J9*w2(t),e=eO*w2(e),n=tO*w2(n),new Nt(b2(3.1338561*t-1.6168667*e-.4906146*n),b2(-.9787684*t+1.9161415*e+.033454*n),b2(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function x2(e){return e>AZ?Math.pow(e,1/3):e/rO+nO}function w2(e){return e>mc?e*e*e:rO*(e-nO)}function b2(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function E2(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function FZ(e){if(e instanceof Xo)return new Xo(e.h,e.c,e.l,e.opacity);if(e instanceof oo||(e=iO(e)),e.a===0&&e.b===0)return new Xo(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*Z9;return new Xo(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function Vm(e,t,n,r){return arguments.length===1?FZ(e):new Xo(e,t,n,r??1)}function Xo(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function oO(e){if(isNaN(e.h))return new oo(e.l,0,0,e.opacity);var t=e.h*K9;return new oo(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}Af(Xo,Vm,kp(Pa,{brighter(e){return new Xo(this.h,this.c,this.l+qm*(e??1),this.opacity)},darker(e){return new Xo(this.h,this.c,this.l-qm*(e??1),this.opacity)},rgb(){return oO(this).rgb()}}));var sO=-.14861,aC=1.78277,lC=-.29227,Qy=-.90649,Vh=1.97294,g6=Vh*Qy,m6=Vh*aC,y6=aC*lC-Qy*sO;function MZ(e){if(e instanceof Al)return new Al(e.h,e.s,e.l,e.opacity);e instanceof Nt||(e=sC(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(y6*r+g6*t-m6*n)/(y6+g6-m6),o=r-i,s=(Vh*(n-i)-lC*o)/Qy,a=Math.sqrt(s*s+o*o)/(Vh*i*(1-i)),l=a?Math.atan2(s,o)*Z9-120:NaN;return new Al(l<0?l+360:l,a,i,e.opacity)}function Yb(e,t,n,r){return arguments.length===1?MZ(e):new Al(e,t,n,r??1)}function Al(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Af(Al,Yb,kp(Pa,{brighter(e){return e=e==null?zc:Math.pow(zc,e),new Al(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Bl:Math.pow(Bl,e),new Al(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*K9,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new Nt(255*(t+n*(sO*r+aC*i)),255*(t+n*(lC*r+Qy*i)),255*(t+n*(Vh*r)),this.opacity)}}));function aO(e,t,n,r,i){var o=e*e,s=o*e;return((1-3*e+3*o-s)*t+(4-6*o+3*s)*n+(1+3*e+3*o-3*s)*r+s*i)/6}function lO(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],o=e[r+1],s=r>0?e[r-1]:2*i-o,a=r<t-1?e[r+2]:2*o-i;return aO((n-r/t)*t,s,i,o,a)}}function uO(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],o=e[r%t],s=e[(r+1)%t],a=e[(r+2)%t];return aO((n-r/t)*t,i,o,s,a)}}const Ky=e=>()=>e;function cO(e,t){return function(n){return e+n*t}}function TZ(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function Zy(e,t){var n=t-e;return n?cO(e,n>180||n<-180?n-360*Math.round(n/360):n):Ky(isNaN(e)?t:e)}function NZ(e){return(e=+e)==1?Rt:function(t,n){return n-t?TZ(t,n,e):Ky(isNaN(t)?n:t)}}function Rt(e,t){var n=t-e;return n?cO(e,n):Ky(isNaN(e)?t:e)}const Xb=function e(t){var n=NZ(t);function r(i,o){var s=n((i=xa(i)).r,(o=xa(o)).r),a=n(i.g,o.g),l=n(i.b,o.b),u=Rt(i.opacity,o.opacity);return function(c){return i.r=s(c),i.g=a(c),i.b=l(c),i.opacity=u(c),i+""}}return r.gamma=e,r}(1);function fO(e){return function(t){var n=t.length,r=new Array(n),i=new Array(n),o=new Array(n),s,a;for(s=0;s<n;++s)a=xa(t[s]),r[s]=a.r||0,i[s]=a.g||0,o[s]=a.b||0;return r=e(r),i=e(i),o=e(o),a.opacity=1,function(l){return a.r=r(l),a.g=i(l),a.b=o(l),a+""}}}var RZ=fO(lO),DZ=fO(uO);function uC(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(o){for(i=0;i<n;++i)r[i]=e[i]*(1-o)+t[i]*o;return r}}function dO(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function OZ(e,t){return(dO(t)?uC:hO)(e,t)}function hO(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),o=new Array(n),s;for(s=0;s<r;++s)i[s]=La(e[s],t[s]);for(;s<n;++s)o[s]=t[s];return function(a){for(s=0;s<r;++s)o[s]=i[s](a);return o}}function pO(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function di(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function gO(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=La(e[i],t[i]):r[i]=t[i];return function(o){for(i in n)r[i]=n[i](o);return r}}var Qb=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,S2=new RegExp(Qb.source,"g");function PZ(e){return function(){return e}}function LZ(e){return function(t){return e(t)+""}}function mO(e,t){var n=Qb.lastIndex=S2.lastIndex=0,r,i,o,s=-1,a=[],l=[];for(e=e+"",t=t+"";(r=Qb.exec(e))&&(i=S2.exec(t));)(o=i.index)>n&&(o=t.slice(n,o),a[s]?a[s]+=o:a[++s]=o),(r=r[0])===(i=i[0])?a[s]?a[s]+=i:a[++s]=i:(a[++s]=null,l.push({i:s,x:di(r,i)})),n=S2.lastIndex;return n<t.length&&(o=t.slice(n),a[s]?a[s]+=o:a[++s]=o),a.length<2?l[0]?LZ(l[0].x):PZ(t):(t=l.length,function(u){for(var c=0,f;c<t;++c)a[(f=l[c]).i]=f.x(u);return a.join("")})}function La(e,t){var n=typeof t,r;return t==null||n==="boolean"?Ky(t):(n==="number"?di:n==="string"?(r=Hh(t))?(t=r,Xb):mO:t instanceof Hh?Xb:t instanceof Date?pO:dO(t)?uC:Array.isArray(t)?hO:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?gO:di)(e,t)}function zZ(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function IZ(e,t){var n=Zy(+e,+t);return function(r){var i=n(r);return i-360*Math.floor(i/360)}}function Cp(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var v6=180/Math.PI,Kb={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function yO(e,t,n,r,i,o){var s,a,l;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,l/=a),e*r<t*n&&(e=-e,t=-t,l=-l,s=-s),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*v6,skewX:Math.atan(l)*v6,scaleX:s,scaleY:a}}var zg;function jZ(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Kb:yO(t.a,t.b,t.c,t.d,t.e,t.f)}function BZ(e){return e==null||(zg||(zg=document.createElementNS("http://www.w3.org/2000/svg","g")),zg.setAttribute("transform",e),!(e=zg.transform.baseVal.consolidate()))?Kb:(e=e.matrix,yO(e.a,e.b,e.c,e.d,e.e,e.f))}function vO(e,t,n,r){function i(u){return u.length?u.pop()+" ":""}function o(u,c,f,d,h,p){if(u!==f||c!==d){var g=h.push("translate(",null,t,null,n);p.push({i:g-4,x:di(u,f)},{i:g-2,x:di(c,d)})}else(f||d)&&h.push("translate("+f+t+d+n)}function s(u,c,f,d){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),d.push({i:f.push(i(f)+"rotate(",null,r)-2,x:di(u,c)})):c&&f.push(i(f)+"rotate("+c+r)}function a(u,c,f,d){u!==c?d.push({i:f.push(i(f)+"skewX(",null,r)-2,x:di(u,c)}):c&&f.push(i(f)+"skewX("+c+r)}function l(u,c,f,d,h,p){if(u!==f||c!==d){var g=h.push(i(h)+"scale(",null,",",null,")");p.push({i:g-4,x:di(u,f)},{i:g-2,x:di(c,d)})}else(f!==1||d!==1)&&h.push(i(h)+"scale("+f+","+d+")")}return function(u,c){var f=[],d=[];return u=e(u),c=e(c),o(u.translateX,u.translateY,c.translateX,c.translateY,f,d),s(u.rotate,c.rotate,f,d),a(u.skewX,c.skewX,f,d),l(u.scaleX,u.scaleY,c.scaleX,c.scaleY,f,d),u=c=null,function(h){for(var p=-1,g=d.length,y;++p<g;)f[(y=d[p]).i]=y.x(h);return f.join("")}}}var UZ=vO(jZ,"px, ","px)","deg)"),WZ=vO(BZ,", ",")",")"),qZ=1e-12;function x6(e){return((e=Math.exp(e))+1/e)/2}function HZ(e){return((e=Math.exp(e))-1/e)/2}function VZ(e){return((e=Math.exp(2*e))-1)/(e+1)}const GZ=function e(t,n,r){function i(o,s){var a=o[0],l=o[1],u=o[2],c=s[0],f=s[1],d=s[2],h=c-a,p=f-l,g=h*h+p*p,y,m;if(g<qZ)m=Math.log(d/u)/t,y=function(E){return[a+E*h,l+E*p,u*Math.exp(t*E*m)]};else{var v=Math.sqrt(g),x=(d*d-u*u+r*g)/(2*u*n*v),w=(d*d-u*u-r*g)/(2*d*n*v),b=Math.log(Math.sqrt(x*x+1)-x),S=Math.log(Math.sqrt(w*w+1)-w);m=(S-b)/t,y=function(E){var _=E*m,k=x6(b),C=u/(n*v)*(k*VZ(t*_+b)-HZ(b));return[a+C*h,l+C*p,u*k/x6(t*_+b)]}}return y.duration=m*1e3*t/Math.SQRT2,y}return i.rho=function(o){var s=Math.max(.001,+o),a=s*s,l=a*a;return e(s,a,l)},i}(Math.SQRT2,2,4);function xO(e){return function(t,n){var r=e((t=Wm(t)).h,(n=Wm(n)).h),i=Rt(t.s,n.s),o=Rt(t.l,n.l),s=Rt(t.opacity,n.opacity);return function(a){return t.h=r(a),t.s=i(a),t.l=o(a),t.opacity=s(a),t+""}}}const YZ=xO(Zy);var XZ=xO(Rt);function QZ(e,t){var n=Rt((e=Hm(e)).l,(t=Hm(t)).l),r=Rt(e.a,t.a),i=Rt(e.b,t.b),o=Rt(e.opacity,t.opacity);return function(s){return e.l=n(s),e.a=r(s),e.b=i(s),e.opacity=o(s),e+""}}function wO(e){return function(t,n){var r=e((t=Vm(t)).h,(n=Vm(n)).h),i=Rt(t.c,n.c),o=Rt(t.l,n.l),s=Rt(t.opacity,n.opacity);return function(a){return t.h=r(a),t.c=i(a),t.l=o(a),t.opacity=s(a),t+""}}}const KZ=wO(Zy);var ZZ=wO(Rt);function bO(e){return function t(n){n=+n;function r(i,o){var s=e((i=Yb(i)).h,(o=Yb(o)).h),a=Rt(i.s,o.s),l=Rt(i.l,o.l),u=Rt(i.opacity,o.opacity);return function(c){return i.h=s(c),i.s=a(c),i.l=l(Math.pow(c,n)),i.opacity=u(c),i+""}}return r.gamma=t,r}(1)}const JZ=bO(Zy);var eJ=bO(Rt);function cC(e,t){t===void 0&&(t=e,e=La);for(var n=0,r=t.length-1,i=t[0],o=new Array(r<0?0:r);n<r;)o[n]=e(i,i=t[++n]);return function(s){var a=Math.max(0,Math.min(r-1,Math.floor(s*=r)));return o[a](s-a)}}function tJ(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}const nJ=Object.freeze(Object.defineProperty({__proto__:null,interpolate:La,interpolateArray:OZ,interpolateBasis:lO,interpolateBasisClosed:uO,interpolateCubehelix:JZ,interpolateCubehelixLong:eJ,interpolateDate:pO,interpolateDiscrete:zZ,interpolateHcl:KZ,interpolateHclLong:ZZ,interpolateHsl:YZ,interpolateHslLong:XZ,interpolateHue:IZ,interpolateLab:QZ,interpolateNumber:di,interpolateNumberArray:uC,interpolateObject:gO,interpolateRgb:Xb,interpolateRgbBasis:RZ,interpolateRgbBasisClosed:DZ,interpolateRound:Cp,interpolateString:mO,interpolateTransformCss:UZ,interpolateTransformSvg:WZ,interpolateZoom:GZ,piecewise:cC,quantize:tJ},Symbol.toStringTag,{value:"Module"}));function rJ(e){return function(){return e}}function Zb(e){return+e}var w6=[0,1];function Xn(e){return e}function Jb(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:rJ(isNaN(t)?NaN:.5)}function iJ(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function oJ(e,t,n){var r=e[0],i=e[1],o=t[0],s=t[1];return i<r?(r=Jb(i,r),o=n(s,o)):(r=Jb(r,i),o=n(o,s)),function(a){return o(r(a))}}function sJ(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),o=new Array(r),s=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<r;)i[s]=Jb(e[s],e[s+1]),o[s]=n(t[s],t[s+1]);return function(a){var l=ga(e,a,1,r)-1;return o[l](i[l](a))}}function $p(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Jy(){var e=w6,t=w6,n=La,r,i,o,s=Xn,a,l,u;function c(){var d=Math.min(e.length,t.length);return s!==Xn&&(s=iJ(e[0],e[d-1])),a=d>2?sJ:oJ,l=u=null,f}function f(d){return d==null||isNaN(d=+d)?o:(l||(l=a(e.map(r),t,n)))(r(s(d)))}return f.invert=function(d){return s(i((u||(u=a(t,e.map(r),di)))(d)))},f.domain=function(d){return arguments.length?(e=Array.from(d,Zb),c()):e.slice()},f.range=function(d){return arguments.length?(t=Array.from(d),c()):t.slice()},f.rangeRound=function(d){return t=Array.from(d),n=Cp,c()},f.clamp=function(d){return arguments.length?(s=d?!0:Xn,c()):s!==Xn},f.interpolate=function(d){return arguments.length?(n=d,c()):n},f.unknown=function(d){return arguments.length?(o=d,f):o},function(d,h){return r=d,i=h,c()}}function EO(){return Jy()(Xn,Xn)}function SO(e,t,n,r){var i=ma(e,t,n),o;switch(r=jl(r??",f"),r.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(o=XR(i,s))&&(r.precision=o),K_(r,s)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(o=QR(i,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=o-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(o=YR(i))&&(r.precision=o-(r.type==="%")*2);break}}return Ay(r)}function hu(e){var t=e.domain;return e.ticks=function(n){var r=t();return Tb(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var i=t();return SO(i[0],i[i.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),i=0,o=r.length-1,s=r[i],a=r[o],l,u,c=10;for(a<s&&(u=s,s=a,a=u,u=i,i=o,o=u);c-- >0;){if(u=Nb(s,a,n),u===l)return r[i]=s,r[o]=a,t(r);if(u>0)s=Math.floor(s/u)*u,a=Math.ceil(a/u)*u;else if(u<0)s=Math.ceil(s*u)/u,a=Math.floor(a*u)/u;else break;l=u}return e},e}function _O(){var e=EO();return e.copy=function(){return $p(e,_O())},bo.apply(e,arguments),hu(e)}function kO(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,Zb),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return kO(e).unknown(t)},e=arguments.length?Array.from(e,Zb):[0,1],hu(n)}function CO(e,t){e=e.slice();var n=0,r=e.length-1,i=e[n],o=e[r],s;return o<i&&(s=n,n=r,r=s,s=i,i=o,o=s),e[n]=t.floor(i),e[r]=t.ceil(o),e}function b6(e){return Math.log(e)}function E6(e){return Math.exp(e)}function aJ(e){return-Math.log(-e)}function lJ(e){return-Math.exp(-e)}function uJ(e){return isFinite(e)?+("1e"+e):e<0?0:e}function cJ(e){return e===10?uJ:e===Math.E?Math.exp:t=>Math.pow(e,t)}function fJ(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function S6(e){return(t,n)=>-e(-t,n)}function fC(e){const t=e(b6,E6),n=t.domain;let r=10,i,o;function s(){return i=fJ(r),o=cJ(r),n()[0]<0?(i=S6(i),o=S6(o),e(aJ,lJ)):e(b6,E6),t}return t.base=function(a){return arguments.length?(r=+a,s()):r},t.domain=function(a){return arguments.length?(n(a),s()):n()},t.ticks=a=>{const l=n();let u=l[0],c=l[l.length-1];const f=c<u;f&&([u,c]=[c,u]);let d=i(u),h=i(c),p,g;const y=a==null?10:+a;let m=[];if(!(r%1)&&h-d<y){if(d=Math.floor(d),h=Math.ceil(h),u>0){for(;d<=h;++d)for(p=1;p<r;++p)if(g=d<0?p/o(-d):p*o(d),!(g<u)){if(g>c)break;m.push(g)}}else for(;d<=h;++d)for(p=r-1;p>=1;--p)if(g=d>0?p/o(-d):p*o(d),!(g<u)){if(g>c)break;m.push(g)}m.length*2<y&&(m=Tb(u,c,y))}else m=Tb(d,h,Math.min(h-d,y)).map(o);return f?m.reverse():m},t.tickFormat=(a,l)=>{if(a==null&&(a=10),l==null&&(l=r===10?"s":","),typeof l!="function"&&(!(r%1)&&(l=jl(l)).precision==null&&(l.trim=!0),l=Ay(l)),a===1/0)return l;const u=Math.max(1,r*a/t.ticks().length);return c=>{let f=c/o(Math.round(i(c)));return f*r<r-.5&&(f*=r),f<=u?l(c):""}},t.nice=()=>n(CO(n(),{floor:a=>o(Math.floor(i(a))),ceil:a=>o(Math.ceil(i(a)))})),t}function $O(){const e=fC(Jy()).domain([1,10]);return e.copy=()=>$p(e,$O()).base(e.base()),bo.apply(e,arguments),e}function _6(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function k6(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function dC(e){var t=1,n=e(_6(t),k6(t));return n.constant=function(r){return arguments.length?e(_6(t=+r),k6(t)):t},hu(n)}function AO(){var e=dC(Jy());return e.copy=function(){return $p(e,AO()).constant(e.constant())},bo.apply(e,arguments)}function C6(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function dJ(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function hJ(e){return e<0?-e*e:e*e}function hC(e){var t=e(Xn,Xn),n=1;function r(){return n===1?e(Xn,Xn):n===.5?e(dJ,hJ):e(C6(n),C6(1/n))}return t.exponent=function(i){return arguments.length?(n=+i,r()):n},hu(t)}function pC(){var e=hC(Jy());return e.copy=function(){return $p(e,pC()).exponent(e.exponent())},bo.apply(e,arguments),e}function pJ(){return pC.apply(null,arguments).exponent(.5)}function FO(){var e=[],t=[],n=[],r;function i(){var s=0,a=Math.max(1,t.length);for(n=new Array(a-1);++s<a;)n[s-1]=UR(e,s/a);return o}function o(s){return s==null||isNaN(s=+s)?r:t[ga(n,s)]}return o.invertExtent=function(s){var a=t.indexOf(s);return a<0?[NaN,NaN]:[a>0?n[a-1]:e[0],a<n.length?n[a]:e[e.length-1]]},o.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let a of s)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Jo),i()},o.range=function(s){return arguments.length?(t=Array.from(s),i()):t.slice()},o.unknown=function(s){return arguments.length?(r=s,o):r},o.quantiles=function(){return n.slice()},o.copy=function(){return FO().domain(e).range(t).unknown(r)},bo.apply(o,arguments)}function MO(){var e=0,t=1,n=1,r=[.5],i=[0,1],o;function s(l){return l!=null&&l<=l?i[ga(r,l,0,n)]:o}function a(){var l=-1;for(r=new Array(n);++l<n;)r[l]=((l+1)*t-(l-n)*e)/(n+1);return s}return s.domain=function(l){return arguments.length?([e,t]=l,e=+e,t=+t,a()):[e,t]},s.range=function(l){return arguments.length?(n=(i=Array.from(l)).length-1,a()):i.slice()},s.invertExtent=function(l){var u=i.indexOf(l);return u<0?[NaN,NaN]:u<1?[e,r[0]]:u>=n?[r[n-1],t]:[r[u-1],r[u]]},s.unknown=function(l){return arguments.length&&(o=l),s},s.thresholds=function(){return r.slice()},s.copy=function(){return MO().domain([e,t]).range(i).unknown(o)},bo.apply(hu(s),arguments)}function TO(){var e=[.5],t=[0,1],n,r=1;function i(o){return o!=null&&o<=o?t[ga(e,o,0,r)]:n}return i.domain=function(o){return arguments.length?(e=Array.from(o),r=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(o){return arguments.length?(t=Array.from(o),r=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(o){var s=t.indexOf(o);return[e[s-1],e[s]]},i.unknown=function(o){return arguments.length?(n=o,i):n},i.copy=function(){return TO().domain(e).range(t).unknown(n)},bo.apply(i,arguments)}function gJ(e){return new Date(e)}function mJ(e){return e instanceof Date?+e:+new Date(+e)}function gC(e,t,n,r,i,o,s,a,l,u){var c=EO(),f=c.invert,d=c.domain,h=u(".%L"),p=u(":%S"),g=u("%I:%M"),y=u("%I %p"),m=u("%a %d"),v=u("%b %d"),x=u("%B"),w=u("%Y");function b(S){return(l(S)<S?h:a(S)<S?p:s(S)<S?g:o(S)<S?y:r(S)<S?i(S)<S?m:v:n(S)<S?x:w)(S)}return c.invert=function(S){return new Date(f(S))},c.domain=function(S){return arguments.length?d(Array.from(S,mJ)):d().map(gJ)},c.ticks=function(S){var E=d();return e(E[0],E[E.length-1],S??10)},c.tickFormat=function(S,E){return E==null?b:u(E)},c.nice=function(S){var E=d();return(!S||typeof S.range!="function")&&(S=t(E[0],E[E.length-1],S??10)),S?d(CO(E,S)):c},c.copy=function(){return $p(c,gC(e,t,n,r,i,o,s,a,l,u))},c}function yJ(){return bo.apply(gC(SY,_Y,fo,Ih,Sf,es,Ty,Fy,Yo,nk).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function vJ(){return bo.apply(gC(bY,EY,ho,jh,_f,la,Ny,My,Yo,rk).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function ev(){var e=0,t=1,n,r,i,o,s=Xn,a=!1,l;function u(f){return f==null||isNaN(f=+f)?l:s(i===0?.5:(f=(o(f)-n)*i,a?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([e,t]=f,n=o(e=+e),r=o(t=+t),i=n===r?0:1/(r-n),u):[e,t]},u.clamp=function(f){return arguments.length?(a=!!f,u):a},u.interpolator=function(f){return arguments.length?(s=f,u):s};function c(f){return function(d){var h,p;return arguments.length?([h,p]=d,s=f(h,p),u):[s(0),s(1)]}}return u.range=c(La),u.rangeRound=c(Cp),u.unknown=function(f){return arguments.length?(l=f,u):l},function(f){return o=f,n=f(e),r=f(t),i=n===r?0:1/(r-n),u}}function za(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function mC(){var e=hu(ev()(Xn));return e.copy=function(){return za(e,mC())},Oa.apply(e,arguments)}function NO(){var e=fC(ev()).domain([1,10]);return e.copy=function(){return za(e,NO()).base(e.base())},Oa.apply(e,arguments)}function RO(){var e=dC(ev());return e.copy=function(){return za(e,RO()).constant(e.constant())},Oa.apply(e,arguments)}function yC(){var e=hC(ev());return e.copy=function(){return za(e,yC()).exponent(e.exponent())},Oa.apply(e,arguments)}function xJ(){return yC.apply(null,arguments).exponent(.5)}function tv(){var e=0,t=.5,n=1,r=1,i,o,s,a,l,u=Xn,c,f=!1,d;function h(g){return isNaN(g=+g)?d:(g=.5+((g=+c(g))-o)*(r*g<r*o?a:l),u(f?Math.max(0,Math.min(1,g)):g))}h.domain=function(g){return arguments.length?([e,t,n]=g,i=c(e=+e),o=c(t=+t),s=c(n=+n),a=i===o?0:.5/(o-i),l=o===s?0:.5/(s-o),r=o<i?-1:1,h):[e,t,n]},h.clamp=function(g){return arguments.length?(f=!!g,h):f},h.interpolator=function(g){return arguments.length?(u=g,h):u};function p(g){return function(y){var m,v,x;return arguments.length?([m,v,x]=y,u=cC(g,[m,v,x]),h):[u(0),u(.5),u(1)]}}return h.range=p(La),h.rangeRound=p(Cp),h.unknown=function(g){return arguments.length?(d=g,h):d},function(g){return c=g,i=g(e),o=g(t),s=g(n),a=i===o?0:.5/(o-i),l=o===s?0:.5/(s-o),r=o<i?-1:1,h}}function DO(){var e=hu(tv()(Xn));return e.copy=function(){return za(e,DO())},Oa.apply(e,arguments)}function OO(){var e=fC(tv()).domain([.1,1,10]);return e.copy=function(){return za(e,OO()).base(e.base())},Oa.apply(e,arguments)}function PO(){var e=dC(tv());return e.copy=function(){return za(e,PO()).constant(e.constant())},Oa.apply(e,arguments)}function vC(){var e=hC(tv());return e.copy=function(){return za(e,vC()).exponent(e.exponent())},Oa.apply(e,arguments)}function wJ(){return vC.apply(null,arguments).exponent(.5)}function Eo(e){for(var t=e.length/6|0,n=new Array(t),r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}const bJ=Eo("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),EJ=Eo("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),SJ=Eo("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),_J=Eo("4269d0efb118ff725c6cc5b03ca951ff8ab7a463f297bbf59c6b4e9498a0"),kJ=Eo("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),CJ=Eo("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),$J=Eo("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),AJ=Eo("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),FJ=Eo("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),MJ=Eo("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f");function xC(e,t,n){const r=e-t+n*2;return e?r>0?r:1:0}const TJ="identity",Ic="linear",ds="log",Ap="pow",Fp="sqrt",nv="symlog",Ul="time",Wl="utc",so="sequential",Ff="diverging",jc="quantile",rv="quantize",iv="threshold",wC="ordinal",eE="point",LO="band",bC="bin-ordinal",$t="continuous",Mp="discrete",Tp="discretizing",Jr="interpolating",EC="temporal";function NJ(e){return function(t){let n=t[0],r=t[1],i;return r<n&&(i=n,n=r,r=i),[e.invert(n),e.invert(r)]}}function RJ(e){return function(t){const n=e.range();let r=t[0],i=t[1],o=-1,s,a,l,u;for(i<r&&(a=r,r=i,i=a),l=0,u=n.length;l<u;++l)n[l]>=r&&n[l]<=i&&(o<0&&(o=l),s=l);if(!(o<0))return r=e.invertExtent(n[o]),i=e.invertExtent(n[s]),[r[0]===void 0?r[1]:r[0],i[1]===void 0?i[0]:i[1]]}}function SC(){const e=oC().unknown(void 0),t=e.domain,n=e.range;let r=[0,1],i,o,s=!1,a=0,l=0,u=.5;delete e.unknown;function c(){const f=t().length,d=r[1]<r[0],h=r[1-d],p=xC(f,a,l);let g=r[d-0];i=(h-g)/(p||1),s&&(i=Math.floor(i)),g+=(h-g-i*(f-a))*u,o=i*(1-a),s&&(g=Math.round(g),o=Math.round(o));const y=mr(f).map(m=>g+i*m);return n(d?y.reverse():y)}return e.domain=function(f){return arguments.length?(t(f),c()):t()},e.range=function(f){return arguments.length?(r=[+f[0],+f[1]],c()):r.slice()},e.rangeRound=function(f){return r=[+f[0],+f[1]],s=!0,c()},e.bandwidth=function(){return o},e.step=function(){return i},e.round=function(f){return arguments.length?(s=!!f,c()):s},e.padding=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),a=l,c()):a},e.paddingInner=function(f){return arguments.length?(a=Math.max(0,Math.min(1,f)),c()):a},e.paddingOuter=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),c()):l},e.align=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),c()):u},e.invertRange=function(f){if(f[0]==null||f[1]==null)return;const d=r[1]<r[0],h=d?n().reverse():n(),p=h.length-1;let g=+f[0],y=+f[1],m,v,x;if(!(g!==g||y!==y)&&(y<g&&(x=g,g=y,y=x),!(y<h[0]||g>r[1-d])))return m=Math.max(0,ga(h,g)-1),v=g===y?m:ga(h,y)-1,g-h[m]>o+1e-10&&++m,d&&(x=m,m=p-v,v=p-x),m>v?void 0:t().slice(m,v+1)},e.invert=function(f){const d=e.invertRange([f,f]);return d&&d[0]},e.copy=function(){return SC().domain(t()).range(r).round(s).paddingInner(a).paddingOuter(l).align(u)},c()}function zO(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return zO(t())},e}function DJ(){return zO(SC().paddingInner(1))}var OJ=Array.prototype.map;function PJ(e){return OJ.call(e,hn)}const LJ=Array.prototype.slice;function IO(){let e=[],t=[];function n(r){return r==null||r!==r?void 0:t[(ga(e,r)-1)%t.length]}return n.domain=function(r){return arguments.length?(e=PJ(r),n):e.slice()},n.range=function(r){return arguments.length?(t=LJ.call(r),n):t.slice()},n.tickFormat=function(r,i){return SO(e[0],Ce(e),r??10,i)},n.copy=function(){return IO().domain(n.domain()).range(n.range())},n}const Gm=new Map,jO=Symbol("vega_scale");function BO(e){return e[jO]=!0,e}function zJ(e){return e&&e[jO]===!0}function IJ(e,t,n){const r=function(){const o=t();return o.invertRange||(o.invertRange=o.invert?NJ(o):o.invertExtent?RJ(o):void 0),o.type=e,BO(o)};return r.metadata=ki(J(n)),r}function Ne(e,t,n){return arguments.length>1?(Gm.set(e,IJ(e,t,n)),this):UO(e)?Gm.get(e):void 0}Ne(TJ,kO);Ne(Ic,_O,$t);Ne(ds,$O,[$t,ds]);Ne(Ap,pC,$t);Ne(Fp,pJ,$t);Ne(nv,AO,$t);Ne(Ul,yJ,[$t,EC]);Ne(Wl,vJ,[$t,EC]);Ne(so,mC,[$t,Jr]);Ne(`${so}-${Ic}`,mC,[$t,Jr]);Ne(`${so}-${ds}`,NO,[$t,Jr,ds]);Ne(`${so}-${Ap}`,yC,[$t,Jr]);Ne(`${so}-${Fp}`,xJ,[$t,Jr]);Ne(`${so}-${nv}`,RO,[$t,Jr]);Ne(`${Ff}-${Ic}`,DO,[$t,Jr]);Ne(`${Ff}-${ds}`,OO,[$t,Jr,ds]);Ne(`${Ff}-${Ap}`,vC,[$t,Jr]);Ne(`${Ff}-${Fp}`,wJ,[$t,Jr]);Ne(`${Ff}-${nv}`,PO,[$t,Jr]);Ne(jc,FO,[Tp,jc]);Ne(rv,MO,Tp);Ne(iv,TO,Tp);Ne(bC,IO,[Mp,Tp]);Ne(wC,oC,Mp);Ne(LO,SC,Mp);Ne(eE,DJ,Mp);function UO(e){return Gm.has(e)}function pu(e,t){const n=Gm.get(e);return n&&n.metadata[t]}function _C(e){return pu(e,$t)}function Bc(e){return pu(e,Mp)}function tE(e){return pu(e,Tp)}function WO(e){return pu(e,ds)}function jJ(e){return pu(e,EC)}function qO(e){return pu(e,Jr)}function HO(e){return pu(e,jc)}const BJ=["clamp","base","constant","exponent"];function VO(e,t){const n=t[0],r=Ce(t)-n;return function(i){return e(n+i*r)}}function ov(e,t,n){return cC(kC(t||"rgb",n),e)}function GO(e,t){const n=new Array(t),r=t+1;for(let i=0;i<t;)n[i]=e(++i/r);return n}function YO(e,t,n){const r=n-t;let i,o,s;return!r||!Number.isFinite(r)?bn(.5):(i=(o=e.type).indexOf("-"),o=i<0?o:o.slice(i+1),s=Ne(o)().domain([t,n]).range([0,1]),BJ.forEach(a=>e[a]?s[a](e[a]()):0),s)}function kC(e,t){const n=nJ[UJ(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function UJ(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}const WJ={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},qJ={accent:EJ,category10:bJ,category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",dark2:SJ,observable10:_J,paired:kJ,pastel1:CJ,pastel2:$J,set1:AJ,set2:FJ,set3:MJ,tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5"};function XO(e){if(j(e))return e;const t=e.length/6|0,n=new Array(t);for(let r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}function QO(e,t){for(const n in e)CC(n,t(e[n]))}const $6={};QO(qJ,XO);QO(WJ,e=>ov(XO(e)));function CC(e,t){return e=e&&e.toLowerCase(),arguments.length>1?($6[e]=t,this):$6[e]}const D0="symbol",HJ="discrete",VJ="gradient",GJ=e=>j(e)?e.map(t=>String(t)):String(e),YJ=(e,t)=>e[1]-t[1],XJ=(e,t)=>t[1]-e[1];function $C(e,t,n){let r;return Me(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),n!=null&&(t=Math.min(t,Math.floor(bp(e.domain())/n||1)+1))),Z(t)&&(r=t.step,t=t.interval),ee(t)&&(t=e.type===Ul?kf(t):e.type==Wl?Cf(t):I("Only time and utc scales accept interval strings."),r&&(t=t.every(r))),t}function KO(e,t,n){let r=e.range(),i=r[0],o=Ce(r),s=YJ;if(i>o&&(r=o,o=i,i=r,s=XJ),i=Math.floor(i),o=Math.ceil(o),t=t.map(a=>[a,e(a)]).filter(a=>i<=a[1]&&a[1]<=o).sort(s).map(a=>a[0]),n>0&&t.length>1){const a=[t[0],Ce(t)];for(;t.length>n&&t.length>=3;)t=t.filter((l,u)=>!(u%2));t.length<3&&(t=a)}return t}function AC(e,t){return e.bins?KO(e,e.bins,t):e.ticks?e.ticks(t):e.domain()}function ZO(e,t,n,r,i,o){const s=t.type;let a=GJ;if(s===Ul||i===Ul)a=e.timeFormat(r);else if(s===Wl||i===Wl)a=e.utcFormat(r);else if(WO(s)){const l=e.formatFloat(r);if(o||t.bins)a=l;else{const u=JO(t,n,!1);a=c=>u(c)?l(c):""}}else if(t.tickFormat){const l=t.domain();a=e.formatSpan(l[0],l[l.length-1],n,r)}else r&&(a=e.format(r));return a}function JO(e,t,n){const r=AC(e,t),i=e.base(),o=Math.log(i),s=Math.max(1,i*t/r.length),a=l=>{let u=l/Math.pow(i,Math.round(Math.log(l)/o));return u*i<i-.5&&(u*=i),u<=s};return n?r.filter(a):a}const nE={[jc]:"quantiles",[rv]:"thresholds",[iv]:"domain"},eP={[jc]:"quantiles",[rv]:"domain"};function tP(e,t){return e.bins?ZJ(e.bins):e.type===ds?JO(e,t,!0):nE[e.type]?KJ(e[nE[e.type]]()):AC(e,t)}function QJ(e,t,n){const r=t[eP[t.type]](),i=r.length;let o=i>1?r[1]-r[0]:r[0],s;for(s=1;s<i;++s)o=Math.min(o,r[s]-r[s-1]);return e.formatSpan(0,o,3*10,n)}function KJ(e){const t=[-1/0].concat(e);return t.max=1/0,t}function ZJ(e){const t=e.slice(0,-1);return t.max=Ce(e),t}const JJ=e=>nE[e.type]||e.bins;function nP(e,t,n,r,i,o,s){const a=eP[t.type]&&o!==Ul&&o!==Wl?QJ(e,t,i):ZO(e,t,n,i,o,s);return r===D0&&JJ(t)?eee(a):r===HJ?tee(a):nee(a)}const eee=e=>(t,n,r)=>{const i=A6(r[n+1],A6(r.max,1/0)),o=F6(t,e),s=F6(i,e);return o&&s?o+" – "+s:s?"< "+s:"≥ "+o},A6=(e,t)=>e??t,tee=e=>(t,n)=>n?e(t):null,nee=e=>t=>e(t),F6=(e,t)=>Number.isFinite(e)?t(e):null;function ree(e){const t=e.domain(),n=t.length-1;let r=+t[0],i=+Ce(t),o=i-r;if(e.type===iv){const s=n?o/n:.1;r-=s,i+=s,o=i-r}return s=>(s-r)/o}function iee(e,t,n,r){const i=r||t.type;return ee(n)&&jJ(i)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),!n&&i===Ul?e.timeFormat("%A, %d %B %Y, %X"):!n&&i===Wl?e.utcFormat("%A, %d %B %Y, %X UTC"):nP(e,t,5,null,n,r,!0)}function rP(e,t,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=iee(e,t,n.format,n.formatType);if(tE(t.type)){const o=tP(t).slice(1).map(i),s=o.length;return`${s} boundar${s===1?"y":"ies"}: ${o.join(", ")}`}else if(Bc(t.type)){const o=t.domain(),s=o.length,a=s>r?o.slice(0,r-2).map(i).join(", ")+", ending with "+o.slice(-1).map(i):o.map(i).join(", ");return`${s} value${s===1?"":"s"}: ${a}`}else{const o=t.domain();return`values from ${i(o[0])} to ${i(Ce(o))}`}}let iP=0;function oee(){iP=0}const Ym="p_";function FC(e){return e&&e.gradient}function oP(e,t,n){const r=e.gradient;let i=e.id,o=r==="radial"?Ym:"";return i||(i=e.id="gradient_"+iP++,r==="radial"?(e.x1=Wi(e.x1,.5),e.y1=Wi(e.y1,.5),e.r1=Wi(e.r1,0),e.x2=Wi(e.x2,.5),e.y2=Wi(e.y2,.5),e.r2=Wi(e.r2,.5),o=Ym):(e.x1=Wi(e.x1,0),e.y1=Wi(e.y1,0),e.x2=Wi(e.x2,1),e.y2=Wi(e.y2,0))),t[i]=e,"url("+(n||"")+"#"+o+i+")"}function Wi(e,t){return e??t}function sP(e,t){var n=[],r;return r={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(i,o){return n.push({offset:i,color:o}),r}}}const M6={basis:{curve:eZ},"basis-closed":{curve:tZ},"basis-open":{curve:nZ},bundle:{curve:rZ,tension:"beta",value:.85},cardinal:{curve:iZ,tension:"tension",value:0},"cardinal-open":{curve:sZ,tension:"tension",value:0},"cardinal-closed":{curve:oZ,tension:"tension",value:0},"catmull-rom":{curve:aZ,tension:"alpha",value:.5},"catmull-rom-closed":{curve:lZ,tension:"alpha",value:.5},"catmull-rom-open":{curve:uZ,tension:"alpha",value:.5},linear:{curve:eC},"linear-closed":{curve:cZ},monotone:{horizontal:dZ,vertical:fZ},natural:{curve:hZ},step:{curve:pZ},"step-after":{curve:mZ},"step-before":{curve:gZ}};function MC(e,t,n){var r=te(M6,e)&&M6[e],i=null;return r&&(i=r.curve||r[t||"vertical"],r.tension&&n!=null&&(i=i[r.tension](n))),i}const see={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},aee=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,lee=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,uee=/^((\s+,?\s*)|(,\s*))/,cee=/^[01]/;function Uc(e){const t=[];return(e.match(aee)||[]).forEach(r=>{let i=r[0];const o=i.toLowerCase(),s=see[o],a=fee(o,s,r.slice(1).trim()),l=a.length;if(l<s||l&&l%s!==0)throw Error("Invalid SVG path, incorrect parameter count");if(t.push([i,...a.slice(0,s)]),l!==s){o==="m"&&(i=i==="M"?"L":"l");for(let u=s;u<l;u+=s)t.push([i,...a.slice(u,u+s)])}}),t}function fee(e,t,n){const r=[];for(let i=0;t&&i<n.length;)for(let o=0;o<t;++o){const s=e==="a"&&(o===3||o===4)?cee:lee,a=n.slice(i).match(s);if(a===null)throw Error("Invalid SVG path, incorrect parameter type");i+=a[0].length,r.push(+a[0]);const l=n.slice(i).match(uee);l!==null&&(i+=l[0].length)}return r}const wa=Math.PI/180,dee=1e-14,fl=Math.PI/2,Ki=Math.PI*2,Mu=Math.sqrt(3)/2;var _2={},k2={},aP=[].join;function hee(e,t,n,r,i,o,s,a,l){const u=aP.call(arguments);if(_2[u])return _2[u];const c=s*wa,f=Math.sin(c),d=Math.cos(c);n=Math.abs(n),r=Math.abs(r);const h=d*(a-e)*.5+f*(l-t)*.5,p=d*(l-t)*.5-f*(a-e)*.5;let g=h*h/(n*n)+p*p/(r*r);g>1&&(g=Math.sqrt(g),n*=g,r*=g);const y=d/n,m=f/n,v=-f/r,x=d/r,w=y*a+m*l,b=v*a+x*l,S=y*e+m*t,E=v*e+x*t;let k=1/((S-w)*(S-w)+(E-b)*(E-b))-.25;k<0&&(k=0);let C=Math.sqrt(k);o==i&&(C=-C);const $=.5*(w+S)-C*(E-b),O=.5*(b+E)+C*(S-w),A=Math.atan2(b-O,w-$);let F=Math.atan2(E-O,S-$)-A;F<0&&o===1?F+=Ki:F>0&&o===0&&(F-=Ki);const R=Math.ceil(Math.abs(F/(fl+.001))),L=[];for(let N=0;N<R;++N){const D=A+N*F/R,U=A+(N+1)*F/R;L[N]=[$,O,D,U,n,r,f,d]}return _2[u]=L}function pee(e){const t=aP.call(e);if(k2[t])return k2[t];var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],l=e[6],u=e[7];const c=u*s,f=-l*a,d=l*s,h=u*a,p=Math.cos(i),g=Math.sin(i),y=Math.cos(o),m=Math.sin(o),v=.5*(o-i),x=Math.sin(v*.5),w=8/3*x*x/Math.sin(v),b=n+p-w*g,S=r+g+w*p,E=n+y,_=r+m,k=E+w*m,C=_-w*y;return k2[t]=[c*b+f*S,d*b+h*S,c*k+f*C,d*k+h*C,c*E+f*_,d*E+h*_]}const Mr=["l",0,0,0,0,0,0,0];function gee(e,t,n){const r=Mr[0]=e[0];if(r==="a"||r==="A")Mr[1]=t*e[1],Mr[2]=n*e[2],Mr[3]=e[3],Mr[4]=e[4],Mr[5]=e[5],Mr[6]=t*e[6],Mr[7]=n*e[7];else if(r==="h"||r==="H")Mr[1]=t*e[1];else if(r==="v"||r==="V")Mr[1]=n*e[1];else for(var i=1,o=e.length;i<o;++i)Mr[i]=(i%2==1?t:n)*e[i];return Mr}function Gh(e,t,n,r,i,o){var s,a=null,l=0,u=0,c=0,f=0,d,h,p,g,y=0,m=0;n==null&&(n=0),r==null&&(r=0),i==null&&(i=1),o==null&&(o=i),e.beginPath&&e.beginPath();for(var v=0,x=t.length;v<x;++v){switch(s=t[v],(i!==1||o!==1)&&(s=gee(s,i,o)),s[0]){case"l":l+=s[1],u+=s[2],e.lineTo(l+n,u+r);break;case"L":l=s[1],u=s[2],e.lineTo(l+n,u+r);break;case"h":l+=s[1],e.lineTo(l+n,u+r);break;case"H":l=s[1],e.lineTo(l+n,u+r);break;case"v":u+=s[1],e.lineTo(l+n,u+r);break;case"V":u=s[1],e.lineTo(l+n,u+r);break;case"m":l+=s[1],u+=s[2],y=l,m=u,e.moveTo(l+n,u+r);break;case"M":l=s[1],u=s[2],y=l,m=u,e.moveTo(l+n,u+r);break;case"c":d=l+s[5],h=u+s[6],c=l+s[3],f=u+s[4],e.bezierCurveTo(l+s[1]+n,u+s[2]+r,c+n,f+r,d+n,h+r),l=d,u=h;break;case"C":l=s[5],u=s[6],c=s[3],f=s[4],e.bezierCurveTo(s[1]+n,s[2]+r,c+n,f+r,l+n,u+r);break;case"s":d=l+s[3],h=u+s[4],c=2*l-c,f=2*u-f,e.bezierCurveTo(c+n,f+r,l+s[1]+n,u+s[2]+r,d+n,h+r),c=l+s[1],f=u+s[2],l=d,u=h;break;case"S":d=s[3],h=s[4],c=2*l-c,f=2*u-f,e.bezierCurveTo(c+n,f+r,s[1]+n,s[2]+r,d+n,h+r),l=d,u=h,c=s[1],f=s[2];break;case"q":d=l+s[3],h=u+s[4],c=l+s[1],f=u+s[2],e.quadraticCurveTo(c+n,f+r,d+n,h+r),l=d,u=h;break;case"Q":d=s[3],h=s[4],e.quadraticCurveTo(s[1]+n,s[2]+r,d+n,h+r),l=d,u=h,c=s[1],f=s[2];break;case"t":d=l+s[1],h=u+s[2],a[0].match(/[QqTt]/)===null?(c=l,f=u):a[0]==="t"?(c=2*l-p,f=2*u-g):a[0]==="q"&&(c=2*l-c,f=2*u-f),p=c,g=f,e.quadraticCurveTo(c+n,f+r,d+n,h+r),l=d,u=h,c=l+s[1],f=u+s[2];break;case"T":d=s[1],h=s[2],c=2*l-c,f=2*u-f,e.quadraticCurveTo(c+n,f+r,d+n,h+r),l=d,u=h;break;case"a":T6(e,l+n,u+r,[s[1],s[2],s[3],s[4],s[5],s[6]+l+n,s[7]+u+r]),l+=s[6],u+=s[7];break;case"A":T6(e,l+n,u+r,[s[1],s[2],s[3],s[4],s[5],s[6]+n,s[7]+r]),l=s[6],u=s[7];break;case"z":case"Z":l=y,u=m,e.closePath();break}a=s}}function T6(e,t,n,r){const i=hee(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n);for(let o=0;o<i.length;++o){const s=pee(i[o]);e.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5])}}const N6=.5773502691896257,R6={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,Ki)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r),e.lineTo(-n,r),e.lineTo(-r,r),e.lineTo(-r,n),e.lineTo(r,n),e.lineTo(r,r),e.lineTo(n,r),e.lineTo(n,-r),e.lineTo(r,-r),e.lineTo(r,-n),e.lineTo(-r,-n),e.lineTo(-r,-r),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,i=n/2.5,o=n/8;e.moveTo(-r,n),e.lineTo(r,n),e.lineTo(r,-o),e.lineTo(i,-o),e.lineTo(0,-n),e.lineTo(-i,-o),e.lineTo(-r,-o),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=Mu*n,i=r-n*N6,o=n/4;e.moveTo(0,-r-i),e.lineTo(-o,r-i),e.lineTo(o,r-i),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=Mu*n,i=r-n*N6;e.moveTo(0,-r-i),e.lineTo(-n,r-i),e.lineTo(n,r-i),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Mu*n;e.moveTo(0,-r),e.lineTo(-n,r),e.lineTo(n,r),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Mu*n;e.moveTo(0,r),e.lineTo(-n,-r),e.lineTo(n,-r),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Mu*n;e.moveTo(r,0),e.lineTo(-r,-n),e.lineTo(-r,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Mu*n;e.moveTo(-r,0),e.lineTo(r,-n),e.lineTo(r,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function lP(e){return te(R6,e)?R6[e]:mee(e)}var C2={};function mee(e){if(!te(C2,e)){const t=Uc(e);C2[e]={draw:function(n,r){Gh(n,t,0,0,Math.sqrt(r)/2)}}}return C2[e]}const As=.448084975506;function yee(e){return e.x}function vee(e){return e.y}function xee(e){return e.width}function wee(e){return e.height}function Ro(e){return typeof e=="function"?e:()=>+e}function Ig(e,t,n){return Math.max(t,Math.min(e,n))}function uP(){var e=yee,t=vee,n=xee,r=wee,i=Ro(0),o=i,s=i,a=i,l=null;function u(c,f,d){var h,p=f??+e.call(this,c),g=d??+t.call(this,c),y=+n.call(this,c),m=+r.call(this,c),v=Math.min(y,m)/2,x=Ig(+i.call(this,c),0,v),w=Ig(+o.call(this,c),0,v),b=Ig(+s.call(this,c),0,v),S=Ig(+a.call(this,c),0,v);if(l||(l=h=Vy()),x<=0&&w<=0&&b<=0&&S<=0)l.rect(p,g,y,m);else{var E=p+y,_=g+m;l.moveTo(p+x,g),l.lineTo(E-w,g),l.bezierCurveTo(E-As*w,g,E,g+As*w,E,g+w),l.lineTo(E,_-S),l.bezierCurveTo(E,_-As*S,E-As*S,_,E-S,_),l.lineTo(p+b,_),l.bezierCurveTo(p+As*b,_,p,_-As*b,p,_-b),l.lineTo(p,g+x),l.bezierCurveTo(p,g+As*x,p+As*x,g,p+x,g),l.closePath()}if(h)return l=null,h+""||null}return u.x=function(c){return arguments.length?(e=Ro(c),u):e},u.y=function(c){return arguments.length?(t=Ro(c),u):t},u.width=function(c){return arguments.length?(n=Ro(c),u):n},u.height=function(c){return arguments.length?(r=Ro(c),u):r},u.cornerRadius=function(c,f,d,h){return arguments.length?(i=Ro(c),o=f!=null?Ro(f):i,a=d!=null?Ro(d):i,s=h!=null?Ro(h):o,u):i},u.context=function(c){return arguments.length?(l=c??null,u):l},u}function cP(){var e,t,n,r,i=null,o,s,a,l;function u(f,d,h){const p=h/2;if(o){var g=a-d,y=f-s;if(g||y){var m=Math.hypot(g,y),v=(g/=m)*l,x=(y/=m)*l,w=Math.atan2(y,g);i.moveTo(s-v,a-x),i.lineTo(f-g*p,d-y*p),i.arc(f,d,p,w-Math.PI,w),i.lineTo(s+v,a+x),i.arc(s,a,l,w,w+Math.PI)}else i.arc(f,d,p,0,Ki);i.closePath()}else o=1;s=f,a=d,l=p}function c(f){var d,h=f.length,p,g=!1,y;for(i==null&&(i=y=Vy()),d=0;d<=h;++d)!(d<h&&r(p=f[d],d,f))===g&&(g=!g)&&(o=0),g&&u(+e(p,d,f),+t(p,d,f),+n(p,d,f));if(y)return i=null,y+""||null}return c.x=function(f){return arguments.length?(e=f,c):e},c.y=function(f){return arguments.length?(t=f,c):t},c.size=function(f){return arguments.length?(n=f,c):n},c.defined=function(f){return arguments.length?(r=f,c):r},c.context=function(f){return arguments.length?(f==null?i=null:i=f,c):i},c}function Np(e,t){return e??t}const Rp=e=>e.x||0,Dp=e=>e.y||0,bee=e=>e.width||0,Eee=e=>e.height||0,See=e=>(e.x||0)+(e.width||0),_ee=e=>(e.y||0)+(e.height||0),kee=e=>e.startAngle||0,Cee=e=>e.endAngle||0,$ee=e=>e.padAngle||0,Aee=e=>e.innerRadius||0,Fee=e=>e.outerRadius||0,Mee=e=>e.cornerRadius||0,Tee=e=>Np(e.cornerRadiusTopLeft,e.cornerRadius)||0,Nee=e=>Np(e.cornerRadiusTopRight,e.cornerRadius)||0,Ree=e=>Np(e.cornerRadiusBottomRight,e.cornerRadius)||0,Dee=e=>Np(e.cornerRadiusBottomLeft,e.cornerRadius)||0,Oee=e=>Np(e.size,64),Pee=e=>e.size||1,sv=e=>e.defined!==!1,Lee=e=>lP(e.shape||"circle"),zee=KK().startAngle(kee).endAngle(Cee).padAngle($ee).innerRadius(Aee).outerRadius(Fee).cornerRadius(Mee),Iee=I9().x(Rp).y1(Dp).y0(_ee).defined(sv),jee=I9().y(Dp).x1(Rp).x0(See).defined(sv),Bee=z9().x(Rp).y(Dp).defined(sv),Uee=uP().x(Rp).y(Dp).width(bee).height(Eee).cornerRadius(Tee,Nee,Ree,Dee),Wee=JK().type(Lee).size(Oee),qee=cP().x(Rp).y(Dp).defined(sv).size(Pee);function TC(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function Hee(e,t){return zee.context(e)(t)}function Vee(e,t){const n=t[0],r=n.interpolate||"linear";return(n.orient==="horizontal"?jee:Iee).curve(MC(r,n.orient,n.tension)).context(e)(t)}function Gee(e,t){const n=t[0],r=n.interpolate||"linear";return Bee.curve(MC(r,n.orient,n.tension)).context(e)(t)}function Mf(e,t,n,r){return Uee.context(e)(t,n,r)}function Yee(e,t){return(t.mark.shape||t.shape).context(e)(t)}function Xee(e,t){return Wee.context(e)(t)}function Qee(e,t){return qee.context(e)(t)}var fP=1;function dP(){fP=1}function NC(e,t,n){var r=t.clip,i=e._defs,o=t.clip_id||(t.clip_id="clip"+fP++),s=i.clipping[o]||(i.clipping[o]={id:o});return me(r)?s.path=r(null):TC(n)?s.path=Mf(null,n,0,0):(s.width=n.width||0,s.height=n.height||0),"url(#"+o+")"}function vt(e){this.clear(),e&&this.union(e)}vt.prototype={clone(){return new vt(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,r){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),r<t?(this.y2=t,this.y1=r):(this.y1=t,this.y2=r),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(e,t,n){var{x1:r,y1:i,x2:o,y2:s}=this,a=Math.cos(e),l=Math.sin(e),u=t-t*a+n*l,c=n-t*l-n*a;return[a*r-l*i+u,l*r+a*i+c,a*r-l*s+u,l*r+a*s+c,a*o-l*i+u,l*o+a*i+c,a*o-l*s+u,l*o+a*s+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};function av(e){this.mark=e,this.bounds=this.bounds||new vt}function lv(e){av.call(this,e),this.items=this.items||[]}X(lv,av);class hP{constructor(t){this._pending=0,this._loader=t||Dy()}pending(){return this._pending}sanitizeURL(t){const n=this;return D6(n),n._loader.sanitize(t,{context:"href"}).then(r=>(ad(n),r)).catch(()=>(ad(n),null))}loadImage(t){const n=this,r=yZ();return D6(n),n._loader.sanitize(t,{context:"image"}).then(i=>{const o=i.href;if(!o||!r)throw{url:o};const s=new r,a=te(i,"crossOrigin")?i.crossOrigin:"anonymous";return a!=null&&(s.crossOrigin=a),s.onload=()=>ad(n),s.onerror=()=>ad(n),s.src=o,s}).catch(i=>(ad(n),{complete:!1,width:0,height:0,src:i&&i.url||""}))}ready(){const t=this;return new Promise(n=>{function r(i){t.pending()?setTimeout(()=>{r(!0)},10):n(i)}r(!1)})}}function D6(e){e._pending+=1}function ad(e){e._pending-=1}function ys(e,t,n){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){const r=t.strokeWidth!=null?+t.strokeWidth:1;e.expand(r+(n?Kee(t,r):0))}return e}function Kee(e,t){return e.strokeJoin&&e.strokeJoin!=="miter"?0:t}const Zee=Ki-1e-8;let uv,O0,P0,wl,rE,L0,iE,oE;const qs=(e,t)=>uv.add(e,t),z0=(e,t)=>qs(O0=e,P0=t),O6=e=>qs(e,uv.y1),P6=e=>qs(uv.x1,e),dl=(e,t)=>rE*e+iE*t,hl=(e,t)=>L0*e+oE*t,$2=(e,t)=>qs(dl(e,t),hl(e,t)),A2=(e,t)=>z0(dl(e,t),hl(e,t));function Op(e,t){return uv=e,t?(wl=t*wa,rE=oE=Math.cos(wl),L0=Math.sin(wl),iE=-L0):(rE=oE=1,wl=L0=iE=0),Jee}const Jee={beginPath(){},closePath(){},moveTo:A2,lineTo:A2,rect(e,t,n,r){wl?($2(e+n,t),$2(e+n,t+r),$2(e,t+r),A2(e,t)):(qs(e+n,t+r),z0(e,t))},quadraticCurveTo(e,t,n,r){const i=dl(e,t),o=hl(e,t),s=dl(n,r),a=hl(n,r);L6(O0,i,s,O6),L6(P0,o,a,P6),z0(s,a)},bezierCurveTo(e,t,n,r,i,o){const s=dl(e,t),a=hl(e,t),l=dl(n,r),u=hl(n,r),c=dl(i,o),f=hl(i,o);z6(O0,s,l,c,O6),z6(P0,a,u,f,P6),z0(c,f)},arc(e,t,n,r,i,o){if(r+=wl,i+=wl,O0=n*Math.cos(i)+e,P0=n*Math.sin(i)+t,Math.abs(i-r)>Zee)qs(e-n,t-n),qs(e+n,t+n);else{const s=u=>qs(n*Math.cos(u)+e,n*Math.sin(u)+t);let a,l;if(s(r),s(i),i!==r)if(r=r%Ki,r<0&&(r+=Ki),i=i%Ki,i<0&&(i+=Ki),i<r&&(o=!o,a=r,r=i,i=a),o)for(i-=Ki,a=r-r%fl,l=0;l<4&&a>i;++l,a-=fl)s(a);else for(a=r-r%fl+fl,l=0;l<4&&a<i;++l,a=a+fl)s(a)}}};function L6(e,t,n,r){const i=(e-t)/(e+n-2*t);0<i&&i<1&&r(e+(t-e)*i)}function z6(e,t,n,r,i){const o=r-e+3*t-3*n,s=e+n-2*t,a=e-t;let l=0,u=0,c;Math.abs(o)>dee?(c=s*s+a*o,c>=0&&(c=Math.sqrt(c),l=(-s+c)/o,u=(-s-c)/o)):l=.5*a/s,0<l&&l<1&&i(I6(l,e,t,n,r)),0<u&&u<1&&i(I6(u,e,t,n,r))}function I6(e,t,n,r,i){const o=1-e,s=o*o,a=e*e;return s*o*t+3*s*e*n+3*o*a*r+a*e*i}var fa=(fa=ca(1,1))?fa.getContext("2d"):null;const sE=new vt;function RC(e){return function(t,n){if(!fa)return!0;e(fa,t),sE.clear().union(t.bounds).intersect(n).round();const{x1:r,y1:i,x2:o,y2:s}=sE;for(let a=i;a<=s;++a)for(let l=r;l<=o;++l)if(fa.isPointInPath(l,a))return!0;return!1}}function DC(e,t){return t.contains(e.x||0,e.y||0)}function pP(e,t){const n=e.x||0,r=e.y||0,i=e.width||0,o=e.height||0;return t.intersects(sE.set(n,r,n+i,r+o))}function gP(e,t){const n=e.x||0,r=e.y||0,i=e.x2!=null?e.x2:n,o=e.y2!=null?e.y2:r;return rc(t,n,r,i,o)}function rc(e,t,n,r,i){const{x1:o,y1:s,x2:a,y2:l}=e,u=r-t,c=i-n;let f=0,d=1,h,p,g,y;for(y=0;y<4;++y){if(y===0&&(h=-u,p=-(o-t)),y===1&&(h=u,p=a-t),y===2&&(h=-c,p=-(s-n)),y===3&&(h=c,p=l-n),Math.abs(h)<1e-10&&p<0)return!1;if(g=p/h,h<0){if(g>d)return!1;g>f&&(f=g)}else if(h>0){if(g<f)return!1;g<d&&(d=g)}}return!0}function Wc(e,t){e.globalCompositeOperation=t.blend||"source-over"}function ii(e,t){return e??t}function j6(e,t){const n=t.length;for(let r=0;r<n;++r)e.addColorStop(t[r].offset,t[r].color);return e}function ete(e,t,n){const r=n.width(),i=n.height();let o;if(t.gradient==="radial")o=e.createRadialGradient(n.x1+ii(t.x1,.5)*r,n.y1+ii(t.y1,.5)*i,Math.max(r,i)*ii(t.r1,0),n.x1+ii(t.x2,.5)*r,n.y1+ii(t.y2,.5)*i,Math.max(r,i)*ii(t.r2,.5));else{const s=ii(t.x1,0),a=ii(t.y1,0),l=ii(t.x2,1),u=ii(t.y2,0);if(s===l||a===u||r===i)o=e.createLinearGradient(n.x1+s*r,n.y1+a*i,n.x1+l*r,n.y1+u*i);else{const c=ca(Math.ceil(r),Math.ceil(i)),f=c.getContext("2d");return f.scale(r,i),f.fillStyle=j6(f.createLinearGradient(s,a,l,u),t.stops),f.fillRect(0,0,r,i),e.createPattern(c,"no-repeat")}}return j6(o,t.stops)}function mP(e,t,n){return FC(n)?ete(e,n,t.bounds):n}function Xm(e,t,n){return n*=t.fillOpacity==null?1:t.fillOpacity,n>0?(e.globalAlpha=n,e.fillStyle=mP(e,t,t.fill),!0):!1}var tte=[];function qc(e,t,n){var r=(r=t.strokeWidth)!=null?r:1;return r<=0?!1:(n*=t.strokeOpacity==null?1:t.strokeOpacity,n>0?(e.globalAlpha=n,e.strokeStyle=mP(e,t,t.stroke),e.lineWidth=r,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||tte),e.lineDashOffset=t.strokeDashOffset||0),!0):!1)}function nte(e,t){return e.zindex-t.zindex||e.index-t.index}function OC(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],r,i,o;for(i=0,o=t.length;i<o;++i)r=t[i],r.index=i,r.zindex&&n.push(r);return e.zdirty=!1,e.zitems=n.sort(nte)}function $i(e,t){var n=e.items,r,i;if(!n||!n.length)return;const o=OC(e);if(o&&o.length){for(r=0,i=n.length;r<i;++r)n[r].zindex||t(n[r]);n=o}for(r=0,i=n.length;r<i;++r)t(n[r])}function Qm(e,t){var n=e.items,r,i;if(!n||!n.length)return null;const o=OC(e);for(o&&o.length&&(n=o),i=n.length;--i>=0;)if(r=t(n[i]))return r;if(n===o){for(n=e.items,i=n.length;--i>=0;)if(!n[i].zindex&&(r=t(n[i])))return r}return null}function PC(e){return function(t,n,r){$i(n,i=>{(!r||r.intersects(i.bounds))&&yP(e,t,i,i)})}}function rte(e){return function(t,n,r){n.items.length&&(!r||r.intersects(n.bounds))&&yP(e,t,n.items[0],n.items)}}function yP(e,t,n,r){var i=n.opacity==null?1:n.opacity;i!==0&&(e(t,r)||(Wc(t,n),n.fill&&Xm(t,n,i)&&t.fill(),n.stroke&&qc(t,n,i)&&t.stroke()))}function cv(e){return e=e||Gr,function(t,n,r,i,o,s){return r*=t.pixelRatio,i*=t.pixelRatio,Qm(n,a=>{const l=a.bounds;if(!(l&&!l.contains(o,s)||!l)&&e(t,a,r,i,o,s))return a})}}function Pp(e,t){return function(n,r,i,o){var s=Array.isArray(r)?r[0]:r,a=t??s.fill,l=s.stroke&&n.isPointInStroke,u,c;return l&&(u=s.strokeWidth,c=s.strokeCap,n.lineWidth=u??1,n.lineCap=c??"butt"),e(n,r)?!1:a&&n.isPointInPath(i,o)||l&&n.isPointInStroke(i,o)}}function LC(e){return cv(Pp(e))}function Fl(e,t){return"translate("+e+","+t+")"}function zC(e){return"rotate("+e+")"}function ite(e,t){return"scale("+e+","+t+")"}function vP(e){return Fl(e.x||0,e.y||0)}function ote(e){return Fl(e.x||0,e.y||0)+(e.angle?" "+zC(e.angle):"")}function ste(e){return Fl(e.x||0,e.y||0)+(e.angle?" "+zC(e.angle):"")+(e.scaleX||e.scaleY?" "+ite(e.scaleX||1,e.scaleY||1):"")}function IC(e,t,n){function r(s,a){s("transform",ote(a)),s("d",t(null,a))}function i(s,a){return t(Op(s,a.angle),a),ys(s,a).translate(a.x||0,a.y||0)}function o(s,a){var l=a.x||0,u=a.y||0,c=a.angle||0;s.translate(l,u),c&&s.rotate(c*=wa),s.beginPath(),t(s,a),c&&s.rotate(-c),s.translate(-l,-u)}return{type:e,tag:"path",nested:!1,attr:r,bound:i,draw:PC(o),pick:LC(o),isect:n||RC(o)}}var ate=IC("arc",Hee);function lte(e,t){for(var n=e[0].orient==="horizontal"?t[1]:t[0],r=e[0].orient==="horizontal"?"y":"x",i=e.length,o=1/0,s,a;--i>=0;)e[i].defined!==!1&&(a=Math.abs(e[i][r]-n),a<o&&(o=a,s=e[i]));return s}function ute(e,t){for(var n=Math.pow(e[0].strokeWidth||1,2),r=e.length,i,o,s;--r>=0;)if(e[r].defined!==!1&&(i=e[r].x-t[0],o=e[r].y-t[1],s=i*i+o*o,s<n))return e[r];return null}function cte(e,t){for(var n=e.length,r,i,o;--n>=0;)if(e[n].defined!==!1&&(r=e[n].x-t[0],i=e[n].y-t[1],o=r*r+i*i,r=e[n].size||1,o<r*r))return e[n];return null}function jC(e,t,n){function r(l,u){var c=u.mark.items;c.length&&l("d",t(null,c))}function i(l,u){var c=u.items;return c.length===0?l:(t(Op(l),c),ys(l,c[0]))}function o(l,u){l.beginPath(),t(l,u)}const s=Pp(o);function a(l,u,c,f,d,h){var p=u.items,g=u.bounds;return!p||!p.length||g&&!g.contains(d,h)?null:(c*=l.pixelRatio,f*=l.pixelRatio,s(l,p,c,f)?p[0]:null)}return{type:e,tag:"path",nested:!0,attr:r,bound:i,draw:rte(o),pick:a,isect:DC,tip:n}}var fte=jC("area",Vee,lte);function dte(e,t){var n=t.clip;e.save(),me(n)?(e.beginPath(),n(e),e.clip()):xP(e,t.group)}function xP(e,t){e.beginPath(),TC(t)?Mf(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function wP(e){const t=ii(e.strokeWidth,1);return e.strokeOffset!=null?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function hte(e,t){e("transform",vP(t))}function bP(e,t){const n=wP(t);e("d",Mf(null,t,n,n))}function pte(e,t){e("class","background"),e("aria-hidden",!0),bP(e,t)}function gte(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?bP(e,t):e("d","")}function mte(e,t,n){const r=t.clip?NC(n,t,t):null;e("clip-path",r)}function yte(e,t){if(!t.clip&&t.items){const n=t.items,r=n.length;for(let i=0;i<r;++i)e.union(n[i].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),ys(e,t),e.translate(t.x||0,t.y||0)}function Yh(e,t,n,r){const i=wP(t);e.beginPath(),Mf(e,t,(n||0)+i,(r||0)+i)}const vte=Pp(Yh),xte=Pp(Yh,!1),wte=Pp(Yh,!0);function bte(e,t,n,r){$i(t,i=>{const o=i.x||0,s=i.y||0,a=i.strokeForeground,l=i.opacity==null?1:i.opacity;(i.stroke||i.fill)&&l&&(Yh(e,i,o,s),Wc(e,i),i.fill&&Xm(e,i,l)&&e.fill(),i.stroke&&!a&&qc(e,i,l)&&e.stroke()),e.save(),e.translate(o,s),i.clip&&xP(e,i),n&&n.translate(-o,-s),$i(i,u=>{(u.marktype==="group"||r==null||r.includes(u.marktype))&&this.draw(e,u,n,r)}),n&&n.translate(o,s),e.restore(),a&&i.stroke&&l&&(Yh(e,i,o,s),Wc(e,i),qc(e,i,l)&&e.stroke())})}function Ete(e,t,n,r,i,o){if(t.bounds&&!t.bounds.contains(i,o)||!t.items)return null;const s=n*e.pixelRatio,a=r*e.pixelRatio;return Qm(t,l=>{let u,c,f;const d=l.bounds;if(d&&!d.contains(i,o))return;c=l.x||0,f=l.y||0;const h=c+(l.width||0),p=f+(l.height||0),g=l.clip;if(g&&(i<c||i>h||o<f||o>p))return;if(e.save(),e.translate(c,f),c=i-c,f=o-f,g&&TC(l)&&!wte(e,l,s,a))return e.restore(),null;const y=l.strokeForeground,m=t.interactive!==!1;return m&&y&&l.stroke&&xte(e,l,s,a)?(e.restore(),l):(u=Qm(l,v=>Ste(v,c,f)?this.pick(v,n,r,c,f):null),!u&&m&&(l.fill||!y&&l.stroke)&&vte(e,l,s,a)&&(u=l),e.restore(),u||null)})}function Ste(e,t,n){return(e.interactive!==!1||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}var _te={type:"group",tag:"g",nested:!1,attr:hte,bound:yte,draw:bte,pick:Ete,isect:pP,content:mte,background:pte,foreground:gte},Xh={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function BC(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(r=>{e.image=r,e.image.url=e.url})),n}function UC(e,t){return e.width!=null?e.width:!t||!t.width?0:e.aspect!==!1&&e.height?e.height*t.width/t.height:t.width}function WC(e,t){return e.height!=null?e.height:!t||!t.height?0:e.aspect!==!1&&e.width?e.width*t.height/t.width:t.height}function fv(e,t){return e==="center"?t/2:e==="right"?t:0}function dv(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function kte(e,t,n){const r=BC(t,n),i=UC(t,r),o=WC(t,r),s=(t.x||0)-fv(t.align,i),a=(t.y||0)-dv(t.baseline,o),l=!r.src&&r.toDataURL?r.toDataURL():r.src||"";e("href",l,Xh["xmlns:xlink"],"xlink:href"),e("transform",Fl(s,a)),e("width",i),e("height",o),e("preserveAspectRatio",t.aspect===!1?"none":"xMidYMid")}function Cte(e,t){const n=t.image,r=UC(t,n),i=WC(t,n),o=(t.x||0)-fv(t.align,r),s=(t.y||0)-dv(t.baseline,i);return e.set(o,s,o+r,s+i)}function $te(e,t,n){$i(t,r=>{if(n&&!n.intersects(r.bounds))return;const i=BC(r,this);let o=UC(r,i),s=WC(r,i);if(o===0||s===0)return;let a=(r.x||0)-fv(r.align,o),l=(r.y||0)-dv(r.baseline,s),u,c,f,d;r.aspect!==!1&&(c=i.width/i.height,f=r.width/r.height,c===c&&f===f&&c!==f&&(f<c?(d=o/c,l+=(s-d)/2,s=d):(d=s*c,a+=(o-d)/2,o=d))),(i.complete||i.toDataURL)&&(Wc(e,r),e.globalAlpha=(u=r.opacity)!=null?u:1,e.imageSmoothingEnabled=r.smooth!==!1,e.drawImage(i,a,l,o,s))})}var Ate={type:"image",tag:"image",nested:!1,attr:kte,bound:Cte,draw:$te,pick:cv(),isect:Gr,get:BC,xOffset:fv,yOffset:dv},Fte=jC("line",Gee,ute);function Mte(e,t){var n=t.scaleX||1,r=t.scaleY||1;(n!==1||r!==1)&&e("vector-effect","non-scaling-stroke"),e("transform",ste(t)),e("d",t.path)}function I0(e,t){var n=t.path;if(n==null)return!0;var r=t.x||0,i=t.y||0,o=t.scaleX||1,s=t.scaleY||1,a=(t.angle||0)*wa,l=t.pathCache;(!l||l.path!==n)&&((t.pathCache=l=Uc(n)).path=n),a&&e.rotate&&e.translate?(e.translate(r,i),e.rotate(a),Gh(e,l,0,0,o,s),e.rotate(-a),e.translate(-r,-i)):Gh(e,l,r,i,o,s)}function Tte(e,t){return I0(Op(e,t.angle),t)?e.set(0,0,0,0):ys(e,t,!0)}var Nte={type:"path",tag:"path",nested:!1,attr:Mte,bound:Tte,draw:PC(I0),pick:LC(I0),isect:RC(I0)};function Rte(e,t){e("d",Mf(null,t))}function Dte(e,t){var n,r;return ys(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)}function B6(e,t){e.beginPath(),Mf(e,t)}var Ote={type:"rect",tag:"path",nested:!1,attr:Rte,bound:Dte,draw:PC(B6),pick:LC(B6),isect:pP};function Pte(e,t){e("transform",vP(t)),e("x2",t.x2!=null?t.x2-(t.x||0):0),e("y2",t.y2!=null?t.y2-(t.y||0):0)}function Lte(e,t){var n,r;return ys(e.set(n=t.x||0,r=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:r),t)}function EP(e,t,n){var r,i,o,s;return t.stroke&&qc(e,t,n)?(r=t.x||0,i=t.y||0,o=t.x2!=null?t.x2:r,s=t.y2!=null?t.y2:i,e.beginPath(),e.moveTo(r,i),e.lineTo(o,s),!0):!1}function zte(e,t,n){$i(t,r=>{if(!(n&&!n.intersects(r.bounds))){var i=r.opacity==null?1:r.opacity;i&&EP(e,r,i)&&(Wc(e,r),e.stroke())}})}function Ite(e,t,n,r){return e.isPointInStroke?EP(e,t,1)&&e.isPointInStroke(n,r):!1}var jte={type:"rule",tag:"line",nested:!1,attr:Pte,bound:Lte,draw:zte,pick:cv(Ite),isect:gP},Bte=IC("shape",Yee),Ute=IC("symbol",Xee,DC);const U6=FR();var xr={height:So,measureWidth:qC,estimateWidth:Km,width:Km,canvas:SP};SP(!0);function SP(e){xr.width=e&&fa?qC:Km}function Km(e,t){return _P(Ea(e,t),So(e))}function _P(e,t){return~~(.8*e.length*t)}function qC(e,t){return So(e)<=0||!(t=Ea(e,t))?0:kP(t,hv(e))}function kP(e,t){const n=`(${t}) ${e}`;let r=U6.get(n);return r===void 0&&(fa.font=t,r=fa.measureText(e).width,U6.set(n,r)),r}function So(e){return e.fontSize!=null?+e.fontSize||0:11}function ba(e){return e.lineHeight!=null?e.lineHeight:So(e)+2}function Wte(e){return j(e)?e.length>1?e:e[0]:e}function Lp(e){return Wte(e.lineBreak&&e.text&&!j(e.text)?e.text.split(e.lineBreak):e.text)}function HC(e){const t=Lp(e);return(j(t)?t.length-1:0)*ba(e)}function Ea(e,t){const n=t==null?"":(t+"").trim();return e.limit>0&&n.length?Hte(e,n):n}function qte(e){if(xr.width===qC){const t=hv(e);return n=>kP(n,t)}else if(xr.width===Km){const t=So(e);return n=>_P(n,t)}else return t=>xr.width(e,t)}function Hte(e,t){var n=+e.limit,r=qte(e);if(r(t)<n)return t;var i=e.ellipsis||"…",o=e.dir==="rtl",s=0,a=t.length,l;if(n-=r(i),o){for(;s<a;)l=s+a>>>1,r(t.slice(l))>n?s=l+1:a=l;return i+t.slice(s)}else{for(;s<a;)l=1+(s+a>>>1),r(t.slice(0,l))<n?s=l:a=l-1;return t.slice(0,s)+i}}function zp(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function hv(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+So(e)+"px "+zp(e,t)}function VC(e){var t=e.baseline,n=So(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:t==="line-top"?.29*n+.5*ba(e):t==="line-bottom"?.29*n-.5*ba(e):0)}const Vte={left:"start",center:"middle",right:"end"},ah=new vt;function pv(e){var t=e.x||0,n=e.y||0,r=e.radius||0,i;return r&&(i=(e.theta||0)-fl,t+=r*Math.cos(i),n+=r*Math.sin(i)),ah.x1=t,ah.y1=n,ah}function Gte(e,t){var n=t.dx||0,r=(t.dy||0)+VC(t),i=pv(t),o=i.x1,s=i.y1,a=t.angle||0,l;e("text-anchor",Vte[t.align]||"start"),a?(l=Fl(o,s)+" "+zC(a),(n||r)&&(l+=" "+Fl(n,r))):l=Fl(o+n,s+r),e("transform",l)}function GC(e,t,n){var r=xr.height(t),i=t.align,o=pv(t),s=o.x1,a=o.y1,l=t.dx||0,u=(t.dy||0)+VC(t)-Math.round(.8*r),c=Lp(t),f;if(j(c)?(r+=ba(t)*(c.length-1),f=c.reduce((d,h)=>Math.max(d,xr.width(t,h)),0)):f=xr.width(t,c),i==="center"?l-=f/2:i==="right"&&(l-=f),e.set(l+=s,u+=a,l+f,u+r),t.angle&&!n)e.rotate(t.angle*wa,s,a);else if(n===2)return e.rotatedPoints(t.angle*wa,s,a);return e}function Yte(e,t,n){$i(t,r=>{var i=r.opacity==null?1:r.opacity,o,s,a,l,u,c,f;if(!(n&&!n.intersects(r.bounds)||i===0||r.fontSize<=0||r.text==null||r.text.length===0)){if(e.font=hv(r),e.textAlign=r.align||"left",o=pv(r),s=o.x1,a=o.y1,r.angle&&(e.save(),e.translate(s,a),e.rotate(r.angle*wa),s=a=0),s+=r.dx||0,a+=(r.dy||0)+VC(r),c=Lp(r),Wc(e,r),j(c))for(u=ba(r),l=0;l<c.length;++l)f=Ea(r,c[l]),r.fill&&Xm(e,r,i)&&e.fillText(f,s,a),r.stroke&&qc(e,r,i)&&e.strokeText(f,s,a),a+=u;else f=Ea(r,c),r.fill&&Xm(e,r,i)&&e.fillText(f,s,a),r.stroke&&qc(e,r,i)&&e.strokeText(f,s,a);r.angle&&e.restore()}})}function Xte(e,t,n,r,i,o){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var s=pv(t),a=s.x1,l=s.y1,u=GC(ah,t,1),c=-t.angle*wa,f=Math.cos(c),d=Math.sin(c),h=f*i-d*o+(a-f*a+d*l),p=d*i+f*o+(l-d*a-f*l);return u.contains(h,p)}function Qte(e,t){const n=GC(ah,e,2);return rc(t,n[0],n[1],n[2],n[3])||rc(t,n[0],n[1],n[4],n[5])||rc(t,n[4],n[5],n[6],n[7])||rc(t,n[2],n[3],n[6],n[7])}var Kte={type:"text",tag:"text",nested:!1,attr:Gte,bound:GC,draw:Yte,pick:cv(Xte),isect:Qte},Zte=jC("trail",Qee,cte),kr={arc:ate,area:fte,group:_te,image:Ate,line:Fte,path:Nte,rect:Ote,rule:jte,shape:Bte,symbol:Ute,text:Kte,trail:Zte};function aE(e,t,n){var r=kr[e.mark.marktype],i=t||r.bound;return r.nested&&(e=e.mark),i(e.bounds||(e.bounds=new vt),e,n)}var W6={mark:null};function CP(e,t,n){var r=kr[e.marktype],i=r.bound,o=e.items,s=o&&o.length,a,l,u,c;if(r.nested)return s?u=o[0]:(W6.mark=e,u=W6),c=aE(u,i,n),t=t&&t.union(c)||c,t;if(t=t||e.bounds&&e.bounds.clear()||new vt,s)for(a=0,l=o.length;a<l;++a)t.union(aE(o[a],i,n));return e.bounds=t}const Jte=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function $P(e,t){return JSON.stringify(e,Jte,t)}function AP(e){const t=typeof e=="string"?JSON.parse(e):e;return FP(t)}function FP(e){var t=e.marktype,n=e.items,r,i,o;if(n)for(i=0,o=n.length;i<o;++i)r=t?"mark":"group",n[i][r]=e,n[i].zindex&&(n[i][r].zdirty=!0),(t||r)==="group"&&FP(n[i]);return t&&CP(e),e}class MP{constructor(t){arguments.length?this.root=AP(t):(this.root=q6({marktype:"group",name:"root",role:"frame"}),this.root.items=[new lv(this.root)])}toJSON(t){return $P(this.root,t||0)}mark(t,n,r){n=n||this.root.items[0];const i=q6(t,n);return n.items[r]=i,i.zindex&&(i.group.zdirty=!0),i}}function q6(e,t){const n={bounds:new vt,clip:!!e.clip,group:t,interactive:e.interactive!==!1,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return e.aria!=null&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function Hs(e,t,n){return!e&&typeof document<"u"&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function YC(e,t){t=t.toLowerCase();for(var n=e.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===t)return n[r]}function bt(e,t,n,r){var i=e.childNodes[t],o;return(!i||i.tagName.toLowerCase()!==n.toLowerCase())&&(o=i||null,i=Hs(e.ownerDocument,n,r),e.insertBefore(i,o)),i}function Dr(e,t){for(var n=e.childNodes,r=n.length;r>t;)e.removeChild(n[--r]);return e}function TP(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function gv(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function ene(e,t,n,r){var i=e&&e.mark,o,s;if(i&&(o=kr[i.marktype]).tip){for(s=gv(t,n),s[0]-=r[0],s[1]-=r[1];e=e.mark.group;)s[0]-=e.x||0,s[1]-=e.y||0;e=o.tip(i.items,s)}return e}let XC=class{constructor(t,n){this._active=null,this._handlers={},this._loader=t||Dy(),this._tooltip=n||tne}initialize(t,n,r){return this._el=t,this._obj=r||null,this.origin(n)}element(){return this._el}canvas(){return this._el&&this._el.firstChild}origin(t){return arguments.length?(this._origin=t||[0,0],this):this._origin.slice()}scene(t){return arguments.length?(this._scene=t,this):this._scene}on(){}off(){}_handlerIndex(t,n,r){for(let i=t?t.length:0;--i>=0;)if(t[i].type===n&&(!r||t[i].handler===r))return i;return-1}handlers(t){const n=this._handlers,r=[];if(t)r.push(...n[this.eventName(t)]);else for(const i in n)r.push(...n[i]);return r}eventName(t){const n=t.indexOf(".");return n<0?t:t.slice(0,n)}handleHref(t,n,r){this._loader.sanitize(r,{context:"href"}).then(i=>{const o=new MouseEvent(t.type,t),s=Hs(null,"a");for(const a in i)s.setAttribute(a,i[a]);s.dispatchEvent(o)}).catch(()=>{})}handleTooltip(t,n,r){if(n&&n.tooltip!=null){n=ene(n,t,this.canvas(),this._origin);const i=r&&n&&n.tooltip||null;this._tooltip.call(this._obj,this,t,n,i)}}getItemBoundingClientRect(t){const n=this.canvas();if(!n)return;const r=n.getBoundingClientRect(),i=this._origin,o=t.bounds,s=o.width(),a=o.height();let l=o.x1+i[0]+r.left,u=o.y1+i[1]+r.top;for(;t.mark&&(t=t.mark.group);)l+=t.x||0,u+=t.y||0;return{x:l,y:u,width:s,height:a,left:l,top:u,right:l+s,bottom:u+a}}};function tne(e,t,n,r){e.element().setAttribute("title",r||"")}class Ip{constructor(t){this._el=null,this._bgcolor=null,this._loader=new hP(t)}initialize(t,n,r,i,o){return this._el=t,this.resize(n,r,i,o)}element(){return this._el}canvas(){return this._el&&this._el.firstChild}background(t){return arguments.length===0?this._bgcolor:(this._bgcolor=t,this)}resize(t,n,r,i){return this._width=t,this._height=n,this._origin=r||[0,0],this._scale=i||1,this}dirty(){}render(t,n){const r=this;return r._call=function(){r._render(t,n)},r._call(),r._call=null,r}_render(){}renderAsync(t,n){const r=this.render(t,n);return this._ready?this._ready.then(()=>r):Promise.resolve(r)}_load(t,n){var r=this,i=r._loader[t](n);if(!r._ready){const o=r._call;r._ready=r._loader.ready().then(s=>{s&&o(),r._ready=null})}return i}sanitizeURL(t){return this._load("sanitizeURL",t)}loadImage(t){return this._load("loadImage",t)}}const nne="keydown",rne="keypress",ine="keyup",NP="dragenter",j0="dragleave",RP="dragover",lE="pointerdown",one="pointerup",Zm="pointermove",B0="pointerout",DP="pointerover",uE="mousedown",sne="mouseup",OP="mousemove",Jm="mouseout",PP="mouseover",e1="click",ane="dblclick",lne="wheel",LP="mousewheel",t1="touchstart",n1="touchmove",r1="touchend",une=[nne,rne,ine,NP,j0,RP,lE,one,Zm,B0,DP,uE,sne,OP,Jm,PP,e1,ane,lne,LP,t1,n1,r1],cE=Zm,lh=Jm,fE=e1;class jp extends XC{constructor(t,n){super(t,n),this._down=null,this._touch=null,this._first=!0,this._events={},this.events=une,this.pointermove=V6([Zm,OP],[DP,PP],[B0,Jm]),this.dragover=V6([RP],[NP],[j0]),this.pointerout=G6([B0,Jm]),this.dragleave=G6([j0])}initialize(t,n,r){return this._canvas=t&&YC(t,"canvas"),[e1,uE,lE,Zm,B0,j0].forEach(i=>H6(this,i)),super.initialize(t,n,r)}canvas(){return this._canvas}context(){return this._canvas.getContext("2d")}DOMMouseScroll(t){this.fire(LP,t)}pointerdown(t){this._down=this._active,this.fire(lE,t)}mousedown(t){this._down=this._active,this.fire(uE,t)}click(t){this._down===this._active&&(this.fire(e1,t),this._down=null)}touchstart(t){this._touch=this.pickEvent(t.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(t1,t,!0)}touchmove(t){this.fire(n1,t,!0)}touchend(t){this.fire(r1,t,!0),this._touch=null}fire(t,n,r){const i=r?this._touch:this._active,o=this._handlers[t];if(n.vegaType=t,t===fE&&i&&i.href?this.handleHref(n,i,i.href):(t===cE||t===lh)&&this.handleTooltip(n,i,t!==lh),o)for(let s=0,a=o.length;s<a;++s)o[s].handler.call(this._obj,n,i)}on(t,n){const r=this.eventName(t),i=this._handlers;return this._handlerIndex(i[r],t,n)<0&&(H6(this,t),(i[r]||(i[r]=[])).push({type:t,handler:n})),this}off(t,n){const r=this.eventName(t),i=this._handlers[r],o=this._handlerIndex(i,t,n);return o>=0&&i.splice(o,1),this}pickEvent(t){const n=gv(t,this._canvas),r=this._origin;return this.pick(this._scene,n[0],n[1],n[0]-r[0],n[1]-r[1])}pick(t,n,r,i,o){const s=this.context();return kr[t.marktype].pick.call(this,s,t,n,r,i,o)}}const cne=e=>e===t1||e===n1||e===r1?[t1,n1,r1]:[e];function H6(e,t){cne(t).forEach(n=>fne(e,n))}function fne(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?r=>e[t](r):r=>e.fire(t,r)))}function Od(e,t,n){t.forEach(r=>e.fire(r,n))}function V6(e,t,n){return function(r){const i=this._active,o=this.pickEvent(r);o===i?Od(this,e,r):((!i||!i.exit)&&Od(this,n,r),this._active=o,Od(this,t,r),Od(this,e,r))}}function G6(e){return function(t){Od(this,e,t),this._active=null}}function dne(){return typeof window<"u"&&window.devicePixelRatio||1}function hne(e,t,n,r,i,o){const s=typeof HTMLElement<"u"&&e instanceof HTMLElement&&e.parentNode!=null,a=e.getContext("2d"),l=s?dne():i;e.width=t*l,e.height=n*l;for(const u in o)a[u]=o[u];return s&&l!==1&&(e.style.width=t+"px",e.style.height=n+"px"),a.pixelRatio=l,a.setTransform(l,0,0,l,l*r[0],l*r[1]),e}class i1 extends Ip{constructor(t){super(t),this._options={},this._redraw=!1,this._dirty=new vt,this._tempb=new vt}initialize(t,n,r,i,o,s){return this._options=s||{},this._canvas=this._options.externalContext?null:ca(1,1,this._options.type),t&&this._canvas&&(Dr(t,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),super.initialize(t,n,r,i,o)}resize(t,n,r,i){if(super.resize(t,n,r,i),this._canvas)hne(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const o=this._options.externalContext;o||I("CanvasRenderer is missing a valid canvas or context"),o.scale(this._scale,this._scale),o.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this}canvas(){return this._canvas}context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)}dirty(t){const n=this._tempb.clear().union(t.bounds);let r=t.mark.group;for(;r;)n.translate(r.x||0,r.y||0),r=r.mark.group;this._dirty.union(n)}_render(t,n){const r=this.context(),i=this._origin,o=this._width,s=this._height,a=this._dirty,l=pne(i,o,s);r.save();const u=this._redraw||a.empty()?(this._redraw=!1,l.expand(1)):gne(r,l.intersect(a),i);return this.clear(-i[0],-i[1],o,s),this.draw(r,t,u,n),r.restore(),a.clear(),this}draw(t,n,r,i){if(n.marktype!=="group"&&i!=null&&!i.includes(n.marktype))return;const o=kr[n.marktype];n.clip&&dte(t,n),o.draw.call(this,t,n,r,i),n.clip&&t.restore()}clear(t,n,r,i){const o=this._options,s=this.context();o.type!=="pdf"&&!o.externalContext&&s.clearRect(t,n,r,i),this._bgcolor!=null&&(s.fillStyle=this._bgcolor,s.fillRect(t,n,r,i))}}const pne=(e,t,n)=>new vt().set(0,0,t,n).translate(-e[0],-e[1]);function gne(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-(n[0]%1),-(n[1]%1)),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}class zP extends XC{constructor(t,n){super(t,n);const r=this;r._hrefHandler=F2(r,(i,o)=>{o&&o.href&&r.handleHref(i,o,o.href)}),r._tooltipHandler=F2(r,(i,o)=>{r.handleTooltip(i,o,i.type!==lh)})}initialize(t,n,r){let i=this._svg;return i&&(i.removeEventListener(fE,this._hrefHandler),i.removeEventListener(cE,this._tooltipHandler),i.removeEventListener(lh,this._tooltipHandler)),this._svg=i=t&&YC(t,"svg"),i&&(i.addEventListener(fE,this._hrefHandler),i.addEventListener(cE,this._tooltipHandler),i.addEventListener(lh,this._tooltipHandler)),super.initialize(t,n,r)}canvas(){return this._svg}on(t,n){const r=this.eventName(t),i=this._handlers;if(this._handlerIndex(i[r],t,n)<0){const s={type:t,handler:n,listener:F2(this,n)};(i[r]||(i[r]=[])).push(s),this._svg&&this._svg.addEventListener(r,s.listener)}return this}off(t,n){const r=this.eventName(t),i=this._handlers[r],o=this._handlerIndex(i,t,n);return o>=0&&(this._svg&&this._svg.removeEventListener(r,i[o].listener),i.splice(o,1)),this}}const F2=(e,t)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,t.call(e._obj,n,r)},IP="aria-hidden",QC="aria-label",KC="role",ZC="aria-roledescription",jP="graphics-object",JC="graphics-symbol",BP=(e,t,n)=>({[KC]:e,[ZC]:t,[QC]:n||void 0}),mne=ki(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),Y6={axis:{desc:"axis",caption:xne},legend:{desc:"legend",caption:wne},"title-text":{desc:"title",caption:e=>`Title text '${Q6(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${Q6(e)}'`}},X6={ariaRole:KC,ariaRoleDescription:ZC,description:QC};function UP(e,t){const n=t.aria===!1;if(e(IP,n||void 0),n||t.description==null)for(const r in X6)e(X6[r],void 0);else{const r=t.mark.marktype;e(QC,t.description),e(KC,t.ariaRole||(r==="group"?jP:JC)),e(ZC,t.ariaRoleDescription||`${r} mark`)}}function WP(e){return e.aria===!1?{[IP]:!0}:mne[e.role]?null:Y6[e.role]?vne(e,Y6[e.role]):yne(e)}function yne(e){const t=e.marktype,n=t==="group"||t==="text"||e.items.some(r=>r.description!=null&&r.aria!==!1);return BP(n?jP:JC,`${t} mark container`,e.description)}function vne(e,t){try{const n=e.items[0],r=t.caption||(()=>"");return BP(t.role||JC,t.desc,n.description||r(n))}catch{return null}}function Q6(e){return J(e.text).join(" ")}function xne(e){const t=e.datum,n=e.orient,r=t.title?qP(e):null,i=e.context,o=i.scales[t.scale].value,s=i.dataflow.locale(),a=o.type;return`${n==="left"||n==="right"?"Y":"X"}-axis`+(r?` titled '${r}'`:"")+` for a ${Bc(a)?"discrete":a} scale with ${rP(s,o,e)}`}function wne(e){const t=e.datum,n=t.title?qP(e):null,r=`${t.type||""} legend`.trim(),i=t.scales,o=Object.keys(i),s=e.context,a=s.scales[i[o[0]]].value,l=s.dataflow.locale();return Ene(r)+(n?` titled '${n}'`:"")+` for ${bne(o)} with ${rP(l,a,e)}`}function qP(e){try{return J(Ce(e.items).items[0].text).join(" ")}catch{return null}}function bne(e){return e=e.map(t=>t+(t==="fill"||t==="stroke"?" color":"")),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+Ce(e)}function Ene(e){return e.length?e[0].toUpperCase()+e.slice(1):e}const HP=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),Sne=e=>HP(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function e3(){let e="",t="",n="";const r=[],i=()=>t=n="",o=l=>{t&&(e+=`${t}>${n}`,i()),r.push(l)},s=(l,u)=>(u!=null&&(t+=` ${l}="${Sne(u)}"`),a),a={open(l){o(l),t="<"+l;for(var u=arguments.length,c=new Array(u>1?u-1:0),f=1;f<u;f++)c[f-1]=arguments[f];for(const d of c)for(const h in d)s(h,d[h]);return a},close(){const l=r.pop();return t?e+=t+(n?`>${n}</${l}>`:"/>"):e+=`</${l}>`,i(),a},attr:s,text:l=>(n+=HP(l),a),toString:()=>e};return a}const VP=e=>GP(e3(),e)+"";function GP(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,r=n.length;for(let i=0;i<r;++i)e.attr(n[i].name,n[i].value)}if(t.hasChildNodes()){const n=t.childNodes;for(const r of n)r.nodeType===3?e.text(r.nodeValue):GP(e,r)}return e.close()}const o1={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},s1={blend:"mix-blend-mode"},YP={fill:"none","stroke-miterlimit":10},ld=0,K6="http://www.w3.org/2000/xmlns/",wt=Xh.xmlns;class t3 extends Ip{constructor(t){super(t),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}initialize(t,n,r,i,o){return this._defs={},this._clearDefs(),t&&(this._svg=bt(t,0,"svg",wt),this._svg.setAttributeNS(K6,"xmlns",wt),this._svg.setAttributeNS(K6,"xmlns:xlink",Xh["xmlns:xlink"]),this._svg.setAttribute("version",Xh.version),this._svg.setAttribute("class","marks"),Dr(t,1),this._root=bt(this._svg,ld,"g",wt),Vs(this._root,YP),Dr(this._svg,ld+1)),this.background(this._bgcolor),super.initialize(t,n,r,i,o)}background(t){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",t),super.background(...arguments)}resize(t,n,r,i){return super.resize(t,n,r,i),this._svg&&(Vs(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this}canvas(){return this._svg}svg(){const t=this._svg,n=this._bgcolor;if(!t)return null;let r;n&&(t.removeAttribute("style"),r=bt(t,ld,"rect",wt),Vs(r,{width:this._width,height:this._height,fill:n}));const i=VP(t);return n&&(t.removeChild(r),this._svg.style.setProperty("background-color",n)),i}_render(t,n){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,t,void 0,n),Dr(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this}dirty(t){t.dirty!==this._dirtyID&&(t.dirty=this._dirtyID,this._dirty.push(t))}isDirty(t){return this._dirtyAll||!t._svg||!t._svg.ownerSVGElement||t.dirty===this._dirtyID}_dirtyCheck(){this._dirtyAll=!0;const t=this._dirty;if(!t.length||!this._dirtyID)return!0;const n=++this._dirtyID;let r,i,o,s,a,l,u;for(a=0,l=t.length;a<l;++a)if(r=t[a],i=r.mark,i.marktype!==o&&(o=i.marktype,s=kr[o]),i.zdirty&&i.dirty!==n&&(this._dirtyAll=!1,Z6(r,n),i.items.forEach(c=>{c.dirty=n})),!i.zdirty){if(r.exit){s.nested&&i.items.length?(u=i.items[0],u._svg&&this._update(s,u._svg,u)):r._svg&&(u=r._svg.parentNode,u&&u.removeChild(r._svg)),r._svg=null;continue}r=s.nested?i.items[0]:r,r._update!==n&&(!r._svg||!r._svg.ownerSVGElement?(this._dirtyAll=!1,Z6(r,n)):this._update(s,r._svg,r),r._update=n)}return!this._dirtyAll}mark(t,n,r,i){if(!this.isDirty(n))return n._svg;const o=this._svg,s=n.marktype,a=kr[s],l=n.interactive===!1?"none":null,u=a.tag==="g",c=J6(n,t,r,"g",o);if(s!=="group"&&i!=null&&!i.includes(s))return Dr(c,0),n._svg;c.setAttribute("class",TP(n));const f=WP(n);for(const g in f)_n(c,g,f[g]);u||_n(c,"pointer-events",l),_n(c,"clip-path",n.clip?NC(this,n,n.group):null);let d=null,h=0;const p=g=>{const y=this.isDirty(g),m=J6(g,c,d,a.tag,o);y&&(this._update(a,m,g),u&&Cne(this,m,g,i)),d=m,++h};return a.nested?n.items.length&&p(n.items[0]):$i(n,p),Dr(c,h),c}_update(t,n,r){Qo=n,cn=n.__values__,UP(uh,r),t.attr(uh,r,this);const i=Ane[t.type];i&&i.call(this,t,n,r),Qo&&this.style(Qo,r)}style(t,n){if(n!=null){for(const r in o1){let i=r==="font"?zp(n):n[r];if(i===cn[r])continue;const o=o1[r];i==null?t.removeAttribute(o):(FC(i)&&(i=oP(i,this._defs.gradient,XP())),t.setAttribute(o,i+"")),cn[r]=i}for(const r in s1)U0(t,s1[r],n[r])}}defs(){const t=this._svg,n=this._defs;let r=n.el,i=0;for(const o in n.gradient)r||(n.el=r=bt(t,ld+1,"defs",wt)),i=_ne(r,n.gradient[o],i);for(const o in n.clipping)r||(n.el=r=bt(t,ld+1,"defs",wt)),i=kne(r,n.clipping[o],i);r&&(i===0?(t.removeChild(r),n.el=null):Dr(r,i))}_clearDefs(){const t=this._defs;t.gradient={},t.clipping={}}}function Z6(e,t){for(;e&&e.dirty!==t;e=e.mark.group)if(e.dirty=t,e.mark&&e.mark.dirty!==t)e.mark.dirty=t;else return}function _ne(e,t,n){let r,i,o;if(t.gradient==="radial"){let s=bt(e,n++,"pattern",wt);Vs(s,{id:Ym+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),s=bt(s,0,"rect",wt),Vs(s,{width:1,height:1,fill:`url(${XP()}#${t.id})`}),e=bt(e,n++,"radialGradient",wt),Vs(e,{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else e=bt(e,n++,"linearGradient",wt),Vs(e,{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(r=0,i=t.stops.length;r<i;++r)o=bt(e,r,"stop",wt),o.setAttribute("offset",t.stops[r].offset),o.setAttribute("stop-color",t.stops[r].color);return Dr(e,r),n}function kne(e,t,n){let r;return e=bt(e,n,"clipPath",wt),e.setAttribute("id",t.id),t.path?(r=bt(e,0,"path",wt),r.setAttribute("d",t.path)):(r=bt(e,0,"rect",wt),Vs(r,{x:0,y:0,width:t.width,height:t.height})),Dr(e,1),n+1}function Cne(e,t,n,r){t=t.lastChild.previousSibling;let i,o=0;$i(n,s=>{i=e.mark(t,s,i,r),++o}),Dr(t,1+o)}function J6(e,t,n,r,i){let o=e._svg,s;if(!o&&(s=t.ownerDocument,o=Hs(s,r,wt),e._svg=o,e.mark&&(o.__data__=e,o.__values__={fill:"default"},r==="g"))){const a=Hs(s,"path",wt);o.appendChild(a),a.__data__=e;const l=Hs(s,"g",wt);o.appendChild(l),l.__data__=e;const u=Hs(s,"path",wt);o.appendChild(u),u.__data__=e,u.__values__={fill:"default"}}return(o.ownerSVGElement!==i||$ne(o,n))&&t.insertBefore(o,n?n.nextSibling:t.firstChild),o}function $ne(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}let Qo=null,cn=null;const Ane={group(e,t,n){const r=Qo=t.childNodes[2];cn=r.__values__,e.foreground(uh,n,this),cn=t.__values__,Qo=t.childNodes[1],e.content(uh,n,this);const i=Qo=t.childNodes[0];e.background(uh,n,this);const o=n.mark.interactive===!1?"none":null;if(o!==cn.events&&(_n(r,"pointer-events",o),_n(i,"pointer-events",o),cn.events=o),n.strokeForeground&&n.stroke){const s=n.fill;_n(r,"display",null),this.style(i,n),_n(i,"stroke",null),s&&(n.fill=null),cn=r.__values__,this.style(r,n),s&&(n.fill=s),Qo=null}else _n(r,"display","none")},image(e,t,n){n.smooth===!1?(U0(t,"image-rendering","optimizeSpeed"),U0(t,"image-rendering","pixelated")):U0(t,"image-rendering",null)},text(e,t,n){const r=Lp(n);let i,o,s,a;j(r)?(o=r.map(l=>Ea(n,l)),i=o.join(`
`),i!==cn.text&&(Dr(t,0),s=t.ownerDocument,a=ba(n),o.forEach((l,u)=>{const c=Hs(s,"tspan",wt);c.__data__=n,c.textContent=l,u&&(c.setAttribute("x",0),c.setAttribute("dy",a)),t.appendChild(c)}),cn.text=i)):(o=Ea(n,r),o!==cn.text&&(t.textContent=o,cn.text=o)),_n(t,"font-family",zp(n)),_n(t,"font-size",So(n)+"px"),_n(t,"font-style",n.fontStyle),_n(t,"font-variant",n.fontVariant),_n(t,"font-weight",n.fontWeight)}};function uh(e,t,n){t!==cn[e]&&(n?Fne(Qo,e,t,n):_n(Qo,e,t),cn[e]=t)}function U0(e,t,n){n!==cn[t]&&(n==null?e.style.removeProperty(t):e.style.setProperty(t,n+""),cn[t]=n)}function Vs(e,t){for(const n in t)_n(e,n,t[n])}function _n(e,t,n){n!=null?e.setAttribute(t,n):e.removeAttribute(t)}function Fne(e,t,n,r){n!=null?e.setAttributeNS(r,t,n):e.removeAttributeNS(r,t)}function XP(){let e;return typeof window>"u"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}class QP extends Ip{constructor(t){super(t),this._text=null,this._defs={gradient:{},clipping:{}}}svg(){return this._text}_render(t){const n=e3();n.open("svg",ge({},Xh,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const r=this._bgcolor;return r&&r!=="transparent"&&r!=="none"&&n.open("rect",{width:this._width,height:this._height,fill:r}).close(),n.open("g",YP,{transform:"translate("+this._origin+")"}),this.mark(n,t),n.close(),this.defs(n),this._text=n.close()+"",this}mark(t,n){const r=kr[n.marktype],i=r.tag,o=[UP,r.attr];t.open("g",{class:TP(n),"clip-path":n.clip?NC(this,n,n.group):null},WP(n),{"pointer-events":i!=="g"&&n.interactive===!1?"none":null});const s=a=>{const l=this.href(a);if(l&&t.open("a",l),t.open(i,this.attr(n,a,o,i!=="g"?i:null)),i==="text"){const u=Lp(a);if(j(u)){const c={x:0,dy:ba(a)};for(let f=0;f<u.length;++f)t.open("tspan",f?c:null).text(Ea(a,u[f])).close()}else t.text(Ea(a,u))}else if(i==="g"){const u=a.strokeForeground,c=a.fill,f=a.stroke;u&&f&&(a.stroke=null),t.open("path",this.attr(n,a,r.background,"bgrect")).close(),t.open("g",this.attr(n,a,r.content)),$i(a,d=>this.mark(t,d)),t.close(),u&&f?(c&&(a.fill=null),a.stroke=f,t.open("path",this.attr(n,a,r.foreground,"bgrect")).close(),c&&(a.fill=c)):t.open("path",this.attr(n,a,r.foreground,"bgfore")).close()}t.close(),l&&t.close()};return r.nested?n.items&&n.items.length&&s(n.items[0]):$i(n,s),t.close()}href(t){const n=t.href;let r;if(n){if(r=this._hrefs&&this._hrefs[n])return r;this.sanitizeURL(n).then(i=>{i["xlink:href"]=i.href,i.href=null,(this._hrefs||(this._hrefs={}))[n]=i})}return null}attr(t,n,r,i){const o={},s=(a,l,u,c)=>{o[c||a]=l};return Array.isArray(r)?r.forEach(a=>a(s,n,this)):r(s,n,this),i&&Mne(o,n,t,i,this._defs),o}defs(t){const n=this._defs.gradient,r=this._defs.clipping;if(Object.keys(n).length+Object.keys(r).length!==0){t.open("defs");for(const o in n){const s=n[o],a=s.stops;s.gradient==="radial"?(t.open("pattern",{id:Ym+o,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),t.open("rect",{width:"1",height:"1",fill:"url(#"+o+")"}).close(),t.close(),t.open("radialGradient",{id:o,fx:s.x1,fy:s.y1,fr:s.r1,cx:s.x2,cy:s.y2,r:s.r2})):t.open("linearGradient",{id:o,x1:s.x1,x2:s.x2,y1:s.y1,y2:s.y2});for(let l=0;l<a.length;++l)t.open("stop",{offset:a[l].offset,"stop-color":a[l].color}).close();t.close()}for(const o in r){const s=r[o];t.open("clipPath",{id:o}),s.path?t.open("path",{d:s.path}).close():t.open("rect",{x:0,y:0,width:s.width,height:s.height}).close(),t.close()}t.close()}}}function Mne(e,t,n,r,i){let o;if(t==null||(r==="bgrect"&&n.interactive===!1&&(e["pointer-events"]="none"),r==="bgfore"&&(n.interactive===!1&&(e["pointer-events"]="none"),e.display="none",t.fill!==null)))return e;r==="image"&&t.smooth===!1&&(o=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]),r==="text"&&(e["font-family"]=zp(t),e["font-size"]=So(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const s in o1){let a=t[s];const l=o1[s];a==="transparent"&&(l==="fill"||l==="stroke")||a!=null&&(FC(a)&&(a=oP(a,i.gradient,"")),e[l]=a)}for(const s in s1){const a=t[s];a!=null&&(o=o||[],o.push(`${s1[s]}: ${a};`))}return o&&(e.style=o.join(" ")),e}const ui={svgMarkTypes:["text"],svgOnTop:!0,debug:!1};function Tne(e){ui.svgMarkTypes=e.svgMarkTypes??["text"],ui.svgOnTop=e.svgOnTop??!0,ui.debug=e.debug??!1}class dE extends Ip{constructor(t){super(t),this._svgRenderer=new t3(t),this._canvasRenderer=new i1(t)}initialize(t,n,r,i,o){this._root_el=bt(t,0,"div");const s=bt(this._root_el,0,"div"),a=bt(this._root_el,1,"div");return this._root_el.style.position="relative",ui.debug||(s.style.height="100%",a.style.position="absolute",a.style.top="0",a.style.left="0",a.style.height="100%",a.style.width="100%"),this._svgEl=ui.svgOnTop?a:s,this._canvasEl=ui.svgOnTop?s:a,this._svgEl.style.pointerEvents="none",this._canvasRenderer.initialize(this._canvasEl,n,r,i,o),this._svgRenderer.initialize(this._svgEl,n,r,i,o),super.initialize(t,n,r,i,o)}dirty(t){return ui.svgMarkTypes.includes(t.mark.marktype)?this._svgRenderer.dirty(t):this._canvasRenderer.dirty(t),this}_render(t,n){const i=(n??["arc","area","image","line","path","rect","rule","shape","symbol","text","trail"]).filter(o=>!ui.svgMarkTypes.includes(o));this._svgRenderer.render(t,ui.svgMarkTypes),this._canvasRenderer.render(t,i)}resize(t,n,r,i){return super.resize(t,n,r,i),this._svgRenderer.resize(t,n,r,i),this._canvasRenderer.resize(t,n,r,i),this}background(t){return ui.svgOnTop?this._canvasRenderer.background(t):this._svgRenderer.background(t),this}}class KP extends jp{constructor(t,n){super(t,n)}initialize(t,n,r){const i=bt(bt(t,0,"div"),ui.svgOnTop?0:1,"div");return super.initialize(i,n,r)}}const ZP="canvas",JP="hybrid",eL="png",tL="svg",nL="none",Gs={Canvas:ZP,PNG:eL,SVG:tL,Hybrid:JP,None:nL},ql={};ql[ZP]=ql[eL]={renderer:i1,headless:i1,handler:jp};ql[tL]={renderer:t3,headless:QP,handler:zP};ql[JP]={renderer:dE,headless:dE,handler:KP};ql[nL]={};function mv(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(ql[e]=t,this):ql[e]}function rL(e,t,n){const r=[],i=new vt().union(t),o=e.marktype;return o?iL(e,i,n,r):o==="group"?oL(e,i,n,r):I("Intersect scene must be mark node or group item.")}function iL(e,t,n,r){if(Nne(e,t,n)){const i=e.items,o=e.marktype,s=i.length;let a=0;if(o==="group")for(;a<s;++a)oL(i[a],t,n,r);else for(const l=kr[o].isect;a<s;++a){const u=i[a];sL(u,t,l)&&r.push(u)}}return r}function Nne(e,t,n){return e.bounds&&t.intersects(e.bounds)&&(e.marktype==="group"||e.interactive!==!1&&(!n||n(e)))}function oL(e,t,n,r){n&&n(e.mark)&&sL(e,t,kr.group.isect)&&r.push(e);const i=e.items,o=i&&i.length;if(o){const s=e.x||0,a=e.y||0;t.translate(-s,-a);for(let l=0;l<o;++l)iL(i[l],t,n,r);t.translate(s,a)}return r}function sL(e,t,n){const r=e.bounds;return t.encloses(r)||t.intersects(r)&&n(e,t)}const M2=new vt;function aL(e){const t=e.clip;if(me(t))t(Op(M2.clear()));else if(t)M2.set(0,0,e.group.width,e.group.height);else return;e.bounds.intersect(M2)}const Rne=1e-9;function n3(e,t,n){return e===t?!0:n==="path"?lL(e,t):e instanceof Date&&t instanceof Date?+e==+t:Me(e)&&Me(t)?Math.abs(e-t)<=Rne:!e||!t||!Z(e)&&!Z(t)?e==t:Dne(e,t)}function lL(e,t){return n3(Uc(e),Uc(t))}function Dne(e,t){var n=Object.keys(e),r=Object.keys(t),i,o;if(n.length!==r.length)return!1;for(n.sort(),r.sort(),o=n.length-1;o>=0;o--)if(n[o]!=r[o])return!1;for(o=n.length-1;o>=0;o--)if(i=n[o],!n3(e[i],t[i],i))return!1;return typeof e==typeof t}function One(){dP(),oee()}const Hc="top",gi="left",mi="right",Sa="bottom",Pne="top-left",Lne="top-right",zne="bottom-left",Ine="bottom-right",r3="start",hE="middle",Cn="end",jne="x",Bne="y",yv="group",i3="axis",o3="title",Une="frame",Wne="scope",s3="legend",uL="row-header",cL="row-footer",fL="row-title",dL="column-header",hL="column-footer",pL="column-title",qne="padding",Hne="symbol",gL="fit",mL="fit-x",yL="fit-y",Vne="pad",a3="none",jg="all",pE="each",l3="flush",Ys="column",Xs="row";function vL(e){P.call(this,null,e)}X(vL,P,{transform(e,t){const n=t.dataflow,r=e.mark,i=r.marktype,o=kr[i],s=o.bound;let a=r.bounds,l;if(o.nested)r.items.length&&n.dirty(r.items[0]),a=Bg(r,s),r.items.forEach(u=>{u.bounds.clear().union(a)});else if(i===yv||e.modified())switch(t.visit(t.MOD,u=>n.dirty(u)),a.clear(),r.items.forEach(u=>a.union(Bg(u,s))),r.role){case i3:case s3:case o3:t.reflow()}else l=t.changed(t.REM),t.visit(t.ADD,u=>{a.union(Bg(u,s))}),t.visit(t.MOD,u=>{l=l||a.alignsWith(u.bounds),n.dirty(u),a.union(Bg(u,s))}),l&&(a.clear(),r.items.forEach(u=>a.union(u.bounds)));return aL(r),t.modifies("bounds")}});function Bg(e,t,n){return t(e.bounds.clear(),e,n)}const eF=":vega_identifier:";function u3(e){P.call(this,0,e)}u3.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]};X(u3,P,{transform(e,t){const n=Gne(t.dataflow),r=e.as;let i=n.value;return t.visit(t.ADD,o=>o[r]=o[r]||++i),n.set(this.value=i),t}});function Gne(e){return e._signals[eF]||(e._signals[eF]=e.add(0))}function xL(e){P.call(this,null,e)}X(xL,P,{transform(e,t){let n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,Yne(e),e.index),n.group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);const r=n.marktype===yv?lv:av;return t.visit(t.ADD,i=>r.call(i,n)),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});function Yne(e){const t=e.groups,n=e.parent;return t&&t.size===1?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}function wL(e){P.call(this,null,e)}const tF={parity:e=>e.filter((t,n)=>n%2?t.opacity=0:1),greedy:(e,t)=>{let n;return e.filter((r,i)=>!i||!bL(n.bounds,r.bounds,t)?(n=r,1):r.opacity=0)}},bL=(e,t,n)=>n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2),nF=(e,t)=>{for(var n=1,r=e.length,i=e[0].bounds,o;n<r;i=o,++n)if(bL(i,o=e[n].bounds,t))return!0},Xne=e=>{const t=e.bounds;return t.width()>1&&t.height()>1},Qne=(e,t,n)=>{var r=e.range(),i=new vt;return t===Hc||t===Sa?i.set(r[0],-1/0,r[1],1/0):i.set(-1/0,r[0],1/0,r[1]),i.expand(n||1),o=>i.encloses(o.bounds)},rF=e=>(e.forEach(t=>t.opacity=1),e),iF=(e,t)=>e.reflow(t.modified()).modifies("opacity");X(wL,P,{transform(e,t){const n=tF[e.method]||tF.parity,r=e.separation||0;let i=t.materialize(t.SOURCE).source,o,s;if(!i||!i.length)return;if(!e.method)return e.modified("method")&&(rF(i),t=iF(t,e)),t;if(i=i.filter(Xne),!i.length)return;if(e.sort&&(i=i.slice().sort(e.sort)),o=rF(i),t=iF(t,e),o.length>=3&&nF(o,r)){do o=n(o,r);while(o.length>=3&&nF(o,r));o.length<3&&!Ce(i).opacity&&(o.length>1&&(Ce(o).opacity=0),Ce(i).opacity=1)}e.boundScale&&e.boundTolerance>=0&&(s=Qne(e.boundScale,e.boundOrient,+e.boundTolerance),i.forEach(l=>{s(l)||(l.opacity=0)}));const a=o[0].mark.bounds.clear();return i.forEach(l=>{l.opacity&&a.union(l.bounds)}),t}});function EL(e){P.call(this,null,e)}X(EL,P,{transform(e,t){const n=t.dataflow;if(t.visit(t.ALL,r=>n.dirty(r)),t.fields&&t.fields.zindex){const r=t.source&&t.source[0];r&&(r.mark.zdirty=!0)}}});const un=new vt;function ic(e,t,n){return e[t]===n?0:(e[t]=n,1)}function Kne(e){var t=e.items[0].orient;return t===gi||t===mi}function Zne(e){let t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}function Jne(e,t,n,r){var i=t.items[0],o=i.datum,s=i.translate!=null?i.translate:.5,a=i.orient,l=Zne(o),u=i.range,c=i.offset,f=i.position,d=i.minExtent,h=i.maxExtent,p=o.title&&i.items[l[2]].items[0],g=i.titlePadding,y=i.bounds,m=p&&HC(p),v=0,x=0,w,b;switch(un.clear().union(y),y.clear(),(w=l[0])>-1&&y.union(i.items[w].bounds),(w=l[1])>-1&&y.union(i.items[w].bounds),a){case Hc:v=f||0,x=-c,b=Math.max(d,Math.min(h,-y.y1)),y.add(0,-b).add(u,0),p&&Ug(e,p,b,g,m,0,-1,y);break;case gi:v=-c,x=f||0,b=Math.max(d,Math.min(h,-y.x1)),y.add(-b,0).add(0,u),p&&Ug(e,p,b,g,m,1,-1,y);break;case mi:v=n+c,x=f||0,b=Math.max(d,Math.min(h,y.x2)),y.add(0,0).add(b,u),p&&Ug(e,p,b,g,m,1,1,y);break;case Sa:v=f||0,x=r+c,b=Math.max(d,Math.min(h,y.y2)),y.add(0,0).add(u,b),p&&Ug(e,p,b,g,0,0,1,y);break;default:v=i.x,x=i.y}return ys(y.translate(v,x),i),ic(i,"x",v+s)|ic(i,"y",x+s)&&(i.bounds=un,e.dirty(i),i.bounds=y,e.dirty(i)),i.mark.bounds.clear().union(y)}function Ug(e,t,n,r,i,o,s,a){const l=t.bounds;if(t.auto){const u=s*(n+i+r);let c=0,f=0;e.dirty(t),o?c=(t.x||0)-(t.x=u):f=(t.y||0)-(t.y=u),t.mark.bounds.clear().union(l.translate(-c,-f)),e.dirty(t)}a.union(l)}const oF=(e,t)=>Math.floor(Math.min(e,t)),sF=(e,t)=>Math.ceil(Math.max(e,t));function ere(e){var t=e.items,n=t.length,r=0,i,o;const s={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;r<n;++r)if(i=t[r],o=i.items,i.marktype===yv)switch(i.role){case i3:case s3:case o3:break;case uL:s.rowheaders.push(...o);break;case cL:s.rowfooters.push(...o);break;case dL:s.colheaders.push(...o);break;case hL:s.colfooters.push(...o);break;case fL:s.rowtitle=o[0];break;case pL:s.coltitle=o[0];break;default:s.marks.push(...o)}return s}function tre(e){return new vt().set(0,0,e.width||0,e.height||0)}function nre(e){const t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function Ke(e,t,n){const r=Z(e)?e[t]:e;return r??(n!==void 0?n:0)}function aF(e){return e<0?Math.ceil(-e):0}function SL(e,t,n){var r=!n.nodirty,i=n.bounds===l3?tre:nre,o=un.set(0,0,0,0),s=Ke(n.align,Ys),a=Ke(n.align,Xs),l=Ke(n.padding,Ys),u=Ke(n.padding,Xs),c=n.columns||t.length,f=c<=0?1:Math.ceil(t.length/c),d=t.length,h=Array(d),p=Array(c),g=0,y=Array(d),m=Array(f),v=0,x=Array(d),w=Array(d),b=Array(d),S,E,_,k,C,$,O,A,T,F,R;for(E=0;E<c;++E)p[E]=0;for(E=0;E<f;++E)m[E]=0;for(E=0;E<d;++E)$=t[E],C=b[E]=i($),$.x=$.x||0,x[E]=0,$.y=$.y||0,w[E]=0,_=E%c,k=~~(E/c),g=Math.max(g,O=Math.ceil(C.x2)),v=Math.max(v,A=Math.ceil(C.y2)),p[_]=Math.max(p[_],O),m[k]=Math.max(m[k],A),h[E]=l+aF(C.x1),y[E]=u+aF(C.y1),r&&e.dirty(t[E]);for(E=0;E<d;++E)E%c===0&&(h[E]=0),E<c&&(y[E]=0);if(s===pE)for(_=1;_<c;++_){for(R=0,E=_;E<d;E+=c)R<h[E]&&(R=h[E]);for(E=_;E<d;E+=c)h[E]=R+p[_-1]}else if(s===jg){for(R=0,E=0;E<d;++E)E%c&&R<h[E]&&(R=h[E]);for(E=0;E<d;++E)E%c&&(h[E]=R+g)}else for(s=!1,_=1;_<c;++_)for(E=_;E<d;E+=c)h[E]+=p[_-1];if(a===pE)for(k=1;k<f;++k){for(R=0,E=k*c,S=E+c;E<S;++E)R<y[E]&&(R=y[E]);for(E=k*c;E<S;++E)y[E]=R+m[k-1]}else if(a===jg){for(R=0,E=c;E<d;++E)R<y[E]&&(R=y[E]);for(E=c;E<d;++E)y[E]=R+v}else for(a=!1,k=1;k<f;++k)for(E=k*c,S=E+c;E<S;++E)y[E]+=m[k-1];for(T=0,E=0;E<d;++E)T=h[E]+(E%c?T:0),x[E]+=T-t[E].x;for(_=0;_<c;++_)for(F=0,E=_;E<d;E+=c)F+=y[E],w[E]+=F-t[E].y;if(s&&Ke(n.center,Ys)&&f>1)for(E=0;E<d;++E)C=s===jg?g:p[E%c],T=C-b[E].x2-t[E].x-x[E],T>0&&(x[E]+=T/2);if(a&&Ke(n.center,Xs)&&c!==1)for(E=0;E<d;++E)C=a===jg?v:m[~~(E/c)],F=C-b[E].y2-t[E].y-w[E],F>0&&(w[E]+=F/2);for(E=0;E<d;++E)o.union(b[E].translate(x[E],w[E]));switch(T=Ke(n.anchor,jne),F=Ke(n.anchor,Bne),Ke(n.anchor,Ys)){case Cn:T-=o.width();break;case hE:T-=o.width()/2}switch(Ke(n.anchor,Xs)){case Cn:F-=o.height();break;case hE:F-=o.height()/2}for(T=Math.round(T),F=Math.round(F),o.clear(),E=0;E<d;++E)t[E].mark.bounds.clear();for(E=0;E<d;++E)$=t[E],$.x+=x[E]+=T,$.y+=w[E]+=F,o.union($.mark.bounds.union($.bounds.translate(x[E],w[E]))),r&&e.dirty($);return o}function rre(e,t,n){var r=ere(t),i=r.marks,o=n.bounds===l3?ire:ore,s=n.offset,a=n.columns||i.length,l=a<=0?1:Math.ceil(i.length/a),u=l*a,c,f,d,h,p,g,y;const m=SL(e,i,n);m.empty()&&m.set(0,0,0,0),r.rowheaders&&(g=Ke(n.headerBand,Xs,null),c=Wg(e,r.rowheaders,i,a,l,-Ke(s,"rowHeader"),oF,0,o,"x1",0,a,1,g)),r.colheaders&&(g=Ke(n.headerBand,Ys,null),f=Wg(e,r.colheaders,i,a,a,-Ke(s,"columnHeader"),oF,1,o,"y1",0,1,a,g)),r.rowfooters&&(g=Ke(n.footerBand,Xs,null),d=Wg(e,r.rowfooters,i,a,l,Ke(s,"rowFooter"),sF,0,o,"x2",a-1,a,1,g)),r.colfooters&&(g=Ke(n.footerBand,Ys,null),h=Wg(e,r.colfooters,i,a,a,Ke(s,"columnFooter"),sF,1,o,"y2",u-a,1,a,g)),r.rowtitle&&(p=Ke(n.titleAnchor,Xs),y=Ke(s,"rowTitle"),y=p===Cn?d+y:c-y,g=Ke(n.titleBand,Xs,.5),lF(e,r.rowtitle,y,0,m,g)),r.coltitle&&(p=Ke(n.titleAnchor,Ys),y=Ke(s,"columnTitle"),y=p===Cn?h+y:f-y,g=Ke(n.titleBand,Ys,.5),lF(e,r.coltitle,y,1,m,g))}function ire(e,t){return t==="x1"?e.x||0:t==="y1"?e.y||0:t==="x2"?(e.x||0)+(e.width||0):t==="y2"?(e.y||0)+(e.height||0):void 0}function ore(e,t){return e.bounds[t]}function Wg(e,t,n,r,i,o,s,a,l,u,c,f,d,h){var p=n.length,g=0,y=0,m,v,x,w,b,S,E,_,k;if(!p)return g;for(m=c;m<p;m+=f)n[m]&&(g=s(g,l(n[m],u)));if(!t.length)return g;for(t.length>i&&(e.warn("Grid headers exceed limit: "+i),t=t.slice(0,i)),g+=o,v=0,w=t.length;v<w;++v)e.dirty(t[v]),t[v].mark.bounds.clear();for(m=c,v=0,w=t.length;v<w;++v,m+=f){for(S=t[v],b=S.mark.bounds,x=m;x>=0&&(E=n[x])==null;x-=d);a?(_=h==null?E.x:Math.round(E.bounds.x1+h*E.bounds.width()),k=g):(_=g,k=h==null?E.y:Math.round(E.bounds.y1+h*E.bounds.height())),b.union(S.bounds.translate(_-(S.x||0),k-(S.y||0))),S.x=_,S.y=k,e.dirty(S),y=s(y,b[u])}return y}function lF(e,t,n,r,i,o){if(t){e.dirty(t);var s=n,a=n;r?s=Math.round(i.x1+o*i.width()):a=Math.round(i.y1+o*i.height()),t.bounds.translate(s-(t.x||0),a-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=s,t.y=a,e.dirty(t)}}function sre(e,t){const n=e[t]||{};return(r,i)=>n[r]!=null?n[r]:e[r]!=null?e[r]:i}function are(e,t){let n=-1/0;return e.forEach(r=>{r.offset!=null&&(n=Math.max(n,r.offset))}),n>-1/0?n:t}function lre(e,t,n,r,i,o,s){const a=sre(n,t),l=are(e,a("offset",0)),u=a("anchor",r3),c=u===Cn?1:u===hE?.5:0,f={align:pE,bounds:a("bounds",l3),columns:a("direction")==="vertical"?1:e.length,padding:a("margin",8),center:a("center"),nodirty:!0};switch(t){case gi:f.anchor={x:Math.floor(r.x1)-l,column:Cn,y:c*(s||r.height()+2*r.y1),row:u};break;case mi:f.anchor={x:Math.ceil(r.x2)+l,y:c*(s||r.height()+2*r.y1),row:u};break;case Hc:f.anchor={y:Math.floor(i.y1)-l,row:Cn,x:c*(o||i.width()+2*i.x1),column:u};break;case Sa:f.anchor={y:Math.ceil(i.y2)+l,x:c*(o||i.width()+2*i.x1),column:u};break;case Pne:f.anchor={x:l,y:l};break;case Lne:f.anchor={x:o-l,y:l,column:Cn};break;case zne:f.anchor={x:l,y:s-l,row:Cn};break;case Ine:f.anchor={x:o-l,y:s-l,column:Cn,row:Cn};break}return f}function ure(e,t){var n=t.items[0],r=n.datum,i=n.orient,o=n.bounds,s=n.x,a=n.y,l,u;return n._bounds?n._bounds.clear().union(o):n._bounds=o.clone(),o.clear(),fre(e,n,n.items[0].items[0]),o=cre(n,o),l=2*n.padding,u=2*n.padding,o.empty()||(l=Math.ceil(o.width()+l),u=Math.ceil(o.height()+u)),r.type===Hne&&dre(n.items[0].items[0].items[0].items),i!==a3&&(n.x=s=0,n.y=a=0),n.width=l,n.height=u,ys(o.set(s,a,s+l,a+u),n),n.mark.bounds.clear().union(o),n}function cre(e,t){return e.items.forEach(n=>t.union(n.bounds)),t.x1=e.padding,t.y1=e.padding,t}function fre(e,t,n){var r=t.padding,i=r-n.x,o=r-n.y;if(!t.datum.title)(i||o)&&ud(e,n,i,o);else{var s=t.items[1].items[0],a=s.anchor,l=t.titlePadding||0,u=r-s.x,c=r-s.y;switch(s.orient){case gi:i+=Math.ceil(s.bounds.width())+l;break;case mi:case Sa:break;default:o+=s.bounds.height()+l}switch((i||o)&&ud(e,n,i,o),s.orient){case gi:c+=Tu(t,n,s,a,1,1);break;case mi:u+=Tu(t,n,s,Cn,0,0)+l,c+=Tu(t,n,s,a,1,1);break;case Sa:u+=Tu(t,n,s,a,0,0),c+=Tu(t,n,s,Cn,-1,0,1)+l;break;default:u+=Tu(t,n,s,a,0,0)}(u||c)&&ud(e,s,u,c),(u=Math.round(s.bounds.x1-r))<0&&(ud(e,n,-u,0),ud(e,s,-u,0))}}function Tu(e,t,n,r,i,o,s){const a=e.datum.type!=="symbol",l=n.datum.vgrad,u=a&&(o||!l)&&!s?t.items[0]:t,c=u.bounds[i?"y2":"x2"]-e.padding,f=l&&o?c:0,d=l&&o?0:c,h=i<=0?0:HC(n);return Math.round(r===r3?f:r===Cn?d-h:.5*(c-h))}function ud(e,t,n,r){t.x+=n,t.y+=r,t.bounds.translate(n,r),t.mark.bounds.translate(n,r),e.dirty(t)}function dre(e){const t=e.reduce((n,r)=>(n[r.column]=Math.max(r.bounds.x2-r.x,n[r.column]||0),n),{});e.forEach(n=>{n.width=t[n.column],n.height=n.bounds.y2-n.y})}function hre(e,t,n,r,i){var o=t.items[0],s=o.frame,a=o.orient,l=o.anchor,u=o.offset,c=o.padding,f=o.items[0].items[0],d=o.items[1]&&o.items[1].items[0],h=a===gi||a===mi?r:n,p=0,g=0,y=0,m=0,v=0,x;if(s!==yv?a===gi?(p=i.y2,h=i.y1):a===mi?(p=i.y1,h=i.y2):(p=i.x1,h=i.x2):a===gi&&(p=r,h=0),x=l===r3?p:l===Cn?h:(p+h)/2,d&&d.text){switch(a){case Hc:case Sa:v=f.bounds.height()+c;break;case gi:m=f.bounds.width()+c;break;case mi:m=-f.bounds.width()-c;break}un.clear().union(d.bounds),un.translate(m-(d.x||0),v-(d.y||0)),ic(d,"x",m)|ic(d,"y",v)&&(e.dirty(d),d.bounds.clear().union(un),d.mark.bounds.clear().union(un),e.dirty(d)),un.clear().union(d.bounds)}else un.clear();switch(un.union(f.bounds),a){case Hc:g=x,y=i.y1-un.height()-u;break;case gi:g=i.x1-un.width()-u,y=x;break;case mi:g=i.x2+un.width()+u,y=x;break;case Sa:g=x,y=i.y2+u;break;default:g=o.x,y=o.y}return ic(o,"x",g)|ic(o,"y",y)&&(un.translate(g,y),e.dirty(o),o.bounds.clear().union(un),t.bounds.clear().union(un),e.dirty(o)),o.bounds}function _L(e){P.call(this,null,e)}X(_L,P,{transform(e,t){const n=t.dataflow;return e.mark.items.forEach(r=>{e.layout&&rre(n,r,e.layout),gre(n,r,e)}),pre(e.mark.group)?t.reflow():t}});function pre(e){return e&&e.mark.role!=="legend-entry"}function gre(e,t,n){var r=t.items,i=Math.max(0,t.width||0),o=Math.max(0,t.height||0),s=new vt().set(0,0,i,o),a=s.clone(),l=s.clone(),u=[],c,f,d,h,p,g;for(p=0,g=r.length;p<g;++p)switch(f=r[p],f.role){case i3:h=Kne(f)?a:l,h.union(Jne(e,f,i,o));break;case o3:c=f;break;case s3:u.push(ure(e,f));break;case Une:case Wne:case uL:case cL:case fL:case dL:case hL:case pL:a.union(f.bounds),l.union(f.bounds);break;default:s.union(f.bounds)}if(u.length){const y={};u.forEach(m=>{d=m.orient||mi,d!==a3&&(y[d]||(y[d]=[])).push(m)});for(const m in y){const v=y[m];SL(e,v,lre(v,m,n.legends,a,l,i,o))}u.forEach(m=>{const v=m.bounds;if(v.equals(m._bounds)||(m.bounds=m._bounds,e.dirty(m),m.bounds=v,e.dirty(m)),n.autosize&&(n.autosize.type===gL||n.autosize.type===mL||n.autosize.type===yL))switch(m.orient){case gi:case mi:s.add(v.x1,0).add(v.x2,0);break;case Hc:case Sa:s.add(0,v.y1).add(0,v.y2)}else s.union(v)})}s.union(a).union(l),c&&s.union(hre(e,c,i,o,s)),t.clip&&s.set(0,0,t.width||0,t.height||0),mre(e,t,s,n)}function mre(e,t,n,r){const i=r.autosize||{},o=i.type;if(e._autosize<1||!o)return;let s=e._width,a=e._height,l=Math.max(0,t.width||0),u=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,t.height||0),f=Math.max(0,Math.ceil(-n.y1));const d=Math.max(0,Math.ceil(n.x2-l)),h=Math.max(0,Math.ceil(n.y2-c));if(i.contains===qne){const p=e.padding();s-=p.left+p.right,a-=p.top+p.bottom}o===a3?(u=0,f=0,l=s,c=a):o===gL?(l=Math.max(0,s-u-d),c=Math.max(0,a-f-h)):o===mL?(l=Math.max(0,s-u-d),a=c+f+h):o===yL?(s=l+u+d,c=Math.max(0,a-f-h)):o===Vne&&(s=l+u+d,a=c+f+h),e._resizeView(s,a,l,c,[u,f],i.resize)}const yre=Object.freeze(Object.defineProperty({__proto__:null,bound:vL,identifier:u3,mark:xL,overlap:wL,render:EL,viewlayout:_L},Symbol.toStringTag,{value:"Module"}));function kL(e){P.call(this,null,e)}X(kL,P,{transform(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,o=e.scale,s=e.count==null?e.values?e.values.length:10:e.count,a=$C(o,s,e.minstep),l=e.format||ZO(n,o,a,e.formatSpecifier,e.formatType,!!e.values),u=e.values?KO(o,e.values,a):AC(o,a);return i&&(r.rem=i),i=u.map((c,f)=>De({index:f/(u.length-1||1),value:c,label:l(c)})),e.extra&&i.length&&i.push(De({index:-1,extra:{value:i[0].value},label:""})),r.source=i,r.add=i,this.value=i,r}});function CL(e){P.call(this,null,e)}function vre(){return De({})}function xre(e){const t=bf().test(n=>n.exit);return t.lookup=n=>t.get(e(n)),t}X(CL,P,{transform(e,t){var n=t.dataflow,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.item||vre,o=e.key||le,s=this.value;return j(r.encode)&&(r.encode=null),s&&(e.modified("key")||t.modified(o))&&I("DataJoin does not support modified key function or fields."),s||(t=t.addAll(),this.value=s=xre(o)),t.visit(t.ADD,a=>{const l=o(a);let u=s.get(l);u?u.exit?(s.empty--,r.add.push(u)):r.mod.push(u):(u=i(a),s.set(l,u),r.add.push(u)),u.datum=a,u.exit=!1}),t.visit(t.MOD,a=>{const l=o(a),u=s.get(l);u&&(u.datum=a,r.mod.push(u))}),t.visit(t.REM,a=>{const l=o(a),u=s.get(l);a===u.datum&&!u.exit&&(r.rem.push(u),u.exit=!0,++s.empty)}),t.changed(t.ADD_MOD)&&r.modifies("datum"),(t.clean()||e.clean&&s.empty>n.cleanThreshold)&&n.runAfter(s.clean),r}});function $L(e){P.call(this,null,e)}X($L,P,{transform(e,t){var n=t.fork(t.ADD_REM),r=e.mod||!1,i=e.encoders,o=t.encode;if(j(o))if(n.changed()||o.every(f=>i[f]))o=o[0],n.encode=null;else return t.StopPropagation;var s=o==="enter",a=i.update||Fs,l=i.enter||Fs,u=i.exit||Fs,c=(o&&!s?i[o]:a)||Fs;if(t.changed(t.ADD)&&(t.visit(t.ADD,f=>{l(f,e),a(f,e)}),n.modifies(l.output),n.modifies(a.output),c!==Fs&&c!==a&&(t.visit(t.ADD,f=>{c(f,e)}),n.modifies(c.output))),t.changed(t.REM)&&u!==Fs&&(t.visit(t.REM,f=>{u(f,e)}),n.modifies(u.output)),s||c!==Fs){const f=t.MOD|(e.modified()?t.REFLOW:0);s?(t.visit(f,d=>{const h=l(d,e)||r;(c(d,e)||h)&&n.mod.push(d)}),n.mod.length&&n.modifies(l.output)):t.visit(f,d=>{(c(d,e)||r)&&n.mod.push(d)}),n.mod.length&&n.modifies(c.output)}return n.changed()?n:t.StopPropagation}});function AL(e){P.call(this,[],e)}X(AL,P,{transform(e,t){if(this.value!=null&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,o=e.type||D0,s=e.scale,a=+e.limit,l=$C(s,e.count==null?5:e.count,e.minstep),u=!!e.values||o===D0,c=e.format||nP(n,s,l,o,e.formatSpecifier,e.formatType,u),f=e.values||tP(s,l),d,h,p,g,y;return i&&(r.rem=i),o===D0?(a&&f.length>a?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),i=f.slice(0,a-1),y=!0):i=f,me(p=e.size)?(!e.values&&s(i[0])===0&&(i=i.slice(1)),g=i.reduce((m,v)=>Math.max(m,p(v,e)),0)):p=bn(g=p||8),i=i.map((m,v)=>De({index:v,label:c(m,v,i),value:m,offset:g,size:p(m,e)})),y&&(y=f[i.length],i.push(De({index:i.length,label:`…${f.length-i.length} entries`,value:y,offset:g,size:p(y,e)})))):o===VJ?(d=s.domain(),h=YO(s,d[0],Ce(d)),f.length<3&&!e.values&&d[0]!==Ce(d)&&(f=[d[0],Ce(d)]),i=f.map((m,v)=>De({index:v,label:c(m,v,f),value:m,perc:h(m)}))):(p=f.length-1,h=ree(s),i=f.map((m,v)=>De({index:v,label:c(m,v,f),value:m,perc:v?h(m):0,perc2:v===p?1:h(f[v+1])}))),r.source=i,r.add=i,this.value=i,r}});const wre=e=>e.source.x,bre=e=>e.source.y,Ere=e=>e.target.x,Sre=e=>e.target.y;function c3(e){P.call(this,{},e)}c3.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]};X(c3,P,{transform(e,t){var n=e.sourceX||wre,r=e.sourceY||bre,i=e.targetX||Ere,o=e.targetY||Sre,s=e.as||"path",a=e.orient||"vertical",l=e.shape||"line",u=uF.get(l+"-"+a)||uF.get(l);return u||I("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,c=>{c[s]=u(n(c),r(c),i(c),o(c))}),t.reflow(e.modified()).modifies(s)}});const FL=(e,t,n,r)=>"M"+e+","+t+"L"+n+","+r,_re=(e,t,n,r)=>FL(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),ML=(e,t,n,r)=>{var i=n-e,o=r-t,s=Math.hypot(i,o)/2,a=180*Math.atan2(o,i)/Math.PI;return"M"+e+","+t+"A"+s+","+s+" "+a+" 0 1 "+n+","+r},kre=(e,t,n,r)=>ML(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),TL=(e,t,n,r)=>{const i=n-e,o=r-t,s=.2*(i+o),a=.2*(o-i);return"M"+e+","+t+"C"+(e+s)+","+(t+a)+" "+(n+a)+","+(r-s)+" "+n+","+r},Cre=(e,t,n,r)=>TL(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),$re=(e,t,n,r)=>"M"+e+","+t+"V"+r+"H"+n,Are=(e,t,n,r)=>"M"+e+","+t+"H"+n+"V"+r,Fre=(e,t,n,r)=>{const i=Math.cos(e),o=Math.sin(e),s=Math.cos(n),a=Math.sin(n),l=Math.abs(n-e)>Math.PI?n<=e:n>e;return"M"+t*i+","+t*o+"A"+t+","+t+" 0 0,"+(l?1:0)+" "+t*s+","+t*a+"L"+r*s+","+r*a},Mre=(e,t,n,r)=>{const i=(e+n)/2;return"M"+e+","+t+"C"+i+","+t+" "+i+","+r+" "+n+","+r},Tre=(e,t,n,r)=>{const i=(t+r)/2;return"M"+e+","+t+"C"+e+","+i+" "+n+","+i+" "+n+","+r},Nre=(e,t,n,r)=>{const i=Math.cos(e),o=Math.sin(e),s=Math.cos(n),a=Math.sin(n),l=(t+r)/2;return"M"+t*i+","+t*o+"C"+l*i+","+l*o+" "+l*s+","+l*a+" "+r*s+","+r*a},uF=bf({line:FL,"line-radial":_re,arc:ML,"arc-radial":kre,curve:TL,"curve-radial":Cre,"orthogonal-horizontal":$re,"orthogonal-vertical":Are,"orthogonal-radial":Fre,"diagonal-horizontal":Mre,"diagonal-vertical":Tre,"diagonal-radial":Nre});function f3(e){P.call(this,null,e)}f3.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]};X(f3,P,{transform(e,t){var n=e.as||["startAngle","endAngle"],r=n[0],i=n[1],o=e.field||vf,s=e.startAngle||0,a=e.endAngle!=null?e.endAngle:2*Math.PI,l=t.source,u=l.map(o),c=u.length,f=s,d=(a-s)/HR(u),h=mr(c),p,g,y;for(e.sort&&h.sort((m,v)=>u[m]-u[v]),p=0;p<c;++p)y=u[h[p]],g=l[h[p]],g[r]=f,g[i]=f+=y*d;return this.value=u,t.reflow(e.modified()).modifies(n)}});const Rre=5;function Dre(e){const t=e.type;return!e.bins&&(t===Ic||t===Ap||t===Fp)}function NL(e){return _C(e)&&e!==so}const Ore=ki(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function RL(e){P.call(this,null,e),this.modified(!0)}X(RL,P,{transform(e,t){var n=t.dataflow,r=this.value,i=Pre(e);(!r||i!==r.type)&&(this.value=r=Ne(i)());for(i in e)if(!Ore[i]){if(i==="padding"&&NL(r.type))continue;me(r[i])?r[i](e[i]):n.warn("Unsupported scale property: "+i)}return Ure(r,e,Bre(r,e,zre(r,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function Pre(e){var t=e.type,n="",r;return t===so?so+"-"+Ic:(Lre(e)&&(r=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(e.domainMid!=null):0,n=r===2?so+"-":r===3?Ff+"-":""),(n+t||Ic).toLowerCase())}function Lre(e){const t=e.type;return _C(t)&&t!==Ul&&t!==Wl&&(e.scheme||e.range&&e.range.length&&e.range.every(ee))}function zre(e,t,n){const r=Ire(e,t.domainRaw,n);if(r>-1)return r;var i=t.domain,o=e.type,s=t.zero||t.zero===void 0&&Dre(e),a,l;if(!i)return 0;if((s||t.domainMin!=null||t.domainMax!=null||t.domainMid!=null)&&(a=(i=i.slice()).length-1||1,s&&(i[0]>0&&(i[0]=0),i[a]<0&&(i[a]=0)),t.domainMin!=null&&(i[0]=t.domainMin),t.domainMax!=null&&(i[a]=t.domainMax),t.domainMid!=null)){l=t.domainMid;const u=l>i[a]?a+1:l<i[0]?0:a;u!==a&&n.warn("Scale domainMid exceeds domain min or max.",l),i.splice(u,0,l)}return NL(o)&&t.padding&&i[0]!==Ce(i)&&(i=jre(o,i,t.range,t.padding,t.exponent,t.constant)),e.domain(DL(o,i,n)),o===wC&&e.unknown(t.domainImplicit?Gb:void 0),t.nice&&e.nice&&e.nice(t.nice!==!0&&$C(e,t.nice)||null),i.length}function Ire(e,t,n){return t?(e.domain(DL(e.type,t,n)),t.length):-1}function jre(e,t,n,r,i,o){var s=Math.abs(Ce(n)-n[0]),a=s/(s-2*r),l=e===ds?U_(t,null,a):e===Fp?Mm(t,null,a,.5):e===Ap?Mm(t,null,a,i||1):e===nv?W_(t,null,a,o||1):B_(t,null,a);return t=t.slice(),t[0]=l[0],t[t.length-1]=l[1],t}function DL(e,t,n){if(WO(e)){var r=Math.abs(t.reduce((i,o)=>i+(o<0?-1:o>0?1:0),0));r!==t.length&&n.warn("Log scale domain includes zero: "+Y(t))}return t}function Bre(e,t,n){let r=t.bins;if(r&&!j(r)){const i=e.domain(),o=i[0],s=Ce(i),a=r.step;let l=r.start==null?o:r.start,u=r.stop==null?s:r.stop;a||I("Scale bins parameter missing step property."),l<o&&(l=a*Math.ceil(o/a)),u>s&&(u=a*Math.floor(s/a)),r=mr(l,u+a/2,a)}return r?e.bins=r:e.bins&&delete e.bins,e.type===bC&&(r?!t.domain&&!t.domainRaw&&(e.domain(r),n=r.length):e.bins=e.domain()),n}function Ure(e,t,n){var r=e.type,i=t.round||!1,o=t.range;if(t.rangeStep!=null)o=Wre(r,t,n);else if(t.scheme&&(o=qre(r,t,n),me(o))){if(e.interpolator)return e.interpolator(o);I(`Scale type ${r} does not support interpolating color schemes.`)}if(o&&qO(r))return e.interpolator(ov(gE(o,t.reverse),t.interpolate,t.interpolateGamma));o&&t.interpolate&&e.interpolate?e.interpolate(kC(t.interpolate,t.interpolateGamma)):me(e.round)?e.round(i):me(e.rangeRound)&&e.interpolate(i?Cp:La),o&&e.range(gE(o,t.reverse))}function Wre(e,t,n){e!==LO&&e!==eE&&I("Only band and point scales support rangeStep.");var r=(t.paddingOuter!=null?t.paddingOuter:t.padding)||0,i=e===eE?1:(t.paddingInner!=null?t.paddingInner:t.padding)||0;return[0,t.rangeStep*xC(n,i,r)]}function qre(e,t,n){var r=t.schemeExtent,i,o;return j(t.scheme)?o=ov(t.scheme,t.interpolate,t.interpolateGamma):(i=t.scheme.toLowerCase(),o=CC(i),o||I(`Unrecognized scheme name: ${t.scheme}`)),n=e===iv?n+1:e===bC?n-1:e===jc||e===rv?+t.schemeCount||Rre:n,qO(e)?cF(o,r,t.reverse):me(o)?GO(cF(o,r),n):e===wC?o:o.slice(0,n)}function cF(e,t,n){return me(e)&&(t||n)?VO(e,gE(t||[0,1],n)):e}function gE(e,t){return t?e.slice().reverse():e}function OL(e){P.call(this,null,e)}X(OL,P,{transform(e,t){const n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(fu(e.sort)),this.modified(n),t}});const fF="zero",PL="center",LL="normalize",zL=["y0","y1"];function d3(e){P.call(this,null,e)}d3.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:fF,values:[fF,PL,LL]},{name:"as",type:"string",array:!0,length:2,default:zL}]};X(d3,P,{transform(e,t){var n=e.as||zL,r=n[0],i=n[1],o=fu(e.sort),s=e.field||vf,a=e.offset===PL?Hre:e.offset===LL?Vre:Gre,l,u,c,f;for(l=Yre(t.source,e.groupby,o,s),u=0,c=l.length,f=l.max;u<c;++u)a(l[u],f,s,r,i);return t.reflow(e.modified()).modifies(n)}});function Hre(e,t,n,r,i){for(var o=(t-e.sum)/2,s=e.length,a=0,l;a<s;++a)l=e[a],l[r]=o,l[i]=o+=Math.abs(n(l))}function Vre(e,t,n,r,i){for(var o=1/e.sum,s=0,a=e.length,l=0,u=0,c;l<a;++l)c=e[l],c[r]=s,c[i]=s=o*(u+=Math.abs(n(c)))}function Gre(e,t,n,r,i){for(var o=0,s=0,a=e.length,l=0,u,c;l<a;++l)c=e[l],u=+n(c),u<0?(c[r]=s,c[i]=s+=u):(c[r]=o,c[i]=o+=u)}function Yre(e,t,n,r){var i=[],o=g=>g(c),s,a,l,u,c,f,d,h,p;if(t==null)i.push(e.slice());else for(s={},a=0,l=e.length;a<l;++a)c=e[a],f=t.map(o),d=s[f],d||(s[f]=d=[],i.push(d)),d.push(c);for(f=0,p=0,u=i.length;f<u;++f){for(d=i[f],a=0,h=0,l=d.length;a<l;++a)h+=Math.abs(r(d[a]));d.sum=h,h>p&&(p=h),n&&d.sort(n)}return i.max=p,i}const Xre=Object.freeze(Object.defineProperty({__proto__:null,axisticks:kL,datajoin:CL,encode:$L,legendentries:AL,linkpath:c3,pie:f3,scale:RL,sortitems:OL,stack:d3},Symbol.toStringTag,{value:"Module"}));var ce=1e-6,a1=1e-12,we=Math.PI,ut=we/2,l1=we/4,Pn=we*2,dt=180/we,ve=we/180,ke=Math.abs,Tf=Math.atan,Qr=Math.atan2,fe=Math.cos,qg=Math.ceil,IL=Math.exp,mE=Math.hypot,u1=Math.log,T2=Math.pow,ue=Math.sin,zr=Math.sign||function(e){return e>0?1:e<0?-1:0},Ln=Math.sqrt,h3=Math.tan;function jL(e){return e>1?0:e<-1?we:Math.acos(e)}function rr(e){return e>1?ut:e<-1?-ut:Math.asin(e)}function Yt(){}function c1(e,t){e&&hF.hasOwnProperty(e.type)&&hF[e.type](e,t)}var dF={Feature:function(e,t){c1(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)c1(n[r].geometry,t)}},hF={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){yE(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)yE(n[r],t,0)},Polygon:function(e,t){pF(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)pF(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)c1(n[r],t)}};function yE(e,t,n){var r=-1,i=e.length-n,o;for(t.lineStart();++r<i;)o=e[r],t.point(o[0],o[1],o[2]);t.lineEnd()}function pF(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)yE(e[n],t,1);t.polygonEnd()}function Uo(e,t){e&&dF.hasOwnProperty(e.type)?dF[e.type](e,t):c1(e,t)}var f1=new Dn,d1=new Dn,BL,UL,vE,xE,wE,go={point:Yt,lineStart:Yt,lineEnd:Yt,polygonStart:function(){f1=new Dn,go.lineStart=Qre,go.lineEnd=Kre},polygonEnd:function(){var e=+f1;d1.add(e<0?Pn+e:e),this.lineStart=this.lineEnd=this.point=Yt},sphere:function(){d1.add(Pn)}};function Qre(){go.point=Zre}function Kre(){WL(BL,UL)}function Zre(e,t){go.point=WL,BL=e,UL=t,e*=ve,t*=ve,vE=e,xE=fe(t=t/2+l1),wE=ue(t)}function WL(e,t){e*=ve,t*=ve,t=t/2+l1;var n=e-vE,r=n>=0?1:-1,i=r*n,o=fe(t),s=ue(t),a=wE*s,l=xE*o+a*fe(i),u=a*r*ue(i);f1.add(Qr(u,l)),vE=e,xE=o,wE=s}function Jre(e){return d1=new Dn,Uo(e,go),d1*2}function h1(e){return[Qr(e[1],e[0]),rr(e[2])]}function Hl(e){var t=e[0],n=e[1],r=fe(n);return[r*fe(t),r*ue(t),ue(n)]}function Hg(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Vc(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function N2(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function Vg(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function p1(e){var t=Ln(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var tt,Vn,st,dr,ul,qL,HL,yc,ch,Ps,hs,jo={point:bE,lineStart:gF,lineEnd:mF,polygonStart:function(){jo.point=GL,jo.lineStart=eie,jo.lineEnd=tie,ch=new Dn,go.polygonStart()},polygonEnd:function(){go.polygonEnd(),jo.point=bE,jo.lineStart=gF,jo.lineEnd=mF,f1<0?(tt=-(st=180),Vn=-(dr=90)):ch>ce?dr=90:ch<-ce&&(Vn=-90),hs[0]=tt,hs[1]=st},sphere:function(){tt=-(st=180),Vn=-(dr=90)}};function bE(e,t){Ps.push(hs=[tt=e,st=e]),t<Vn&&(Vn=t),t>dr&&(dr=t)}function VL(e,t){var n=Hl([e*ve,t*ve]);if(yc){var r=Vc(yc,n),i=[r[1],-r[0],0],o=Vc(i,r);p1(o),o=h1(o);var s=e-ul,a=s>0?1:-1,l=o[0]*dt*a,u,c=ke(s)>180;c^(a*ul<l&&l<a*e)?(u=o[1]*dt,u>dr&&(dr=u)):(l=(l+360)%360-180,c^(a*ul<l&&l<a*e)?(u=-o[1]*dt,u<Vn&&(Vn=u)):(t<Vn&&(Vn=t),t>dr&&(dr=t))),c?e<ul?fr(tt,e)>fr(tt,st)&&(st=e):fr(e,st)>fr(tt,st)&&(tt=e):st>=tt?(e<tt&&(tt=e),e>st&&(st=e)):e>ul?fr(tt,e)>fr(tt,st)&&(st=e):fr(e,st)>fr(tt,st)&&(tt=e)}else Ps.push(hs=[tt=e,st=e]);t<Vn&&(Vn=t),t>dr&&(dr=t),yc=n,ul=e}function gF(){jo.point=VL}function mF(){hs[0]=tt,hs[1]=st,jo.point=bE,yc=null}function GL(e,t){if(yc){var n=e-ul;ch.add(ke(n)>180?n+(n>0?360:-360):n)}else qL=e,HL=t;go.point(e,t),VL(e,t)}function eie(){go.lineStart()}function tie(){GL(qL,HL),go.lineEnd(),ke(ch)>ce&&(tt=-(st=180)),hs[0]=tt,hs[1]=st,yc=null}function fr(e,t){return(t-=e)<0?t+360:t}function nie(e,t){return e[0]-t[0]}function yF(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function rie(e){var t,n,r,i,o,s,a;if(dr=st=-(tt=Vn=1/0),Ps=[],Uo(e,jo),n=Ps.length){for(Ps.sort(nie),t=1,r=Ps[0],o=[r];t<n;++t)i=Ps[t],yF(r,i[0])||yF(r,i[1])?(fr(r[0],i[1])>fr(r[0],r[1])&&(r[1]=i[1]),fr(i[0],r[1])>fr(r[0],r[1])&&(r[0]=i[0])):o.push(r=i);for(s=-1/0,n=o.length-1,t=0,r=o[n];t<=n;r=i,++t)i=o[t],(a=fr(r[1],i[0]))>s&&(s=a,tt=i[0],st=r[1])}return Ps=hs=null,tt===1/0||Vn===1/0?[[NaN,NaN],[NaN,NaN]]:[[tt,Vn],[st,dr]]}var Pd,g1,m1,y1,v1,x1,w1,b1,EE,SE,_E,YL,XL,$n,An,Fn,yi={sphere:Yt,point:p3,lineStart:vF,lineEnd:xF,polygonStart:function(){yi.lineStart=sie,yi.lineEnd=aie},polygonEnd:function(){yi.lineStart=vF,yi.lineEnd=xF}};function p3(e,t){e*=ve,t*=ve;var n=fe(t);Bp(n*fe(e),n*ue(e),ue(t))}function Bp(e,t,n){++Pd,m1+=(e-m1)/Pd,y1+=(t-y1)/Pd,v1+=(n-v1)/Pd}function vF(){yi.point=iie}function iie(e,t){e*=ve,t*=ve;var n=fe(t);$n=n*fe(e),An=n*ue(e),Fn=ue(t),yi.point=oie,Bp($n,An,Fn)}function oie(e,t){e*=ve,t*=ve;var n=fe(t),r=n*fe(e),i=n*ue(e),o=ue(t),s=Qr(Ln((s=An*o-Fn*i)*s+(s=Fn*r-$n*o)*s+(s=$n*i-An*r)*s),$n*r+An*i+Fn*o);g1+=s,x1+=s*($n+($n=r)),w1+=s*(An+(An=i)),b1+=s*(Fn+(Fn=o)),Bp($n,An,Fn)}function xF(){yi.point=p3}function sie(){yi.point=lie}function aie(){QL(YL,XL),yi.point=p3}function lie(e,t){YL=e,XL=t,e*=ve,t*=ve,yi.point=QL;var n=fe(t);$n=n*fe(e),An=n*ue(e),Fn=ue(t),Bp($n,An,Fn)}function QL(e,t){e*=ve,t*=ve;var n=fe(t),r=n*fe(e),i=n*ue(e),o=ue(t),s=An*o-Fn*i,a=Fn*r-$n*o,l=$n*i-An*r,u=mE(s,a,l),c=rr(u),f=u&&-c/u;EE.add(f*s),SE.add(f*a),_E.add(f*l),g1+=c,x1+=c*($n+($n=r)),w1+=c*(An+(An=i)),b1+=c*(Fn+(Fn=o)),Bp($n,An,Fn)}function uie(e){Pd=g1=m1=y1=v1=x1=w1=b1=0,EE=new Dn,SE=new Dn,_E=new Dn,Uo(e,yi);var t=+EE,n=+SE,r=+_E,i=mE(t,n,r);return i<a1&&(t=x1,n=w1,r=b1,g1<ce&&(t=m1,n=y1,r=v1),i=mE(t,n,r),i<a1)?[NaN,NaN]:[Qr(n,t)*dt,rr(r/i)*dt]}function kE(e,t){function n(r,i){return r=e(r,i),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,i){return r=t.invert(r,i),r&&e.invert(r[0],r[1])}),n}function CE(e,t){return ke(e)>we&&(e-=Math.round(e/Pn)*Pn),[e,t]}CE.invert=CE;function KL(e,t,n){return(e%=Pn)?t||n?kE(bF(e),EF(t,n)):bF(e):t||n?EF(t,n):CE}function wF(e){return function(t,n){return t+=e,ke(t)>we&&(t-=Math.round(t/Pn)*Pn),[t,n]}}function bF(e){var t=wF(e);return t.invert=wF(-e),t}function EF(e,t){var n=fe(e),r=ue(e),i=fe(t),o=ue(t);function s(a,l){var u=fe(l),c=fe(a)*u,f=ue(a)*u,d=ue(l),h=d*n+c*r;return[Qr(f*i-h*o,c*n-d*r),rr(h*i+f*o)]}return s.invert=function(a,l){var u=fe(l),c=fe(a)*u,f=ue(a)*u,d=ue(l),h=d*i-f*o;return[Qr(f*i+d*o,c*n+h*r),rr(h*n-c*r)]},s}function cie(e){e=KL(e[0]*ve,e[1]*ve,e.length>2?e[2]*ve:0);function t(n){return n=e(n[0]*ve,n[1]*ve),n[0]*=dt,n[1]*=dt,n}return t.invert=function(n){return n=e.invert(n[0]*ve,n[1]*ve),n[0]*=dt,n[1]*=dt,n},t}function fie(e,t,n,r,i,o){if(n){var s=fe(t),a=ue(t),l=r*n;i==null?(i=t+r*Pn,o=t-l/2):(i=SF(s,i),o=SF(s,o),(r>0?i<o:i>o)&&(i+=r*Pn));for(var u,c=i;r>0?c>o:c<o;c-=l)u=h1([s,-a*fe(c),-a*ue(c)]),e.point(u[0],u[1])}}function SF(e,t){t=Hl(t),t[0]-=e,p1(t);var n=jL(-t[1]);return((-t[2]<0?-n:n)+Pn-ce)%Pn}function ZL(){var e=[],t;return{point:function(n,r,i){t.push([n,r,i])},lineStart:function(){e.push(t=[])},lineEnd:Yt,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function W0(e,t){return ke(e[0]-t[0])<ce&&ke(e[1]-t[1])<ce}function Gg(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function JL(e,t,n,r,i){var o=[],s=[],a,l;if(e.forEach(function(p){if(!((g=p.length-1)<=0)){var g,y=p[0],m=p[g],v;if(W0(y,m)){if(!y[2]&&!m[2]){for(i.lineStart(),a=0;a<g;++a)i.point((y=p[a])[0],y[1]);i.lineEnd();return}m[0]+=2*ce}o.push(v=new Gg(y,p,null,!0)),s.push(v.o=new Gg(y,null,v,!1)),o.push(v=new Gg(m,p,null,!1)),s.push(v.o=new Gg(m,null,v,!0))}}),!!o.length){for(s.sort(t),_F(o),_F(s),a=0,l=s.length;a<l;++a)s[a].e=n=!n;for(var u=o[0],c,f;;){for(var d=u,h=!0;d.v;)if((d=d.n)===u)return;c=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(a=0,l=c.length;a<l;++a)i.point((f=c[a])[0],f[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(h)for(c=d.p.z,a=c.length-1;a>=0;--a)i.point((f=c[a])[0],f[1]);else r(d.x,d.p.x,-1,i);d=d.p}d=d.o,c=d.z,h=!h}while(!d.v);i.lineEnd()}}}function _F(e){if(t=e.length){for(var t,n=0,r=e[0],i;++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}function R2(e){return ke(e[0])<=we?e[0]:zr(e[0])*((ke(e[0])+we)%Pn-we)}function die(e,t){var n=R2(t),r=t[1],i=ue(r),o=[ue(n),-fe(n),0],s=0,a=0,l=new Dn;i===1?r=ut+ce:i===-1&&(r=-ut-ce);for(var u=0,c=e.length;u<c;++u)if(d=(f=e[u]).length)for(var f,d,h=f[d-1],p=R2(h),g=h[1]/2+l1,y=ue(g),m=fe(g),v=0;v<d;++v,p=w,y=S,m=E,h=x){var x=f[v],w=R2(x),b=x[1]/2+l1,S=ue(b),E=fe(b),_=w-p,k=_>=0?1:-1,C=k*_,$=C>we,O=y*S;if(l.add(Qr(O*k*ue(C),m*E+O*fe(C))),s+=$?_+k*Pn:_,$^p>=n^w>=n){var A=Vc(Hl(h),Hl(x));p1(A);var T=Vc(o,A);p1(T);var F=($^_>=0?-1:1)*rr(T[2]);(r>F||r===F&&(A[0]||A[1]))&&(a+=$^_>=0?1:-1)}}return(s<-ce||s<ce&&l<-a1)^a&1}function ez(e,t,n,r){return function(i){var o=t(i),s=ZL(),a=t(s),l=!1,u,c,f,d={point:h,lineStart:g,lineEnd:y,polygonStart:function(){d.point=m,d.lineStart=v,d.lineEnd=x,c=[],u=[]},polygonEnd:function(){d.point=h,d.lineStart=g,d.lineEnd=y,c=qR(c);var w=die(u,r);c.length?(l||(i.polygonStart(),l=!0),JL(c,pie,w,n,i)):w&&(l||(i.polygonStart(),l=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),l&&(i.polygonEnd(),l=!1),c=u=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function h(w,b){e(w,b)&&i.point(w,b)}function p(w,b){o.point(w,b)}function g(){d.point=p,o.lineStart()}function y(){d.point=h,o.lineEnd()}function m(w,b){f.push([w,b]),a.point(w,b)}function v(){a.lineStart(),f=[]}function x(){m(f[0][0],f[0][1]),a.lineEnd();var w=a.clean(),b=s.result(),S,E=b.length,_,k,C;if(f.pop(),u.push(f),f=null,!!E){if(w&1){if(k=b[0],(_=k.length-1)>0){for(l||(i.polygonStart(),l=!0),i.lineStart(),S=0;S<_;++S)i.point((C=k[S])[0],C[1]);i.lineEnd()}return}E>1&&w&2&&b.push(b.pop().concat(b.shift())),c.push(b.filter(hie))}}return d}}function hie(e){return e.length>1}function pie(e,t){return((e=e.x)[0]<0?e[1]-ut-ce:ut-e[1])-((t=t.x)[0]<0?t[1]-ut-ce:ut-t[1])}const kF=ez(function(){return!0},gie,yie,[-we,-ut]);function gie(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(o,s){var a=o>0?we:-we,l=ke(o-t);ke(l-we)<ce?(e.point(t,n=(n+s)/2>0?ut:-ut),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(a,n),e.point(o,n),i=0):r!==a&&l>=we&&(ke(t-r)<ce&&(t-=r*ce),ke(o-a)<ce&&(o-=a*ce),n=mie(t,n,o,s),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(a,n),i=0),e.point(t=o,n=s),r=a},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}}function mie(e,t,n,r){var i,o,s=ue(e-n);return ke(s)>ce?Tf((ue(t)*(o=fe(r))*ue(n)-ue(r)*(i=fe(t))*ue(e))/(i*o*s)):(t+r)/2}function yie(e,t,n,r){var i;if(e==null)i=n*ut,r.point(-we,i),r.point(0,i),r.point(we,i),r.point(we,0),r.point(we,-i),r.point(0,-i),r.point(-we,-i),r.point(-we,0),r.point(-we,i);else if(ke(e[0]-t[0])>ce){var o=e[0]<t[0]?we:-we;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(t[0],t[1])}function vie(e){var t=fe(e),n=2*ve,r=t>0,i=ke(t)>ce;function o(c,f,d,h){fie(h,e,n,d,c,f)}function s(c,f){return fe(c)*fe(f)>t}function a(c){var f,d,h,p,g;return{lineStart:function(){p=h=!1,g=1},point:function(y,m){var v=[y,m],x,w=s(y,m),b=r?w?0:u(y,m):w?u(y+(y<0?we:-we),m):0;if(!f&&(p=h=w)&&c.lineStart(),w!==h&&(x=l(f,v),(!x||W0(f,x)||W0(v,x))&&(v[2]=1)),w!==h)g=0,w?(c.lineStart(),x=l(v,f),c.point(x[0],x[1])):(x=l(f,v),c.point(x[0],x[1],2),c.lineEnd()),f=x;else if(i&&f&&r^w){var S;!(b&d)&&(S=l(v,f,!0))&&(g=0,r?(c.lineStart(),c.point(S[0][0],S[0][1]),c.point(S[1][0],S[1][1]),c.lineEnd()):(c.point(S[1][0],S[1][1]),c.lineEnd(),c.lineStart(),c.point(S[0][0],S[0][1],3)))}w&&(!f||!W0(f,v))&&c.point(v[0],v[1]),f=v,h=w,d=b},lineEnd:function(){h&&c.lineEnd(),f=null},clean:function(){return g|(p&&h)<<1}}}function l(c,f,d){var h=Hl(c),p=Hl(f),g=[1,0,0],y=Vc(h,p),m=Hg(y,y),v=y[0],x=m-v*v;if(!x)return!d&&c;var w=t*m/x,b=-t*v/x,S=Vc(g,y),E=Vg(g,w),_=Vg(y,b);N2(E,_);var k=S,C=Hg(E,k),$=Hg(k,k),O=C*C-$*(Hg(E,E)-1);if(!(O<0)){var A=Ln(O),T=Vg(k,(-C-A)/$);if(N2(T,E),T=h1(T),!d)return T;var F=c[0],R=f[0],L=c[1],N=f[1],D;R<F&&(D=F,F=R,R=D);var U=R-F,K=ke(U-we)<ce,se=K||U<ce;if(!K&&N<L&&(D=L,L=N,N=D),se?K?L+N>0^T[1]<(ke(T[0]-F)<ce?L:N):L<=T[1]&&T[1]<=N:U>we^(F<=T[0]&&T[0]<=R)){var be=Vg(k,(-C+A)/$);return N2(be,E),[T,h1(be)]}}}function u(c,f){var d=r?e:we-e,h=0;return c<-d?h|=1:c>d&&(h|=2),f<-d?h|=4:f>d&&(h|=8),h}return ez(s,a,o,r?[0,-e]:[-we,e-we])}function xie(e,t,n,r,i,o){var s=e[0],a=e[1],l=t[0],u=t[1],c=0,f=1,d=l-s,h=u-a,p;if(p=n-s,!(!d&&p>0)){if(p/=d,d<0){if(p<c)return;p<f&&(f=p)}else if(d>0){if(p>f)return;p>c&&(c=p)}if(p=i-s,!(!d&&p<0)){if(p/=d,d<0){if(p>f)return;p>c&&(c=p)}else if(d>0){if(p<c)return;p<f&&(f=p)}if(p=r-a,!(!h&&p>0)){if(p/=h,h<0){if(p<c)return;p<f&&(f=p)}else if(h>0){if(p>f)return;p>c&&(c=p)}if(p=o-a,!(!h&&p<0)){if(p/=h,h<0){if(p>f)return;p>c&&(c=p)}else if(h>0){if(p<c)return;p<f&&(f=p)}return c>0&&(e[0]=s+c*d,e[1]=a+c*h),f<1&&(t[0]=s+f*d,t[1]=a+f*h),!0}}}}}var Ld=1e9,Yg=-Ld;function tz(e,t,n,r){function i(u,c){return e<=u&&u<=n&&t<=c&&c<=r}function o(u,c,f,d){var h=0,p=0;if(u==null||(h=s(u,f))!==(p=s(c,f))||l(u,c)<0^f>0)do d.point(h===0||h===3?e:n,h>1?r:t);while((h=(h+f+4)%4)!==p);else d.point(c[0],c[1])}function s(u,c){return ke(u[0]-e)<ce?c>0?0:3:ke(u[0]-n)<ce?c>0?2:1:ke(u[1]-t)<ce?c>0?1:0:c>0?3:2}function a(u,c){return l(u.x,c.x)}function l(u,c){var f=s(u,1),d=s(c,1);return f!==d?f-d:f===0?c[1]-u[1]:f===1?u[0]-c[0]:f===2?u[1]-c[1]:c[0]-u[0]}return function(u){var c=u,f=ZL(),d,h,p,g,y,m,v,x,w,b,S,E={point:_,lineStart:O,lineEnd:A,polygonStart:C,polygonEnd:$};function _(F,R){i(F,R)&&c.point(F,R)}function k(){for(var F=0,R=0,L=h.length;R<L;++R)for(var N=h[R],D=1,U=N.length,K=N[0],se,be,pe=K[0],Re=K[1];D<U;++D)se=pe,be=Re,K=N[D],pe=K[0],Re=K[1],be<=r?Re>r&&(pe-se)*(r-be)>(Re-be)*(e-se)&&++F:Re<=r&&(pe-se)*(r-be)<(Re-be)*(e-se)&&--F;return F}function C(){c=f,d=[],h=[],S=!0}function $(){var F=k(),R=S&&F,L=(d=qR(d)).length;(R||L)&&(u.polygonStart(),R&&(u.lineStart(),o(null,null,1,u),u.lineEnd()),L&&JL(d,a,F,o,u),u.polygonEnd()),c=u,d=h=p=null}function O(){E.point=T,h&&h.push(p=[]),b=!0,w=!1,v=x=NaN}function A(){d&&(T(g,y),m&&w&&f.rejoin(),d.push(f.result())),E.point=_,w&&c.lineEnd()}function T(F,R){var L=i(F,R);if(h&&p.push([F,R]),b)g=F,y=R,m=L,b=!1,L&&(c.lineStart(),c.point(F,R));else if(L&&w)c.point(F,R);else{var N=[v=Math.max(Yg,Math.min(Ld,v)),x=Math.max(Yg,Math.min(Ld,x))],D=[F=Math.max(Yg,Math.min(Ld,F)),R=Math.max(Yg,Math.min(Ld,R))];xie(N,D,e,t,n,r)?(w||(c.lineStart(),c.point(N[0],N[1])),c.point(D[0],D[1]),L||c.lineEnd(),S=!1):L&&(c.lineStart(),c.point(F,R),S=!1)}v=F,x=R,w=L}return E}}function CF(e,t,n){var r=mr(e,t-ce,n).concat(t);return function(i){return r.map(function(o){return[i,o]})}}function $F(e,t,n){var r=mr(e,t-ce,n).concat(t);return function(i){return r.map(function(o){return[o,i]})}}function wie(){var e,t,n,r,i,o,s,a,l=10,u=l,c=90,f=360,d,h,p,g,y=2.5;function m(){return{type:"MultiLineString",coordinates:v()}}function v(){return mr(qg(r/c)*c,n,c).map(p).concat(mr(qg(a/f)*f,s,f).map(g)).concat(mr(qg(t/l)*l,e,l).filter(function(x){return ke(x%c)>ce}).map(d)).concat(mr(qg(o/u)*u,i,u).filter(function(x){return ke(x%f)>ce}).map(h))}return m.lines=function(){return v().map(function(x){return{type:"LineString",coordinates:x}})},m.outline=function(){return{type:"Polygon",coordinates:[p(r).concat(g(s).slice(1),p(n).reverse().slice(1),g(a).reverse().slice(1))]}},m.extent=function(x){return arguments.length?m.extentMajor(x).extentMinor(x):m.extentMinor()},m.extentMajor=function(x){return arguments.length?(r=+x[0][0],n=+x[1][0],a=+x[0][1],s=+x[1][1],r>n&&(x=r,r=n,n=x),a>s&&(x=a,a=s,s=x),m.precision(y)):[[r,a],[n,s]]},m.extentMinor=function(x){return arguments.length?(t=+x[0][0],e=+x[1][0],o=+x[0][1],i=+x[1][1],t>e&&(x=t,t=e,e=x),o>i&&(x=o,o=i,i=x),m.precision(y)):[[t,o],[e,i]]},m.step=function(x){return arguments.length?m.stepMajor(x).stepMinor(x):m.stepMinor()},m.stepMajor=function(x){return arguments.length?(c=+x[0],f=+x[1],m):[c,f]},m.stepMinor=function(x){return arguments.length?(l=+x[0],u=+x[1],m):[l,u]},m.precision=function(x){return arguments.length?(y=+x,d=CF(o,i,90),h=$F(t,e,y),p=CF(a,s,90),g=$F(r,n,y),m):y},m.extentMajor([[-180,-90+ce],[180,90-ce]]).extentMinor([[-180,-80-ce],[180,80+ce]])}const Qh=e=>e;var D2=new Dn,$E=new Dn,nz,rz,AE,FE,Wo={point:Yt,lineStart:Yt,lineEnd:Yt,polygonStart:function(){Wo.lineStart=bie,Wo.lineEnd=Sie},polygonEnd:function(){Wo.lineStart=Wo.lineEnd=Wo.point=Yt,D2.add(ke($E)),$E=new Dn},result:function(){var e=D2/2;return D2=new Dn,e}};function bie(){Wo.point=Eie}function Eie(e,t){Wo.point=iz,nz=AE=e,rz=FE=t}function iz(e,t){$E.add(FE*e-AE*t),AE=e,FE=t}function Sie(){iz(nz,rz)}var Gc=1/0,E1=Gc,Kh=-Gc,S1=Kh,_1={point:_ie,lineStart:Yt,lineEnd:Yt,polygonStart:Yt,polygonEnd:Yt,result:function(){var e=[[Gc,E1],[Kh,S1]];return Kh=S1=-(E1=Gc=1/0),e}};function _ie(e,t){e<Gc&&(Gc=e),e>Kh&&(Kh=e),t<E1&&(E1=t),t>S1&&(S1=t)}var ME=0,TE=0,zd=0,k1=0,C1=0,oc=0,NE=0,RE=0,Id=0,oz,sz,Zi,Ji,Or={point:Vl,lineStart:AF,lineEnd:FF,polygonStart:function(){Or.lineStart=$ie,Or.lineEnd=Aie},polygonEnd:function(){Or.point=Vl,Or.lineStart=AF,Or.lineEnd=FF},result:function(){var e=Id?[NE/Id,RE/Id]:oc?[k1/oc,C1/oc]:zd?[ME/zd,TE/zd]:[NaN,NaN];return ME=TE=zd=k1=C1=oc=NE=RE=Id=0,e}};function Vl(e,t){ME+=e,TE+=t,++zd}function AF(){Or.point=kie}function kie(e,t){Or.point=Cie,Vl(Zi=e,Ji=t)}function Cie(e,t){var n=e-Zi,r=t-Ji,i=Ln(n*n+r*r);k1+=i*(Zi+e)/2,C1+=i*(Ji+t)/2,oc+=i,Vl(Zi=e,Ji=t)}function FF(){Or.point=Vl}function $ie(){Or.point=Fie}function Aie(){az(oz,sz)}function Fie(e,t){Or.point=az,Vl(oz=Zi=e,sz=Ji=t)}function az(e,t){var n=e-Zi,r=t-Ji,i=Ln(n*n+r*r);k1+=i*(Zi+e)/2,C1+=i*(Ji+t)/2,oc+=i,i=Ji*e-Zi*t,NE+=i*(Zi+e),RE+=i*(Ji+t),Id+=i*3,Vl(Zi=e,Ji=t)}function lz(e){this._context=e}lz.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,Pn);break}}},result:Yt};var DE=new Dn,O2,uz,cz,jd,Bd,Zh={point:Yt,lineStart:function(){Zh.point=Mie},lineEnd:function(){O2&&fz(uz,cz),Zh.point=Yt},polygonStart:function(){O2=!0},polygonEnd:function(){O2=null},result:function(){var e=+DE;return DE=new Dn,e}};function Mie(e,t){Zh.point=fz,uz=jd=e,cz=Bd=t}function fz(e,t){jd-=e,Bd-=t,DE.add(Ln(jd*jd+Bd*Bd)),jd=e,Bd=t}let MF,$1,TF,NF;class RF{constructor(t){this._append=t==null?dz:Tie(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,n){switch(this._point){case 0:{this._append`M${t},${n}`,this._point=1;break}case 1:{this._append`L${t},${n}`;break}default:{if(this._append`M${t},${n}`,this._radius!==TF||this._append!==$1){const r=this._radius,i=this._;this._="",this._append`m0,${r}a${r},${r} 0 1,1 0,${-2*r}a${r},${r} 0 1,1 0,${2*r}z`,TF=r,$1=this._append,NF=this._,this._=i}this._+=NF;break}}}result(){const t=this._;return this._="",t.length?t:null}}function dz(e){let t=1;this._+=e[0];for(const n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function Tie(e){const t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return dz;if(t!==MF){const n=10**t;MF=t,$1=function(i){let o=1;this._+=i[0];for(const s=i.length;o<s;++o)this._+=Math.round(arguments[o]*n)/n+i[o]}}return $1}function hz(e,t){let n=3,r=4.5,i,o;function s(a){return a&&(typeof r=="function"&&o.pointRadius(+r.apply(this,arguments)),Uo(a,i(o))),o.result()}return s.area=function(a){return Uo(a,i(Wo)),Wo.result()},s.measure=function(a){return Uo(a,i(Zh)),Zh.result()},s.bounds=function(a){return Uo(a,i(_1)),_1.result()},s.centroid=function(a){return Uo(a,i(Or)),Or.result()},s.projection=function(a){return arguments.length?(i=a==null?(e=null,Qh):(e=a).stream,s):e},s.context=function(a){return arguments.length?(o=a==null?(t=null,new RF(n)):new lz(t=a),typeof r!="function"&&o.pointRadius(r),s):t},s.pointRadius=function(a){return arguments.length?(r=typeof a=="function"?a:(o.pointRadius(+a),+a),s):r},s.digits=function(a){if(!arguments.length)return n;if(a==null)n=null;else{const l=Math.floor(a);if(!(l>=0))throw new RangeError(`invalid digits: ${a}`);n=l}return t===null&&(o=new RF(n)),s},s.projection(e).digits(n).context(t)}function vv(e){return function(t){var n=new OE;for(var r in e)n[r]=e[r];return n.stream=t,n}}function OE(){}OE.prototype={constructor:OE,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function g3(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),Uo(n,e.stream(_1)),t(_1.result()),r!=null&&e.clipExtent(r),e}function xv(e,t,n){return g3(e,function(r){var i=t[1][0]-t[0][0],o=t[1][1]-t[0][1],s=Math.min(i/(r[1][0]-r[0][0]),o/(r[1][1]-r[0][1])),a=+t[0][0]+(i-s*(r[1][0]+r[0][0]))/2,l=+t[0][1]+(o-s*(r[1][1]+r[0][1]))/2;e.scale(150*s).translate([a,l])},n)}function m3(e,t,n){return xv(e,[[0,0],t],n)}function y3(e,t,n){return g3(e,function(r){var i=+t,o=i/(r[1][0]-r[0][0]),s=(i-o*(r[1][0]+r[0][0]))/2,a=-o*r[0][1];e.scale(150*o).translate([s,a])},n)}function v3(e,t,n){return g3(e,function(r){var i=+t,o=i/(r[1][1]-r[0][1]),s=-o*r[0][0],a=(i-o*(r[1][1]+r[0][1]))/2;e.scale(150*o).translate([s,a])},n)}var DF=16,Nie=fe(30*ve);function OF(e,t){return+t?Die(e,t):Rie(e)}function Rie(e){return vv({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function Die(e,t){function n(r,i,o,s,a,l,u,c,f,d,h,p,g,y){var m=u-r,v=c-i,x=m*m+v*v;if(x>4*t&&g--){var w=s+d,b=a+h,S=l+p,E=Ln(w*w+b*b+S*S),_=rr(S/=E),k=ke(ke(S)-1)<ce||ke(o-f)<ce?(o+f)/2:Qr(b,w),C=e(k,_),$=C[0],O=C[1],A=$-r,T=O-i,F=v*A-m*T;(F*F/x>t||ke((m*A+v*T)/x-.5)>.3||s*d+a*h+l*p<Nie)&&(n(r,i,o,s,a,l,$,O,k,w/=E,b/=E,S,g,y),y.point($,O),n($,O,k,w,b,S,u,c,f,d,h,p,g,y))}}return function(r){var i,o,s,a,l,u,c,f,d,h,p,g,y={point:m,lineStart:v,lineEnd:w,polygonStart:function(){r.polygonStart(),y.lineStart=b},polygonEnd:function(){r.polygonEnd(),y.lineStart=v}};function m(_,k){_=e(_,k),r.point(_[0],_[1])}function v(){f=NaN,y.point=x,r.lineStart()}function x(_,k){var C=Hl([_,k]),$=e(_,k);n(f,d,c,h,p,g,f=$[0],d=$[1],c=_,h=C[0],p=C[1],g=C[2],DF,r),r.point(f,d)}function w(){y.point=m,r.lineEnd()}function b(){v(),y.point=S,y.lineEnd=E}function S(_,k){x(i=_,k),o=f,s=d,a=h,l=p,u=g,y.point=x}function E(){n(f,d,c,h,p,g,o,s,i,a,l,u,DF,r),y.lineEnd=w,w()}return y}}var Oie=vv({point:function(e,t){this.stream.point(e*ve,t*ve)}});function Pie(e){return vv({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function Lie(e,t,n,r,i){function o(s,a){return s*=r,a*=i,[t+e*s,n-e*a]}return o.invert=function(s,a){return[(s-t)/e*r,(n-a)/e*i]},o}function PF(e,t,n,r,i,o){if(!o)return Lie(e,t,n,r,i);var s=fe(o),a=ue(o),l=s*e,u=a*e,c=s/e,f=a/e,d=(a*n-s*t)/e,h=(a*t+s*n)/e;function p(g,y){return g*=r,y*=i,[l*g-u*y+t,n-u*g-l*y]}return p.invert=function(g,y){return[r*(c*g-f*y+d),i*(h-f*g-c*y)]},p}function _o(e){return pz(function(){return e})()}function pz(e){var t,n=150,r=480,i=250,o=0,s=0,a=0,l=0,u=0,c,f=0,d=1,h=1,p=null,g=kF,y=null,m,v,x,w=Qh,b=.5,S,E,_,k,C;function $(F){return _(F[0]*ve,F[1]*ve)}function O(F){return F=_.invert(F[0],F[1]),F&&[F[0]*dt,F[1]*dt]}$.stream=function(F){return k&&C===F?k:k=Oie(Pie(c)(g(S(w(C=F)))))},$.preclip=function(F){return arguments.length?(g=F,p=void 0,T()):g},$.postclip=function(F){return arguments.length?(w=F,y=m=v=x=null,T()):w},$.clipAngle=function(F){return arguments.length?(g=+F?vie(p=F*ve):(p=null,kF),T()):p*dt},$.clipExtent=function(F){return arguments.length?(w=F==null?(y=m=v=x=null,Qh):tz(y=+F[0][0],m=+F[0][1],v=+F[1][0],x=+F[1][1]),T()):y==null?null:[[y,m],[v,x]]},$.scale=function(F){return arguments.length?(n=+F,A()):n},$.translate=function(F){return arguments.length?(r=+F[0],i=+F[1],A()):[r,i]},$.center=function(F){return arguments.length?(o=F[0]%360*ve,s=F[1]%360*ve,A()):[o*dt,s*dt]},$.rotate=function(F){return arguments.length?(a=F[0]%360*ve,l=F[1]%360*ve,u=F.length>2?F[2]%360*ve:0,A()):[a*dt,l*dt,u*dt]},$.angle=function(F){return arguments.length?(f=F%360*ve,A()):f*dt},$.reflectX=function(F){return arguments.length?(d=F?-1:1,A()):d<0},$.reflectY=function(F){return arguments.length?(h=F?-1:1,A()):h<0},$.precision=function(F){return arguments.length?(S=OF(E,b=F*F),T()):Ln(b)},$.fitExtent=function(F,R){return xv($,F,R)},$.fitSize=function(F,R){return m3($,F,R)},$.fitWidth=function(F,R){return y3($,F,R)},$.fitHeight=function(F,R){return v3($,F,R)};function A(){var F=PF(n,0,0,d,h,f).apply(null,t(o,s)),R=PF(n,r-F[0],i-F[1],d,h,f);return c=KL(a,l,u),E=kE(t,R),_=kE(c,E),S=OF(E,b),T()}function T(){return k=C=null,$}return function(){return t=e.apply(this,arguments),$.invert=t.invert&&O,A()}}function x3(e){var t=0,n=we/3,r=pz(e),i=r(t,n);return i.parallels=function(o){return arguments.length?r(t=o[0]*ve,n=o[1]*ve):[t*dt,n*dt]},i}function zie(e){var t=fe(e);function n(r,i){return[r*t,ue(i)/t]}return n.invert=function(r,i){return[r/t,rr(i*t)]},n}function Iie(e,t){var n=ue(e),r=(n+ue(t))/2;if(ke(r)<ce)return zie(e);var i=1+n*(2*r-n),o=Ln(i)/r;function s(a,l){var u=Ln(i-2*r*ue(l))/r;return[u*ue(a*=r),o-u*fe(a)]}return s.invert=function(a,l){var u=o-l,c=Qr(a,ke(u))*zr(u);return u*r<0&&(c-=we*zr(a)*zr(u)),[c/r,rr((i-(a*a+u*u)*r*r)/(2*r))]},s}function A1(){return x3(Iie).scale(155.424).center([0,33.6442])}function gz(){return A1().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function jie(e){var t=e.length;return{point:function(n,r){for(var i=-1;++i<t;)e[i].point(n,r)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function Bie(){var e,t,n=gz(),r,i=A1().rotate([154,0]).center([-2,58.5]).parallels([55,65]),o,s=A1().rotate([157,0]).center([-3,19.9]).parallels([8,18]),a,l,u={point:function(d,h){l=[d,h]}};function c(d){var h=d[0],p=d[1];return l=null,r.point(h,p),l||(o.point(h,p),l)||(a.point(h,p),l)}c.invert=function(d){var h=n.scale(),p=n.translate(),g=(d[0]-p[0])/h,y=(d[1]-p[1])/h;return(y>=.12&&y<.234&&g>=-.425&&g<-.214?i:y>=.166&&y<.234&&g>=-.214&&g<-.115?s:n).invert(d)},c.stream=function(d){return e&&t===d?e:e=jie([n.stream(t=d),i.stream(d),s.stream(d)])},c.precision=function(d){return arguments.length?(n.precision(d),i.precision(d),s.precision(d),f()):n.precision()},c.scale=function(d){return arguments.length?(n.scale(d),i.scale(d*.35),s.scale(d),c.translate(n.translate())):n.scale()},c.translate=function(d){if(!arguments.length)return n.translate();var h=n.scale(),p=+d[0],g=+d[1];return r=n.translate(d).clipExtent([[p-.455*h,g-.238*h],[p+.455*h,g+.238*h]]).stream(u),o=i.translate([p-.307*h,g+.201*h]).clipExtent([[p-.425*h+ce,g+.12*h+ce],[p-.214*h-ce,g+.234*h-ce]]).stream(u),a=s.translate([p-.205*h,g+.212*h]).clipExtent([[p-.214*h+ce,g+.166*h+ce],[p-.115*h-ce,g+.234*h-ce]]).stream(u),f()},c.fitExtent=function(d,h){return xv(c,d,h)},c.fitSize=function(d,h){return m3(c,d,h)},c.fitWidth=function(d,h){return y3(c,d,h)},c.fitHeight=function(d,h){return v3(c,d,h)};function f(){return e=t=null,c}return c.scale(1070)}function mz(e){return function(t,n){var r=fe(t),i=fe(n),o=e(r*i);return o===1/0?[2,0]:[o*i*ue(t),o*ue(n)]}}function Up(e){return function(t,n){var r=Ln(t*t+n*n),i=e(r),o=ue(i),s=fe(i);return[Qr(t*o,r*s),rr(r&&n*o/r)]}}var yz=mz(function(e){return Ln(2/(1+e))});yz.invert=Up(function(e){return 2*rr(e/2)});function Uie(){return _o(yz).scale(124.75).clipAngle(180-.001)}var vz=mz(function(e){return(e=jL(e))&&e/ue(e)});vz.invert=Up(function(e){return e});function Wie(){return _o(vz).scale(79.4188).clipAngle(180-.001)}function wv(e,t){return[e,u1(h3((ut+t)/2))]}wv.invert=function(e,t){return[e,2*Tf(IL(t))-ut]};function qie(){return xz(wv).scale(961/Pn)}function xz(e){var t=_o(e),n=t.center,r=t.scale,i=t.translate,o=t.clipExtent,s=null,a,l,u;t.scale=function(f){return arguments.length?(r(f),c()):r()},t.translate=function(f){return arguments.length?(i(f),c()):i()},t.center=function(f){return arguments.length?(n(f),c()):n()},t.clipExtent=function(f){return arguments.length?(f==null?s=a=l=u=null:(s=+f[0][0],a=+f[0][1],l=+f[1][0],u=+f[1][1]),c()):s==null?null:[[s,a],[l,u]]};function c(){var f=we*r(),d=t(cie(t.rotate()).invert([0,0]));return o(s==null?[[d[0]-f,d[1]-f],[d[0]+f,d[1]+f]]:e===wv?[[Math.max(d[0]-f,s),a],[Math.min(d[0]+f,l),u]]:[[s,Math.max(d[1]-f,a)],[l,Math.min(d[1]+f,u)]])}return c()}function Xg(e){return h3((ut+e)/2)}function Hie(e,t){var n=fe(e),r=e===t?ue(e):u1(n/fe(t))/u1(Xg(t)/Xg(e)),i=n*T2(Xg(e),r)/r;if(!r)return wv;function o(s,a){i>0?a<-ut+ce&&(a=-ut+ce):a>ut-ce&&(a=ut-ce);var l=i/T2(Xg(a),r);return[l*ue(r*s),i-l*fe(r*s)]}return o.invert=function(s,a){var l=i-a,u=zr(r)*Ln(s*s+l*l),c=Qr(s,ke(l))*zr(l);return l*r<0&&(c-=we*zr(s)*zr(l)),[c/r,2*Tf(T2(i/u,1/r))-ut]},o}function Vie(){return x3(Hie).scale(109.5).parallels([30,30])}function F1(e,t){return[e,t]}F1.invert=F1;function Gie(){return _o(F1).scale(152.63)}function Yie(e,t){var n=fe(e),r=e===t?ue(e):(n-fe(t))/(t-e),i=n/r+e;if(ke(r)<ce)return F1;function o(s,a){var l=i-a,u=r*s;return[l*ue(u),i-l*fe(u)]}return o.invert=function(s,a){var l=i-a,u=Qr(s,ke(l))*zr(l);return l*r<0&&(u-=we*zr(s)*zr(l)),[u/r,i-zr(r)*Ln(s*s+l*l)]},o}function Xie(){return x3(Yie).scale(131.154).center([0,13.9389])}var fh=1.340264,dh=-.081106,hh=893e-6,ph=.003796,M1=Ln(3)/2,Qie=12;function wz(e,t){var n=rr(M1*ue(t)),r=n*n,i=r*r*r;return[e*fe(n)/(M1*(fh+3*dh*r+i*(7*hh+9*ph*r))),n*(fh+dh*r+i*(hh+ph*r))]}wz.invert=function(e,t){for(var n=t,r=n*n,i=r*r*r,o=0,s,a,l;o<Qie&&(a=n*(fh+dh*r+i*(hh+ph*r))-t,l=fh+3*dh*r+i*(7*hh+9*ph*r),n-=s=a/l,r=n*n,i=r*r*r,!(ke(s)<a1));++o);return[M1*e*(fh+3*dh*r+i*(7*hh+9*ph*r))/fe(n),rr(ue(n)/M1)]};function Kie(){return _o(wz).scale(177.158)}function bz(e,t){var n=fe(t),r=fe(e)*n;return[n*ue(e)/r,ue(t)/r]}bz.invert=Up(Tf);function Zie(){return _o(bz).scale(144.049).clipAngle(60)}function Jie(){var e=1,t=0,n=0,r=1,i=1,o=0,s,a,l=null,u,c,f,d=1,h=1,p=vv({point:function(w,b){var S=x([w,b]);this.stream.point(S[0],S[1])}}),g=Qh,y,m;function v(){return d=e*r,h=e*i,y=m=null,x}function x(w){var b=w[0]*d,S=w[1]*h;if(o){var E=S*s-b*a;b=b*s+S*a,S=E}return[b+t,S+n]}return x.invert=function(w){var b=w[0]-t,S=w[1]-n;if(o){var E=S*s+b*a;b=b*s-S*a,S=E}return[b/d,S/h]},x.stream=function(w){return y&&m===w?y:y=p(g(m=w))},x.postclip=function(w){return arguments.length?(g=w,l=u=c=f=null,v()):g},x.clipExtent=function(w){return arguments.length?(g=w==null?(l=u=c=f=null,Qh):tz(l=+w[0][0],u=+w[0][1],c=+w[1][0],f=+w[1][1]),v()):l==null?null:[[l,u],[c,f]]},x.scale=function(w){return arguments.length?(e=+w,v()):e},x.translate=function(w){return arguments.length?(t=+w[0],n=+w[1],v()):[t,n]},x.angle=function(w){return arguments.length?(o=w%360*ve,a=ue(o),s=fe(o),v()):o*dt},x.reflectX=function(w){return arguments.length?(r=w?-1:1,v()):r<0},x.reflectY=function(w){return arguments.length?(i=w?-1:1,v()):i<0},x.fitExtent=function(w,b){return xv(x,w,b)},x.fitSize=function(w,b){return m3(x,w,b)},x.fitWidth=function(w,b){return y3(x,w,b)},x.fitHeight=function(w,b){return v3(x,w,b)},x}function Ez(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(-.013791+r*(.003971*n-.001529*r))),t*(1.007226+n*(.015085+r*(-.044475+.028874*n-.005916*r)))]}Ez.invert=function(e,t){var n=t,r=25,i;do{var o=n*n,s=o*o;n-=i=(n*(1.007226+o*(.015085+s*(-.044475+.028874*o-.005916*s)))-t)/(1.007226+o*(.015085*3+s*(-.044475*7+.028874*9*o-.005916*11*s)))}while(ke(i)>ce&&--r>0);return[e/(.8707+(o=n*n)*(-.131979+o*(-.013791+o*o*o*(.003971-.001529*o)))),n]};function eoe(){return _o(Ez).scale(175.295)}function Sz(e,t){return[fe(t)*ue(e),ue(t)]}Sz.invert=Up(rr);function toe(){return _o(Sz).scale(249.5).clipAngle(90+ce)}function _z(e,t){var n=fe(t),r=1+fe(e)*n;return[n*ue(e)/r,ue(t)/r]}_z.invert=Up(function(e){return 2*Tf(e)});function noe(){return _o(_z).scale(250).clipAngle(142)}function kz(e,t){return[u1(h3((ut+t)/2)),-e]}kz.invert=function(e,t){return[-t,2*Tf(IL(e))-ut]};function roe(){var e=xz(kz),t=e.center,n=e.rotate;return e.center=function(r){return arguments.length?t([-r[1],r[0]]):(r=t(),[r[1],-r[0]])},e.rotate=function(r){return arguments.length?n([r[0],r[1],r.length>2?r[2]+90:90]):(r=n(),[r[0],r[1],r[2]-90])},n([0,0,90]).scale(159.155)}var ioe=Math.abs,PE=Math.cos,T1=Math.sin,ooe=1e-6,Cz=Math.PI,LE=Cz/2,LF=soe(2);function zF(e){return e>1?LE:e<-1?-LE:Math.asin(e)}function soe(e){return e>0?Math.sqrt(e):0}function aoe(e,t){var n=e*T1(t),r=30,i;do t-=i=(t+T1(t)-n)/(1+PE(t));while(ioe(i)>ooe&&--r>0);return t/2}function loe(e,t,n){function r(i,o){return[e*i*PE(o=aoe(n,o)),t*T1(o)]}return r.invert=function(i,o){return o=zF(o/t),[i/(e*PE(o)),zF((2*o+T1(2*o))/n)]},r}var uoe=loe(LF/LE,LF,Cz);function coe(){return _o(uoe).scale(169.529)}const foe=hz(),zE=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function doe(e,t){return function n(){const r=t();return r.type=e,r.path=hz().projection(r),r.copy=r.copy||function(){const i=n();return zE.forEach(o=>{r[o]&&i[o](r[o]())}),i.path.pointRadius(r.path.pointRadius()),i},BO(r)}}function w3(e,t){if(!e||typeof e!="string")throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(N1[e]=doe(e,t),this):N1[e]||null}function $z(e){return e&&e.path||foe}const N1={albers:gz,albersusa:Bie,azimuthalequalarea:Uie,azimuthalequidistant:Wie,conicconformal:Vie,conicequalarea:A1,conicequidistant:Xie,equalEarth:Kie,equirectangular:Gie,gnomonic:Zie,identity:Jie,mercator:qie,mollweide:coe,naturalEarth1:eoe,orthographic:toe,stereographic:noe,transversemercator:roe};for(const e in N1)w3(e,N1[e]);function hoe(){}const Do=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function Az(){var e=1,t=1,n=a;function r(l,u){return u.map(c=>i(l,c))}function i(l,u){var c=[],f=[];return o(l,u,d=>{n(d,l,u),poe(d)>0?c.push([d]):f.push(d)}),f.forEach(d=>{for(var h=0,p=c.length,g;h<p;++h)if(goe((g=c[h])[0],d)!==-1){g.push(d);return}}),{type:"MultiPolygon",value:u,coordinates:c}}function o(l,u,c){var f=[],d=[],h,p,g,y,m,v;for(h=p=-1,y=l[0]>=u,Do[y<<1].forEach(x);++h<e-1;)g=y,y=l[h+1]>=u,Do[g|y<<1].forEach(x);for(Do[y<<0].forEach(x);++p<t-1;){for(h=-1,y=l[p*e+e]>=u,m=l[p*e]>=u,Do[y<<1|m<<2].forEach(x);++h<e-1;)g=y,y=l[p*e+e+h+1]>=u,v=m,m=l[p*e+h+1]>=u,Do[g|y<<1|m<<2|v<<3].forEach(x);Do[y|m<<3].forEach(x)}for(h=-1,m=l[p*e]>=u,Do[m<<2].forEach(x);++h<e-1;)v=m,m=l[p*e+h+1]>=u,Do[m<<2|v<<3].forEach(x);Do[m<<3].forEach(x);function x(w){var b=[w[0][0]+h,w[0][1]+p],S=[w[1][0]+h,w[1][1]+p],E=s(b),_=s(S),k,C;(k=d[E])?(C=f[_])?(delete d[k.end],delete f[C.start],k===C?(k.ring.push(S),c(k.ring)):f[k.start]=d[C.end]={start:k.start,end:C.end,ring:k.ring.concat(C.ring)}):(delete d[k.end],k.ring.push(S),d[k.end=_]=k):(k=f[_])?(C=d[E])?(delete f[k.start],delete d[C.end],k===C?(k.ring.push(S),c(k.ring)):f[C.start]=d[k.end]={start:C.start,end:k.end,ring:C.ring.concat(k.ring)}):(delete f[k.start],k.ring.unshift(b),f[k.start=E]=k):f[E]=d[_]={start:E,end:_,ring:[b,S]}}}function s(l){return l[0]*2+l[1]*(e+1)*4}function a(l,u,c){l.forEach(f=>{var d=f[0],h=f[1],p=d|0,g=h|0,y,m=u[g*e+p];d>0&&d<e&&p===d&&(y=u[g*e+p-1],f[0]=d+(c-y)/(m-y)-.5),h>0&&h<t&&g===h&&(y=u[(g-1)*e+p],f[1]=h+(c-y)/(m-y)-.5)})}return r.contour=i,r.size=function(l){if(!arguments.length)return[e,t];var u=Math.floor(l[0]),c=Math.floor(l[1]);return u>=0&&c>=0||I("invalid size"),e=u,t=c,r},r.smooth=function(l){return arguments.length?(n=l?a:hoe,r):n===a},r}function poe(e){for(var t=0,n=e.length,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r}function goe(e,t){for(var n=-1,r=t.length,i;++n<r;)if(i=moe(e,t[n]))return i;return 0}function moe(e,t){for(var n=t[0],r=t[1],i=-1,o=0,s=e.length,a=s-1;o<s;a=o++){var l=e[o],u=l[0],c=l[1],f=e[a],d=f[0],h=f[1];if(yoe(l,f,t))return 0;c>r!=h>r&&n<(d-u)*(r-c)/(h-c)+u&&(i=-i)}return i}function yoe(e,t,n){var r;return voe(e,t,n)&&xoe(e[r=+(e[0]===t[0])],n[r],t[r])}function voe(e,t,n){return(t[0]-e[0])*(n[1]-e[1])===(n[0]-e[0])*(t[1]-e[1])}function xoe(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}function Fz(e,t,n){return function(r){var i=co(r),o=n?Math.min(i[0],0):i[0],s=i[1],a=s-o,l=t?ma(o,s,e):a/(e+1);return mr(o+l,s,l)}}function b3(e){P.call(this,null,e)}b3.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]};X(b3,P,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=e.field||wn,o=Az().smooth(e.smooth!==!1),s=e.thresholds||woe(r,i,e),a=e.as===null?null:e.as||"contour",l=[];return r.forEach(u=>{const c=i(u),f=o.size([c.width,c.height])(c.values,j(s)?s:s(c.values));boe(f,c,u,e),f.forEach(d=>{l.push(Ly(u,De(a!=null?{[a]:d}:d)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=l,n}});function woe(e,t,n){const r=Fz(n.levels||10,n.nice,n.zero!==!1);return n.resolve!=="shared"?r:r(e.map(i=>Cl(t(i).values)))}function boe(e,t,n,r){let i=r.scale||t.scale,o=r.translate||t.translate;if(me(i)&&(i=i(n,r)),me(o)&&(o=o(n,r)),(i===1||i==null)&&!o)return;const s=(Me(i)?i:i[0])||1,a=(Me(i)?i:i[1])||1,l=o&&o[0]||0,u=o&&o[1]||0;e.forEach(Mz(t,s,a,l,u))}function Mz(e,t,n,r,i){const o=e.x1||0,s=e.y1||0,a=t*n<0;function l(f){f.forEach(u)}function u(f){a&&f.reverse(),f.forEach(c)}function c(f){f[0]=(f[0]-o)*t+r,f[1]=(f[1]-s)*n+i}return function(f){return f.coordinates.forEach(l),f}}function IF(e,t,n){const r=e>=0?e:hk(t,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function P2(e){return me(e)?e:bn(+e)}function Tz(){var e=l=>l[0],t=l=>l[1],n=vf,r=[-1,-1],i=960,o=500,s=2;function a(l,u){const c=IF(r[0],l,e)>>s,f=IF(r[1],l,t)>>s,d=c?c+2:0,h=f?f+2:0,p=2*d+(i>>s),g=2*h+(o>>s),y=new Float32Array(p*g),m=new Float32Array(p*g);let v=y;l.forEach(w=>{const b=d+(+e(w)>>s),S=h+(+t(w)>>s);b>=0&&b<p&&S>=0&&S<g&&(y[b+S*p]+=+n(w))}),c>0&&f>0?(Nu(p,g,y,m,c),Ru(p,g,m,y,f),Nu(p,g,y,m,c),Ru(p,g,m,y,f),Nu(p,g,y,m,c),Ru(p,g,m,y,f)):c>0?(Nu(p,g,y,m,c),Nu(p,g,m,y,c),Nu(p,g,y,m,c),v=m):f>0&&(Ru(p,g,y,m,f),Ru(p,g,m,y,f),Ru(p,g,y,m,f),v=m);const x=u?Math.pow(2,-2*s):1/HR(v);for(let w=0,b=p*g;w<b;++w)v[w]*=x;return{values:v,scale:1<<s,width:p,height:g,x1:d,y1:h,x2:d+(i>>s),y2:h+(o>>s)}}return a.x=function(l){return arguments.length?(e=P2(l),a):e},a.y=function(l){return arguments.length?(t=P2(l),a):t},a.weight=function(l){return arguments.length?(n=P2(l),a):n},a.size=function(l){if(!arguments.length)return[i,o];var u=+l[0],c=+l[1];return u>=0&&c>=0||I("invalid size"),i=u,o=c,a},a.cellSize=function(l){return arguments.length?((l=+l)>=1||I("invalid cell size"),s=Math.floor(Math.log(l)/Math.LN2),a):1<<s},a.bandwidth=function(l){return arguments.length?(l=J(l),l.length===1&&(l=[+l[0],+l[0]]),l.length!==2&&I("invalid bandwidth"),r=l,a):r},a}function Nu(e,t,n,r,i){const o=(i<<1)+1;for(let s=0;s<t;++s)for(let a=0,l=0;a<e+i;++a)a<e&&(l+=n[a+s*e]),a>=i&&(a>=o&&(l-=n[a-o+s*e]),r[a-i+s*e]=l/Math.min(a+1,e-1+o-a,o))}function Ru(e,t,n,r,i){const o=(i<<1)+1;for(let s=0;s<e;++s)for(let a=0,l=0;a<t+i;++a)a<t&&(l+=n[s+a*e]),a>=i&&(a>=o&&(l-=n[s+(a-o)*e]),r[s+(a-i)*e]=l/Math.min(a+1,t-1+o-a,o))}function E3(e){P.call(this,null,e)}E3.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const Eoe=["x","y","weight","size","cellSize","bandwidth"];function Nz(e,t){return Eoe.forEach(n=>t[n]!=null?e[n](t[n]):0),e}X(E3,P,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=Soe(r,e.groupby),o=(e.groupby||[]).map(ft),s=Nz(Tz(),e),a=e.as||"grid",l=[];function u(c,f){for(let d=0;d<o.length;++d)c[o[d]]=f[d];return c}return l=i.map(c=>De(u({[a]:s(c,e.counts)},c.dims))),this.value&&(n.rem=this.value),this.value=n.source=n.add=l,n}});function Soe(e,t){var n=[],r=c=>c(a),i,o,s,a,l,u;if(t==null)n.push(e);else for(i={},o=0,s=e.length;o<s;++o)a=e[o],l=t.map(r),u=i[l],u||(i[l]=u=[],u.dims=l,n.push(u)),u.push(a);return n}function S3(e){P.call(this,null,e)}S3.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]};X(S3,P,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=Az().smooth(e.smooth!==!1),i=e.values,o=e.thresholds||Fz(e.count||10,e.nice,!!i),s=e.size,a,l;return i||(i=t.materialize(t.SOURCE).source,a=Nz(Tz(),e)(i,!0),l=Mz(a,a.scale||1,a.scale||1,0,0),s=[a.width,a.height],i=a.values),o=j(o)?o:o(i),i=r.size(s)(i,o),l&&i.forEach(l),this.value&&(n.rem=this.value),this.value=n.source=n.add=(i||[]).map(De),n}});const IE="Feature",_3="FeatureCollection",_oe="MultiPoint";function k3(e){P.call(this,null,e)}k3.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]};X(k3,P,{transform(e,t){var n=this._features,r=this._points,i=e.fields,o=i&&i[0],s=i&&i[1],a=e.geojson||!i&&wn,l=t.ADD,u;u=e.modified()||t.changed(t.REM)||t.modified(gn(a))||o&&t.modified(gn(o))||s&&t.modified(gn(s)),(!this.value||u)&&(l=t.SOURCE,this._features=n=[],this._points=r=[]),a&&t.visit(l,c=>n.push(a(c))),o&&s&&(t.visit(l,c=>{var f=o(c),d=s(c);f!=null&&d!=null&&(f=+f)===f&&(d=+d)===d&&r.push([f,d])}),n=n.concat({type:IE,geometry:{type:_oe,coordinates:r}})),this.value={type:_3,features:n}}});function C3(e){P.call(this,null,e)}C3.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]};X(C3,P,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.field||wn,o=e.as||"path",s=n.SOURCE;!r||e.modified()?(this.value=r=$z(e.projection),n.materialize().reflow()):s=i===wn||t.modified(i.fields)?n.ADD_MOD:n.ADD;const a=koe(r,e.pointRadius);return n.visit(s,l=>l[o]=r(i(l))),r.pointRadius(a),n.modifies(o)}});function koe(e,t){const n=e.pointRadius();return e.context(null),t!=null&&e.pointRadius(t),n}function $3(e){P.call(this,null,e)}$3.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]};X($3,P,{transform(e,t){var n=e.projection,r=e.fields[0],i=e.fields[1],o=e.as||["x","y"],s=o[0],a=o[1],l;function u(c){const f=n([r(c),i(c)]);f?(c[s]=f[0],c[a]=f[1]):(c[s]=void 0,c[a]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,u):(l=t.modified(r.fields)||t.modified(i.fields),t.visit(l?t.ADD_MOD:t.ADD,u)),t.modifies(o)}});function A3(e){P.call(this,null,e)}A3.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]};X(A3,P,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.as||"shape",o=n.ADD;return(!r||e.modified())&&(this.value=r=Coe($z(e.projection),e.field||Vr("datum"),e.pointRadius),n.materialize().reflow(),o=n.SOURCE),n.visit(o,s=>s[i]=r),n.modifies(i)}});function Coe(e,t,n){const r=n==null?i=>e(t(i)):i=>{var o=e.pointRadius(),s=e.pointRadius(n)(t(i));return e.pointRadius(o),s};return r.context=i=>(e.context(i),r),r}function F3(e){P.call(this,[],e),this.generator=wie()}F3.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]};X(F3,P,{transform(e,t){var n=this.value,r=this.generator,i;if(!n.length||e.modified())for(const o in e)me(r[o])&&r[o](e[o]);return i=r(),n.length?t.mod.push(jD(n[0],i)):t.add.push(De(i)),n[0]=i,t}});function M3(e){P.call(this,null,e)}M3.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]};X(M3,P,{transform(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,r=e.resolve==="shared",i=e.field||wn,o=Aoe(e.opacity,e),s=$oe(e.color,e),a=e.as||"image",l={$x:0,$y:0,$value:0,$max:r?Cl(n.map(u=>Cl(i(u).values))):0};return n.forEach(u=>{const c=i(u),f=ge({},u,l);r||(f.$max=Cl(c.values||[])),u[a]=Foe(c,f,s.dep?s:bn(s(f)),o.dep?o:bn(o(f)))}),t.reflow(!0).modifies(a)}});function $oe(e,t){let n;return me(e)?(n=r=>xa(e(r,t)),n.dep=Rz(e)):n=bn(xa(e||"#888")),n}function Aoe(e,t){let n;return me(e)?(n=r=>e(r,t),n.dep=Rz(e)):e?n=bn(e):(n=r=>r.$value/r.$max||0,n.dep=!0),n}function Rz(e){if(!me(e))return!1;const t=ki(gn(e));return t.$x||t.$y||t.$value||t.$max}function Foe(e,t,n,r){const i=e.width,o=e.height,s=e.x1||0,a=e.y1||0,l=e.x2||i,u=e.y2||o,c=e.values,f=c?y=>c[y]:Bs,d=ca(l-s,u-a),h=d.getContext("2d"),p=h.getImageData(0,0,l-s,u-a),g=p.data;for(let y=a,m=0;y<u;++y){t.$y=y-a;for(let v=s,x=y*i;v<l;++v,m+=4){t.$x=v-s,t.$value=f(v+x);const w=n(t);g[m+0]=w.r,g[m+1]=w.g,g[m+2]=w.b,g[m+3]=~~(255*r(t))}}return h.putImageData(p,0,0),d}function Dz(e){P.call(this,null,e),this.modified(!0)}X(Dz,P,{transform(e,t){let n=this.value;return!n||e.modified("type")?(this.value=n=Toe(e.type),zE.forEach(r=>{e[r]!=null&&jF(n,r,e[r])})):zE.forEach(r=>{e.modified(r)&&jF(n,r,e[r])}),e.pointRadius!=null&&n.path.pointRadius(e.pointRadius),e.fit&&Moe(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function Moe(e,t){const n=Noe(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}function Toe(e){const t=w3((e||"mercator").toLowerCase());return t||I("Unrecognized projection type: "+e),t()}function jF(e,t,n){me(e[t])&&e[t](n)}function Noe(e){return e=J(e),e.length===1?e[0]:{type:_3,features:e.reduce((t,n)=>t.concat(Roe(n)),[])}}function Roe(e){return e.type===_3?e.features:J(e).filter(t=>t!=null).map(t=>t.type===IE?t:{type:IE,geometry:t})}const Doe=Object.freeze(Object.defineProperty({__proto__:null,contour:S3,geojson:k3,geopath:C3,geopoint:$3,geoshape:A3,graticule:F3,heatmap:M3,isocontour:b3,kde2d:E3,projection:Dz},Symbol.toStringTag,{value:"Module"}));function Ooe(e,t){var n,r=1;e==null&&(e=0),t==null&&(t=0);function i(){var o,s=n.length,a,l=0,u=0;for(o=0;o<s;++o)a=n[o],l+=a.x,u+=a.y;for(l=(l/s-e)*r,u=(u/s-t)*r,o=0;o<s;++o)a=n[o],a.x-=l,a.y-=u}return i.initialize=function(o){n=o},i.x=function(o){return arguments.length?(e=+o,i):e},i.y=function(o){return arguments.length?(t=+o,i):t},i.strength=function(o){return arguments.length?(r=+o,i):r},i}function Poe(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return Oz(this.cover(t,n),t,n,e)}function Oz(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,o=e._root,s={data:r},a=e._x0,l=e._y0,u=e._x1,c=e._y1,f,d,h,p,g,y,m,v;if(!o)return e._root=s,e;for(;o.length;)if((g=t>=(f=(a+u)/2))?a=f:u=f,(y=n>=(d=(l+c)/2))?l=d:c=d,i=o,!(o=o[m=y<<1|g]))return i[m]=s,e;if(h=+e._x.call(null,o.data),p=+e._y.call(null,o.data),t===h&&n===p)return s.next=o,i?i[m]=s:e._root=s,e;do i=i?i[m]=new Array(4):e._root=new Array(4),(g=t>=(f=(a+u)/2))?a=f:u=f,(y=n>=(d=(l+c)/2))?l=d:c=d;while((m=y<<1|g)===(v=(p>=d)<<1|h>=f));return i[v]=o,i[m]=s,e}function Loe(e){var t,n,r=e.length,i,o,s=new Array(r),a=new Array(r),l=1/0,u=1/0,c=-1/0,f=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(o=+this._y.call(null,t))||(s[n]=i,a[n]=o,i<l&&(l=i),i>c&&(c=i),o<u&&(u=o),o>f&&(f=o));if(l>c||u>f)return this;for(this.cover(l,u).cover(c,f),n=0;n<r;++n)Oz(this,s[n],a[n],e[n]);return this}function zoe(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,o=(r=Math.floor(t))+1;else{for(var s=i-n||1,a=this._root,l,u;n>e||e>=i||r>t||t>=o;)switch(u=(t<r)<<1|e<n,l=new Array(4),l[u]=a,a=l,s*=2,u){case 0:i=n+s,o=r+s;break;case 1:n=i-s,o=r+s;break;case 2:i=n+s,r=o-s;break;case 3:n=i-s,r=o-s;break}this._root&&this._root.length&&(this._root=a)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this}function Ioe(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function joe(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Mn(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function Boe(e,t,n){var r,i=this._x0,o=this._y0,s,a,l,u,c=this._x1,f=this._y1,d=[],h=this._root,p,g;for(h&&d.push(new Mn(h,i,o,c,f)),n==null?n=1/0:(i=e-n,o=t-n,c=e+n,f=t+n,n*=n);p=d.pop();)if(!(!(h=p.node)||(s=p.x0)>c||(a=p.y0)>f||(l=p.x1)<i||(u=p.y1)<o))if(h.length){var y=(s+l)/2,m=(a+u)/2;d.push(new Mn(h[3],y,m,l,u),new Mn(h[2],s,m,y,u),new Mn(h[1],y,a,l,m),new Mn(h[0],s,a,y,m)),(g=(t>=m)<<1|e>=y)&&(p=d[d.length-1],d[d.length-1]=d[d.length-1-g],d[d.length-1-g]=p)}else{var v=e-+this._x.call(null,h.data),x=t-+this._y.call(null,h.data),w=v*v+x*x;if(w<n){var b=Math.sqrt(n=w);i=e-b,o=t-b,c=e+b,f=t+b,r=h.data}}return r}function Uoe(e){if(isNaN(c=+this._x.call(null,e))||isNaN(f=+this._y.call(null,e)))return this;var t,n=this._root,r,i,o,s=this._x0,a=this._y0,l=this._x1,u=this._y1,c,f,d,h,p,g,y,m;if(!n)return this;if(n.length)for(;;){if((p=c>=(d=(s+l)/2))?s=d:l=d,(g=f>=(h=(a+u)/2))?a=h:u=h,t=n,!(n=n[y=g<<1|p]))return this;if(!n.length)break;(t[y+1&3]||t[y+2&3]||t[y+3&3])&&(r=t,m=y)}for(;n.data!==e;)if(i=n,!(n=n.next))return this;return(o=n.next)&&delete n.next,i?(o?i.next=o:delete i.next,this):t?(o?t[y]=o:delete t[y],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[m]=n:this._root=n),this):(this._root=o,this)}function Woe(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function qoe(){return this._root}function Hoe(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function Voe(e){var t=[],n,r=this._root,i,o,s,a,l;for(r&&t.push(new Mn(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,o=n.x0,s=n.y0,a=n.x1,l=n.y1)&&r.length){var u=(o+a)/2,c=(s+l)/2;(i=r[3])&&t.push(new Mn(i,u,c,a,l)),(i=r[2])&&t.push(new Mn(i,o,c,u,l)),(i=r[1])&&t.push(new Mn(i,u,s,a,c)),(i=r[0])&&t.push(new Mn(i,o,s,u,c))}return this}function Goe(e){var t=[],n=[],r;for(this._root&&t.push(new Mn(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var i=r.node;if(i.length){var o,s=r.x0,a=r.y0,l=r.x1,u=r.y1,c=(s+l)/2,f=(a+u)/2;(o=i[0])&&t.push(new Mn(o,s,a,c,f)),(o=i[1])&&t.push(new Mn(o,c,a,l,f)),(o=i[2])&&t.push(new Mn(o,s,f,c,u)),(o=i[3])&&t.push(new Mn(o,c,f,l,u))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}function Yoe(e){return e[0]}function Xoe(e){return arguments.length?(this._x=e,this):this._x}function Qoe(e){return e[1]}function Koe(e){return arguments.length?(this._y=e,this):this._y}function T3(e,t,n){var r=new N3(t??Yoe,n??Qoe,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function N3(e,t,n,r,i,o){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function BF(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var Bn=T3.prototype=N3.prototype;Bn.copy=function(){var e=new N3(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=BF(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var i=0;i<4;++i)(r=t.source[i])&&(r.length?n.push({source:r,target:t.target[i]=new Array(4)}):t.target[i]=BF(r));return e};Bn.add=Poe;Bn.addAll=Loe;Bn.cover=zoe;Bn.data=Ioe;Bn.extent=joe;Bn.find=Boe;Bn.remove=Uoe;Bn.removeAll=Woe;Bn.root=qoe;Bn.size=Hoe;Bn.visit=Voe;Bn.visitAfter=Goe;Bn.x=Xoe;Bn.y=Koe;function Tn(e){return function(){return e}}function Qs(e){return(e()-.5)*1e-6}function Zoe(e){return e.x+e.vx}function Joe(e){return e.y+e.vy}function ese(e){var t,n,r,i=1,o=1;typeof e!="function"&&(e=Tn(e==null?1:+e));function s(){for(var u,c=t.length,f,d,h,p,g,y,m=0;m<o;++m)for(f=T3(t,Zoe,Joe).visitAfter(a),u=0;u<c;++u)d=t[u],g=n[d.index],y=g*g,h=d.x+d.vx,p=d.y+d.vy,f.visit(v);function v(x,w,b,S,E){var _=x.data,k=x.r,C=g+k;if(_){if(_.index>d.index){var $=h-_.x-_.vx,O=p-_.y-_.vy,A=$*$+O*O;A<C*C&&($===0&&($=Qs(r),A+=$*$),O===0&&(O=Qs(r),A+=O*O),A=(C-(A=Math.sqrt(A)))/A*i,d.vx+=($*=A)*(C=(k*=k)/(y+k)),d.vy+=(O*=A)*C,_.vx-=$*(C=1-C),_.vy-=O*C)}return}return w>h+C||S<h-C||b>p+C||E<p-C}}function a(u){if(u.data)return u.r=n[u.data.index];for(var c=u.r=0;c<4;++c)u[c]&&u[c].r>u.r&&(u.r=u[c].r)}function l(){if(t){var u,c=t.length,f;for(n=new Array(c),u=0;u<c;++u)f=t[u],n[f.index]=+e(f,u,t)}}return s.initialize=function(u,c){t=u,r=c,l()},s.iterations=function(u){return arguments.length?(o=+u,s):o},s.strength=function(u){return arguments.length?(i=+u,s):i},s.radius=function(u){return arguments.length?(e=typeof u=="function"?u:Tn(+u),l(),s):e},s}function tse(e){return e.index}function UF(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function nse(e){var t=tse,n=f,r,i=Tn(30),o,s,a,l,u,c=1;e==null&&(e=[]);function f(y){return 1/Math.min(a[y.source.index],a[y.target.index])}function d(y){for(var m=0,v=e.length;m<c;++m)for(var x=0,w,b,S,E,_,k,C;x<v;++x)w=e[x],b=w.source,S=w.target,E=S.x+S.vx-b.x-b.vx||Qs(u),_=S.y+S.vy-b.y-b.vy||Qs(u),k=Math.sqrt(E*E+_*_),k=(k-o[x])/k*y*r[x],E*=k,_*=k,S.vx-=E*(C=l[x]),S.vy-=_*C,b.vx+=E*(C=1-C),b.vy+=_*C}function h(){if(s){var y,m=s.length,v=e.length,x=new Map(s.map((b,S)=>[t(b,S,s),b])),w;for(y=0,a=new Array(m);y<v;++y)w=e[y],w.index=y,typeof w.source!="object"&&(w.source=UF(x,w.source)),typeof w.target!="object"&&(w.target=UF(x,w.target)),a[w.source.index]=(a[w.source.index]||0)+1,a[w.target.index]=(a[w.target.index]||0)+1;for(y=0,l=new Array(v);y<v;++y)w=e[y],l[y]=a[w.source.index]/(a[w.source.index]+a[w.target.index]);r=new Array(v),p(),o=new Array(v),g()}}function p(){if(s)for(var y=0,m=e.length;y<m;++y)r[y]=+n(e[y],y,e)}function g(){if(s)for(var y=0,m=e.length;y<m;++y)o[y]=+i(e[y],y,e)}return d.initialize=function(y,m){s=y,u=m,h()},d.links=function(y){return arguments.length?(e=y,h(),d):e},d.id=function(y){return arguments.length?(t=y,d):t},d.iterations=function(y){return arguments.length?(c=+y,d):c},d.strength=function(y){return arguments.length?(n=typeof y=="function"?y:Tn(+y),p(),d):n},d.distance=function(y){return arguments.length?(i=typeof y=="function"?y:Tn(+y),g(),d):i},d}var rse={value:()=>{}};function Pz(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new q0(n)}function q0(e){this._=e}function ise(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}q0.prototype=Pz.prototype={constructor:q0,on:function(e,t){var n=this._,r=ise(e+"",n),i,o=-1,s=r.length;if(arguments.length<2){for(;++o<s;)if((i=(e=r[o]).type)&&(i=ose(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<s;)if(i=(e=r[o]).type)n[i]=WF(n[i],e.name,t);else if(t==null)for(i in n)n[i]=WF(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new q0(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,o;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],r=0,i=o.length;r<i;++r)o[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,o=r.length;i<o;++i)r[i].value.apply(t,n)}};function ose(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function WF(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=rse,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Yc=0,Ud=0,cd=0,Lz=1e3,R1,Wd,D1=0,Gl=0,bv=0,Jh=typeof performance=="object"&&performance.now?performance:Date,zz=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function R3(){return Gl||(zz(sse),Gl=Jh.now()+bv)}function sse(){Gl=0}function O1(){this._call=this._time=this._next=null}O1.prototype=Iz.prototype={constructor:O1,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?R3():+n)+(t==null?0:+t),!this._next&&Wd!==this&&(Wd?Wd._next=this:R1=this,Wd=this),this._call=e,this._time=n,jE()},stop:function(){this._call&&(this._call=null,this._time=1/0,jE())}};function Iz(e,t,n){var r=new O1;return r.restart(e,t,n),r}function ase(){R3(),++Yc;for(var e=R1,t;e;)(t=Gl-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Yc}function qF(){Gl=(D1=Jh.now())+bv,Yc=Ud=0;try{ase()}finally{Yc=0,use(),Gl=0}}function lse(){var e=Jh.now(),t=e-D1;t>Lz&&(bv-=t,D1=e)}function use(){for(var e,t=R1,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:R1=n);Wd=e,jE(r)}function jE(e){if(!Yc){Ud&&(Ud=clearTimeout(Ud));var t=e-Gl;t>24?(e<1/0&&(Ud=setTimeout(qF,e-Jh.now()-bv)),cd&&(cd=clearInterval(cd))):(cd||(D1=Jh.now(),cd=setInterval(lse,Lz)),Yc=1,zz(qF))}}function cse(e,t,n){var r=new O1,i=t;return t==null?(r.restart(e,t,n),r):(r._restart=r.restart,r.restart=function(o,s,a){s=+s,a=a==null?R3():+a,r._restart(function l(u){u+=i,r._restart(l,i+=s,a),o(u)},s,a)},r.restart(e,t,n),r)}const fse=1664525,dse=1013904223,HF=4294967296;function hse(){let e=1;return()=>(e=(fse*e+dse)%HF)/HF}function pse(e){return e.x}function gse(e){return e.y}var mse=10,yse=Math.PI*(3-Math.sqrt(5));function vse(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),o=0,s=.6,a=new Map,l=Iz(f),u=Pz("tick","end"),c=hse();e==null&&(e=[]);function f(){d(),u.call("tick",t),n<r&&(l.stop(),u.call("end",t))}function d(g){var y,m=e.length,v;g===void 0&&(g=1);for(var x=0;x<g;++x)for(n+=(o-n)*i,a.forEach(function(w){w(n)}),y=0;y<m;++y)v=e[y],v.fx==null?v.x+=v.vx*=s:(v.x=v.fx,v.vx=0),v.fy==null?v.y+=v.vy*=s:(v.y=v.fy,v.vy=0);return t}function h(){for(var g=0,y=e.length,m;g<y;++g){if(m=e[g],m.index=g,m.fx!=null&&(m.x=m.fx),m.fy!=null&&(m.y=m.fy),isNaN(m.x)||isNaN(m.y)){var v=mse*Math.sqrt(.5+g),x=g*yse;m.x=v*Math.cos(x),m.y=v*Math.sin(x)}(isNaN(m.vx)||isNaN(m.vy))&&(m.vx=m.vy=0)}}function p(g){return g.initialize&&g.initialize(e,c),g}return h(),t={tick:d,restart:function(){return l.restart(f),t},stop:function(){return l.stop(),t},nodes:function(g){return arguments.length?(e=g,h(),a.forEach(p),t):e},alpha:function(g){return arguments.length?(n=+g,t):n},alphaMin:function(g){return arguments.length?(r=+g,t):r},alphaDecay:function(g){return arguments.length?(i=+g,t):+i},alphaTarget:function(g){return arguments.length?(o=+g,t):o},velocityDecay:function(g){return arguments.length?(s=1-g,t):1-s},randomSource:function(g){return arguments.length?(c=g,a.forEach(p),t):c},force:function(g,y){return arguments.length>1?(y==null?a.delete(g):a.set(g,p(y)),t):a.get(g)},find:function(g,y,m){var v=0,x=e.length,w,b,S,E,_;for(m==null?m=1/0:m*=m,v=0;v<x;++v)E=e[v],w=g-E.x,b=y-E.y,S=w*w+b*b,S<m&&(_=E,m=S);return _},on:function(g,y){return arguments.length>1?(u.on(g,y),t):u.on(g)}}}function xse(){var e,t,n,r,i=Tn(-30),o,s=1,a=1/0,l=.81;function u(h){var p,g=e.length,y=T3(e,pse,gse).visitAfter(f);for(r=h,p=0;p<g;++p)t=e[p],y.visit(d)}function c(){if(e){var h,p=e.length,g;for(o=new Array(p),h=0;h<p;++h)g=e[h],o[g.index]=+i(g,h,e)}}function f(h){var p=0,g,y,m=0,v,x,w;if(h.length){for(v=x=w=0;w<4;++w)(g=h[w])&&(y=Math.abs(g.value))&&(p+=g.value,m+=y,v+=y*g.x,x+=y*g.y);h.x=v/m,h.y=x/m}else{g=h,g.x=g.data.x,g.y=g.data.y;do p+=o[g.data.index];while(g=g.next)}h.value=p}function d(h,p,g,y){if(!h.value)return!0;var m=h.x-t.x,v=h.y-t.y,x=y-p,w=m*m+v*v;if(x*x/l<w)return w<a&&(m===0&&(m=Qs(n),w+=m*m),v===0&&(v=Qs(n),w+=v*v),w<s&&(w=Math.sqrt(s*w)),t.vx+=m*h.value*r/w,t.vy+=v*h.value*r/w),!0;if(h.length||w>=a)return;(h.data!==t||h.next)&&(m===0&&(m=Qs(n),w+=m*m),v===0&&(v=Qs(n),w+=v*v),w<s&&(w=Math.sqrt(s*w)));do h.data!==t&&(x=o[h.data.index]*r/w,t.vx+=m*x,t.vy+=v*x);while(h=h.next)}return u.initialize=function(h,p){e=h,n=p,c()},u.strength=function(h){return arguments.length?(i=typeof h=="function"?h:Tn(+h),c(),u):i},u.distanceMin=function(h){return arguments.length?(s=h*h,u):Math.sqrt(s)},u.distanceMax=function(h){return arguments.length?(a=h*h,u):Math.sqrt(a)},u.theta=function(h){return arguments.length?(l=h*h,u):Math.sqrt(l)},u}function wse(e){var t=Tn(.1),n,r,i;typeof e!="function"&&(e=Tn(e==null?0:+e));function o(a){for(var l=0,u=n.length,c;l<u;++l)c=n[l],c.vx+=(i[l]-c.x)*r[l]*a}function s(){if(n){var a,l=n.length;for(r=new Array(l),i=new Array(l),a=0;a<l;++a)r[a]=isNaN(i[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return o.initialize=function(a){n=a,s()},o.strength=function(a){return arguments.length?(t=typeof a=="function"?a:Tn(+a),s(),o):t},o.x=function(a){return arguments.length?(e=typeof a=="function"?a:Tn(+a),s(),o):e},o}function bse(e){var t=Tn(.1),n,r,i;typeof e!="function"&&(e=Tn(e==null?0:+e));function o(a){for(var l=0,u=n.length,c;l<u;++l)c=n[l],c.vy+=(i[l]-c.y)*r[l]*a}function s(){if(n){var a,l=n.length;for(r=new Array(l),i=new Array(l),a=0;a<l;++a)r[a]=isNaN(i[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return o.initialize=function(a){n=a,s()},o.strength=function(a){return arguments.length?(t=typeof a=="function"?a:Tn(+a),s(),o):t},o.y=function(a){return arguments.length?(e=typeof a=="function"?a:Tn(+a),s(),o):e},o}const VF={center:Ooe,collide:ese,nbody:xse,link:nse,x:wse,y:bse},qd="forces",BE=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],Ese=["static","iterations"],jz=["x","y","vx","vy"];function D3(e){P.call(this,null,e)}D3.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30,expr:!0},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:jz}]};X(D3,P,{transform(e,t){var n=this.value,r=t.changed(t.ADD_REM),i=e.modified(BE),o=e.iterations||300;if(n?(r&&(t.modifies("index"),n.nodes(t.source)),(i||t.changed(t.MOD))&&Bz(n,e,0,t)):(this.value=n=_se(t.source,e),n.on("tick",Sse(t.dataflow,this)),e.static||(r=!0,n.tick()),t.modifies("index")),i||r||e.modified(Ese)||t.changed()&&e.restart){if(n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/o)),e.static)for(n.stop();--o>=0;)n.tick();else if(n.stopped()&&n.restart(),!r)return t.StopPropagation}return this.finish(e,t)},finish(e,t){const n=t.dataflow;for(let a=this._argops,l=0,u=a.length,c;l<u;++l)if(c=a[l],!(c.name!==qd||c.op._argval.force!=="link")){for(var r=c.op._argops,i=0,o=r.length,s;i<o;++i)if(r[i].name==="links"&&(s=r[i].op.source)){n.pulse(s,n.changeset().reflow());break}}return t.reflow(e.modified()).modifies(jz)}});function Sse(e,t){return()=>e.touch(t).run()}function _se(e,t){const n=vse(e),r=n.stop,i=n.restart;let o=!1;return n.stopped=()=>o,n.restart=()=>(o=!1,i()),n.stop=()=>(o=!0,r()),Bz(n,t,!0).on("end",()=>o=!0)}function Bz(e,t,n,r){var i=J(t.forces),o,s,a,l;for(o=0,s=BE.length;o<s;++o)a=BE[o],a!==qd&&t.modified(a)&&e[a](t[a]);for(o=0,s=i.length;o<s;++o)l=qd+o,a=n||t.modified(qd,o)?Cse(i[o]):r&&kse(i[o],r)?e.force(l):null,a&&e.force(l,a);for(s=e.numForces||0;o<s;++o)e.force(qd+o,null);return e.numForces=i.length,e}function kse(e,t){var n,r;for(n in e)if(me(r=e[n])&&t.modified(gn(r)))return 1;return 0}function Cse(e){var t,n;te(VF,e.force)||I("Unrecognized force: "+e.force),t=VF[e.force]();for(n in e)me(t[n])&&$se(t[n],e[n],e);return t}function $se(e,t,n){e(me(t)?r=>t(r,n):t)}const Ase=Object.freeze(Object.defineProperty({__proto__:null,force:D3},Symbol.toStringTag,{value:"Module"}));function Fse(e,t){return e.parent===t.parent?1:2}function Mse(e){return e.reduce(Tse,0)/e.length}function Tse(e,t){return e+t.x}function Nse(e){return 1+e.reduce(Rse,0)}function Rse(e,t){return Math.max(e,t.y)}function Dse(e){for(var t;t=e.children;)e=t[0];return e}function Ose(e){for(var t;t=e.children;)e=t[t.length-1];return e}function Pse(){var e=Fse,t=1,n=1,r=!1;function i(o){var s,a=0;o.eachAfter(function(d){var h=d.children;h?(d.x=Mse(h),d.y=Nse(h)):(d.x=s?a+=e(d,s):0,d.y=0,s=d)});var l=Dse(o),u=Ose(o),c=l.x-e(l,u)/2,f=u.x+e(u,l)/2;return o.eachAfter(r?function(d){d.x=(d.x-o.x)*t,d.y=(o.y-d.y)*n}:function(d){d.x=(d.x-c)/(f-c)*t,d.y=(1-(o.y?d.y/o.y:1))*n})}return i.separation=function(o){return arguments.length?(e=o,i):e},i.size=function(o){return arguments.length?(r=!1,t=+o[0],n=+o[1],i):r?null:[t,n]},i.nodeSize=function(o){return arguments.length?(r=!0,t=+o[0],n=+o[1],i):r?[t,n]:null},i}function Lse(e){var t=0,n=e.children,r=n&&n.length;if(!r)t=1;else for(;--r>=0;)t+=n[r].value;e.value=t}function zse(){return this.eachAfter(Lse)}function Ise(e,t){let n=-1;for(const r of this)e.call(t,r,++n,this);return this}function jse(e,t){for(var n=this,r=[n],i,o,s=-1;n=r.pop();)if(e.call(t,n,++s,this),i=n.children)for(o=i.length-1;o>=0;--o)r.push(i[o]);return this}function Bse(e,t){for(var n=this,r=[n],i=[],o,s,a,l=-1;n=r.pop();)if(i.push(n),o=n.children)for(s=0,a=o.length;s<a;++s)r.push(o[s]);for(;n=i.pop();)e.call(t,n,++l,this);return this}function Use(e,t){let n=-1;for(const r of this)if(e.call(t,r,++n,this))return r}function Wse(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,r=t.children,i=r&&r.length;--i>=0;)n+=r[i].value;t.value=n})}function qse(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function Hse(e){for(var t=this,n=Vse(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var i=r.length;e!==n;)r.splice(i,0,e),e=e.parent;return r}function Vse(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),i=null;for(e=n.pop(),t=r.pop();e===t;)i=e,e=n.pop(),t=r.pop();return i}function Gse(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function Yse(){return Array.from(this)}function Xse(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function Qse(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*Kse(){var e=this,t,n=[e],r,i,o;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,r=e.children)for(i=0,o=r.length;i<o;++i)n.push(r[i]);while(n.length)}function O3(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=eae)):t===void 0&&(t=Jse);for(var n=new Xc(e),r,i=[n],o,s,a,l;r=i.pop();)if((s=t(r.data))&&(l=(s=Array.from(s)).length))for(r.children=s,a=l-1;a>=0;--a)i.push(o=s[a]=new Xc(s[a])),o.parent=r,o.depth=r.depth+1;return n.eachBefore(Uz)}function Zse(){return O3(this).eachBefore(tae)}function Jse(e){return e.children}function eae(e){return Array.isArray(e)?e[1]:null}function tae(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function Uz(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function Xc(e){this.data=e,this.depth=this.height=0,this.parent=null}Xc.prototype=O3.prototype={constructor:Xc,count:zse,each:Ise,eachAfter:Bse,eachBefore:jse,find:Use,sum:Wse,sort:qse,path:Hse,ancestors:Gse,descendants:Yse,leaves:Xse,links:Qse,copy:Zse,[Symbol.iterator]:Kse};function H0(e){return e==null?null:Wz(e)}function Wz(e){if(typeof e!="function")throw new Error;return e}function pl(){return 0}function Bu(e){return function(){return e}}const nae=1664525,rae=1013904223,GF=4294967296;function iae(){let e=1;return()=>(e=(nae*e+rae)%GF)/GF}function oae(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function sae(e,t){let n=e.length,r,i;for(;n;)i=t()*n--|0,r=e[n],e[n]=e[i],e[i]=r;return e}function aae(e,t){for(var n=0,r=(e=sae(Array.from(e),t)).length,i=[],o,s;n<r;)o=e[n],s&&qz(s,o)?++n:(s=uae(i=lae(i,o)),n=0);return s}function lae(e,t){var n,r;if(L2(t,e))return[t];for(n=0;n<e.length;++n)if(Qg(t,e[n])&&L2(Hd(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(r=n+1;r<e.length;++r)if(Qg(Hd(e[n],e[r]),t)&&Qg(Hd(e[n],t),e[r])&&Qg(Hd(e[r],t),e[n])&&L2(Hz(e[n],e[r],t),e))return[e[n],e[r],t];throw new Error}function Qg(e,t){var n=e.r-t.r,r=t.x-e.x,i=t.y-e.y;return n<0||n*n<r*r+i*i}function qz(e,t){var n=e.r-t.r+Math.max(e.r,t.r,1)*1e-9,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function L2(e,t){for(var n=0;n<t.length;++n)if(!qz(e,t[n]))return!1;return!0}function uae(e){switch(e.length){case 1:return cae(e[0]);case 2:return Hd(e[0],e[1]);case 3:return Hz(e[0],e[1],e[2])}}function cae(e){return{x:e.x,y:e.y,r:e.r}}function Hd(e,t){var n=e.x,r=e.y,i=e.r,o=t.x,s=t.y,a=t.r,l=o-n,u=s-r,c=a-i,f=Math.sqrt(l*l+u*u);return{x:(n+o+l/f*c)/2,y:(r+s+u/f*c)/2,r:(f+i+a)/2}}function Hz(e,t,n){var r=e.x,i=e.y,o=e.r,s=t.x,a=t.y,l=t.r,u=n.x,c=n.y,f=n.r,d=r-s,h=r-u,p=i-a,g=i-c,y=l-o,m=f-o,v=r*r+i*i-o*o,x=v-s*s-a*a+l*l,w=v-u*u-c*c+f*f,b=h*p-d*g,S=(p*w-g*x)/(b*2)-r,E=(g*y-p*m)/b,_=(h*x-d*w)/(b*2)-i,k=(d*m-h*y)/b,C=E*E+k*k-1,$=2*(o+S*E+_*k),O=S*S+_*_-o*o,A=-(Math.abs(C)>1e-6?($+Math.sqrt($*$-4*C*O))/(2*C):O/$);return{x:r+S+E*A,y:i+_+k*A,r:A}}function YF(e,t,n){var r=e.x-t.x,i,o,s=e.y-t.y,a,l,u=r*r+s*s;u?(o=t.r+n.r,o*=o,l=e.r+n.r,l*=l,o>l?(i=(u+l-o)/(2*u),a=Math.sqrt(Math.max(0,l/u-i*i)),n.x=e.x-i*r-a*s,n.y=e.y-i*s+a*r):(i=(u+o-l)/(2*u),a=Math.sqrt(Math.max(0,o/u-i*i)),n.x=t.x+i*r-a*s,n.y=t.y+i*s+a*r)):(n.x=t.x+n.r,n.y=t.y)}function XF(e,t){var n=e.r+t.r-1e-6,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function QF(e){var t=e._,n=e.next._,r=t.r+n.r,i=(t.x*n.r+n.x*t.r)/r,o=(t.y*n.r+n.y*t.r)/r;return i*i+o*o}function Kg(e){this._=e,this.next=null,this.previous=null}function fae(e,t){if(!(o=(e=oae(e)).length))return 0;var n,r,i,o,s,a,l,u,c,f,d;if(n=e[0],n.x=0,n.y=0,!(o>1))return n.r;if(r=e[1],n.x=-r.r,r.x=n.r,r.y=0,!(o>2))return n.r+r.r;YF(r,n,i=e[2]),n=new Kg(n),r=new Kg(r),i=new Kg(i),n.next=i.previous=r,r.next=n.previous=i,i.next=r.previous=n;e:for(l=3;l<o;++l){YF(n._,r._,i=e[l]),i=new Kg(i),u=r.next,c=n.previous,f=r._.r,d=n._.r;do if(f<=d){if(XF(u._,i._)){r=u,n.next=r,r.previous=n,--l;continue e}f+=u._.r,u=u.next}else{if(XF(c._,i._)){n=c,n.next=r,r.previous=n,--l;continue e}d+=c._.r,c=c.previous}while(u!==c.next);for(i.previous=n,i.next=r,n.next=r.previous=r=i,s=QF(n);(i=i.next)!==r;)(a=QF(i))<s&&(n=i,s=a);r=n.next}for(n=[r._],i=r;(i=i.next)!==r;)n.push(i._);for(i=aae(n,t),l=0;l<o;++l)n=e[l],n.x-=i.x,n.y-=i.y;return i.r}function dae(e){return Math.sqrt(e.value)}function hae(){var e=null,t=1,n=1,r=pl;function i(o){const s=iae();return o.x=t/2,o.y=n/2,e?o.eachBefore(KF(e)).eachAfter(z2(r,.5,s)).eachBefore(ZF(1)):o.eachBefore(KF(dae)).eachAfter(z2(pl,1,s)).eachAfter(z2(r,o.r/Math.min(t,n),s)).eachBefore(ZF(Math.min(t,n)/(2*o.r))),o}return i.radius=function(o){return arguments.length?(e=H0(o),i):e},i.size=function(o){return arguments.length?(t=+o[0],n=+o[1],i):[t,n]},i.padding=function(o){return arguments.length?(r=typeof o=="function"?o:Bu(+o),i):r},i}function KF(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function z2(e,t,n){return function(r){if(i=r.children){var i,o,s=i.length,a=e(r)*t||0,l;if(a)for(o=0;o<s;++o)i[o].r+=a;if(l=fae(i,n),a)for(o=0;o<s;++o)i[o].r-=a;r.r=l+a}}}function ZF(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function Vz(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function Wp(e,t,n,r,i){for(var o=e.children,s,a=-1,l=o.length,u=e.value&&(r-t)/e.value;++a<l;)s=o[a],s.y0=n,s.y1=i,s.x0=t,s.x1=t+=s.value*u}function pae(){var e=1,t=1,n=0,r=!1;function i(s){var a=s.height+1;return s.x0=s.y0=n,s.x1=e,s.y1=t/a,s.eachBefore(o(t,a)),r&&s.eachBefore(Vz),s}function o(s,a){return function(l){l.children&&Wp(l,l.x0,s*(l.depth+1)/a,l.x1,s*(l.depth+2)/a);var u=l.x0,c=l.y0,f=l.x1-n,d=l.y1-n;f<u&&(u=f=(u+f)/2),d<c&&(c=d=(c+d)/2),l.x0=u,l.y0=c,l.x1=f,l.y1=d}}return i.round=function(s){return arguments.length?(r=!!s,i):r},i.size=function(s){return arguments.length?(e=+s[0],t=+s[1],i):[e,t]},i.padding=function(s){return arguments.length?(n=+s,i):n},i}var gae={depth:-1},JF={},I2={};function mae(e){return e.id}function yae(e){return e.parentId}function eM(){var e=mae,t=yae,n;function r(i){var o=Array.from(i),s=e,a=t,l,u,c,f,d,h,p,g,y=new Map;if(n!=null){const m=o.map((w,b)=>vae(n(w,b,i))),v=m.map(tM),x=new Set(m).add("");for(const w of v)x.has(w)||(x.add(w),m.push(w),v.push(tM(w)),o.push(I2));s=(w,b)=>m[b],a=(w,b)=>v[b]}for(c=0,l=o.length;c<l;++c)u=o[c],h=o[c]=new Xc(u),(p=s(u,c,i))!=null&&(p+="")&&(g=h.id=p,y.set(g,y.has(g)?JF:h)),(p=a(u,c,i))!=null&&(p+="")&&(h.parent=p);for(c=0;c<l;++c)if(h=o[c],p=h.parent){if(d=y.get(p),!d)throw new Error("missing: "+p);if(d===JF)throw new Error("ambiguous: "+p);d.children?d.children.push(h):d.children=[h],h.parent=d}else{if(f)throw new Error("multiple roots");f=h}if(!f)throw new Error("no root");if(n!=null){for(;f.data===I2&&f.children.length===1;)f=f.children[0],--l;for(let m=o.length-1;m>=0&&(h=o[m],h.data===I2);--m)h.data=null}if(f.parent=gae,f.eachBefore(function(m){m.depth=m.parent.depth+1,--l}).eachBefore(Uz),f.parent=null,l>0)throw new Error("cycle");return f}return r.id=function(i){return arguments.length?(e=H0(i),r):e},r.parentId=function(i){return arguments.length?(t=H0(i),r):t},r.path=function(i){return arguments.length?(n=H0(i),r):n},r}function vae(e){e=`${e}`;let t=e.length;return UE(e,t-1)&&!UE(e,t-2)&&(e=e.slice(0,-1)),e[0]==="/"?e:`/${e}`}function tM(e){let t=e.length;if(t<2)return"";for(;--t>1&&!UE(e,t););return e.slice(0,t)}function UE(e,t){if(e[t]==="/"){let n=0;for(;t>0&&e[--t]==="\\";)++n;if(!(n&1))return!0}return!1}function xae(e,t){return e.parent===t.parent?1:2}function j2(e){var t=e.children;return t?t[0]:e.t}function B2(e){var t=e.children;return t?t[t.length-1]:e.t}function wae(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function bae(e){for(var t=0,n=0,r=e.children,i=r.length,o;--i>=0;)o=r[i],o.z+=t,o.m+=t,t+=o.s+(n+=o.c)}function Eae(e,t,n){return e.a.parent===t.parent?e.a:n}function V0(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}V0.prototype=Object.create(Xc.prototype);function Sae(e){for(var t=new V0(e,0),n,r=[t],i,o,s,a;n=r.pop();)if(o=n._.children)for(n.children=new Array(a=o.length),s=a-1;s>=0;--s)r.push(i=n.children[s]=new V0(o[s],s)),i.parent=n;return(t.parent=new V0(null,0)).children=[t],t}function _ae(){var e=xae,t=1,n=1,r=null;function i(u){var c=Sae(u);if(c.eachAfter(o),c.parent.m=-c.z,c.eachBefore(s),r)u.eachBefore(l);else{var f=u,d=u,h=u;u.eachBefore(function(v){v.x<f.x&&(f=v),v.x>d.x&&(d=v),v.depth>h.depth&&(h=v)});var p=f===d?1:e(f,d)/2,g=p-f.x,y=t/(d.x+p+g),m=n/(h.depth||1);u.eachBefore(function(v){v.x=(v.x+g)*y,v.y=v.depth*m})}return u}function o(u){var c=u.children,f=u.parent.children,d=u.i?f[u.i-1]:null;if(c){bae(u);var h=(c[0].z+c[c.length-1].z)/2;d?(u.z=d.z+e(u._,d._),u.m=u.z-h):u.z=h}else d&&(u.z=d.z+e(u._,d._));u.parent.A=a(u,d,u.parent.A||f[0])}function s(u){u._.x=u.z+u.parent.m,u.m+=u.parent.m}function a(u,c,f){if(c){for(var d=u,h=u,p=c,g=d.parent.children[0],y=d.m,m=h.m,v=p.m,x=g.m,w;p=B2(p),d=j2(d),p&&d;)g=j2(g),h=B2(h),h.a=u,w=p.z+v-d.z-y+e(p._,d._),w>0&&(wae(Eae(p,u,f),u,w),y+=w,m+=w),v+=p.m,y+=d.m,x+=g.m,m+=h.m;p&&!B2(h)&&(h.t=p,h.m+=v-m),d&&!j2(g)&&(g.t=d,g.m+=y-x,f=u)}return f}function l(u){u.x*=t,u.y=u.depth*n}return i.separation=function(u){return arguments.length?(e=u,i):e},i.size=function(u){return arguments.length?(r=!1,t=+u[0],n=+u[1],i):r?null:[t,n]},i.nodeSize=function(u){return arguments.length?(r=!0,t=+u[0],n=+u[1],i):r?[t,n]:null},i}function Ev(e,t,n,r,i){for(var o=e.children,s,a=-1,l=o.length,u=e.value&&(i-n)/e.value;++a<l;)s=o[a],s.x0=t,s.x1=r,s.y0=n,s.y1=n+=s.value*u}var Gz=(1+Math.sqrt(5))/2;function Yz(e,t,n,r,i,o){for(var s=[],a=t.children,l,u,c=0,f=0,d=a.length,h,p,g=t.value,y,m,v,x,w,b,S;c<d;){h=i-n,p=o-r;do y=a[f++].value;while(!y&&f<d);for(m=v=y,b=Math.max(p/h,h/p)/(g*e),S=y*y*b,w=Math.max(v/S,S/m);f<d;++f){if(y+=u=a[f].value,u<m&&(m=u),u>v&&(v=u),S=y*y*b,x=Math.max(v/S,S/m),x>w){y-=u;break}w=x}s.push(l={value:y,dice:h<p,children:a.slice(c,f)}),l.dice?Wp(l,n,r,i,g?r+=p*y/g:o):Ev(l,n,r,g?n+=h*y/g:i,o),g-=y,c=f}return s}const Xz=function e(t){function n(r,i,o,s,a){Yz(t,r,i,o,s,a)}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(Gz);function kae(){var e=Xz,t=!1,n=1,r=1,i=[0],o=pl,s=pl,a=pl,l=pl,u=pl;function c(d){return d.x0=d.y0=0,d.x1=n,d.y1=r,d.eachBefore(f),i=[0],t&&d.eachBefore(Vz),d}function f(d){var h=i[d.depth],p=d.x0+h,g=d.y0+h,y=d.x1-h,m=d.y1-h;y<p&&(p=y=(p+y)/2),m<g&&(g=m=(g+m)/2),d.x0=p,d.y0=g,d.x1=y,d.y1=m,d.children&&(h=i[d.depth+1]=o(d)/2,p+=u(d)-h,g+=s(d)-h,y-=a(d)-h,m-=l(d)-h,y<p&&(p=y=(p+y)/2),m<g&&(g=m=(g+m)/2),e(d,p,g,y,m))}return c.round=function(d){return arguments.length?(t=!!d,c):t},c.size=function(d){return arguments.length?(n=+d[0],r=+d[1],c):[n,r]},c.tile=function(d){return arguments.length?(e=Wz(d),c):e},c.padding=function(d){return arguments.length?c.paddingInner(d).paddingOuter(d):c.paddingInner()},c.paddingInner=function(d){return arguments.length?(o=typeof d=="function"?d:Bu(+d),c):o},c.paddingOuter=function(d){return arguments.length?c.paddingTop(d).paddingRight(d).paddingBottom(d).paddingLeft(d):c.paddingTop()},c.paddingTop=function(d){return arguments.length?(s=typeof d=="function"?d:Bu(+d),c):s},c.paddingRight=function(d){return arguments.length?(a=typeof d=="function"?d:Bu(+d),c):a},c.paddingBottom=function(d){return arguments.length?(l=typeof d=="function"?d:Bu(+d),c):l},c.paddingLeft=function(d){return arguments.length?(u=typeof d=="function"?d:Bu(+d),c):u},c}function Cae(e,t,n,r,i){var o=e.children,s,a=o.length,l,u=new Array(a+1);for(u[0]=l=s=0;s<a;++s)u[s+1]=l+=o[s].value;c(0,a,e.value,t,n,r,i);function c(f,d,h,p,g,y,m){if(f>=d-1){var v=o[f];v.x0=p,v.y0=g,v.x1=y,v.y1=m;return}for(var x=u[f],w=h/2+x,b=f+1,S=d-1;b<S;){var E=b+S>>>1;u[E]<w?b=E+1:S=E}w-u[b-1]<u[b]-w&&f+1<b&&--b;var _=u[b]-x,k=h-_;if(y-p>m-g){var C=h?(p*k+y*_)/h:y;c(f,b,_,p,g,C,m),c(b,d,k,C,g,y,m)}else{var $=h?(g*k+m*_)/h:m;c(f,b,_,p,g,y,$),c(b,d,k,p,$,y,m)}}}function $ae(e,t,n,r,i){(e.depth&1?Ev:Wp)(e,t,n,r,i)}const Aae=function e(t){function n(r,i,o,s,a){if((l=r._squarify)&&l.ratio===t)for(var l,u,c,f,d=-1,h,p=l.length,g=r.value;++d<p;){for(u=l[d],c=u.children,f=u.value=0,h=c.length;f<h;++f)u.value+=c[f].value;u.dice?Wp(u,i,o,s,g?o+=(a-o)*u.value/g:a):Ev(u,i,o,g?i+=(s-i)*u.value/g:s,a),g-=u.value}else r._squarify=l=Yz(t,r,i,o,s,a),l.ratio=t}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(Gz);function WE(e,t,n){const r={};return e.each(i=>{const o=i.data;n(o)&&(r[t(o)]=i)}),e.lookup=r,e}function P3(e){P.call(this,null,e)}P3.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const Fae=e=>e.values;X(P3,P,{transform(e,t){t.source||I("Nest transform requires an upstream data source.");var n=e.generate,r=e.modified(),i=t.clone(),o=this.value;return(!o||r||t.changed())&&(o&&o.each(s=>{s.children&&Py(s.data)&&i.rem.push(s.data)}),this.value=o=O3({values:J(e.keys).reduce((s,a)=>(s.key(a),s),Mae()).entries(i.source)},Fae),n&&o.each(s=>{s.children&&(s=De(s.data),i.add.push(s),i.source.push(s))}),WE(o,le,le)),i.source.root=o,i}});function Mae(){const e=[],t={entries:i=>r(n(i,0),0),key:i=>(e.push(i),t)};function n(i,o){if(o>=e.length)return i;const s=i.length,a=e[o++],l={},u={};let c=-1,f,d,h;for(;++c<s;)f=a(d=i[c])+"",(h=l[f])?h.push(d):l[f]=[d];for(f in l)u[f]=n(l[f],o);return u}function r(i,o){if(++o>e.length)return i;const s=[];for(const a in i)s.push({key:a,values:r(i[a],o)});return s}return t}function vs(e){P.call(this,null,e)}const Tae=(e,t)=>e.parent===t.parent?1:2;X(vs,P,{transform(e,t){(!t.source||!t.source.root)&&I(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(e.method),r=this.fields,i=t.source.root,o=e.as||r;e.field?i.sum(e.field):i.count(),e.sort&&i.sort(fu(e.sort,s=>s.data)),Nae(n,this.params,e),n.separation&&n.separation(e.separation!==!1?Tae:vf);try{this.value=n(i)}catch(s){I(s)}return i.each(s=>Rae(s,r,o)),t.reflow(e.modified()).modifies(o).modifies("leaf")}});function Nae(e,t,n){for(let r,i=0,o=t.length;i<o;++i)r=t[i],r in n&&e[r](n[r])}function Rae(e,t,n){const r=e.data,i=t.length-1;for(let o=0;o<i;++o)r[n[o]]=e[t[o]];r[n[i]]=e.children?e.children.length:0}const qE=["x","y","r","depth","children"];function L3(e){vs.call(this,e)}L3.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:qE.length,default:qE}]};X(L3,vs,{layout:hae,params:["radius","size","padding"],fields:qE});const HE=["x0","y0","x1","y1","depth","children"];function z3(e){vs.call(this,e)}z3.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:HE.length,default:HE}]};X(z3,vs,{layout:pae,params:["size","round","padding"],fields:HE});function I3(e){P.call(this,null,e)}I3.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]};X(I3,P,{transform(e,t){t.source||I("Stratify transform requires an upstream data source.");let n=this.value;const r=e.modified(),i=t.fork(t.ALL).materialize(t.SOURCE),o=!n||r||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return i.source=i.source.slice(),o&&(n=i.source.length?WE(eM().id(e.key).parentId(e.parentKey)(i.source),e.key,Gr):WE(eM()([{}]),e.key,e.key)),i.source.root=this.value=n,i}});const nM={tidy:_ae,cluster:Pse},VE=["x","y","depth","children"];function j3(e){vs.call(this,e)}j3.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:VE.length,default:VE}]};X(j3,vs,{layout(e){const t=e||"tidy";if(te(nM,t))return nM[t]();I("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:VE});function B3(e){P.call(this,[],e)}B3.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]};X(B3,P,{transform(e,t){const n=this.value,r=t.source&&t.source.root,i=t.fork(t.NO_SOURCE),o={};return r||I("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(i.rem=n,t.visit(t.SOURCE,s=>o[le(s)]=1),r.each(s=>{const a=s.data,l=s.parent&&s.parent.data;l&&o[le(a)]&&o[le(l)]&&i.add.push(De({source:l,target:a}))}),this.value=i.add):t.changed(t.MOD)&&(t.visit(t.MOD,s=>o[le(s)]=1),n.forEach(s=>{(o[le(s.source)]||o[le(s.target)])&&i.mod.push(s)})),i}});const rM={binary:Cae,dice:Wp,slice:Ev,slicedice:$ae,squarify:Xz,resquarify:Aae},GE=["x0","y0","x1","y1","depth","children"];function U3(e){vs.call(this,e)}U3.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:GE.length,default:GE}]};X(U3,vs,{layout(){const e=kae();return e.ratio=t=>{const n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=t=>{te(rM,t)?e.tile(rM[t]):I("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:GE});const Dae=Object.freeze(Object.defineProperty({__proto__:null,nest:P3,pack:L3,partition:z3,stratify:I3,tree:j3,treelinks:B3,treemap:U3},Symbol.toStringTag,{value:"Module"})),U2=4278190080;function Oae(e,t){const n=e.bitmap();return(t||[]).forEach(r=>n.set(e(r.boundary[0]),e(r.boundary[3]))),[n,void 0]}function Pae(e,t,n,r,i){const o=e.width,s=e.height,a=r||i,l=ca(o,s).getContext("2d"),u=ca(o,s).getContext("2d"),c=a&&ca(o,s).getContext("2d");n.forEach(_=>G0(l,_,!1)),G0(u,t,!1),a&&G0(c,t,!0);const f=W2(l,o,s),d=W2(u,o,s),h=a&&W2(c,o,s),p=e.bitmap(),g=a&&e.bitmap();let y,m,v,x,w,b,S,E;for(m=0;m<s;++m)for(y=0;y<o;++y)w=m*o+y,b=f[w]&U2,E=d[w]&U2,S=a&&h[w]&U2,(b||S||E)&&(v=e(y),x=e(m),!i&&(b||E)&&p.set(v,x),a&&(b||S)&&g.set(v,x));return[p,g]}function W2(e,t,n){return new Uint32Array(e.getImageData(0,0,t,n).data.buffer)}function G0(e,t,n){if(!t.length)return;const r=t[0].mark.marktype;r==="group"?t.forEach(i=>{i.items.forEach(o=>G0(e,o.items,n))}):kr[r].draw(e,{items:n?t.map(Lae):t})}function Lae(e){const t=Ly(e,{});return t.stroke&&t.strokeOpacity!==0||t.fill&&t.fillOpacity!==0?{...t,strokeOpacity:1,stroke:"#000",fillOpacity:0}:t}const Oo=5,En=31,ep=32,Ls=new Uint32Array(ep+1),hi=new Uint32Array(ep+1);hi[0]=0;Ls[0]=~hi[0];for(let e=1;e<=ep;++e)hi[e]=hi[e-1]<<1|1,Ls[e]=~hi[e];function zae(e,t){const n=new Uint32Array(~~((e*t+ep)/ep));function r(o,s){n[o]|=s}function i(o,s){n[o]&=s}return{array:n,get:(o,s)=>{const a=s*e+o;return n[a>>>Oo]&1<<(a&En)},set:(o,s)=>{const a=s*e+o;r(a>>>Oo,1<<(a&En))},clear:(o,s)=>{const a=s*e+o;i(a>>>Oo,~(1<<(a&En)))},getRange:(o,s,a,l)=>{let u=l,c,f,d,h;for(;u>=s;--u)if(c=u*e+o,f=u*e+a,d=c>>>Oo,h=f>>>Oo,d===h){if(n[d]&Ls[c&En]&hi[(f&En)+1])return!0}else{if(n[d]&Ls[c&En]||n[h]&hi[(f&En)+1])return!0;for(let p=d+1;p<h;++p)if(n[p])return!0}return!1},setRange:(o,s,a,l)=>{let u,c,f,d,h;for(;s<=l;++s)if(u=s*e+o,c=s*e+a,f=u>>>Oo,d=c>>>Oo,f===d)r(f,Ls[u&En]&hi[(c&En)+1]);else for(r(f,Ls[u&En]),r(d,hi[(c&En)+1]),h=f+1;h<d;++h)r(h,4294967295)},clearRange:(o,s,a,l)=>{let u,c,f,d,h;for(;s<=l;++s)if(u=s*e+o,c=s*e+a,f=u>>>Oo,d=c>>>Oo,f===d)i(f,hi[u&En]|Ls[(c&En)+1]);else for(i(f,hi[u&En]),i(d,Ls[(c&En)+1]),h=f+1;h<d;++h)i(h,0)},outOfBounds:(o,s,a,l)=>o<0||s<0||l>=t||a>=e}}function Iae(e,t,n){const r=Math.max(1,Math.sqrt(e*t/1e6)),i=~~((e+2*n+r)/r),o=~~((t+2*n+r)/r),s=a=>~~((a+n)/r);return s.invert=a=>a*r-n,s.bitmap=()=>zae(i,o),s.ratio=r,s.padding=n,s.width=e,s.height=t,s}function jae(e,t,n,r){const i=e.width,o=e.height;return function(s){const a=s.datum.datum.items[r].items,l=a.length,u=s.datum.fontSize,c=xr.width(s.datum,s.datum.text);let f=0,d,h,p,g,y,m,v;for(let x=0;x<l;++x)d=a[x].x,p=a[x].y,h=a[x].x2===void 0?d:a[x].x2,g=a[x].y2===void 0?p:a[x].y2,y=(d+h)/2,m=(p+g)/2,v=Math.abs(h-d+g-p),v>=f&&(f=v,s.x=y,s.y=m);return y=c/2,m=u/2,d=s.x-y,h=s.x+y,p=s.y-m,g=s.y+m,s.align="center",d<0&&h<=i?s.align="left":0<=d&&i<h&&(s.align="right"),s.baseline="middle",p<0&&g<=o?s.baseline="top":0<=p&&o<g&&(s.baseline="bottom"),!0}}function P1(e,t,n,r,i,o){let s=n/2;return e-s<0||e+s>i||t-(s=r/2)<0||t+s>o}function Ks(e,t,n,r,i,o,s,a){const l=i*o/(r*2),u=e(t-l),c=e(t+l),f=e(n-(o=o/2)),d=e(n+o);return s.outOfBounds(u,f,c,d)||s.getRange(u,f,c,d)||a&&a.getRange(u,f,c,d)}function Bae(e,t,n,r){const i=e.width,o=e.height,s=t[0],a=t[1];function l(u,c,f,d,h){const p=e.invert(u),g=e.invert(c);let y=f,m=o,v;if(!P1(p,g,d,h,i,o)&&!Ks(e,p,g,h,d,y,s,a)&&!Ks(e,p,g,h,d,h,s,null)){for(;m-y>=1;)v=(y+m)/2,Ks(e,p,g,h,d,v,s,a)?m=v:y=v;if(y>f)return[p,g,y,!0]}}return function(u){const c=u.datum.datum.items[r].items,f=c.length,d=u.datum.fontSize,h=xr.width(u.datum,u.datum.text);let p=n?d:0,g=!1,y=!1,m=0,v,x,w,b,S,E,_,k,C,$,O,A,T,F,R,L,N;for(let D=0;D<f;++D){for(v=c[D].x,w=c[D].y,x=c[D].x2===void 0?v:c[D].x2,b=c[D].y2===void 0?w:c[D].y2,v>x&&(N=v,v=x,x=N),w>b&&(N=w,w=b,b=N),C=e(v),O=e(x),$=~~((C+O)/2),A=e(w),F=e(b),T=~~((A+F)/2),_=$;_>=C;--_)for(k=T;k>=A;--k)L=l(_,k,p,h,d),L&&([u.x,u.y,p,g]=L);for(_=$;_<=O;++_)for(k=T;k<=F;++k)L=l(_,k,p,h,d),L&&([u.x,u.y,p,g]=L);!g&&!n&&(R=Math.abs(x-v+b-w),S=(v+x)/2,E=(w+b)/2,R>=m&&!P1(S,E,h,d,i,o)&&!Ks(e,S,E,d,h,d,s,null)&&(m=R,u.x=S,u.y=E,y=!0))}return g||y?(S=h/2,E=d/2,s.setRange(e(u.x-S),e(u.y-E),e(u.x+S),e(u.y+E)),u.align="center",u.baseline="middle",!0):!1}}const Uae=[-1,-1,1,1],Wae=[-1,1,-1,1];function qae(e,t,n,r){const i=e.width,o=e.height,s=t[0],a=t[1],l=e.bitmap();return function(u){const c=u.datum.datum.items[r].items,f=c.length,d=u.datum.fontSize,h=xr.width(u.datum,u.datum.text),p=[];let g=n?d:0,y=!1,m=!1,v=0,x,w,b,S,E,_,k,C,$,O,A,T;for(let F=0;F<f;++F){for(x=c[F].x,b=c[F].y,w=c[F].x2===void 0?x:c[F].x2,S=c[F].y2===void 0?b:c[F].y2,p.push([e((x+w)/2),e((b+S)/2)]);p.length;)if([k,C]=p.pop(),!(s.get(k,C)||a.get(k,C)||l.get(k,C))){l.set(k,C);for(let R=0;R<4;++R)E=k+Uae[R],_=C+Wae[R],l.outOfBounds(E,_,E,_)||p.push([E,_]);if(E=e.invert(k),_=e.invert(C),$=g,O=o,!P1(E,_,h,d,i,o)&&!Ks(e,E,_,d,h,$,s,a)&&!Ks(e,E,_,d,h,d,s,null)){for(;O-$>=1;)A=($+O)/2,Ks(e,E,_,d,h,A,s,a)?O=A:$=A;$>g&&(u.x=E,u.y=_,g=$,y=!0)}}!y&&!n&&(T=Math.abs(w-x+S-b),E=(x+w)/2,_=(b+S)/2,T>=v&&!P1(E,_,h,d,i,o)&&!Ks(e,E,_,d,h,d,s,null)&&(v=T,u.x=E,u.y=_,m=!0))}return y||m?(E=h/2,_=d/2,s.setRange(e(u.x-E),e(u.y-_),e(u.x+E),e(u.y+_)),u.align="center",u.baseline="middle",!0):!1}}const Hae=["right","center","left"],Vae=["bottom","middle","top"];function Gae(e,t,n,r){const i=e.width,o=e.height,s=t[0],a=t[1],l=r.length;return function(u){const c=u.boundary,f=u.datum.fontSize;if(c[2]<0||c[5]<0||c[0]>i||c[3]>o)return!1;let d=u.textWidth??0,h,p,g,y,m,v,x,w,b,S,E,_,k,C,$;for(let O=0;O<l;++O){if(h=(n[O]&3)-1,p=(n[O]>>>2&3)-1,g=h===0&&p===0||r[O]<0,y=h&&p?Math.SQRT1_2:1,m=r[O]<0?-1:1,v=c[1+h]+r[O]*h*y,E=c[4+p]+m*f*p/2+r[O]*p*y,w=E-f/2,b=E+f/2,_=e(v),C=e(w),$=e(b),!d)if(iM(_,_,C,$,s,a,v,v,w,b,c,g))d=xr.width(u.datum,u.datum.text);else continue;if(S=v+m*d*h/2,v=S-d/2,x=S+d/2,_=e(v),k=e(x),iM(_,k,C,$,s,a,v,x,w,b,c,g))return u.x=h?h*m<0?x:v:S,u.y=p?p*m<0?b:w:E,u.align=Hae[h*m+1],u.baseline=Vae[p*m+1],s.setRange(_,C,k,$),!0}return!1}}function iM(e,t,n,r,i,o,s,a,l,u,c,f){return!(i.outOfBounds(e,n,t,r)||(f&&o||i).getRange(e,n,t,r))}const q2=0,H2=4,V2=8,G2=0,Y2=1,X2=2,Yae={"top-left":q2+G2,top:q2+Y2,"top-right":q2+X2,left:H2+G2,middle:H2+Y2,right:H2+X2,"bottom-left":V2+G2,bottom:V2+Y2,"bottom-right":V2+X2},Xae={naive:jae,"reduced-search":Bae,floodfill:qae};function Qae(e,t,n,r,i,o,s,a,l,u,c){if(!e.length)return e;const f=Math.max(r.length,i.length),d=Kae(r,f),h=Zae(i,f),p=Jae(e[0].datum),g=p==="group"&&e[0].datum.items[l].marktype,y=g==="area",m=ele(p,g,a,l),v=u===null||u===1/0,x=y&&c==="naive";let w=-1,b=-1;const S=e.map(C=>{const $=v?xr.width(C,C.text):void 0;return w=Math.max(w,$),b=Math.max(b,C.fontSize),{datum:C,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:m(C),textWidth:$}});u=u===null||u===1/0?Math.max(w,b)+Math.max(...r):u;const E=Iae(t[0],t[1],u);let _;if(!x){n&&S.sort((O,A)=>n(O.datum,A.datum));let C=!1;for(let O=0;O<h.length&&!C;++O)C=h[O]===5||d[O]<0;const $=(p&&s||y)&&e.map(O=>O.datum);_=o.length||$?Pae(E,$||[],o,C,y):Oae(E,s&&S)}const k=y?Xae[c](E,_,s,l):Gae(E,_,h,d);return S.forEach(C=>C.opacity=+k(C)),S}function Kae(e,t){const n=new Float64Array(t),r=e.length;for(let i=0;i<r;++i)n[i]=e[i]||0;for(let i=r;i<t;++i)n[i]=n[r-1];return n}function Zae(e,t){const n=new Int8Array(t),r=e.length;for(let i=0;i<r;++i)n[i]|=Yae[e[i]];for(let i=r;i<t;++i)n[i]=n[r-1];return n}function Jae(e){return e&&e.mark&&e.mark.marktype}function ele(e,t,n,r){const i=o=>[o.x,o.x,o.x,o.y,o.y,o.y];return e?e==="line"||e==="area"?o=>i(o.datum):t==="line"?o=>{const s=o.datum.items[r].items;return i(s.length?s[n==="start"?0:s.length-1]:{x:NaN,y:NaN})}:o=>{const s=o.datum.bounds;return[s.x1,(s.x1+s.x2)/2,s.x2,s.y1,(s.y1+s.y2)/2,s.y2]}:i}const YE=["x","y","opacity","align","baseline"],Qz=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function W3(e){P.call(this,null,e)}W3.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:Qz},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0,null:!0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:YE.length,default:YE}]};X(W3,P,{transform(e,t){function n(o){const s=e[o];return me(s)&&t.modified(s.fields)}const r=e.modified();if(!(r||t.changed(t.ADD_REM)||n("sort")))return;(!e.size||e.size.length!==2)&&I("Size parameter should be specified as a [width, height] array.");const i=e.as||YE;return Qae(t.materialize(t.SOURCE).source||[],e.size,e.sort,J(e.offset==null?1:e.offset),J(e.anchor||Qz),e.avoidMarks||[],e.avoidBaseMark!==!1,e.lineAnchor||"end",e.markIndex||0,e.padding===void 0?0:e.padding,e.method||"naive").forEach(o=>{const s=o.datum;s[i[0]]=o.x,s[i[1]]=o.y,s[i[2]]=o.opacity,s[i[3]]=o.align,s[i[4]]=o.baseline}),t.reflow(r).modifies(i)}});const tle=Object.freeze(Object.defineProperty({__proto__:null,label:W3},Symbol.toStringTag,{value:"Module"}));function Kz(e,t){var n=[],r=function(c){return c(a)},i,o,s,a,l,u;if(t==null)n.push(e);else for(i={},o=0,s=e.length;o<s;++o)a=e[o],l=t.map(r),u=i[l],u||(i[l]=u=[],u.dims=l,n.push(u)),u.push(a);return n}function q3(e){P.call(this,null,e)}q3.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]};X(q3,P,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=Kz(r,e.groupby),o=(e.groupby||[]).map(ft),s=o.length,a=e.as||[ft(e.x),ft(e.y)],l=[];i.forEach(u=>{i9(u,e.x,e.y,e.bandwidth||.3).forEach(c=>{const f={};for(let d=0;d<s;++d)f[o[d]]=u.dims[d];f[a[0]]=c[0],f[a[1]]=c[1],l.push(De(f))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});const XE={constant:kk,linear:Ck,log:e9,exp:t9,pow:n9,quad:$k,poly:r9},nle=(e,t)=>e==="poly"?t:e==="quad"?2:1;function H3(e){P.call(this,null,e)}H3.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(XE)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]};X(H3,P,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=Kz(r,e.groupby),o=(e.groupby||[]).map(ft),s=e.method||"linear",a=e.order==null?3:e.order,l=nle(s,a),u=e.as||[ft(e.x),ft(e.y)],c=XE[s],f=[];let d=e.extent;te(XE,s)||I("Invalid regression method: "+s),d!=null&&s==="log"&&d[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),d=null),i.forEach(h=>{if(h.length<=l){t.dataflow.warn("Skipping regression with more parameters than data points.");return}const g=c(h,e.x,e.y,a);if(e.params){f.push(De({keys:h.dims,coef:g.coef,rSquared:g.rSquared}));return}const y=d||co(h,e.x),m=v=>{const x={};for(let w=0;w<o.length;++w)x[o[w]]=h.dims[w];x[u[0]]=v[0],x[u[1]]=v[1],f.push(De(x))};s==="linear"||s==="constant"?y.forEach(v=>m([v,g.predict(v)])):qy(g.predict,y,25,200).forEach(m)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=f}return n}});const rle=Object.freeze(Object.defineProperty({__proto__:null,loess:q3,regression:H3},Symbol.toStringTag,{value:"Module"})),ts=11102230246251565e-32,an=134217729,ile=(3+8*ts)*ts;function Q2(e,t,n,r,i){let o,s,a,l,u=t[0],c=r[0],f=0,d=0;c>u==c>-u?(o=u,u=t[++f]):(o=c,c=r[++d]);let h=0;if(f<e&&d<n)for(c>u==c>-u?(s=u+o,a=o-(s-u),u=t[++f]):(s=c+o,a=o-(s-c),c=r[++d]),o=s,a!==0&&(i[h++]=a);f<e&&d<n;)c>u==c>-u?(s=o+u,l=s-o,a=o-(s-l)+(u-l),u=t[++f]):(s=o+c,l=s-o,a=o-(s-l)+(c-l),c=r[++d]),o=s,a!==0&&(i[h++]=a);for(;f<e;)s=o+u,l=s-o,a=o-(s-l)+(u-l),u=t[++f],o=s,a!==0&&(i[h++]=a);for(;d<n;)s=o+c,l=s-o,a=o-(s-l)+(c-l),c=r[++d],o=s,a!==0&&(i[h++]=a);return(o!==0||h===0)&&(i[h++]=o),h}function ole(e,t){let n=t[0];for(let r=1;r<e;r++)n+=t[r];return n}function qp(e){return new Float64Array(e)}const sle=(3+16*ts)*ts,ale=(2+12*ts)*ts,lle=(9+64*ts)*ts*ts,Du=qp(4),oM=qp(8),sM=qp(12),aM=qp(16),Sn=qp(4);function ule(e,t,n,r,i,o,s){let a,l,u,c,f,d,h,p,g,y,m,v,x,w,b,S,E,_;const k=e-i,C=n-i,$=t-o,O=r-o;w=k*O,d=an*k,h=d-(d-k),p=k-h,d=an*O,g=d-(d-O),y=O-g,b=p*y-(w-h*g-p*g-h*y),S=$*C,d=an*$,h=d-(d-$),p=$-h,d=an*C,g=d-(d-C),y=C-g,E=p*y-(S-h*g-p*g-h*y),m=b-E,f=b-m,Du[0]=b-(m+f)+(f-E),v=w+m,f=v-w,x=w-(v-f)+(m-f),m=x-S,f=x-m,Du[1]=x-(m+f)+(f-S),_=v+m,f=_-v,Du[2]=v-(_-f)+(m-f),Du[3]=_;let A=ole(4,Du),T=ale*s;if(A>=T||-A>=T||(f=e-k,a=e-(k+f)+(f-i),f=n-C,u=n-(C+f)+(f-i),f=t-$,l=t-($+f)+(f-o),f=r-O,c=r-(O+f)+(f-o),a===0&&l===0&&u===0&&c===0)||(T=lle*s+ile*Math.abs(A),A+=k*c+O*a-($*u+C*l),A>=T||-A>=T))return A;w=a*O,d=an*a,h=d-(d-a),p=a-h,d=an*O,g=d-(d-O),y=O-g,b=p*y-(w-h*g-p*g-h*y),S=l*C,d=an*l,h=d-(d-l),p=l-h,d=an*C,g=d-(d-C),y=C-g,E=p*y-(S-h*g-p*g-h*y),m=b-E,f=b-m,Sn[0]=b-(m+f)+(f-E),v=w+m,f=v-w,x=w-(v-f)+(m-f),m=x-S,f=x-m,Sn[1]=x-(m+f)+(f-S),_=v+m,f=_-v,Sn[2]=v-(_-f)+(m-f),Sn[3]=_;const F=Q2(4,Du,4,Sn,oM);w=k*c,d=an*k,h=d-(d-k),p=k-h,d=an*c,g=d-(d-c),y=c-g,b=p*y-(w-h*g-p*g-h*y),S=$*u,d=an*$,h=d-(d-$),p=$-h,d=an*u,g=d-(d-u),y=u-g,E=p*y-(S-h*g-p*g-h*y),m=b-E,f=b-m,Sn[0]=b-(m+f)+(f-E),v=w+m,f=v-w,x=w-(v-f)+(m-f),m=x-S,f=x-m,Sn[1]=x-(m+f)+(f-S),_=v+m,f=_-v,Sn[2]=v-(_-f)+(m-f),Sn[3]=_;const R=Q2(F,oM,4,Sn,sM);w=a*c,d=an*a,h=d-(d-a),p=a-h,d=an*c,g=d-(d-c),y=c-g,b=p*y-(w-h*g-p*g-h*y),S=l*u,d=an*l,h=d-(d-l),p=l-h,d=an*u,g=d-(d-u),y=u-g,E=p*y-(S-h*g-p*g-h*y),m=b-E,f=b-m,Sn[0]=b-(m+f)+(f-E),v=w+m,f=v-w,x=w-(v-f)+(m-f),m=x-S,f=x-m,Sn[1]=x-(m+f)+(f-S),_=v+m,f=_-v,Sn[2]=v-(_-f)+(m-f),Sn[3]=_;const L=Q2(R,sM,4,Sn,aM);return aM[L-1]}function Zg(e,t,n,r,i,o){const s=(t-o)*(n-i),a=(e-i)*(r-o),l=s-a,u=Math.abs(s+a);return Math.abs(l)>=sle*u?l:-ule(e,t,n,r,i,o,u)}const lM=Math.pow(2,-52),Jg=new Uint32Array(512);class L1{static from(t,n=ple,r=gle){const i=t.length,o=new Float64Array(i*2);for(let s=0;s<i;s++){const a=t[s];o[2*s]=n(a),o[2*s+1]=r(a)}return new L1(o)}constructor(t){const n=t.length>>1;if(n>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const r=Math.max(2*n-5,0);this._triangles=new Uint32Array(r*3),this._halfedges=new Int32Array(r*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:t,_hullPrev:n,_hullNext:r,_hullTri:i,_hullHash:o}=this,s=t.length>>1;let a=1/0,l=1/0,u=-1/0,c=-1/0;for(let k=0;k<s;k++){const C=t[2*k],$=t[2*k+1];C<a&&(a=C),$<l&&(l=$),C>u&&(u=C),$>c&&(c=$),this._ids[k]=k}const f=(a+u)/2,d=(l+c)/2;let h,p,g;for(let k=0,C=1/0;k<s;k++){const $=K2(f,d,t[2*k],t[2*k+1]);$<C&&(h=k,C=$)}const y=t[2*h],m=t[2*h+1];for(let k=0,C=1/0;k<s;k++){if(k===h)continue;const $=K2(y,m,t[2*k],t[2*k+1]);$<C&&$>0&&(p=k,C=$)}let v=t[2*p],x=t[2*p+1],w=1/0;for(let k=0;k<s;k++){if(k===h||k===p)continue;const C=dle(y,m,v,x,t[2*k],t[2*k+1]);C<w&&(g=k,w=C)}let b=t[2*g],S=t[2*g+1];if(w===1/0){for(let $=0;$<s;$++)this._dists[$]=t[2*$]-t[0]||t[2*$+1]-t[1];sc(this._ids,this._dists,0,s-1);const k=new Uint32Array(s);let C=0;for(let $=0,O=-1/0;$<s;$++){const A=this._ids[$],T=this._dists[A];T>O&&(k[C++]=A,O=T)}this.hull=k.subarray(0,C),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(Zg(y,m,v,x,b,S)<0){const k=p,C=v,$=x;p=g,v=b,x=S,g=k,b=C,S=$}const E=hle(y,m,v,x,b,S);this._cx=E.x,this._cy=E.y;for(let k=0;k<s;k++)this._dists[k]=K2(t[2*k],t[2*k+1],E.x,E.y);sc(this._ids,this._dists,0,s-1),this._hullStart=h;let _=3;r[h]=n[g]=p,r[p]=n[h]=g,r[g]=n[p]=h,i[h]=0,i[p]=1,i[g]=2,o.fill(-1),o[this._hashKey(y,m)]=h,o[this._hashKey(v,x)]=p,o[this._hashKey(b,S)]=g,this.trianglesLen=0,this._addTriangle(h,p,g,-1,-1,-1);for(let k=0,C,$;k<this._ids.length;k++){const O=this._ids[k],A=t[2*O],T=t[2*O+1];if(k>0&&Math.abs(A-C)<=lM&&Math.abs(T-$)<=lM||(C=A,$=T,O===h||O===p||O===g))continue;let F=0;for(let U=0,K=this._hashKey(A,T);U<this._hashSize&&(F=o[(K+U)%this._hashSize],!(F!==-1&&F!==r[F]));U++);F=n[F];let R=F,L;for(;L=r[R],Zg(A,T,t[2*R],t[2*R+1],t[2*L],t[2*L+1])>=0;)if(R=L,R===F){R=-1;break}if(R===-1)continue;let N=this._addTriangle(R,O,r[R],-1,-1,i[R]);i[O]=this._legalize(N+2),i[R]=N,_++;let D=r[R];for(;L=r[D],Zg(A,T,t[2*D],t[2*D+1],t[2*L],t[2*L+1])<0;)N=this._addTriangle(D,O,L,i[O],-1,i[D]),i[O]=this._legalize(N+2),r[D]=D,_--,D=L;if(R===F)for(;L=n[R],Zg(A,T,t[2*L],t[2*L+1],t[2*R],t[2*R+1])<0;)N=this._addTriangle(L,O,R,-1,i[R],i[L]),this._legalize(N+2),i[L]=N,r[R]=R,_--,R=L;this._hullStart=n[O]=R,r[R]=n[D]=O,r[O]=D,o[this._hashKey(A,T)]=O,o[this._hashKey(t[2*R],t[2*R+1])]=R}this.hull=new Uint32Array(_);for(let k=0,C=this._hullStart;k<_;k++)this.hull[k]=C,C=r[C];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,n){return Math.floor(cle(t-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:n,_halfedges:r,coords:i}=this;let o=0,s=0;for(;;){const a=r[t],l=t-t%3;if(s=l+(t+2)%3,a===-1){if(o===0)break;t=Jg[--o];continue}const u=a-a%3,c=l+(t+1)%3,f=u+(a+2)%3,d=n[s],h=n[t],p=n[c],g=n[f];if(fle(i[2*d],i[2*d+1],i[2*h],i[2*h+1],i[2*p],i[2*p+1],i[2*g],i[2*g+1])){n[t]=g,n[a]=d;const m=r[f];if(m===-1){let x=this._hullStart;do{if(this._hullTri[x]===f){this._hullTri[x]=t;break}x=this._hullPrev[x]}while(x!==this._hullStart)}this._link(t,m),this._link(a,r[s]),this._link(s,f);const v=u+(a+1)%3;o<Jg.length&&(Jg[o++]=v)}else{if(o===0)break;t=Jg[--o]}}return s}_link(t,n){this._halfedges[t]=n,n!==-1&&(this._halfedges[n]=t)}_addTriangle(t,n,r,i,o,s){const a=this.trianglesLen;return this._triangles[a]=t,this._triangles[a+1]=n,this._triangles[a+2]=r,this._link(a,i),this._link(a+1,o),this._link(a+2,s),this.trianglesLen+=3,a}}function cle(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}function K2(e,t,n,r){const i=e-n,o=t-r;return i*i+o*o}function fle(e,t,n,r,i,o,s,a){const l=e-s,u=t-a,c=n-s,f=r-a,d=i-s,h=o-a,p=l*l+u*u,g=c*c+f*f,y=d*d+h*h;return l*(f*y-g*h)-u*(c*y-g*d)+p*(c*h-f*d)<0}function dle(e,t,n,r,i,o){const s=n-e,a=r-t,l=i-e,u=o-t,c=s*s+a*a,f=l*l+u*u,d=.5/(s*u-a*l),h=(u*c-a*f)*d,p=(s*f-l*c)*d;return h*h+p*p}function hle(e,t,n,r,i,o){const s=n-e,a=r-t,l=i-e,u=o-t,c=s*s+a*a,f=l*l+u*u,d=.5/(s*u-a*l),h=e+(u*c-a*f)*d,p=t+(s*f-l*c)*d;return{x:h,y:p}}function sc(e,t,n,r){if(r-n<=20)for(let i=n+1;i<=r;i++){const o=e[i],s=t[o];let a=i-1;for(;a>=n&&t[e[a]]>s;)e[a+1]=e[a--];e[a+1]=o}else{const i=n+r>>1;let o=n+1,s=r;fd(e,i,o),t[e[n]]>t[e[r]]&&fd(e,n,r),t[e[o]]>t[e[r]]&&fd(e,o,r),t[e[n]]>t[e[o]]&&fd(e,n,o);const a=e[o],l=t[a];for(;;){do o++;while(t[e[o]]<l);do s--;while(t[e[s]]>l);if(s<o)break;fd(e,o,s)}e[n+1]=e[s],e[s]=a,r-o+1>=s-n?(sc(e,t,o,r),sc(e,t,n,s-1)):(sc(e,t,n,s-1),sc(e,t,o,r))}}function fd(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function ple(e){return e[0]}function gle(e){return e[1]}const uM=1e-6;class bl{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,n){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,n){this._+=`L${this._x1=+t},${this._y1=+n}`}arc(t,n,r){t=+t,n=+n,r=+r;const i=t+r,o=n;if(r<0)throw new Error("negative radius");this._x1===null?this._+=`M${i},${o}`:(Math.abs(this._x1-i)>uM||Math.abs(this._y1-o)>uM)&&(this._+="L"+i+","+o),r&&(this._+=`A${r},${r},0,1,1,${t-r},${n}A${r},${r},0,1,1,${this._x1=i},${this._y1=o}`)}rect(t,n,r,i){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${+r}v${+i}h${-r}Z`}value(){return this._||null}}class QE{constructor(){this._=[]}moveTo(t,n){this._.push([t,n])}closePath(){this._.push(this._[0].slice())}lineTo(t,n){this._.push([t,n])}value(){return this._.length?this._:null}}let mle=class{constructor(t,[n,r,i,o]=[0,0,960,500]){if(!((i=+i)>=(n=+n))||!((o=+o)>=(r=+r)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(t.points.length*2),this.vectors=new Float64Array(t.points.length*2),this.xmax=i,this.xmin=n,this.ymax=o,this.ymin=r,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:n,triangles:r},vectors:i}=this;let o,s;const a=this.circumcenters=this._circumcenters.subarray(0,r.length/3*2);for(let g=0,y=0,m=r.length,v,x;g<m;g+=3,y+=2){const w=r[g]*2,b=r[g+1]*2,S=r[g+2]*2,E=t[w],_=t[w+1],k=t[b],C=t[b+1],$=t[S],O=t[S+1],A=k-E,T=C-_,F=$-E,R=O-_,L=(A*R-T*F)*2;if(Math.abs(L)<1e-9){if(o===void 0){o=s=0;for(const D of n)o+=t[D*2],s+=t[D*2+1];o/=n.length,s/=n.length}const N=1e9*Math.sign((o-E)*R-(s-_)*F);v=(E+$)/2-N*R,x=(_+O)/2+N*F}else{const N=1/L,D=A*A+T*T,U=F*F+R*R;v=E+(R*D-T*U)*N,x=_+(A*U-F*D)*N}a[y]=v,a[y+1]=x}let l=n[n.length-1],u,c=l*4,f,d=t[2*l],h,p=t[2*l+1];i.fill(0);for(let g=0;g<n.length;++g)l=n[g],u=c,f=d,h=p,c=l*4,d=t[2*l],p=t[2*l+1],i[u+2]=i[c]=h-p,i[u+3]=i[c+1]=d-f}render(t){const n=t==null?t=new bl:void 0,{delaunay:{halfedges:r,inedges:i,hull:o},circumcenters:s,vectors:a}=this;if(o.length<=1)return null;for(let c=0,f=r.length;c<f;++c){const d=r[c];if(d<c)continue;const h=Math.floor(c/3)*2,p=Math.floor(d/3)*2,g=s[h],y=s[h+1],m=s[p],v=s[p+1];this._renderSegment(g,y,m,v,t)}let l,u=o[o.length-1];for(let c=0;c<o.length;++c){l=u,u=o[c];const f=Math.floor(i[u]/3)*2,d=s[f],h=s[f+1],p=l*4,g=this._project(d,h,a[p+2],a[p+3]);g&&this._renderSegment(d,h,g[0],g[1],t)}return n&&n.value()}renderBounds(t){const n=t==null?t=new bl:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(t,n){const r=n==null?n=new bl:void 0,i=this._clip(t);if(i===null||!i.length)return;n.moveTo(i[0],i[1]);let o=i.length;for(;i[0]===i[o-2]&&i[1]===i[o-1]&&o>1;)o-=2;for(let s=2;s<o;s+=2)(i[s]!==i[s-2]||i[s+1]!==i[s-1])&&n.lineTo(i[s],i[s+1]);return n.closePath(),r&&r.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let n=0,r=t.length/2;n<r;++n){const i=this.cellPolygon(n);i&&(i.index=n,yield i)}}cellPolygon(t){const n=new QE;return this.renderCell(t,n),n.value()}_renderSegment(t,n,r,i,o){let s;const a=this._regioncode(t,n),l=this._regioncode(r,i);a===0&&l===0?(o.moveTo(t,n),o.lineTo(r,i)):(s=this._clipSegment(t,n,r,i,a,l))&&(o.moveTo(s[0],s[1]),o.lineTo(s[2],s[3]))}contains(t,n,r){return n=+n,n!==n||(r=+r,r!==r)?!1:this.delaunay._step(t,n,r)===t}*neighbors(t){const n=this._clip(t);if(n)for(const r of this.delaunay.neighbors(t)){const i=this._clip(r);if(i){e:for(let o=0,s=n.length;o<s;o+=2)for(let a=0,l=i.length;a<l;a+=2)if(n[o]===i[a]&&n[o+1]===i[a+1]&&n[(o+2)%s]===i[(a+l-2)%l]&&n[(o+3)%s]===i[(a+l-1)%l]){yield r;break e}}}}_cell(t){const{circumcenters:n,delaunay:{inedges:r,halfedges:i,triangles:o}}=this,s=r[t];if(s===-1)return null;const a=[];let l=s;do{const u=Math.floor(l/3);if(a.push(n[u*2],n[u*2+1]),l=l%3===2?l-2:l+1,o[l]!==t)break;l=i[l]}while(l!==s&&l!==-1);return a}_clip(t){if(t===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(t);if(n===null)return null;const{vectors:r}=this,i=t*4;return this._simplify(r[i]||r[i+1]?this._clipInfinite(t,n,r[i],r[i+1],r[i+2],r[i+3]):this._clipFinite(t,n))}_clipFinite(t,n){const r=n.length;let i=null,o,s,a=n[r-2],l=n[r-1],u,c=this._regioncode(a,l),f,d=0;for(let h=0;h<r;h+=2)if(o=a,s=l,a=n[h],l=n[h+1],u=c,c=this._regioncode(a,l),u===0&&c===0)f=d,d=0,i?i.push(a,l):i=[a,l];else{let p,g,y,m,v;if(u===0){if((p=this._clipSegment(o,s,a,l,u,c))===null)continue;[g,y,m,v]=p}else{if((p=this._clipSegment(a,l,o,s,c,u))===null)continue;[m,v,g,y]=p,f=d,d=this._edgecode(g,y),f&&d&&this._edge(t,f,d,i,i.length),i?i.push(g,y):i=[g,y]}f=d,d=this._edgecode(m,v),f&&d&&this._edge(t,f,d,i,i.length),i?i.push(m,v):i=[m,v]}if(i)f=d,d=this._edgecode(i[0],i[1]),f&&d&&this._edge(t,f,d,i,i.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return i}_clipSegment(t,n,r,i,o,s){const a=o<s;for(a&&([t,n,r,i,o,s]=[r,i,t,n,s,o]);;){if(o===0&&s===0)return a?[r,i,t,n]:[t,n,r,i];if(o&s)return null;let l,u,c=o||s;c&8?(l=t+(r-t)*(this.ymax-n)/(i-n),u=this.ymax):c&4?(l=t+(r-t)*(this.ymin-n)/(i-n),u=this.ymin):c&2?(u=n+(i-n)*(this.xmax-t)/(r-t),l=this.xmax):(u=n+(i-n)*(this.xmin-t)/(r-t),l=this.xmin),o?(t=l,n=u,o=this._regioncode(t,n)):(r=l,i=u,s=this._regioncode(r,i))}}_clipInfinite(t,n,r,i,o,s){let a=Array.from(n),l;if((l=this._project(a[0],a[1],r,i))&&a.unshift(l[0],l[1]),(l=this._project(a[a.length-2],a[a.length-1],o,s))&&a.push(l[0],l[1]),a=this._clipFinite(t,a))for(let u=0,c=a.length,f,d=this._edgecode(a[c-2],a[c-1]);u<c;u+=2)f=d,d=this._edgecode(a[u],a[u+1]),f&&d&&(u=this._edge(t,f,d,a,u),c=a.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(a=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return a}_edge(t,n,r,i,o){for(;n!==r;){let s,a;switch(n){case 5:n=4;continue;case 4:n=6,s=this.xmax,a=this.ymin;break;case 6:n=2;continue;case 2:n=10,s=this.xmax,a=this.ymax;break;case 10:n=8;continue;case 8:n=9,s=this.xmin,a=this.ymax;break;case 9:n=1;continue;case 1:n=5,s=this.xmin,a=this.ymin;break}(i[o]!==s||i[o+1]!==a)&&this.contains(t,s,a)&&(i.splice(o,0,s,a),o+=2)}return o}_project(t,n,r,i){let o=1/0,s,a,l;if(i<0){if(n<=this.ymin)return null;(s=(this.ymin-n)/i)<o&&(l=this.ymin,a=t+(o=s)*r)}else if(i>0){if(n>=this.ymax)return null;(s=(this.ymax-n)/i)<o&&(l=this.ymax,a=t+(o=s)*r)}if(r>0){if(t>=this.xmax)return null;(s=(this.xmax-t)/r)<o&&(a=this.xmax,l=n+(o=s)*i)}else if(r<0){if(t<=this.xmin)return null;(s=(this.xmin-t)/r)<o&&(a=this.xmin,l=n+(o=s)*i)}return[a,l]}_edgecode(t,n){return(t===this.xmin?1:t===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(t,n){return(t<this.xmin?1:t>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}_simplify(t){if(t&&t.length>4){for(let n=0;n<t.length;n+=2){const r=(n+2)%t.length,i=(n+4)%t.length;(t[n]===t[r]&&t[r]===t[i]||t[n+1]===t[r+1]&&t[r+1]===t[i+1])&&(t.splice(r,2),n-=2)}t.length||(t=null)}return t}};const yle=2*Math.PI,Ou=Math.pow;function vle(e){return e[0]}function xle(e){return e[1]}function wle(e){const{triangles:t,coords:n}=e;for(let r=0;r<t.length;r+=3){const i=2*t[r],o=2*t[r+1],s=2*t[r+2];if((n[s]-n[i])*(n[o+1]-n[i+1])-(n[o]-n[i])*(n[s+1]-n[i+1])>1e-10)return!1}return!0}function ble(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class V3{static from(t,n=vle,r=xle,i){return new V3("length"in t?Ele(t,n,r,i):Float64Array.from(Sle(t,n,r,i)))}constructor(t){this._delaunator=new L1(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&wle(t)){this.collinear=Int32Array.from({length:n.length/2},(d,h)=>h).sort((d,h)=>n[2*d]-n[2*h]||n[2*d+1]-n[2*h+1]);const l=this.collinear[0],u=this.collinear[this.collinear.length-1],c=[n[2*l],n[2*l+1],n[2*u],n[2*u+1]],f=1e-8*Math.hypot(c[3]-c[1],c[2]-c[0]);for(let d=0,h=n.length/2;d<h;++d){const p=ble(n[2*d],n[2*d+1],f);n[2*d]=p[0],n[2*d+1]=p[1]}this._delaunator=new L1(n)}else delete this.collinear;const r=this.halfedges=this._delaunator.halfedges,i=this.hull=this._delaunator.hull,o=this.triangles=this._delaunator.triangles,s=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let l=0,u=r.length;l<u;++l){const c=o[l%3===2?l-2:l+1];(r[l]===-1||s[c]===-1)&&(s[c]=l)}for(let l=0,u=i.length;l<u;++l)a[i[l]]=l;i.length<=2&&i.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=i[0],s[i[0]]=1,i.length===2&&(s[i[1]]=0,this.triangles[1]=i[1],this.triangles[2]=i[1]))}voronoi(t){return new mle(this,t)}*neighbors(t){const{inedges:n,hull:r,_hullIndex:i,halfedges:o,triangles:s,collinear:a}=this;if(a){const f=a.indexOf(t);f>0&&(yield a[f-1]),f<a.length-1&&(yield a[f+1]);return}const l=n[t];if(l===-1)return;let u=l,c=-1;do{if(yield c=s[u],u=u%3===2?u-2:u+1,s[u]!==t)return;if(u=o[u],u===-1){const f=r[(i[t]+1)%r.length];f!==c&&(yield f);return}}while(u!==l)}find(t,n,r=0){if(t=+t,t!==t||(n=+n,n!==n))return-1;const i=r;let o;for(;(o=this._step(r,t,n))>=0&&o!==r&&o!==i;)r=o;return o}_step(t,n,r){const{inedges:i,hull:o,_hullIndex:s,halfedges:a,triangles:l,points:u}=this;if(i[t]===-1||!u.length)return(t+1)%(u.length>>1);let c=t,f=Ou(n-u[t*2],2)+Ou(r-u[t*2+1],2);const d=i[t];let h=d;do{let p=l[h];const g=Ou(n-u[p*2],2)+Ou(r-u[p*2+1],2);if(g<f&&(f=g,c=p),h=h%3===2?h-2:h+1,l[h]!==t)break;if(h=a[h],h===-1){if(h=o[(s[t]+1)%o.length],h!==p&&Ou(n-u[h*2],2)+Ou(r-u[h*2+1],2)<f)return h;break}}while(h!==d);return c}render(t){const n=t==null?t=new bl:void 0,{points:r,halfedges:i,triangles:o}=this;for(let s=0,a=i.length;s<a;++s){const l=i[s];if(l<s)continue;const u=o[s]*2,c=o[l]*2;t.moveTo(r[u],r[u+1]),t.lineTo(r[c],r[c+1])}return this.renderHull(t),n&&n.value()}renderPoints(t,n){n===void 0&&(!t||typeof t.moveTo!="function")&&(n=t,t=null),n=n==null?2:+n;const r=t==null?t=new bl:void 0,{points:i}=this;for(let o=0,s=i.length;o<s;o+=2){const a=i[o],l=i[o+1];t.moveTo(a+n,l),t.arc(a,l,n,0,yle)}return r&&r.value()}renderHull(t){const n=t==null?t=new bl:void 0,{hull:r,points:i}=this,o=r[0]*2,s=r.length;t.moveTo(i[o],i[o+1]);for(let a=1;a<s;++a){const l=2*r[a];t.lineTo(i[l],i[l+1])}return t.closePath(),n&&n.value()}hullPolygon(){const t=new QE;return this.renderHull(t),t.value()}renderTriangle(t,n){const r=n==null?n=new bl:void 0,{points:i,triangles:o}=this,s=o[t*=3]*2,a=o[t+1]*2,l=o[t+2]*2;return n.moveTo(i[s],i[s+1]),n.lineTo(i[a],i[a+1]),n.lineTo(i[l],i[l+1]),n.closePath(),r&&r.value()}*trianglePolygons(){const{triangles:t}=this;for(let n=0,r=t.length/3;n<r;++n)yield this.trianglePolygon(n)}trianglePolygon(t){const n=new QE;return this.renderTriangle(t,n),n.value()}}function Ele(e,t,n,r){const i=e.length,o=new Float64Array(i*2);for(let s=0;s<i;++s){const a=e[s];o[s*2]=t.call(r,a,s,e),o[s*2+1]=n.call(r,a,s,e)}return o}function*Sle(e,t,n,r){let i=0;for(const o of e)yield t.call(r,o,i,e),yield n.call(r,o,i,e),++i}function G3(e){P.call(this,null,e)}G3.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const _le=[-1e5,-1e5,1e5,1e5];X(G3,P,{transform(e,t){const n=e.as||"path",r=t.source;if(!r||!r.length)return t;let i=e.size;i=i?[0,0,i[0],i[1]]:(i=e.extent)?[i[0][0],i[0][1],i[1][0],i[1][1]]:_le;const o=this.value=V3.from(r,e.x,e.y).voronoi(i);for(let s=0,a=r.length;s<a;++s){const l=o.cellPolygon(s);r[s][n]=l&&!Cle(l)?kle(l):null}return t.reflow(e.modified()).modifies(n)}});function kle(e){const t=e[0][0],n=e[0][1];let r=e.length-1;for(;e[r][0]===t&&e[r][1]===n;--r);return"M"+e.slice(0,r+1).join("L")+"Z"}function Cle(e){return e.length===2&&e[0][0]===e[1][0]&&e[0][1]===e[1][1]}const $le=Object.freeze(Object.defineProperty({__proto__:null,voronoi:G3},Symbol.toStringTag,{value:"Module"}));var Z2=Math.PI/180,Vd=64,Y0=2048;function Ale(){var e=[256,256],t,n,r,i,o,s,a,l=Zz,u=[],c=Math.random,f={};f.layout=function(){for(var p=d(ca()),g=Dle((e[0]>>5)*e[1]),y=null,m=u.length,v=-1,x=[],w=u.map(S=>({text:t(S),font:n(S),style:i(S),weight:o(S),rotate:s(S),size:~~(r(S)+1e-14),padding:a(S),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:S})).sort((S,E)=>E.size-S.size);++v<m;){var b=w[v];b.x=e[0]*(c()+.5)>>1,b.y=e[1]*(c()+.5)>>1,Fle(p,b,w,v),b.hasText&&h(g,b,y)&&(x.push(b),y?Tle(y,b):y=[{x:b.x+b.x0,y:b.y+b.y0},{x:b.x+b.x1,y:b.y+b.y1}],b.x-=e[0]>>1,b.y-=e[1]>>1)}return x};function d(p){p.width=p.height=1;var g=Math.sqrt(p.getContext("2d").getImageData(0,0,1,1).data.length>>2);p.width=(Vd<<5)/g,p.height=Y0/g;var y=p.getContext("2d");return y.fillStyle=y.strokeStyle="red",y.textAlign="center",{context:y,ratio:g}}function h(p,g,y){for(var m=g.x,v=g.y,x=Math.hypot(e[0],e[1]),w=l(e),b=c()<.5?1:-1,S=-b,E,_,k;(E=w(S+=b))&&(_=~~E[0],k=~~E[1],!(Math.min(Math.abs(_),Math.abs(k))>=x));)if(g.x=m+_,g.y=v+k,!(g.x+g.x0<0||g.y+g.y0<0||g.x+g.x1>e[0]||g.y+g.y1>e[1])&&(!y||!Mle(g,p,e[0]))&&(!y||Nle(g,y))){for(var C=g.sprite,$=g.width>>5,O=e[0]>>5,A=g.x-($<<4),T=A&127,F=32-T,R=g.y1-g.y0,L=(g.y+g.y0)*O+(A>>5),N,D=0;D<R;D++){N=0;for(var U=0;U<=$;U++)p[L+U]|=N<<F|(U<$?(N=C[D*$+U])>>>T:0);L+=O}return g.sprite=null,!0}return!1}return f.words=function(p){return arguments.length?(u=p,f):u},f.size=function(p){return arguments.length?(e=[+p[0],+p[1]],f):e},f.font=function(p){return arguments.length?(n=Xa(p),f):n},f.fontStyle=function(p){return arguments.length?(i=Xa(p),f):i},f.fontWeight=function(p){return arguments.length?(o=Xa(p),f):o},f.rotate=function(p){return arguments.length?(s=Xa(p),f):s},f.text=function(p){return arguments.length?(t=Xa(p),f):t},f.spiral=function(p){return arguments.length?(l=Ole[p]||p,f):l},f.fontSize=function(p){return arguments.length?(r=Xa(p),f):r},f.padding=function(p){return arguments.length?(a=Xa(p),f):a},f.random=function(p){return arguments.length?(c=p,f):c},f}function Fle(e,t,n,r){if(!t.sprite){var i=e.context,o=e.ratio;i.clearRect(0,0,(Vd<<5)/o,Y0/o);var s=0,a=0,l=0,u=n.length,c,f,d,h,p;for(--r;++r<u;){if(t=n[r],i.save(),i.font=t.style+" "+t.weight+" "+~~((t.size+1)/o)+"px "+t.font,c=i.measureText(t.text+"m").width*o,d=t.size<<1,t.rotate){var g=Math.sin(t.rotate*Z2),y=Math.cos(t.rotate*Z2),m=c*y,v=c*g,x=d*y,w=d*g;c=Math.max(Math.abs(m+w),Math.abs(m-w))+31>>5<<5,d=~~Math.max(Math.abs(v+x),Math.abs(v-x))}else c=c+31>>5<<5;if(d>l&&(l=d),s+c>=Vd<<5&&(s=0,a+=l,l=0),a+d>=Y0)break;i.translate((s+(c>>1))/o,(a+(d>>1))/o),t.rotate&&i.rotate(t.rotate*Z2),i.fillText(t.text,0,0),t.padding&&(i.lineWidth=2*t.padding,i.strokeText(t.text,0,0)),i.restore(),t.width=c,t.height=d,t.xoff=s,t.yoff=a,t.x1=c>>1,t.y1=d>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,s+=c}for(var b=i.getImageData(0,0,(Vd<<5)/o,Y0/o).data,S=[];--r>=0;)if(t=n[r],!!t.hasText){for(c=t.width,f=c>>5,d=t.y1-t.y0,h=0;h<d*f;h++)S[h]=0;if(s=t.xoff,s==null)return;a=t.yoff;var E=0,_=-1;for(p=0;p<d;p++){for(h=0;h<c;h++){var k=f*p+(h>>5),C=b[(a+p)*(Vd<<5)+(s+h)<<2]?1<<31-h%32:0;S[k]|=C,E|=C}E?_=p:(t.y0++,d--,p--,a++)}t.y1=t.y0+_,t.sprite=S.slice(0,(t.y1-t.y0)*f)}}}function Mle(e,t,n){n>>=5;for(var r=e.sprite,i=e.width>>5,o=e.x-(i<<4),s=o&127,a=32-s,l=e.y1-e.y0,u=(e.y+e.y0)*n+(o>>5),c,f=0;f<l;f++){c=0;for(var d=0;d<=i;d++)if((c<<a|(d<i?(c=r[f*i+d])>>>s:0))&t[u+d])return!0;u+=n}return!1}function Tle(e,t){var n=e[0],r=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>r.x&&(r.x=t.x+t.x1),t.y+t.y1>r.y&&(r.y=t.y+t.y1)}function Nle(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function Zz(e){var t=e[0]/e[1];return function(n){return[t*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function Rle(e){var t=4,n=t*e[0]/e[1],r=0,i=0;return function(o){var s=o<0?-1:1;switch(Math.sqrt(1+4*s*o)-s&3){case 0:r+=n;break;case 1:i+=t;break;case 2:r-=n;break;default:i-=t;break}return[r,i]}}function Dle(e){for(var t=[],n=-1;++n<e;)t[n]=0;return t}function Xa(e){return typeof e=="function"?e:function(){return e}}var Ole={archimedean:Zz,rectangular:Rle};const Jz=["x","y","font","fontSize","fontStyle","fontWeight","angle"],Ple=["text","font","rotate","fontSize","fontStyle","fontWeight"];function Y3(e){P.call(this,Ale(),e)}Y3.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:Jz}]};X(Y3,P,{transform(e,t){e.size&&!(e.size[0]&&e.size[1])&&I("Wordcloud size dimensions must be non-zero.");function n(p){const g=e[p];return me(g)&&t.modified(g.fields)}const r=e.modified();if(!(r||t.changed(t.ADD_REM)||Ple.some(n)))return;const i=t.materialize(t.SOURCE).source,o=this.value,s=e.as||Jz;let a=e.fontSize||14,l;if(me(a)?l=e.fontSizeRange:a=bn(a),l){const p=a,g=Ne("sqrt")().domain(co(i,p)).range(l);a=y=>g(p(y))}i.forEach(p=>{p[s[0]]=NaN,p[s[1]]=NaN,p[s[3]]=0});const u=o.words(i).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(a).random(Xr).layout(),c=o.size(),f=c[0]>>1,d=c[1]>>1,h=u.length;for(let p=0,g,y;p<h;++p)g=u[p],y=g.datum,y[s[0]]=g.x+f,y[s[1]]=g.y+d,y[s[2]]=g.font,y[s[3]]=g.size,y[s[4]]=g.style,y[s[5]]=g.weight,y[s[6]]=g.rotate;return t.reflow(r).modifies(s)}});const Lle=Object.freeze(Object.defineProperty({__proto__:null,wordcloud:Y3},Symbol.toStringTag,{value:"Module"})),zle=e=>new Uint8Array(e),Ile=e=>new Uint16Array(e),gh=e=>new Uint32Array(e);function jle(){let e=8,t=[],n=gh(0),r=e0(0,e),i=e0(0,e);return{data:()=>t,seen:()=>n=Ble(n,t.length),add(o){for(let s=0,a=t.length,l=o.length,u;s<l;++s)u=o[s],u._index=a++,t.push(u)},remove(o,s){const a=t.length,l=Array(a-o),u=t;let c,f,d;for(f=0;!s[f]&&f<a;++f)l[f]=t[f],u[f]=f;for(d=f;f<a;++f)c=t[f],s[f]?u[f]=-1:(u[f]=d,r[d]=r[f],i[d]=i[f],l[d]=c,c._index=d++),r[f]=0;return t=l,u},size:()=>t.length,curr:()=>r,prev:()=>i,reset:o=>i[o]=r[o],all:()=>e<257?255:e<65537?65535:4294967295,set(o,s){r[o]|=s},clear(o,s){r[o]&=~s},resize(o,s){const a=r.length;(o>a||s>e)&&(e=Math.max(s,e),r=e0(o,e,r),i=e0(o,e))}}}function Ble(e,t,n){return e.length>=t?e:(n=n||new e.constructor(t),n.set(e),n)}function e0(e,t,n){const r=(t<257?zle:t<65537?Ile:gh)(e);return n&&r.set(n),r}function cM(e,t,n){const r=1<<t;return{one:r,zero:~r,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(i,o){const s=this,a=s.bisect(s.range,i.value),l=i.index,u=a[0],c=a[1],f=l.length;let d;for(d=0;d<u;++d)o[l[d]]|=r;for(d=c;d<f;++d)o[l[d]]|=r;return s}}}function fM(){let e=gh(0),t=[],n=0;function r(a,l,u){if(!l.length)return[];const c=n,f=l.length,d=gh(f);let h=Array(f),p,g,y;for(y=0;y<f;++y)h[y]=a(l[y]),d[y]=y;if(h=Ule(h,d),c)p=t,g=e,t=Array(c+f),e=gh(c+f),Wle(u,p,g,c,h,d,f,t,e);else{if(u>0)for(y=0;y<f;++y)d[y]+=u;t=h,e=d}return n=c+f,{index:d,value:h}}function i(a,l){const u=n;let c,f,d;for(f=0;!l[e[f]]&&f<u;++f);for(d=f;f<u;++f)l[c=e[f]]||(e[d]=c,t[d]=t[f],++d);n=u-a}function o(a){for(let l=0,u=n;l<u;++l)e[l]=a[e[l]]}function s(a,l){let u;return l?u=l.length:(l=t,u=n),[GG(l,a[0],0,u),ga(l,a[1],0,u)]}return{insert:r,remove:i,bisect:s,reindex:o,index:()=>e,size:()=>n}}function Ule(e,t){return e.sort.call(t,(n,r)=>{const i=e[n],o=e[r];return i<o?-1:i>o?1:0}),QG(e,t)}function Wle(e,t,n,r,i,o,s,a,l){let u=0,c=0,f;for(f=0;u<r&&c<s;++f)t[u]<i[c]?(a[f]=t[u],l[f]=n[u++]):(a[f]=i[c],l[f]=o[c++]+e);for(;u<r;++u,++f)a[f]=t[u],l[f]=n[u];for(;c<s;++c,++f)a[f]=i[c],l[f]=o[c]+e}function X3(e){P.call(this,jle(),e),this._indices=null,this._dims=null}X3.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]};X(X3,P,{transform(e,t){if(this._dims){var n=e.modified("fields")||e.fields.some(r=>t.modified(r.fields));return n?this.reinit(e,t):this.eval(e,t)}else return this.init(e,t)},init(e,t){const n=e.fields,r=e.query,i=this._indices={},o=this._dims=[],s=r.length;let a=0,l,u;for(;a<s;++a)l=n[a].fname,u=i[l]||(i[l]=fM()),o.push(cM(u,a,r[a]));return this.eval(e,t)},reinit(e,t){const n=t.materialize().fork(),r=e.fields,i=e.query,o=this._indices,s=this._dims,a=this.value,l=a.curr(),u=a.prev(),c=a.all(),f=n.rem=n.add,d=n.mod,h=i.length,p={};let g,y,m,v,x,w,b,S,E;if(u.set(l),t.rem.length&&(x=this.remove(e,t,n)),t.add.length&&a.add(t.add),t.mod.length)for(w={},v=t.mod,b=0,S=v.length;b<S;++b)w[v[b]._index]=1;for(b=0;b<h;++b)E=r[b],(!s[b]||e.modified("fields",b)||t.modified(E.fields))&&(m=E.fname,(g=p[m])||(o[m]=y=fM(),p[m]=g=y.insert(E,t.source,0)),s[b]=cM(y,b,i[b]).onAdd(g,l));for(b=0,S=a.data().length;b<S;++b)x[b]||(u[b]!==l[b]?f.push(b):w[b]&&l[b]!==c&&d.push(b));return a.mask=(1<<h)-1,n},eval(e,t){const n=t.materialize().fork(),r=this._dims.length;let i=0;return t.rem.length&&(this.remove(e,t,n),i|=(1<<r)-1),e.modified("query")&&!e.modified("fields")&&(i|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),i|=(1<<r)-1),t.mod.length&&(this.modify(t,n),i|=(1<<r)-1),this.value.mask=i,n},insert(e,t,n){const r=t.add,i=this.value,o=this._dims,s=this._indices,a=e.fields,l={},u=n.add,c=i.size()+r.length,f=o.length;let d=i.size(),h,p,g;i.resize(c,f),i.add(r);const y=i.curr(),m=i.prev(),v=i.all();for(h=0;h<f;++h)p=a[h].fname,g=l[p]||(l[p]=s[p].insert(a[h],r,d)),o[h].onAdd(g,y);for(;d<c;++d)m[d]=v,y[d]!==v&&u.push(d)},modify(e,t){const n=t.mod,r=this.value,i=r.curr(),o=r.all(),s=e.mod;let a,l,u;for(a=0,l=s.length;a<l;++a)u=s[a]._index,i[u]!==o&&n.push(u)},remove(e,t,n){const r=this._indices,i=this.value,o=i.curr(),s=i.prev(),a=i.all(),l={},u=n.rem,c=t.rem;let f,d,h,p;for(f=0,d=c.length;f<d;++f)h=c[f]._index,l[h]=1,s[h]=p=o[h],o[h]=a,p!==a&&u.push(h);for(h in r)r[h].remove(d,l);return this.reindex(t,d,l),l},reindex(e,t,n){const r=this._indices,i=this.value;e.runAfter(()=>{const o=i.remove(t,n);for(const s in r)r[s].reindex(o)})},update(e,t,n){const r=this._dims,i=e.query,o=t.stamp,s=r.length;let a=0,l,u;for(n.filters=0,u=0;u<s;++u)e.modified("query",u)&&(l=u,++a);if(a===1)a=r[l].one,this.incrementOne(r[l],i[l],n.add,n.rem);else for(u=0,a=0;u<s;++u)e.modified("query",u)&&(a|=r[u].one,this.incrementAll(r[u],i[u],o,n.add),n.rem=n.add);return a},incrementAll(e,t,n,r){const i=this.value,o=i.seen(),s=i.curr(),a=i.prev(),l=e.index(),u=e.bisect(e.range),c=e.bisect(t),f=c[0],d=c[1],h=u[0],p=u[1],g=e.one;let y,m,v;if(f<h)for(y=f,m=Math.min(h,d);y<m;++y)v=l[y],o[v]!==n&&(a[v]=s[v],o[v]=n,r.push(v)),s[v]^=g;else if(f>h)for(y=h,m=Math.min(f,p);y<m;++y)v=l[y],o[v]!==n&&(a[v]=s[v],o[v]=n,r.push(v)),s[v]^=g;if(d>p)for(y=Math.max(f,p),m=d;y<m;++y)v=l[y],o[v]!==n&&(a[v]=s[v],o[v]=n,r.push(v)),s[v]^=g;else if(d<p)for(y=Math.max(h,d),m=p;y<m;++y)v=l[y],o[v]!==n&&(a[v]=s[v],o[v]=n,r.push(v)),s[v]^=g;e.range=t.slice()},incrementOne(e,t,n,r){const i=this.value,o=i.curr(),s=e.index(),a=e.bisect(e.range),l=e.bisect(t),u=l[0],c=l[1],f=a[0],d=a[1],h=e.one;let p,g,y;if(u<f)for(p=u,g=Math.min(f,c);p<g;++p)y=s[p],o[y]^=h,n.push(y);else if(u>f)for(p=f,g=Math.min(u,d);p<g;++p)y=s[p],o[y]^=h,r.push(y);if(c>d)for(p=Math.max(u,d),g=c;p<g;++p)y=s[p],o[y]^=h,n.push(y);else if(c<d)for(p=Math.max(f,c),g=d;p<g;++p)y=s[p],o[y]^=h,r.push(y);e.range=t.slice()}});function Q3(e){P.call(this,null,e)}Q3.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]};X(Q3,P,{transform(e,t){const n=~(e.ignore||0),r=e.filter,i=r.mask;if(!(i&n))return t.StopPropagation;const o=t.fork(t.ALL),s=r.data(),a=r.curr(),l=r.prev(),u=c=>a[c]&n?null:s[c];return o.filter(o.MOD,u),i&i-1?(o.filter(o.ADD,c=>{const f=a[c]&n;return!f&&f^l[c]&n?s[c]:null}),o.filter(o.REM,c=>{const f=a[c]&n;return f&&!(f^(f^l[c]&n))?s[c]:null})):(o.filter(o.ADD,u),o.filter(o.REM,c=>(a[c]&n)===i?s[c]:null)),o.filter(o.SOURCE,c=>u(c._index))}});const qle=Object.freeze(Object.defineProperty({__proto__:null,crossfilter:X3,resolvefilter:Q3},Symbol.toStringTag,{value:"Module"})),Hle="RawCode",Yl="Literal",Vle="Property",Gle="Identifier",Yle="ArrayExpression",Xle="BinaryExpression",eI="CallExpression",Qle="ConditionalExpression",Kle="LogicalExpression",Zle="MemberExpression",Jle="ObjectExpression",eue="UnaryExpression";function Ni(e){this.type=e}Ni.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=tue(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};function tue(e){switch(e.type){case Yle:return e.elements;case Xle:case Kle:return[e.left,e.right];case eI:return[e.callee].concat(e.arguments);case Qle:return[e.test,e.consequent,e.alternate];case Zle:return[e.object,e.property];case Jle:return e.properties;case Vle:return[e.key,e.value];case eue:return[e.argument];case Gle:case Yl:case Hle:default:return[]}}var ko,ie,z,yn,Le,Sv=1,Hp=2,Xl=3,Ia=4,_v=5,gu=6,qn=7,Vp=8,nue=9;ko={};ko[Sv]="Boolean";ko[Hp]="<end>";ko[Xl]="Identifier";ko[Ia]="Keyword";ko[_v]="Null";ko[gu]="Numeric";ko[qn]="Punctuator";ko[Vp]="String";ko[nue]="RegularExpression";var rue="ArrayExpression",iue="BinaryExpression",oue="CallExpression",sue="ConditionalExpression",tI="Identifier",aue="Literal",lue="LogicalExpression",uue="MemberExpression",cue="ObjectExpression",fue="Property",due="UnaryExpression",Dt="Unexpected token %0",hue="Unexpected number",pue="Unexpected string",gue="Unexpected identifier",mue="Unexpected reserved word",yue="Unexpected end of input",KE="Invalid regular expression",J2="Invalid regular expression: missing /",nI="Octal literals are not allowed in strict mode.",vue="Duplicate data property in object literal not allowed in strict mode",Xt="ILLEGAL",tp="Disabled.",xue=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),wue=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function kv(e,t){if(!e)throw new Error("ASSERT: "+t)}function Bo(e){return e>=48&&e<=57}function K3(e){return"0123456789abcdefABCDEF".includes(e)}function mh(e){return"01234567".includes(e)}function bue(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].includes(e)}function np(e){return e===10||e===13||e===8232||e===8233}function Gp(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&xue.test(String.fromCharCode(e))}function z1(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&wue.test(String.fromCharCode(e))}const Eue={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function rI(){for(;z<yn;){const e=ie.charCodeAt(z);if(bue(e)||np(e))++z;else break}}function ZE(e){var t,n,r,i=0;for(n=e==="u"?4:2,t=0;t<n;++t)z<yn&&K3(ie[z])?(r=ie[z++],i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())):Fe({},Dt,Xt);return String.fromCharCode(i)}function Sue(){var e,t,n,r;for(e=ie[z],t=0,e==="}"&&Fe({},Dt,Xt);z<yn&&(e=ie[z++],!!K3(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&Fe({},Dt,Xt),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,r=(t-65536&1023)+56320,String.fromCharCode(n,r))}function iI(){var e,t;for(e=ie.charCodeAt(z++),t=String.fromCharCode(e),e===92&&(ie.charCodeAt(z)!==117&&Fe({},Dt,Xt),++z,e=ZE("u"),(!e||e==="\\"||!Gp(e.charCodeAt(0)))&&Fe({},Dt,Xt),t=e);z<yn&&(e=ie.charCodeAt(z),!!z1(e));)++z,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),ie.charCodeAt(z)!==117&&Fe({},Dt,Xt),++z,e=ZE("u"),(!e||e==="\\"||!z1(e.charCodeAt(0)))&&Fe({},Dt,Xt),t+=e);return t}function _ue(){var e,t;for(e=z++;z<yn;){if(t=ie.charCodeAt(z),t===92)return z=e,iI();if(z1(t))++z;else break}return ie.slice(e,z)}function kue(){var e,t,n;return e=z,t=ie.charCodeAt(z)===92?iI():_ue(),t.length===1?n=Xl:Eue.hasOwnProperty(t)?n=Ia:t==="null"?n=_v:t==="true"||t==="false"?n=Sv:n=Xl,{type:n,value:t,start:e,end:z}}function ew(){var e=z,t=ie.charCodeAt(z),n,r=ie[z],i,o,s;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++z,{type:qn,value:String.fromCharCode(t),start:e,end:z};default:if(n=ie.charCodeAt(z+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return z+=2,{type:qn,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:z};case 33:case 61:return z+=2,ie.charCodeAt(z)===61&&++z,{type:qn,value:ie.slice(e,z),start:e,end:z}}}if(s=ie.substr(z,4),s===">>>=")return z+=4,{type:qn,value:s,start:e,end:z};if(o=s.substr(0,3),o===">>>"||o==="<<="||o===">>=")return z+=3,{type:qn,value:o,start:e,end:z};if(i=o.substr(0,2),r===i[1]&&"+-<>&|".includes(r)||i==="=>")return z+=2,{type:qn,value:i,start:e,end:z};if(i==="//"&&Fe({},Dt,Xt),"<>=!+-*%&|^/".includes(r))return++z,{type:qn,value:r,start:e,end:z};Fe({},Dt,Xt)}function Cue(e){let t="";for(;z<yn&&K3(ie[z]);)t+=ie[z++];return t.length===0&&Fe({},Dt,Xt),Gp(ie.charCodeAt(z))&&Fe({},Dt,Xt),{type:gu,value:parseInt("0x"+t,16),start:e,end:z}}function $ue(e){let t="0"+ie[z++];for(;z<yn&&mh(ie[z]);)t+=ie[z++];return(Gp(ie.charCodeAt(z))||Bo(ie.charCodeAt(z)))&&Fe({},Dt,Xt),{type:gu,value:parseInt(t,8),octal:!0,start:e,end:z}}function dM(){var e,t,n;if(n=ie[z],kv(Bo(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=z,e="",n!=="."){if(e=ie[z++],n=ie[z],e==="0"){if(n==="x"||n==="X")return++z,Cue(t);if(mh(n))return $ue(t);n&&Bo(n.charCodeAt(0))&&Fe({},Dt,Xt)}for(;Bo(ie.charCodeAt(z));)e+=ie[z++];n=ie[z]}if(n==="."){for(e+=ie[z++];Bo(ie.charCodeAt(z));)e+=ie[z++];n=ie[z]}if(n==="e"||n==="E")if(e+=ie[z++],n=ie[z],(n==="+"||n==="-")&&(e+=ie[z++]),Bo(ie.charCodeAt(z)))for(;Bo(ie.charCodeAt(z));)e+=ie[z++];else Fe({},Dt,Xt);return Gp(ie.charCodeAt(z))&&Fe({},Dt,Xt),{type:gu,value:parseFloat(e),start:t,end:z}}function Aue(){var e="",t,n,r,i,o=!1;for(t=ie[z],kv(t==="'"||t==='"',"String literal must starts with a quote"),n=z,++z;z<yn;)if(r=ie[z++],r===t){t="";break}else if(r==="\\")if(r=ie[z++],!r||!np(r.charCodeAt(0)))switch(r){case"u":case"x":ie[z]==="{"?(++z,e+=Sue()):e+=ZE(r);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:mh(r)?(i="01234567".indexOf(r),i!==0&&(o=!0),z<yn&&mh(ie[z])&&(o=!0,i=i*8+"01234567".indexOf(ie[z++]),"0123".includes(r)&&z<yn&&mh(ie[z])&&(i=i*8+"01234567".indexOf(ie[z++]))),e+=String.fromCharCode(i)):e+=r;break}else r==="\r"&&ie[z]===`
`&&++z;else{if(np(r.charCodeAt(0)))break;e+=r}return t!==""&&Fe({},Dt,Xt),{type:Vp,value:e,octal:o,start:n,end:z}}function Fue(e,t){let n=e;t.includes("u")&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(r,i)=>{if(parseInt(i,16)<=1114111)return"x";Fe({},KE)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch{Fe({},KE)}try{return new RegExp(e,t)}catch{return null}}function Mue(){var e,t,n,r,i;for(e=ie[z],kv(e==="/","Regular expression literal must start with a slash"),t=ie[z++],n=!1,r=!1;z<yn;)if(e=ie[z++],t+=e,e==="\\")e=ie[z++],np(e.charCodeAt(0))&&Fe({},J2),t+=e;else if(np(e.charCodeAt(0)))Fe({},J2);else if(n)e==="]"&&(n=!1);else if(e==="/"){r=!0;break}else e==="["&&(n=!0);return r||Fe({},J2),i=t.substr(1,t.length-2),{value:i,literal:t}}function Tue(){var e,t,n;for(t="",n="";z<yn&&(e=ie[z],!!z1(e.charCodeAt(0)));)++z,e==="\\"&&z<yn?Fe({},Dt,Xt):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&Fe({},KE,n),{value:n,literal:t}}function Nue(){var e,t,n,r;return Le=null,rI(),e=z,t=Mue(),n=Tue(),r=Fue(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:z}}function Rue(e){return e.type===Xl||e.type===Ia||e.type===Sv||e.type===_v}function oI(){if(rI(),z>=yn)return{type:Hp,start:z,end:z};const e=ie.charCodeAt(z);return Gp(e)?kue():e===40||e===41||e===59?ew():e===39||e===34?Aue():e===46?Bo(ie.charCodeAt(z+1))?dM():ew():Bo(e)?dM():ew()}function Gn(){const e=Le;return z=e.end,Le=oI(),z=e.end,e}function sI(){const e=z;Le=oI(),z=e}function Due(e){const t=new Ni(rue);return t.elements=e,t}function hM(e,t,n){const r=new Ni(e==="||"||e==="&&"?lue:iue);return r.operator=e,r.left=t,r.right=n,r}function Oue(e,t){const n=new Ni(oue);return n.callee=e,n.arguments=t,n}function Pue(e,t,n){const r=new Ni(sue);return r.test=e,r.consequent=t,r.alternate=n,r}function Z3(e){const t=new Ni(tI);return t.name=e,t}function Gd(e){const t=new Ni(aue);return t.value=e.value,t.raw=ie.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function pM(e,t,n){const r=new Ni(uue);return r.computed=e==="[",r.object=t,r.property=n,r.computed||(n.member=!0),r}function Lue(e){const t=new Ni(cue);return t.properties=e,t}function gM(e,t,n){const r=new Ni(fue);return r.key=t,r.value=n,r.kind=e,r}function zue(e,t){const n=new Ni(due);return n.operator=e,n.argument=t,n.prefix=!0,n}function Fe(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,(o,s)=>(kv(s<r.length,"Message reference must be in range"),r[s]));throw n=new Error(i),n.index=z,n.description=i,n}function Cv(e){e.type===Hp&&Fe(e,yue),e.type===gu&&Fe(e,hue),e.type===Vp&&Fe(e,pue),e.type===Xl&&Fe(e,gue),e.type===Ia&&Fe(e,mue),Fe(e,Dt,e.value)}function vn(e){const t=Gn();(t.type!==qn||t.value!==e)&&Cv(t)}function Ye(e){return Le.type===qn&&Le.value===e}function tw(e){return Le.type===Ia&&Le.value===e}function Iue(){const e=[];for(z=Le.start,vn("[");!Ye("]");)Ye(",")?(Gn(),e.push(null)):(e.push(Ql()),Ye("]")||vn(","));return Gn(),Due(e)}function mM(){z=Le.start;const e=Gn();return e.type===Vp||e.type===gu?(e.octal&&Fe(e,nI),Gd(e)):Z3(e.value)}function jue(){var e,t,n,r;if(z=Le.start,e=Le,e.type===Xl)return n=mM(),vn(":"),r=Ql(),gM("init",n,r);if(e.type===Hp||e.type===qn)Cv(e);else return t=mM(),vn(":"),r=Ql(),gM("init",t,r)}function Bue(){var e=[],t,n,r,i={},o=String;for(z=Le.start,vn("{");!Ye("}");)t=jue(),t.key.type===tI?n=t.key.name:n=o(t.key.value),r="$"+n,Object.prototype.hasOwnProperty.call(i,r)?Fe({},vue):i[r]=!0,e.push(t),Ye("}")||vn(",");return vn("}"),Lue(e)}function Uue(){vn("(");const e=J3();return vn(")"),e}const Wue={if:1};function que(){var e,t,n;if(Ye("("))return Uue();if(Ye("["))return Iue();if(Ye("{"))return Bue();if(e=Le.type,z=Le.start,e===Xl||Wue[Le.value])n=Z3(Gn().value);else if(e===Vp||e===gu)Le.octal&&Fe(Le,nI),n=Gd(Gn());else{if(e===Ia)throw new Error(tp);e===Sv?(t=Gn(),t.value=t.value==="true",n=Gd(t)):e===_v?(t=Gn(),t.value=null,n=Gd(t)):Ye("/")||Ye("/=")?(n=Gd(Nue()),sI()):Cv(Gn())}return n}function Hue(){const e=[];if(vn("("),!Ye(")"))for(;z<yn&&(e.push(Ql()),!Ye(")"));)vn(",");return vn(")"),e}function Vue(){z=Le.start;const e=Gn();return Rue(e)||Cv(e),Z3(e.value)}function Gue(){return vn("."),Vue()}function Yue(){vn("[");const e=J3();return vn("]"),e}function Xue(){var e,t,n;for(e=que();;)if(Ye("."))n=Gue(),e=pM(".",e,n);else if(Ye("("))t=Hue(),e=Oue(e,t);else if(Ye("["))n=Yue(),e=pM("[",e,n);else break;return e}function yM(){const e=Xue();if(Le.type===qn&&(Ye("++")||Ye("--")))throw new Error(tp);return e}function X0(){var e,t;if(Le.type!==qn&&Le.type!==Ia)t=yM();else{if(Ye("++")||Ye("--"))throw new Error(tp);if(Ye("+")||Ye("-")||Ye("~")||Ye("!"))e=Gn(),t=X0(),t=zue(e.value,t);else{if(tw("delete")||tw("void")||tw("typeof"))throw new Error(tp);t=yM()}}return t}function vM(e){let t=0;if(e.type!==qn&&e.type!==Ia)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function Que(){var e,t,n,r,i,o,s,a,l,u;if(e=Le,l=X0(),r=Le,i=vM(r),i===0)return l;for(r.prec=i,Gn(),t=[e,Le],s=X0(),o=[l,r,s];(i=vM(Le))>0;){for(;o.length>2&&i<=o[o.length-2].prec;)s=o.pop(),a=o.pop().value,l=o.pop(),t.pop(),n=hM(a,l,s),o.push(n);r=Gn(),r.prec=i,o.push(r),t.push(Le),n=X0(),o.push(n)}for(u=o.length-1,n=o[u],t.pop();u>1;)t.pop(),n=hM(o[u-1].value,o[u-2],n),u-=2;return n}function Ql(){var e,t,n;return e=Que(),Ye("?")&&(Gn(),t=Ql(),vn(":"),n=Ql(),e=Pue(e,t,n)),e}function J3(){const e=Ql();if(Ye(","))throw new Error(tp);return e}function e$(e){ie=e,z=0,yn=ie.length,Le=null,sI();const t=J3();if(Le.type!==Hp)throw new Error("Unexpect token after expression.");return t}var aI={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function lI(e){function t(s,a,l,u){let c=e(a[0]);return l&&(c=l+"("+c+")",l.lastIndexOf("new ",0)===0&&(c="("+c+")")),c+"."+s+(u<0?"":u===0?"()":"("+a.slice(1).map(e).join(",")+")")}function n(s,a,l){return u=>t(s,u,a,l)}const r="new Date",i="String",o="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",hypot:"Math.hypot",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(s){s.length<3&&I("Missing arguments to clamp function."),s.length>3&&I("Too many arguments to clamp function.");const a=s.map(e);return"Math.max("+a[1]+", Math.min("+a[2]+","+a[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:r,date:n("getDate",r,0),day:n("getDay",r,0),year:n("getFullYear",r,0),month:n("getMonth",r,0),hours:n("getHours",r,0),minutes:n("getMinutes",r,0),seconds:n("getSeconds",r,0),milliseconds:n("getMilliseconds",r,0),time:n("getTime",r,0),timezoneoffset:n("getTimezoneOffset",r,0),utcdate:n("getUTCDate",r,0),utcday:n("getUTCDay",r,0),utcyear:n("getUTCFullYear",r,0),utcmonth:n("getUTCMonth",r,0),utchours:n("getUTCHours",r,0),utcminutes:n("getUTCMinutes",r,0),utcseconds:n("getUTCSeconds",r,0),utcmilliseconds:n("getUTCMilliseconds",r,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",i,0),lower:n("toLowerCase",i,0),substring:n("substring",i),split:n("split",i),trim:n("trim",i,0),regexp:o,test:n("test",o),if:function(s){s.length<3&&I("Missing arguments to if function."),s.length>3&&I("Too many arguments to if function.");const a=s.map(e);return"("+a[0]+"?"+a[1]+":"+a[2]+")"}}}function Kue(e){const t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function uI(e){e=e||{};const t=e.allowed?ki(e.allowed):{},n=e.forbidden?ki(e.forbidden):{},r=e.constants||aI,i=(e.functions||lI)(f),o=e.globalvar,s=e.fieldvar,a=me(o)?o:p=>`${o}["${p}"]`;let l={},u={},c=0;function f(p){if(ee(p))return p;const g=d[p.type];return g==null&&I("Unsupported type: "+p.type),g(p)}const d={Literal:p=>p.raw,Identifier:p=>{const g=p.name;return c>0?g:te(n,g)?I("Illegal identifier: "+g):te(r,g)?r[g]:te(t,g)?g:(l[g]=1,a(g))},MemberExpression:p=>{const g=!p.computed,y=f(p.object);g&&(c+=1);const m=f(p.property);return y===s&&(u[Kue(m)]=1),g&&(c-=1),y+(g?"."+m:"["+m+"]")},CallExpression:p=>{p.callee.type!=="Identifier"&&I("Illegal callee type: "+p.callee.type);const g=p.callee.name,y=p.arguments,m=te(i,g)&&i[g];return m||I("Unrecognized function: "+g),me(m)?m(y):m+"("+y.map(f).join(",")+")"},ArrayExpression:p=>"["+p.elements.map(f).join(",")+"]",BinaryExpression:p=>"("+f(p.left)+" "+p.operator+" "+f(p.right)+")",UnaryExpression:p=>"("+p.operator+f(p.argument)+")",ConditionalExpression:p=>"("+f(p.test)+"?"+f(p.consequent)+":"+f(p.alternate)+")",LogicalExpression:p=>"("+f(p.left)+p.operator+f(p.right)+")",ObjectExpression:p=>"{"+p.properties.map(f).join(",")+"}",Property:p=>{c+=1;const g=f(p.key);return c-=1,g+":"+f(p.value)}};function h(p){const g={code:f(p),globals:Object.keys(l),fields:Object.keys(u)};return l={},u={},g}return h.functions=i,h.constants=r,h}const xM=Symbol("vega_selection_getter");function cI(e){return(!e.getter||!e.getter[xM])&&(e.getter=Vr(e.field),e.getter[xM]=!0),e.getter}const t$="intersect",wM="union",Zue="vlMulti",Jue="vlPoint",bM="or",ece="and",Xi="_vgsid_",rp=Vr(Xi),tce="E",nce="R",rce="R-E",ice="R-LE",oce="R-RE",I1="index:unit";function EM(e,t){for(var n=t.fields,r=t.values,i=n.length,o=0,s,a;o<i;++o)if(a=n[o],s=cI(a)(e),aa(s)&&(s=hn(s)),aa(r[o])&&(r[o]=hn(r[o])),j(r[o])&&aa(r[o][0])&&(r[o]=r[o].map(hn)),a.type===tce){if(j(r[o])?r[o].indexOf(s)<0:s!==r[o])return!1}else if(a.type===nce){if(!nc(s,r[o]))return!1}else if(a.type===oce){if(!nc(s,r[o],!0,!1))return!1}else if(a.type===rce){if(!nc(s,r[o],!1,!1))return!1}else if(a.type===ice&&!nc(s,r[o],!1,!0))return!1;return!0}function sce(e,t,n){for(var r=this.context.data[e],i=r?r.values.value:[],o=r?r[I1]&&r[I1].value:void 0,s=n===t$,a=i.length,l=0,u,c,f,d,h;l<a;++l)if(u=i[l],o&&s){if(c=c||{},f=c[d=u.unit]||0,f===-1)continue;if(h=EM(t,u),c[d]=h?-1:++f,h&&o.size===1)return!0;if(!h&&f===o.get(d).count)return!1}else if(h=EM(t,u),s^h)return h;return a&&s}const fI=Ef(rp),ace=fI.left,lce=fI.right;function uce(e,t,n){const r=this.context.data[e],i=r?r.values.value:[],o=r?r[I1]&&r[I1].value:void 0,s=n===t$,a=rp(t),l=ace(i,a);if(l===i.length||rp(i[l])!==a)return!1;if(o&&s){if(o.size===1)return!0;if(lce(i,a)-l<o.size)return!1}return!0}function cce(e,t){return e.map(n=>ge(t.fields?{values:t.fields.map(r=>cI(r)(n.datum))}:{[Xi]:rp(n.datum)},t))}function fce(e,t,n,r){for(var i=this.context.data[e],o=i?i.values.value:[],s={},a={},l={},u,c,f,d,h,p,g,y,m,v,x=o.length,w=0,b,S;w<x;++w)if(u=o[w],d=u.unit,c=u.fields,f=u.values,c&&f){for(b=0,S=c.length;b<S;++b)h=c[b],g=s[h.field]||(s[h.field]={}),y=g[d]||(g[d]=[]),l[h.field]=m=h.type.charAt(0),v=nw[`${m}_union`],g[d]=v(y,J(f[b]));n&&(y=a[d]||(a[d]=[]),y.push(J(f).reduce((E,_,k)=>(E[c[k].field]=_,E),{})))}else h=Xi,p=rp(u),g=s[h]||(s[h]={}),y=g[d]||(g[d]=[]),y.push(p),n&&(y=a[d]||(a[d]=[]),y.push({[Xi]:p}));if(t=t||wM,s[Xi]?s[Xi]=nw[`${Xi}_${t}`](...Object.values(s[Xi])):Object.keys(s).forEach(E=>{s[E]=Object.keys(s[E]).map(_=>s[E][_]).reduce((_,k)=>_===void 0?k:nw[`${l[E]}_${t}`](_,k))}),o=Object.keys(a),n&&o.length){const E=r?Jue:Zue;s[E]=t===wM?{[bM]:o.reduce((_,k)=>(_.push(...a[k]),_),[])}:{[ece]:o.map(_=>({[bM]:a[_]}))}}return s}var nw={[`${Xi}_union`]:oY,[`${Xi}_intersect`]:rY,E_union:function(e,t){if(!e.length)return t;for(var n=0,r=t.length;n<r;++n)e.indexOf(t[n])<0&&e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter(n=>t.indexOf(n)>=0):t},R_union:function(e,t){var n=hn(t[0]),r=hn(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<r&&(e[1]=r),e):[n,r]},R_intersect:function(e,t){var n=hn(t[0]),r=hn(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?r<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>r&&(e[1]=r),e):[n,r]}};const dce=":",hce="@";function n$(e,t,n,r){t[0].type!==Yl&&I("First argument to selection functions must be a string literal.");const i=t[0].value,o=t.length>=2&&Ce(t).value,s="unit",a=hce+s,l=dce+i;o===t$&&!te(r,a)&&(r[a]=n.getData(i).indataRef(n,s)),te(r,l)||(r[l]=n.getData(i).tuplesRef())}function dI(e){const t=this.context.data[e];return t?t.values.value:[]}function pce(e,t,n){const r=this.context.data[e]["index:"+t],i=r?r.value.get(n):void 0;return i&&i.count}function gce(e,t){const n=this.context.dataflow,r=this.context.data[e],i=r.input;return n.pulse(i,n.changeset().remove(Gr).insert(t)),1}function mce(e,t,n){if(e){const r=this.context.dataflow,i=e.mark.source;r.pulse(i,r.changeset().encode(e,t))}return n!==void 0?n:e}const Yp=e=>function(t,n){const r=this.context.dataflow.locale();return t===null?"null":r[e](n)(t)},yce=Yp("format"),hI=Yp("timeFormat"),vce=Yp("utcFormat"),xce=Yp("timeParse"),wce=Yp("utcParse"),t0=new Date(2e3,0,1);function $v(e,t,n){return!Number.isInteger(e)||!Number.isInteger(t)?"":(t0.setYear(2e3),t0.setMonth(e),t0.setDate(t),hI.call(this,t0,n))}function bce(e){return $v.call(this,e,1,"%B")}function Ece(e){return $v.call(this,e,1,"%b")}function Sce(e){return $v.call(this,0,2+e,"%A")}function _ce(e){return $v.call(this,0,2+e,"%a")}const kce=":",Cce="@",JE="%",pI="$";function r$(e,t,n,r){t[0].type!==Yl&&I("First argument to data functions must be a string literal.");const i=t[0].value,o=kce+i;if(!te(o,r))try{r[o]=n.getData(i).tuplesRef()}catch{}}function $ce(e,t,n,r){t[0].type!==Yl&&I("First argument to indata must be a string literal."),t[1].type!==Yl&&I("Second argument to indata must be a string literal.");const i=t[0].value,o=t[1].value,s=Cce+o;te(s,r)||(r[s]=n.getData(i).indataRef(n,o))}function On(e,t,n,r){if(t[0].type===Yl)SM(n,r,t[0].value);else for(e in n.scales)SM(n,r,e)}function SM(e,t,n){const r=JE+n;if(!te(t,r))try{t[r]=e.scaleRef(n)}catch{}}function Co(e,t){if(me(e))return e;if(ee(e)){const n=t.scales[e];return n&&zJ(n.value)?n.value:void 0}}function Ace(e,t,n){t.__bandwidth=i=>i&&i.bandwidth?i.bandwidth():0,n._bandwidth=On,n._range=On,n._scale=On;const r=i=>"_["+(i.type===Yl?Y(JE+i.value):Y(JE)+"+"+e(i))+"]";return{_bandwidth:i=>`this.__bandwidth(${r(i[0])})`,_range:i=>`${r(i[0])}.range()`,_scale:i=>`${r(i[0])}(${e(i[1])})`}}function i$(e,t){return function(n,r,i){if(n){const o=Co(n,(i||this).context);return o&&o.path[e](r)}else return t(r)}}const Fce=i$("area",Jre),Mce=i$("bounds",rie),Tce=i$("centroid",uie);function Nce(e,t){const n=Co(e,(t||this).context);return n&&n.scale()}function Rce(e){const t=this.context.group;let n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n}function o$(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(r){e.warn(r)}return n[n.length-1]}function Dce(){return o$(this.context.dataflow,"warn",arguments)}function Oce(){return o$(this.context.dataflow,"info",arguments)}function Pce(){return o$(this.context.dataflow,"debug",arguments)}function rw(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function eS(e){const t=xa(e),n=rw(t.r),r=rw(t.g),i=rw(t.b);return .2126*n+.7152*r+.0722*i}function Lce(e,t){const n=eS(e),r=eS(t),i=Math.max(n,r),o=Math.min(n,r);return(i+.05)/(o+.05)}function zce(){const e=[].slice.call(arguments);return e.unshift({}),ge(...e)}function gI(e,t){return e===t||e!==e&&t!==t?!0:j(e)?j(t)&&e.length===t.length?Ice(e,t):!1:Z(e)&&Z(t)?mI(e,t):!1}function Ice(e,t){for(let n=0,r=e.length;n<r;++n)if(!gI(e[n],t[n]))return!1;return!0}function mI(e,t){for(const n in e)if(!gI(e[n],t[n]))return!1;return!0}function _M(e){return t=>mI(e,t)}function jce(e,t,n,r,i,o){const s=this.context.dataflow,a=this.context.data[e],l=a.input,u=s.stamp();let c=a.changes,f,d;if(s._trigger===!1||!(l.value.length||t||r))return 0;if((!c||c.stamp<u)&&(a.changes=c=s.changeset(),c.stamp=u,s.runAfter(()=>{a.modified=!0,s.pulse(l,c).run()},!0,1)),n&&(f=n===!0?Gr:j(n)||Py(n)?n:_M(n),c.remove(f)),t&&c.insert(t),r&&(f=_M(r),l.value.some(f)?c.remove(f):c.insert(r)),i)for(d in o)c.modify(i,d,o[d]);return 1}function Bce(e){const t=e.touches,n=t[0].clientX-t[1].clientX,r=t[0].clientY-t[1].clientY;return Math.hypot(n,r)}function Uce(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)}const kM={};function Wce(e,t){const n=kM[t]||(kM[t]=Vr(t));return j(e)?e.map(n):n(e)}function s$(e){return j(e)||ArrayBuffer.isView(e)?e:null}function a$(e){return s$(e)||(ee(e)?e:null)}function qce(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return s$(e).join(...n)}function Hce(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return a$(e).indexOf(...n)}function Vce(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return a$(e).lastIndexOf(...n)}function Gce(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return a$(e).slice(...n)}function Yce(e,t,n){return me(n)&&I("Function argument passed to replace."),String(e).replace(t,n)}function Xce(e){return s$(e).slice().reverse()}function Qce(e,t,n){return xC(e||0,t||0,n||0)}function Kce(e,t){const n=Co(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}function Zce(e,t){const n=Co(e,(t||this).context);return n?n.copy():void 0}function Jce(e,t){const n=Co(e,(t||this).context);return n?n.domain():[]}function efe(e,t,n){const r=Co(e,(n||this).context);return r?j(t)?(r.invertRange||r.invert)(t):(r.invert||r.invertExtent)(t):void 0}function tfe(e,t){const n=Co(e,(t||this).context);return n&&n.range?n.range():[]}function nfe(e,t,n){const r=Co(e,(n||this).context);return r?r(t):void 0}function rfe(e,t,n,r,i){e=Co(e,(i||this).context);const o=sP(t,n);let s=e.domain(),a=s[0],l=Ce(s),u=wn;return l-a?u=YO(e,a,l):e=(e.interpolator?Ne("sequential")().interpolator(e.interpolator()):Ne("linear")().interpolate(e.interpolate()).range(e.range())).domain([a=0,l=1]),e.ticks&&(s=e.ticks(+r||15),a!==s[0]&&s.unshift(a),l!==Ce(s)&&s.push(l)),s.forEach(c=>o.stop(u(c),e(c))),o}function ife(e,t,n){const r=Co(e,(n||this).context);return function(i){return r?r.path.context(i)(t):""}}function ofe(e){let t=null;return function(n){return n?Gh(n,t=t||Uc(e)):e}}const yI=e=>e.data;function vI(e,t){const n=dI.call(t,e);return n.root&&n.root.lookup||{}}function sfe(e,t,n){const r=vI(e,this),i=r[t],o=r[n];return i&&o?i.path(o).map(yI):void 0}function afe(e,t){const n=vI(e,this)[t];return n?n.ancestors().map(yI):void 0}const xI=()=>typeof window<"u"&&window||null;function lfe(){const e=xI();return e?e.screen:{}}function ufe(){const e=xI();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]}function cfe(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]}function wI(e,t,n){if(!e)return[];const[r,i]=e,o=new vt().set(r[0],r[1],i[0],i[1]),s=n||this.context.dataflow.scenegraph().root;return rL(s,o,ffe(t))}function ffe(e){let t=null;if(e){const n=J(e.marktype),r=J(e.markname);t=i=>(!n.length||n.some(o=>i.marktype===o))&&(!r.length||r.some(o=>i.name===o))}return t}function dfe(e,t,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:5;e=J(e);const i=e[e.length-1];return i===void 0||Math.hypot(i[0]-t,i[1]-n)>r?[...e,[t,n]]:e}function hfe(e){return J(e).reduce((t,n,r)=>{let[i,o]=n;return t+=r==0?`M ${i},${o} `:r===e.length-1?" Z":`L ${i},${o} `},"")}function pfe(e,t,n){const{x:r,y:i,mark:o}=n,s=new vt().set(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER);for(const[l,u]of t)l<s.x1&&(s.x1=l),l>s.x2&&(s.x2=l),u<s.y1&&(s.y1=u),u>s.y2&&(s.y2=u);return s.translate(r,i),wI([[s.x1,s.y1],[s.x2,s.y2]],e,o).filter(l=>gfe(l.x,l.y,t))}function gfe(e,t,n){let r=0;for(let i=0,o=n.length-1;i<n.length;o=i++){const[s,a]=n[o],[l,u]=n[i];u>t!=a>t&&e<(s-l)*(t-u)/(a-u)+l&&r++}return r&1}const ip={random(){return Xr()},cumulativeNormal:By,cumulativeLogNormal:xk,cumulativeUniform:Sk,densityNormal:pk,densityLogNormal:vk,densityUniform:Ek,quantileNormal:Uy,quantileLogNormal:wk,quantileUniform:_k,sampleNormal:jy,sampleLogNormal:yk,sampleUniform:bk,isArray:j,isBoolean:Da,isDate:aa,isDefined(e){return e!==void 0},isNumber:Me,isObject:Z,isRegExp:$R,isString:ee,isTuple:Py,isValid(e){return e!=null&&e===e},toBoolean:G_,toDate(e){return Y_(e)},toNumber:hn,toString:X_,indexof:Hce,join:qce,lastindexof:Vce,replace:Yce,reverse:Xce,slice:Gce,flush:kR,lerp:AR,merge:zce,pad:TR,peek:Ce,pluck:Wce,span:bp,inrange:nc,truncate:NR,rgb:xa,lab:Hm,hcl:Vm,hsl:Wm,luminance:eS,contrast:Lce,sequence:mr,format:yce,utcFormat:vce,utcParse:wce,utcOffset:fD,utcSequence:pD,timeFormat:hI,timeParse:xce,timeOffset:cD,timeSequence:hD,timeUnitSpecifier:JR,monthFormat:bce,monthAbbrevFormat:Ece,dayFormat:Sce,dayAbbrevFormat:_ce,quarter:bR,utcquarter:ER,week:tD,utcweek:iD,dayofyear:eD,utcdayofyear:rD,warn:Dce,info:Oce,debug:Pce,extent(e){return co(e)},inScope:Rce,intersect:wI,clampRange:SR,pinchDistance:Bce,pinchAngle:Uce,screen:lfe,containerSize:cfe,windowSize:ufe,bandspace:Qce,setdata:gce,pathShape:ofe,panLinear:yR,panLog:vR,panPow:xR,panSymlog:wR,zoomLinear:B_,zoomLog:U_,zoomPow:Mm,zoomSymlog:W_,encode:mce,modify:jce,lassoAppend:dfe,lassoPath:hfe,intersectLasso:pfe},mfe=["view","item","group","xy","x","y"],yfe="event.vega.",bI="this.",l$={},EI={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>`_[${Y(pI+e)}]`,functions:vfe,constants:aI,visitors:l$},tS=uI(EI);function vfe(e){const t=lI(e);mfe.forEach(n=>t[n]=yfe+n);for(const n in ip)t[n]=bI+n;return ge(t,Ace(e,ip,l$)),t}function mt(e,t,n){return arguments.length===1?ip[e]:(ip[e]=t,n&&(l$[e]=n),tS&&(tS.functions[e]=bI+e),this)}mt("bandwidth",Kce,On);mt("copy",Zce,On);mt("domain",Jce,On);mt("range",tfe,On);mt("invert",efe,On);mt("scale",nfe,On);mt("gradient",rfe,On);mt("geoArea",Fce,On);mt("geoBounds",Mce,On);mt("geoCentroid",Tce,On);mt("geoShape",ife,On);mt("geoScale",Nce,On);mt("indata",pce,$ce);mt("data",dI,r$);mt("treePath",sfe,r$);mt("treeAncestors",afe,r$);mt("vlSelectionTest",sce,n$);mt("vlSelectionIdTest",uce,n$);mt("vlSelectionResolve",fce,n$);mt("vlSelectionTuples",cce);function mo(e,t){const n={};let r;try{e=ee(e)?e:Y(e)+"",r=e$(e)}catch{I("Expression parse error: "+e)}r.visit(o=>{if(o.type!==eI)return;const s=o.callee.name,a=EI.visitors[s];a&&a(s,o.arguments,t,n)});const i=tS(r);return i.globals.forEach(o=>{const s=pI+o;!te(n,s)&&t.getSignal(o)&&(n[s]=t.signalRef(o))}),{$expr:ge({code:i.code},t.options.ast?{ast:r}:null),$fields:i.fields,$params:n}}function xfe(e){const t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach(r=>t.parseOperator(r)),n.forEach(r=>t.parseOperatorParameters(r)),(e.streams||[]).forEach(r=>t.parseStream(r)),(e.updates||[]).forEach(r=>t.parseUpdate(r)),t.resolve()}const wfe=ki(["rule"]),CM=ki(["group","image","rect"]);function bfe(e,t){let n="";return wfe[t]||(e.x2&&(e.x?(CM[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(CM[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}function u$(e){return(e+"").toLowerCase()}function Efe(e){return u$(e)==="operator"}function Sfe(e){return u$(e)==="collect"}function dd(e,t,n){n.endsWith(";")||(n="return("+n+");");const r=Function(...t.concat(n));return e&&e.functions?r.bind(e.functions):r}function _fe(e,t,n,r){return`((u = ${e}) < (v = ${t}) || u == null) && v != null ? ${n}
  : (u > v || v == null) && u != null ? ${r}
  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${n}
  : v !== v && u === u ? ${r} : `}var kfe={operator:(e,t)=>dd(e,["_"],t.code),parameter:(e,t)=>dd(e,["datum","_"],t.code),event:(e,t)=>dd(e,["event"],t.code),handler:(e,t)=>{const n=`var datum=event.item&&event.item.datum;return ${t.code};`;return dd(e,["_","event"],n)},encode:(e,t)=>{const{marktype:n,channels:r}=t;let i="var o=item,datum=o.datum,m=0,$;";for(const o in r){const s="o["+Y(o)+"]";i+=`$=${r[o].code};if(${s}!==$)${s}=$,m=1;`}return i+=bfe(r,n),i+="return m;",dd(e,["item","_"],i)},codegen:{get(e){const t=`[${e.map(Y).join("][")}]`,n=Function("_",`return _${t};`);return n.path=t,n},comparator(e,t){let n;const r=(o,s)=>{const a=t[s];let l,u;return o.path?(l=`a${o.path}`,u=`b${o.path}`):((n=n||{})["f"+s]=o,l=`this.f${s}(a)`,u=`this.f${s}(b)`),_fe(l,u,-a,a)},i=Function("a","b","var u, v; return "+e.map(r).join("")+"0;");return n?i.bind(n):i}}};function Cfe(e){const t=this;Efe(e.type)||!e.type?t.operator(e,e.update?t.operatorExpression(e.update):null):t.transform(e,e.type)}function $fe(e){const t=this;if(e.params){const n=t.get(e.id);n||I("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}}function Afe(e,t){t=t||{};const n=this;for(const r in e){const i=e[r];t[r]=j(i)?i.map(o=>$M(o,n,t)):$M(i,n,t)}return t}function $M(e,t,n){if(!e||!Z(e))return e;for(let r=0,i=AM.length,o;r<i;++r)if(o=AM[r],te(e,o.key))return o.parse(e,t,n);return e}var AM=[{key:"$ref",parse:Ffe},{key:"$key",parse:Tfe},{key:"$expr",parse:Mfe},{key:"$field",parse:Nfe},{key:"$encode",parse:Dfe},{key:"$compare",parse:Rfe},{key:"$context",parse:Ofe},{key:"$subflow",parse:Pfe},{key:"$tupleid",parse:Lfe}];function Ffe(e,t){return t.get(e.$ref)||I("Operator not defined: "+e.$ref)}function Mfe(e,t,n){e.$params&&t.parseParameters(e.$params,n);const r="e:"+e.$expr.code;return t.fn[r]||(t.fn[r]=ar(t.parameterExpression(e.$expr),e.$fields))}function Tfe(e,t){const n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=V_(e.$key,e.$flat,t.expr.codegen))}function Nfe(e,t){if(!e.$field)return null;const n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=Vr(e.$field,e.$name,t.expr.codegen))}function Rfe(e,t){const n="c:"+e.$compare+"_"+e.$order,r=J(e.$compare).map(i=>i&&i.$tupleid?le:i);return t.fn[n]||(t.fn[n]=q_(r,e.$order,t.expr.codegen))}function Dfe(e,t){const n=e.$encode,r={};for(const i in n){const o=n[i];r[i]=ar(t.encodeExpression(o.$expr),o.$fields),r[i].output=o.$output}return r}function Ofe(e,t){return t}function Pfe(e,t){const n=e.$subflow;return function(r,i,o){const s=t.fork().parse(n),a=s.get(n.operators[0].id),l=s.signals.parent;return l&&l.set(o),a.detachSubflow=()=>t.detach(s),a}}function Lfe(){return le}function zfe(e){var t=this,n=e.filter!=null?t.eventExpression(e.filter):void 0,r=e.stream!=null?t.get(e.stream):void 0,i;e.source?r=t.events(e.source,e.type,n):e.merge&&(i=e.merge.map(o=>t.get(o)),r=i[0].merge.apply(i[0],i.slice(1))),e.between&&(i=e.between.map(o=>t.get(o)),r=r.between(i[0],i[1])),e.filter&&(r=r.filter(n)),e.throttle!=null&&(r=r.throttle(+e.throttle)),e.debounce!=null&&(r=r.debounce(+e.debounce)),r==null&&I("Invalid stream definition: "+JSON.stringify(e)),e.consume&&r.consume(!0),t.stream(e,r)}function Ife(e){var t=this,n=Z(n=e.source)?n.$ref:n,r=t.get(n),i=null,o=e.update,s=void 0;r||I("Source not defined: "+e.source),i=e.target&&e.target.$expr?t.eventExpression(e.target.$expr):t.get(e.target),o&&o.$expr&&(o.$params&&(s=t.parseParameters(o.$params)),o=t.handlerExpression(o.$expr)),t.update(e,r,i,o,s)}const jfe={skip:!0};function Bfe(e){var t=this,n={};if(e.signals){var r=n.signals={};Object.keys(t.signals).forEach(o=>{const s=t.signals[o];e.signals(o,s)&&(r[o]=s.value)})}if(e.data){var i=n.data={};Object.keys(t.data).forEach(o=>{const s=t.data[o];e.data(o,s)&&(i[o]=s.input.value)})}return t.subcontext&&e.recurse!==!1&&(n.subcontext=t.subcontext.map(o=>o.getState(e))),n}function Ufe(e){var t=this,n=t.dataflow,r=e.data,i=e.signals;Object.keys(i||{}).forEach(o=>{n.update(t.signals[o],i[o],jfe)}),Object.keys(r||{}).forEach(o=>{n.pulse(t.data[o].input,n.changeset().remove(Gr).insert(r[o]))}),(e.subcontext||[]).forEach((o,s)=>{const a=t.subcontext[s];a&&a.setState(o)})}function SI(e,t,n,r){return new _I(e,t,n,r)}function _I(e,t,n,r){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=r||kfe,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function FM(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}_I.prototype=FM.prototype={fork(){const e=new FM(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(e){this.subcontext=this.subcontext.filter(n=>n!==e);const t=Object.keys(e.nodes);for(const n of t)e.nodes[n]._targets=null;for(const n of t)e.nodes[n].detach();e.nodes=null},get(e){return this.nodes[e]},set(e,t){return this.nodes[e]=t},add(e,t){const n=this,r=n.dataflow,i=e.value;if(n.set(e.id,t),Sfe(e.type)&&i&&(i.$ingest?r.ingest(t,i.$ingest,i.$format):i.$request?r.preload(t,i.$request,i.$format):r.pulse(t,r.changeset().insert(i))),e.root&&(n.root=t),e.parent){let o=n.get(e.parent.$ref);o?(r.connect(o,[t]),t.targets().add(o)):(n.unresolved=n.unresolved||[]).push(()=>{o=n.get(e.parent.$ref),r.connect(o,[t]),t.targets().add(o)})}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(const o in e.data){const s=n.data[o]||(n.data[o]={});e.data[o].forEach(a=>s[a]=t)}},resolve(){return(this.unresolved||[]).forEach(e=>e()),delete this.unresolved,this},operator(e,t){this.add(e,this.dataflow.add(e.value,t))},transform(e,t){this.add(e,this.dataflow.add(this.transforms[u$(t)]))},stream(e,t){this.set(e.id,t)},update(e,t,n,r,i){this.dataflow.on(t,n,r,i,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:xfe,parseOperator:Cfe,parseOperatorParameters:$fe,parseParameters:Afe,parseStream:zfe,parseUpdate:Ife,getState:Bfe,setState:Ufe};function Wfe(e){const t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),kI(t,e.description()))}function kI(e,t){e&&(t==null?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}function qfe(e){e.add(null,t=>(e._background=t.bg,e._resize=1,t.bg),{bg:e._signals.background})}const iw="default";function Hfe(e){const t=e._signals.cursor||(e._signals.cursor=e.add({user:iw,item:null}));e.on(e.events("view","pointermove"),t,(n,r)=>{const i=t.value,o=i?ee(i)?i:i.user:iw,s=r.item&&r.item.cursor||null;return i&&o===i.user&&s==i.item?i:{user:o,item:s}}),e.add(null,function(n){let r=n.cursor,i=this.value;return ee(r)||(i=r.item,r=r.user),nS(e,r&&r!==iw?r:i||r),i},{cursor:t})}function nS(e,t){const n=e.globalCursor()?typeof document<"u"&&document.body:e.container();if(n)return t==null?n.style.removeProperty("cursor"):n.style.cursor=t}function j1(e,t){var n=e._runtime.data;return te(n,t)||I("Unrecognized data set: "+t),n[t]}function Vfe(e,t){return arguments.length<2?j1(this,e).values.value:Av.call(this,e,du().remove(Gr).insert(t))}function Av(e,t){BD(t)||I("Second argument to changes must be a changeset.");const n=j1(this,e);return n.modified=!0,this.pulse(n.input,t)}function Gfe(e,t){return Av.call(this,e,du().insert(t))}function Yfe(e,t){return Av.call(this,e,du().remove(t))}function CI(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function $I(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function Fv(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function Xfe(e){var t=Fv(e),n=CI(e),r=$I(e);e._renderer.background(e.background()),e._renderer.resize(n,r,t),e._handler.origin(t),e._resizeListeners.forEach(i=>{try{i(n,r)}catch(o){e.error(o)}})}function Qfe(e,t,n){var r=e._renderer,i=r&&r.canvas(),o,s,a;return i&&(a=Fv(e),s=t.changedTouches?t.changedTouches[0]:t,o=gv(s,i),o[0]-=a[0],o[1]-=a[1]),t.dataflow=e,t.item=n,t.vega=Kfe(e,n,o),t}function Kfe(e,t,n){const r=t?t.mark.marktype==="group"?t:t.mark.group:null;function i(s){var a=r,l;if(s){for(l=t;l;l=l.mark.group)if(l.mark.name===s){a=l;break}}return a&&a.mark&&a.mark.interactive?a:{}}function o(s){if(!s)return n;ee(s)&&(s=i(s));const a=n.slice();for(;s;)a[0]-=s.x||0,a[1]-=s.y||0,s=s.mark&&s.mark.group;return a}return{view:bn(e),item:bn(t||{}),group:i,xy:o,x:s=>o(s)[0],y:s=>o(s)[1]}}const MM="view",Zfe="timer",Jfe="window",ede={trap:!1};function tde(e){const t=ge({defaults:{}},e),n=(r,i)=>{i.forEach(o=>{j(r[o])&&(r[o]=ki(r[o]))})};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}function AI(e,t,n,r){e._eventListeners.push({type:n,sources:J(t),handler:r})}function nde(e,t){var n=e._eventConfig.defaults,r=n.prevent,i=n.allow;return r===!1||i===!0?!1:r===!0||i===!1?!0:r?r[t]:i?!i[t]:e.preventDefault()}function n0(e,t,n){const r=e._eventConfig&&e._eventConfig[t];return r===!1||Z(r)&&!r[n]?(e.warn(`Blocked ${t} ${n} event listener.`),!1):!0}function rde(e,t,n){var r=this,i=new Iy(n),o=function(u,c){r.runAsync(null,()=>{e===MM&&nde(r,t)&&u.preventDefault(),i.receive(Qfe(r,u,c))})},s;if(e===Zfe)n0(r,"timer",t)&&r.timer(o,t);else if(e===MM)n0(r,"view",t)&&r.addEventListener(t,o,ede);else if(e===Jfe?n0(r,"window",t)&&typeof window<"u"&&(s=[window]):typeof document<"u"&&n0(r,"selector",t)&&(s=Array.from(document.querySelectorAll(e))),!s)r.warn("Can not resolve event source: "+e);else{for(var a=0,l=s.length;a<l;++a)s[a].addEventListener(t,o);AI(r,s,t,o)}return i}function TM(e){return e.item}function NM(e){return e.item.mark.source}function RM(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function ide(e,t){return e=[e||"hover"],t=[t||"update",e[0]],this.on(this.events("view","pointerover",TM),NM,RM(e)),this.on(this.events("view","pointerout",TM),NM,RM(t)),this}function ode(){var e=this._tooltip,t=this._timers,n=this._handler.handlers(),r=this._eventListeners,i,o,s,a,l;for(i=t.length;--i>=0;)t[i].stop();for(i=r.length;--i>=0;)for(s=r[i],o=s.sources.length;--o>=0;)s.sources[o].removeEventListener(s.type,s.handler);for(e&&e.call(this,this._handler,null,null,null),i=n.length;--i>=0;)l=n[i].type,a=n[i].handler,this._handler.off(l,a);return this}function wr(e,t,n){const r=document.createElement(e);for(const i in t)r.setAttribute(i,t[i]);return n!=null&&(r.textContent=n),r}const sde="vega-bind",ade="vega-bind-name",lde="vega-bind-radio";function ude(e,t,n){if(!t)return;const r=n.param;let i=n.state;return i||(i=n.state={elements:null,active:!1,set:null,update:s=>{s!=e.signal(r.signal)&&e.runAsync(null,()=>{i.source=!0,e.signal(r.signal,s)})}},r.debounce&&(i.update=H_(r.debounce,i.update))),(r.input==null&&r.element?cde:dde)(i,t,r,e),i.active||(e.on(e._signals[r.signal],null,()=>{i.source?i.source=!1:i.set(e.signal(r.signal))}),i.active=!0),i}function cde(e,t,n,r){const i=n.event||"input",o=()=>e.update(t.value);r.signal(n.signal,t.value),t.addEventListener(i,o),AI(r,t,i,o),e.set=s=>{t.value=s,t.dispatchEvent(fde(i))}}function fde(e){return typeof Event<"u"?new Event(e):{type:e}}function dde(e,t,n,r){const i=r.signal(n.signal),o=wr("div",{class:sde}),s=n.input==="radio"?o:o.appendChild(wr("label"));s.appendChild(wr("span",{class:ade},n.name||n.signal)),t.appendChild(o);let a=hde;switch(n.input){case"checkbox":a=pde;break;case"select":a=gde;break;case"radio":a=mde;break;case"range":a=yde;break}a(e,s,n,i)}function hde(e,t,n,r){const i=wr("input");for(const o in n)o!=="signal"&&o!=="element"&&i.setAttribute(o==="input"?"type":o,n[o]);i.setAttribute("name",n.signal),i.value=r,t.appendChild(i),i.addEventListener("input",()=>e.update(i.value)),e.elements=[i],e.set=o=>i.value=o}function pde(e,t,n,r){const i={type:"checkbox",name:n.signal};r&&(i.checked=!0);const o=wr("input",i);t.appendChild(o),o.addEventListener("change",()=>e.update(o.checked)),e.elements=[o],e.set=s=>o.checked=!!s||null}function gde(e,t,n,r){const i=wr("select",{name:n.signal}),o=n.labels||[];n.options.forEach((s,a)=>{const l={value:s};B1(s,r)&&(l.selected=!0),i.appendChild(wr("option",l,(o[a]||s)+""))}),t.appendChild(i),i.addEventListener("change",()=>{e.update(n.options[i.selectedIndex])}),e.elements=[i],e.set=s=>{for(let a=0,l=n.options.length;a<l;++a)if(B1(n.options[a],s)){i.selectedIndex=a;return}}}function mde(e,t,n,r){const i=wr("span",{class:lde}),o=n.labels||[];t.appendChild(i),e.elements=n.options.map((s,a)=>{const l={type:"radio",name:n.signal,value:s};B1(s,r)&&(l.checked=!0);const u=wr("input",l);u.addEventListener("change",()=>e.update(s));const c=wr("label",{},(o[a]||s)+"");return c.prepend(u),i.appendChild(c),u}),e.set=s=>{const a=e.elements,l=a.length;for(let u=0;u<l;++u)B1(a[u].value,s)&&(a[u].checked=!0)}}function yde(e,t,n,r){r=r!==void 0?r:(+n.max+ +n.min)/2;const i=n.max!=null?n.max:Math.max(100,+r)||100,o=n.min||Math.min(0,i,+r)||0,s=n.step||ma(o,i,100),a=wr("input",{type:"range",name:n.signal,min:o,max:i,step:s});a.value=r;const l=wr("span",{},+r);t.appendChild(a),t.appendChild(l);const u=()=>{l.textContent=a.value,e.update(+a.value)};a.addEventListener("input",u),a.addEventListener("change",u),e.elements=[a],e.set=c=>{a.value=c,l.textContent=c}}function B1(e,t){return e===t||e+""==t+""}function FI(e,t,n,r,i,o){return t=t||new r(e.loader()),t.initialize(n,CI(e),$I(e),Fv(e),i,o).background(e.background())}function c$(e,t){return t?function(){try{t.apply(this,arguments)}catch(n){e.error(n)}}:null}function vde(e,t,n,r){const i=new r(e.loader(),c$(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,Fv(e),e);return t&&t.handlers().forEach(o=>{i.on(o.type,o.handler)}),i}function xde(e,t){const n=this,r=n._renderType,i=n._eventConfig.bind,o=mv(r);e=n._el=e?ow(n,e,!0):null,Wfe(n),o||n.error("Unrecognized renderer type: "+r);const s=o.handler||jp,a=e?o.renderer:o.headless;return n._renderer=a?FI(n,n._renderer,e,a):null,n._handler=vde(n,n._handler,e,s),n._redraw=!0,e&&i!=="none"&&(t=t?n._elBind=ow(n,t,!0):e.appendChild(wr("form",{class:"vega-bindings"})),n._bind.forEach(l=>{l.param.element&&i!=="container"&&(l.element=ow(n,l.param.element,!!l.param.input))}),n._bind.forEach(l=>{ude(n,l.element||t,l)})),n}function ow(e,t,n){if(typeof t=="string")if(typeof document<"u"){if(t=document.querySelector(t),!t)return e.error("Signal bind element not found: "+t),null}else return e.error("DOM document instance not found."),null;if(t&&n)try{t.textContent=""}catch(r){t=null,e.error(r)}return t}const hd=e=>+e||0,wde=e=>({top:e,bottom:e,left:e,right:e});function DM(e){return Z(e)?{top:hd(e.top),bottom:hd(e.bottom),left:hd(e.left),right:hd(e.right)}:wde(hd(e))}async function f$(e,t,n,r){const i=mv(t),o=i&&i.headless;return o||I("Unrecognized renderer type: "+t),await e.runAsync(),FI(e,null,null,o,n,r).renderAsync(e._scenegraph.root)}async function bde(e,t){e!==Gs.Canvas&&e!==Gs.SVG&&e!==Gs.PNG&&I("Unrecognized image type: "+e);const n=await f$(this,e,t);return e===Gs.SVG?Ede(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")}function Ede(e,t){const n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}async function Sde(e,t){return(await f$(this,Gs.Canvas,e,t)).canvas()}async function _de(e){return(await f$(this,Gs.SVG,e)).svg()}function kde(e,t,n){return SI(e,Pc,ip,n).parse(t)}function Cde(e){var t=this._runtime.scales;return te(t,e)||I("Unrecognized scale or projection: "+e),t[e].value}var MI="width",TI="height",d$="padding",OM={skip:!0};function NI(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===d$?r.left+r.right:0)}function RI(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===d$?r.top+r.bottom:0)}function $de(e){var t=e._signals,n=t[MI],r=t[TI],i=t[d$];function o(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,a=>{e._width=a.size,e._viewWidth=NI(e,a.size),o()},{size:n}),e._resizeHeight=e.add(null,a=>{e._height=a.size,e._viewHeight=RI(e,a.size),o()},{size:r});const s=e.add(null,o,{pad:i});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=r.rank+1,s.rank=i.rank+1}function Ade(e,t,n,r,i,o){this.runAfter(s=>{let a=0;s._autosize=0,s.width()!==n&&(a=1,s.signal(MI,n,OM),s._resizeWidth.skip(!0)),s.height()!==r&&(a=1,s.signal(TI,r,OM),s._resizeHeight.skip(!0)),s._viewWidth!==e&&(s._resize=1,s._viewWidth=e),s._viewHeight!==t&&(s._resize=1,s._viewHeight=t),(s._origin[0]!==i[0]||s._origin[1]!==i[1])&&(s._resize=1,s._origin=i),a&&s.run("enter"),o&&s.runAfter(l=>l.resize())},!1,1)}function Fde(e){return this._runtime.getState(e||{data:Mde,signals:Tde,recurse:!0})}function Mde(e,t){return t.modified&&j(t.input.value)&&!e.startsWith("_:vega:_")}function Tde(e,t){return!(e==="parent"||t instanceof Pc.proxy)}function Nde(e){return this.runAsync(null,t=>{t._trigger=!1,t._runtime.setState(e)},t=>{t._trigger=!0}),this}function Rde(e,t){function n(r){e({timestamp:Date.now(),elapsed:r})}this._timers.push(cse(n,t))}function Dde(e,t,n,r){const i=e.element();i&&i.setAttribute("title",Ode(r))}function Ode(e){return e==null?"":j(e)?DI(e):Z(e)&&!aa(e)?Pde(e):e+""}function Pde(e){return Object.keys(e).map(t=>{const n=e[t];return t+": "+(j(n)?DI(n):OI(n))}).join(`
`)}function DI(e){return"["+e.map(OI).join(", ")+"]"}function OI(e){return j(e)?"[…]":Z(e)&&!aa(e)?"{…}":e}function Lde(){if(this.renderer()==="canvas"&&this._renderer._canvas){let e=null;const t=()=>{e!=null&&e();const n=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`);n.addEventListener("change",t),e=()=>{n.removeEventListener("change",t)},this._renderer._canvas.getContext("2d").pixelRatio=window.devicePixelRatio||1,this._redraw=!0,this._resize=1,this.resize().runAsync()};t()}}function PI(e,t){const n=this;if(t=t||{},pc.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),t.logLevel!=null&&n.logLevel(t.logLevel),t.locale||e.locale){const o=ge({},e.locale,t.locale);n.locale(TD(o.number,o.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||Gs.Canvas,n._scenegraph=new MP;const r=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||Dde,n._redraw=!0,n._handler=new jp().scene(r),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=tde(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const i=kde(n,e,t.expr);n._runtime=i,n._signals=i.signals,n._bind=(e.bindings||[]).map(o=>({state:null,param:ge({},o)})),i.root&&i.root.set(r),r.source=i.data.root.input,n.pulse(i.data.root.input,n.changeset().insert(r.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=NI(n,n._width),n._viewHeight=RI(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,$de(n),qfe(n),Hfe(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind),t.watchPixelRatio&&n._watchPixelRatio()}function r0(e,t){return te(e._signals,t)?e._signals[t]:I("Unrecognized signal name: "+Y(t))}function LI(e,t){const n=(e._targets||[]).filter(r=>r._update&&r._update.handler===t);return n.length?n[0]:null}function PM(e,t,n,r){let i=LI(n,r);return i||(i=c$(e,()=>r(t,n.value)),i.handler=r,e.on(n,null,i)),e}function LM(e,t,n){const r=LI(t,n);return r&&t._targets.remove(r),e}X(PI,pc,{async evaluate(e,t,n){if(await pc.prototype.evaluate.call(this,e,t),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,Xfe(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(r){this.error(r)}return n&&N0(this,n),this},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description(e){if(arguments.length){const t=e!=null?e+"":null;return t!==this._desc&&kI(this._el,this._desc=t),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(e,t,n){const r=r0(this,e);return arguments.length===1?r.value:this.update(r,t,n)},width(e){return arguments.length?this.signal("width",e):this.signal("width")},height(e){return arguments.length?this.signal("height",e):this.signal("height")},padding(e){return arguments.length?this.signal("padding",DM(e)):DM(this.signal("padding"))},autosize(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer(e){return arguments.length?(mv(e)||I("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader(e){return arguments.length?(e!==this._loader&&(pc.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(r0(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:Ade,addEventListener(e,t,n){let r=t;return n&&n.trap===!1||(r=c$(this,t),r.raw=t),this._handler.on(e,r),this},removeEventListener(e,t){for(var n=this._handler.handlers(e),r=n.length,i,o;--r>=0;)if(o=n[r].type,i=n[r].handler,e===o&&(t===i||t===i.raw)){this._handler.off(o,i);break}return this},addResizeListener(e){const t=this._resizeListeners;return t.includes(e)||t.push(e),this},removeResizeListener(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener(e,t){return PM(this,e,r0(this,e),t)},removeSignalListener(e,t){return LM(this,r0(this,e),t)},addDataListener(e,t){return PM(this,e,j1(this,e).values,t)},removeDataListener(e,t){return LM(this,j1(this,e).values,t)},globalCursor(e){if(arguments.length){if(this._globalCursor!==!!e){const t=nS(this,null);this._globalCursor=!!e,t&&nS(this,t)}return this}else return this._globalCursor},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:Rde,events:rde,finalize:ode,hover:ide,data:Vfe,change:Av,insert:Gfe,remove:Yfe,scale:Cde,initialize:xde,toImageURL:bde,toCanvas:Sde,toSVG:_de,getState:Fde,setState:Nde,_watchPixelRatio:Lde});const zde="view",U1="[",W1="]",zI="{",II="}",Ide=":",jI=",",jde="@",Bde=">",Ude=/[[\]{}]/,Wde={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let BI,UI;function ja(e,t,n){return BI=t||zde,UI=n||Wde,WI(e.trim()).map(rS)}function qde(e){return UI[e]}function yh(e,t,n,r,i){const o=e.length;let s=0,a;for(;t<o;++t){if(a=e[t],!s&&a===n)return t;i&&i.indexOf(a)>=0?--s:r&&r.indexOf(a)>=0&&++s}return t}function WI(e){const t=[],n=e.length;let r=0,i=0;for(;i<n;)i=yh(e,i,jI,U1+zI,W1+II),t.push(e.substring(r,i).trim()),r=++i;if(t.length===0)throw"Empty event selector: "+e;return t}function rS(e){return e[0]==="["?Hde(e):Vde(e)}function Hde(e){const t=e.length;let n=1,r;if(n=yh(e,n,W1,U1,W1),n===t)throw"Empty between selector: "+e;if(r=WI(e.substring(1,n)),r.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==Bde)throw"Expected '>' after between selector: "+e;r=r.map(rS);const i=rS(e.slice(1).trim());return i.between?{between:r,stream:i}:(i.between=r,i)}function Vde(e){const t={source:BI},n=[];let r=[0,0],i=0,o=0,s=e.length,a=0,l,u;if(e[s-1]===II){if(a=e.lastIndexOf(zI),a>=0){try{r=Gde(e.substring(a+1,s-1))}catch{throw"Invalid throttle specification: "+e}e=e.slice(0,a).trim(),s=e.length}else throw"Unmatched right brace: "+e;a=0}if(!s)throw e;if(e[0]===jde&&(i=++a),l=yh(e,a,Ide),l<s&&(n.push(e.substring(o,l).trim()),o=a=++l),a=yh(e,a,U1),a===s)n.push(e.substring(o,s).trim());else if(n.push(e.substring(o,a).trim()),u=[],o=++a,o===s)throw"Unmatched left bracket: "+e;for(;a<s;){if(a=yh(e,a,W1),a===s)throw"Unmatched left bracket: "+e;if(u.push(e.substring(o,a).trim()),a<s-1&&e[++a]!==U1)throw"Expected left bracket: "+e;o=++a}if(!(s=n.length)||Ude.test(n[s-1]))throw"Invalid event selector: "+e;return s>1?(t.type=n[1],i?t.markname=n[0].slice(1):qde(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),u!=null&&(t.filter=u),r[0]&&(t.throttle=r[0]),r[1]&&(t.debounce=r[1]),t}function Gde(e){const t=e.split(jI);if(!e.length||t.length>2)throw e;return t.map(n=>{const r=+n;if(r!==r)throw e;return r})}function Yde(e){return Z(e)?e:{type:e||"pad"}}const pd=e=>+e||0,Xde=e=>({top:e,bottom:e,left:e,right:e});function Qde(e){return Z(e)?e.signal?e:{top:pd(e.top),bottom:pd(e.bottom),left:pd(e.left),right:pd(e.right)}:Xde(pd(e))}const Ot=e=>Z(e)&&!j(e)?ge({},e):{value:e};function zM(e,t,n,r){return n!=null?(Z(n)&&!j(n)||j(n)&&n.length&&Z(n[0])?e.update[t]=n:e[r||"enter"][t]={value:n},1):0}function en(e,t,n){for(const r in t)zM(e,r,t[r]);for(const r in n)zM(e,r,n[r],"update")}function Nf(e,t,n){for(const r in t)n&&te(n,r)||(e[r]=ge(e[r]||{},t[r]));return e}function Uu(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}const h$="mark",p$="frame",g$="scope",Kde="axis",Zde="axis-domain",Jde="axis-grid",ehe="axis-label",the="axis-tick",nhe="axis-title",rhe="legend",ihe="legend-band",ohe="legend-entry",she="legend-gradient",qI="legend-label",ahe="legend-symbol",lhe="legend-title",uhe="title",che="title-text",fhe="title-subtitle";function dhe(e,t,n,r,i){const o={},s={};let a,l,u,c;l="lineBreak",t==="text"&&i[l]!=null&&!Uu(l,e)&&sw(o,l,i[l]),(n=="legend"||String(n).startsWith("axis"))&&(n=null),c=n===p$?i.group:n===h$?ge({},i.mark,i[t]):null;for(l in c)u=Uu(l,e)||(l==="fill"||l==="stroke")&&(Uu("fill",e)||Uu("stroke",e)),u||sw(o,l,c[l]);J(r).forEach(f=>{const d=i.style&&i.style[f];for(const h in d)Uu(h,e)||sw(o,h,d[h])}),e=ge({},e);for(l in o)c=o[l],c.signal?(a=a||{})[l]=c:s[l]=c;return e.enter=ge(s,e.enter),a&&(e.update=ge(a,e.update)),e}function sw(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}const HI=e=>ee(e)?Y(e):e.signal?`(${e.signal})`:VI(e);function Mv(e){if(e.gradient!=null)return phe(e);let t=e.signal?`(${e.signal})`:e.color?hhe(e.color):e.field!=null?VI(e.field):e.value!==void 0?Y(e.value):void 0;return e.scale!=null&&(t=ghe(e,t)),t===void 0&&(t=null),e.exponent!=null&&(t=`pow(${t},${Q0(e.exponent)})`),e.mult!=null&&(t+=`*${Q0(e.mult)}`),e.offset!=null&&(t+=`+${Q0(e.offset)}`),e.round&&(t=`round(${t})`),t}const i0=(e,t,n,r)=>`(${e}(${[t,n,r].map(Mv).join(",")})+'')`;function hhe(e){return e.c?i0("hcl",e.h,e.c,e.l):e.h||e.s?i0("hsl",e.h,e.s,e.l):e.l||e.a?i0("lab",e.l,e.a,e.b):e.r||e.g||e.b?i0("rgb",e.r,e.g,e.b):null}function phe(e){const t=[e.start,e.stop,e.count].map(n=>n==null?null:Y(n));for(;t.length&&Ce(t)==null;)t.pop();return t.unshift(HI(e.gradient)),`gradient(${t.join(",")})`}function Q0(e){return Z(e)?"("+Mv(e)+")":e}function VI(e){return GI(Z(e)?e:{datum:e})}function GI(e){let t,n,r;if(e.signal)t="datum",r=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t="item";n-- >0;)t+=".mark.group";e.parent?(r=e.parent,t+=".datum"):r=e.group}else e.datum?(t="datum",r=e.datum):I("Invalid field reference: "+Y(e));return e.signal||(r=ee(r)?wo(r).map(Y).join("]["):GI(r)),t+"["+r+"]"}function ghe(e,t){const n=HI(e.scale);return e.range!=null?t=`lerp(_range(${n}), ${+e.range})`:(t!==void 0&&(t=`_scale(${n}, ${t})`),e.band&&(t=(t?t+"+":"")+`_bandwidth(${n})`+(+e.band==1?"":"*"+Q0(e.band)),e.extra&&(t=`(datum.extra ? _scale(${n}, datum.extra.value) : ${t})`)),t==null&&(t="0")),t}function mhe(e){let t="";return e.forEach(n=>{const r=Mv(n);t+=n.test?`(${n.test})?${r}:`:r}),Ce(t)===":"&&(t+="null"),t}function YI(e,t,n,r,i,o){const s={};o=o||{},o.encoders={$encode:s},e=dhe(e,t,n,r,i.config);for(const a in e)s[a]=yhe(e[a],t,o,i);return o}function yhe(e,t,n,r){const i={},o={};for(const s in e)e[s]!=null&&(i[s]=xhe(vhe(e[s]),r,n,o));return{$expr:{marktype:t,channels:i},$fields:Object.keys(o),$output:Object.keys(e)}}function vhe(e){return j(e)?mhe(e):Mv(e)}function xhe(e,t,n,r){const i=mo(e,t);return i.$fields.forEach(o=>r[o]=1),ge(n,i.$params),i.$expr}const whe="outer",bhe=["value","update","init","react","bind"];function IM(e,t){I(e+' for "outer" push: '+Y(t))}function XI(e,t){const n=e.name;if(e.push===whe)t.signals[n]||IM("No prior signal definition",n),bhe.forEach(r=>{e[r]!==void 0&&IM("Invalid property ",r)});else{const r=t.addSignal(n,e.value);e.react===!1&&(r.react=!1),e.bind&&t.addBinding(n,e.bind)}}function iS(e,t,n,r){this.id=-1,this.type=e,this.value=t,this.params=n,r&&(this.parent=r)}function Tv(e,t,n,r){return new iS(e,t,n,r)}function q1(e,t){return Tv("operator",e,t)}function ae(e){const t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function op(e,t){return t?{$field:e,$name:t}:{$field:e}}const oS=op("key");function jM(e,t){return{$compare:e,$order:t}}function Ehe(e,t){const n={$key:e};return t&&(n.$flat=!0),n}const She="ascending",_he="descending";function khe(e){return Z(e)?(e.order===_he?"-":"+")+Nv(e.op,e.field):""}function Nv(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}const m$="scope",sS="view";function kt(e){return e&&e.signal}function Che(e){return e&&e.expr}function K0(e){if(kt(e))return!0;if(Z(e)){for(const t in e)if(K0(e[t]))return!0}return!1}function ci(e,t){return e??t}function Ml(e){return e&&e.signal||e}const BM="timer";function sp(e,t){return(e.merge?Ahe:e.stream?Fhe:e.type?Mhe:I("Invalid stream specification: "+Y(e)))(e,t)}function $he(e){return e===m$?sS:e||sS}function Ahe(e,t){const n=e.merge.map(i=>sp(i,t)),r=y$({merge:n},e,t);return t.addStream(r).id}function Fhe(e,t){const n=sp(e.stream,t),r=y$({stream:n},e,t);return t.addStream(r).id}function Mhe(e,t){let n;e.type===BM?(n=t.event(BM,e.throttle),e={between:e.between,filter:e.filter}):n=t.event($he(e.source),e.type);const r=y$({stream:n},e,t);return Object.keys(r).length===1?n:t.addStream(r).id}function y$(e,t,n){let r=t.between;return r&&(r.length!==2&&I('Stream "between" parameter must have 2 entries: '+Y(t)),e.between=[sp(r[0],n),sp(r[1],n)]),r=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&r.push(The(t.marktype,t.markname,t.markrole)),t.source===m$&&r.push("inScope(event.item)"),r.length&&(e.filter=mo("("+r.join(")&&(")+")",n).$expr),(r=t.throttle)!=null&&(e.throttle=+r),(r=t.debounce)!=null&&(e.debounce=+r),t.consume&&(e.consume=!0),e}function The(e,t,n){const r="event.item";return r+(e&&e!=="*"?"&&"+r+".mark.marktype==='"+e+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(t?"&&"+r+".mark.name==='"+t+"'":"")}const Nhe={code:"_.$value",ast:{type:"Identifier",value:"value"}};function Rhe(e,t,n){const r=e.encode,i={target:n};let o=e.events,s=e.update,a=[];o||I("Signal update missing events specification."),ee(o)&&(o=ja(o,t.isSubscope()?m$:sS)),o=J(o).filter(l=>l.signal||l.scale?(a.push(l),0):1),a.length>1&&(a=[Ohe(a)]),o.length&&a.push(o.length>1?{merge:o}:o[0]),r!=null&&(s&&I("Signal encode and update are mutually exclusive."),s="encode(item(),"+Y(r)+")"),i.update=ee(s)?mo(s,t):s.expr!=null?mo(s.expr,t):s.value!=null?s.value:s.signal!=null?{$expr:Nhe,$params:{$value:t.signalRef(s.signal)}}:I("Invalid signal update specification."),e.force&&(i.options={force:!0}),a.forEach(l=>t.addUpdate(ge(Dhe(l,t),i)))}function Dhe(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):sp(e,t)}}function Ohe(e){return{signal:"["+e.map(t=>t.scale?'scale("'+t.scale+'")':t.signal)+"]"}}function Phe(e,t){const n=t.getSignal(e.name);let r=e.update;e.init&&(r?I("Signals can not include both init and update expressions."):(r=e.init,n.initonly=!0)),r&&(r=mo(r,t),n.update=r.$expr,n.params=r.$params),e.on&&e.on.forEach(i=>Rhe(i,t,n.id))}const We=e=>(t,n,r)=>Tv(e,n,t||void 0,r),QI=We("aggregate"),Lhe=We("axisticks"),KI=We("bound"),Ri=We("collect"),UM=We("compare"),zhe=We("datajoin"),ZI=We("encode"),Ihe=We("expression"),jhe=We("facet"),Bhe=We("field"),Uhe=We("key"),Whe=We("legendentries"),qhe=We("load"),Hhe=We("mark"),Vhe=We("multiextent"),Ghe=We("multivalues"),Yhe=We("overlap"),Xhe=We("params"),JI=We("prefacet"),Qhe=We("projection"),Khe=We("proxy"),Zhe=We("relay"),ej=We("render"),Jhe=We("scale"),mu=We("sieve"),epe=We("sortitems"),tj=We("viewlayout"),tpe=We("values");let npe=0;const nj={min:"min",max:"max",count:"sum"};function rpe(e,t){const n=e.type||"linear";UO(n)||I("Unrecognized scale type: "+Y(n)),t.addScale(e.name,{type:n,domain:void 0})}function ipe(e,t){const n=t.getScale(e.name).params;let r;n.domain=rj(e.domain,e,t),e.range!=null&&(n.range=oj(e,t,n)),e.interpolate!=null&&ppe(e.interpolate,n),e.nice!=null&&(n.nice=hpe(e.nice,t)),e.bins!=null&&(n.bins=dpe(e.bins,t));for(r in e)te(n,r)||r==="name"||(n[r]=Ir(e[r],t))}function Ir(e,t){return Z(e)?e.signal?t.signalRef(e.signal):I("Unsupported object: "+Y(e)):e}function Z0(e,t){return e.signal?t.signalRef(e.signal):e.map(n=>Ir(n,t))}function Rv(e){I("Can not find data set: "+Y(e))}function rj(e,t,n){if(!e){(t.domainMin!=null||t.domainMax!=null)&&I("No scale domain defined for domainMin/domainMax to override.");return}return e.signal?n.signalRef(e.signal):(j(e)?ope:e.fields?ape:spe)(e,t,n)}function ope(e,t,n){return e.map(r=>Ir(r,n))}function spe(e,t,n){const r=n.getData(e.data);return r||Rv(e.data),Bc(t.type)?r.valuesRef(n,e.field,ij(e.sort,!1)):HO(t.type)?r.domainRef(n,e.field):r.extentRef(n,e.field)}function ape(e,t,n){const r=e.data,i=e.fields.reduce((o,s)=>(s=ee(s)?{data:r,field:s}:j(s)||s.signal?lpe(s,n):s,o.push(s),o),[]);return(Bc(t.type)?upe:HO(t.type)?cpe:fpe)(e,n,i)}function lpe(e,t){const n="_:vega:_"+npe++,r=Ri({});if(j(e))r.value={$ingest:e};else if(e.signal){const i="setdata("+Y(n)+","+e.signal+")";r.params.input=t.signalRef(i)}return t.addDataPipeline(n,[r,mu({})]),{data:n,field:"data"}}function upe(e,t,n){const r=ij(e.sort,!0);let i,o;const s=n.map(u=>{const c=t.getData(u.data);return c||Rv(u.data),c.countsRef(t,u.field,r)}),a={groupby:oS,pulse:s};r&&(i=r.op||"count",o=r.field?Nv(i,r.field):"count",a.ops=[nj[i]],a.fields=[t.fieldRef(o)],a.as=[o]),i=t.add(QI(a));const l=t.add(Ri({pulse:ae(i)}));return o=t.add(tpe({field:oS,sort:t.sortRef(r),pulse:ae(l)})),ae(o)}function ij(e,t){return e&&(!e.field&&!e.op?Z(e)?e.field="key":e={field:"key"}:!e.field&&e.op!=="count"?I("No field provided for sort aggregate op: "+e.op):t&&e.field&&e.op&&!nj[e.op]&&I("Multiple domain scales can not be sorted using "+e.op)),e}function cpe(e,t,n){const r=n.map(i=>{const o=t.getData(i.data);return o||Rv(i.data),o.domainRef(t,i.field)});return ae(t.add(Ghe({values:r})))}function fpe(e,t,n){const r=n.map(i=>{const o=t.getData(i.data);return o||Rv(i.data),o.extentRef(t,i.field)});return ae(t.add(Vhe({extents:r})))}function dpe(e,t){return e.signal||j(e)?Z0(e,t):t.objectProperty(e)}function hpe(e,t){return e.signal?t.signalRef(e.signal):Z(e)?{interval:Ir(e.interval),step:Ir(e.step)}:Ir(e)}function ppe(e,t){t.interpolate=Ir(e.type||e),e.gamma!=null&&(t.interpolateGamma=Ir(e.gamma))}function oj(e,t,n){const r=t.config.range;let i=e.range;if(i.signal)return t.signalRef(i.signal);if(ee(i)){if(r&&te(r,i))return e=ge({},e,{range:r[i]}),oj(e,t,n);i==="width"?i=[0,{signal:"width"}]:i==="height"?i=Bc(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:I("Unrecognized scale range value: "+Y(i))}else if(i.scheme){n.scheme=j(i.scheme)?Z0(i.scheme,t):Ir(i.scheme,t),i.extent&&(n.schemeExtent=Z0(i.extent,t)),i.count&&(n.schemeCount=Ir(i.count,t));return}else if(i.step){n.rangeStep=Ir(i.step,t);return}else{if(Bc(e.type)&&!j(i))return rj(i,e,t);j(i)||I("Unsupported range type: "+Y(i))}return i.map(o=>(j(o)?Z0:Ir)(o,t))}function gpe(e,t){const n=t.config.projection||{},r={};for(const i in e)i!=="name"&&(r[i]=aS(e[i],i,t));for(const i in n)r[i]==null&&(r[i]=aS(n[i],i,t));t.addProjection(e.name,r)}function aS(e,t,n){return j(e)?e.map(r=>aS(r,t,n)):Z(e)?e.signal?n.signalRef(e.signal):t==="fit"?e:I("Unsupported parameter object: "+Y(e)):e}const Di="top",Rf="left",Df="right",_a="bottom",sj="center",mpe="vertical",ype="start",vpe="middle",xpe="end",lS="index",v$="label",wpe="offset",Qc="perc",bpe="perc2",Ur="value",Xp="guide-label",x$="guide-title",Epe="group-title",Spe="group-subtitle",WM="symbol",J0="gradient",uS="discrete",cS="size",_pe="shape",kpe="fill",Cpe="stroke",$pe="strokeWidth",Ape="strokeDash",Fpe="opacity",w$=[cS,_pe,kpe,Cpe,$pe,Ape,Fpe],Qp={name:1,style:1,interactive:1},$e={value:0},Wr={value:1},Dv="group",aj="rect",b$="rule",Mpe="symbol",yu="text";function ap(e){return e.type=Dv,e.interactive=e.interactive||!1,e}function lr(e,t){const n=(r,i)=>ci(e[r],ci(t[r],i));return n.isVertical=r=>mpe===ci(e.direction,t.direction||(r?t.symbolDirection:t.gradientDirection)),n.gradientLength=()=>ci(e.gradientLength,t.gradientLength||t.gradientWidth),n.gradientThickness=()=>ci(e.gradientThickness,t.gradientThickness||t.gradientHeight),n.entryColumns=()=>ci(e.columns,ci(t.columns,+n.isVertical(!0))),n}function lj(e,t){const n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function Tpe(e,t,n){const r=t.config.style[n];return r&&r[e]}function Ov(e,t,n){return`item.anchor === '${ype}' ? ${e} : item.anchor === '${xpe}' ? ${t} : ${n}`}const E$=Ov(Y(Rf),Y(Df),Y(sj));function Npe(e){const t=e("tickBand");let n=e("tickOffset"),r,i;return t?t.signal?(r={signal:`(${t.signal}) === 'extent' ? 1 : 0.5`},i={signal:`(${t.signal}) === 'extent'`},Z(n)||(n={signal:`(${t.signal}) === 'extent' ? 0 : ${n}`})):t==="extent"?(r=1,i=!0,n=0):(r=.5,i=!1):(r=e("bandPosition"),i=e("tickExtra")),{extra:i,band:r,offset:n}}function uj(e,t){return t?e?Z(e)?Object.assign({},e,{offset:uj(e.offset,t)}):{value:e,offset:t}:t:e}function Cr(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=Nf(e.encode,t,Qp)):e.interactive=!1,e}function Rpe(e,t,n,r){const i=lr(e,n),o=i.isVertical(),s=i.gradientThickness(),a=i.gradientLength();let l,u,c,f,d;o?(u=[0,1],c=[0,0],f=s,d=a):(u=[0,0],c=[1,0],f=a,d=s);const h={enter:l={opacity:$e,x:$e,y:$e,width:Ot(f),height:Ot(d)},update:ge({},l,{opacity:Wr,fill:{gradient:t,start:u,stop:c}}),exit:{opacity:$e}};return en(h,{stroke:i("gradientStrokeColor"),strokeWidth:i("gradientStrokeWidth")},{opacity:i("gradientOpacity")}),Cr({type:aj,role:she,encode:h},r)}function Dpe(e,t,n,r,i){const o=lr(e,n),s=o.isVertical(),a=o.gradientThickness(),l=o.gradientLength();let u,c,f,d,h="";s?(u="y",f="y2",c="x",d="width",h="1-"):(u="x",f="x2",c="y",d="height");const p={opacity:$e,fill:{scale:t,field:Ur}};p[u]={signal:h+"datum."+Qc,mult:l},p[c]=$e,p[f]={signal:h+"datum."+bpe,mult:l},p[d]=Ot(a);const g={enter:p,update:ge({},p,{opacity:Wr}),exit:{opacity:$e}};return en(g,{stroke:o("gradientStrokeColor"),strokeWidth:o("gradientStrokeWidth")},{opacity:o("gradientOpacity")}),Cr({type:aj,role:ihe,key:Ur,from:i,encode:g},r)}const Ope=`datum.${Qc}<=0?"${Rf}":datum.${Qc}>=1?"${Df}":"${sj}"`,Ppe=`datum.${Qc}<=0?"${_a}":datum.${Qc}>=1?"${Di}":"${vpe}"`;function qM(e,t,n,r){const i=lr(e,t),o=i.isVertical(),s=Ot(i.gradientThickness()),a=i.gradientLength();let l=i("labelOverlap"),u,c,f,d,h="";const p={enter:u={opacity:$e},update:c={opacity:Wr,text:{field:v$}},exit:{opacity:$e}};return en(p,{fill:i("labelColor"),fillOpacity:i("labelOpacity"),font:i("labelFont"),fontSize:i("labelFontSize"),fontStyle:i("labelFontStyle"),fontWeight:i("labelFontWeight"),limit:ci(e.labelLimit,t.gradientLabelLimit)}),o?(u.align={value:"left"},u.baseline=c.baseline={signal:Ppe},f="y",d="x",h="1-"):(u.align=c.align={signal:Ope},u.baseline={value:"top"},f="x",d="y"),u[f]=c[f]={signal:h+"datum."+Qc,mult:a},u[d]=c[d]=s,s.offset=ci(e.labelOffset,t.gradientLabelOffset)||0,l=l?{separation:i("labelSeparation"),method:l,order:"datum."+lS}:void 0,Cr({type:yu,role:qI,style:Xp,key:Ur,from:r,encode:p,overlap:l},n)}function Lpe(e,t,n,r,i){const o=lr(e,t),s=n.entries,a=!!(s&&s.interactive),l=s?s.name:void 0,u=o("clipHeight"),c=o("symbolOffset"),f={data:"value"},d=`(${i}) ? datum.${wpe} : datum.${cS}`,h=u?Ot(u):{field:cS},p=`datum.${lS}`,g=`max(1, ${i})`;let y,m,v,x,w;h.mult=.5,y={enter:m={opacity:$e,x:{signal:d,mult:.5,offset:c},y:h},update:v={opacity:Wr,x:m.x,y:m.y},exit:{opacity:$e}};let b=null,S=null;e.fill||(b=t.symbolBaseFillColor,S=t.symbolBaseStrokeColor),en(y,{fill:o("symbolFillColor",b),shape:o("symbolType"),size:o("symbolSize"),stroke:o("symbolStrokeColor",S),strokeDash:o("symbolDash"),strokeDashOffset:o("symbolDashOffset"),strokeWidth:o("symbolStrokeWidth")},{opacity:o("symbolOpacity")}),w$.forEach(C=>{e[C]&&(v[C]=m[C]={scale:e[C],field:Ur})});const E=Cr({type:Mpe,role:ahe,key:Ur,from:f,clip:u?!0:void 0,encode:y},n.symbols),_=Ot(c);_.offset=o("labelOffset"),y={enter:m={opacity:$e,x:{signal:d,offset:_},y:h},update:v={opacity:Wr,text:{field:v$},x:m.x,y:m.y},exit:{opacity:$e}},en(y,{align:o("labelAlign"),baseline:o("labelBaseline"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontStyle:o("labelFontStyle"),fontWeight:o("labelFontWeight"),limit:o("labelLimit")});const k=Cr({type:yu,role:qI,style:Xp,key:Ur,from:f,encode:y},n.labels);return y={enter:{noBound:{value:!u},width:$e,height:u?Ot(u):$e,opacity:$e},exit:{opacity:$e},update:v={opacity:Wr,row:{signal:null},column:{signal:null}}},o.isVertical(!0)?(x=`ceil(item.mark.items.length / ${g})`,v.row.signal=`${p}%${x}`,v.column.signal=`floor(${p} / ${x})`,w={field:["row",p]}):(v.row.signal=`floor(${p} / ${g})`,v.column.signal=`${p} % ${g}`,w={field:p}),v.column.signal=`(${i})?${v.column.signal}:${p}`,r={facet:{data:r,name:"value",groupby:lS}},ap({role:g$,from:r,encode:Nf(y,s,Qp),marks:[E,k],name:l,interactive:a,sort:w})}function zpe(e,t){const n=lr(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}const S$='item.orient === "left"',_$='item.orient === "right"',Pv=`(${S$} || ${_$})`,Ipe=`datum.vgrad && ${Pv}`,jpe=Ov('"top"','"bottom"','"middle"'),Bpe=Ov('"right"','"left"','"center"'),Upe=`datum.vgrad && ${_$} ? (${Bpe}) : (${Pv} && !(datum.vgrad && ${S$})) ? "left" : ${E$}`,Wpe=`item._anchor || (${Pv} ? "middle" : "start")`,qpe=`${Ipe} ? (${S$} ? -90 : 90) : 0`,Hpe=`${Pv} ? (datum.vgrad ? (${_$} ? "bottom" : "top") : ${jpe}) : "top"`;function Vpe(e,t,n,r){const i=lr(e,t),o={enter:{opacity:$e},update:{opacity:Wr,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:$e}};return en(o,{orient:i("titleOrient"),_anchor:i("titleAnchor"),anchor:{signal:Wpe},angle:{signal:qpe},align:{signal:Upe},baseline:{signal:Hpe},text:e.title,fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),baseline:i("titleBaseline")}),Cr({type:yu,role:lhe,style:x$,from:r,encode:o},n)}function Gpe(e,t){let n;return Z(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+HM(e.path)+")":e.sphere&&(n="geoShape("+HM(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function HM(e){return Z(e)&&e.signal?e.signal:Y(e)}function cj(e){const t=e.role||"";return t.startsWith("axis")||t.startsWith("legend")||t.startsWith("title")?t:e.type===Dv?g$:t||h$}function Ype(e){return{marktype:e.type,name:e.name||void 0,role:e.role||cj(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function Xpe(e,t){return e&&e.signal?t.signalRef(e.signal):e!==!1}function k$(e,t){const n=qD(e.type);n||I("Unrecognized transform type: "+Y(e.type));const r=Tv(n.type.toLowerCase(),null,fj(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(r)),r.metadata=n.metadata||{},r}function fj(e,t,n){const r={},i=e.params.length;for(let o=0;o<i;++o){const s=e.params[o];r[s.name]=Qpe(s,t,n)}return r}function Qpe(e,t,n){const r=e.type,i=t[e.name];if(r==="index")return Kpe(e,t,n);if(i===void 0){e.required&&I("Missing required "+Y(t.type)+" parameter: "+Y(e.name));return}else{if(r==="param")return Zpe(e,t,n);if(r==="projection")return n.projectionRef(t[e.name])}return e.array&&!kt(i)?i.map(o=>VM(e,o,n)):VM(e,i,n)}function VM(e,t,n){const r=e.type;if(kt(t))return YM(r)?I("Expression references can not be signals."):aw(r)?n.fieldRef(t):XM(r)?n.compareRef(t):n.signalRef(t.signal);{const i=e.expr||aw(r);return i&&Jpe(t)?n.exprRef(t.expr,t.as):i&&ege(t)?op(t.field,t.as):YM(r)?mo(t,n):tge(r)?ae(n.getData(t).values):aw(r)?op(t):XM(r)?n.compareRef(t):t}}function Kpe(e,t,n){return ee(t.from)||I('Lookup "from" parameter must be a string literal.'),n.getData(t.from).lookupRef(n,t.key)}function Zpe(e,t,n){const r=t[e.name];return e.array?(j(r)||I("Expected an array of sub-parameters. Instead: "+Y(r)),r.map(i=>GM(e,i,n))):GM(e,r,n)}function GM(e,t,n){const r=e.params.length;let i;for(let s=0;s<r;++s){i=e.params[s];for(const a in i.key)if(i.key[a]!==t[a]){i=null;break}if(i)break}i||I("Unsupported parameter: "+Y(t));const o=ge(fj(i,t,n),i.key);return ae(n.add(Xhe(o)))}const Jpe=e=>e&&e.expr,ege=e=>e&&e.field,tge=e=>e==="data",YM=e=>e==="expr",aw=e=>e==="field",XM=e=>e==="compare";function nge(e,t,n){let r,i,o,s,a;return e?(r=e.facet)&&(t||I("Only group marks can be faceted."),r.field!=null?s=a=em(r,n):(e.data?a=ae(n.getData(e.data).aggregate):(o=k$(ge({type:"aggregate",groupby:J(r.groupby)},r.aggregate),n),o.params.key=n.keyRef(r.groupby),o.params.pulse=em(r,n),s=a=ae(n.add(o))),i=n.keyRef(r.groupby,!0))):s=ae(n.add(Ri(null,[{}]))),s||(s=em(e,n)),{key:i,pulse:s,parent:a}}function em(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:ae(t.getData(e.data).output)}function Kl(e,t,n,r,i){this.scope=e,this.input=t,this.output=n,this.values=r,this.aggregate=i,this.index={}}Kl.fromEntries=function(e,t){const n=t.length,r=t[n-1],i=t[n-2];let o=t[0],s=null,a=1;for(o&&o.type==="load"&&(o=t[1]),e.add(t[0]);a<n;++a)t[a].params.pulse=ae(t[a-1]),e.add(t[a]),t[a].type==="aggregate"&&(s=t[a]);return new Kl(e,o,i,r,s)};function dj(e){return ee(e)?e:null}function QM(e,t,n){const r=Nv(n.op,n.field);let i;if(t.ops){for(let o=0,s=t.as.length;o<s;++o)if(t.as[o]===r)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((i=n.op.signal)?e.signalRef(i):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(r))}function gd(e,t,n,r,i,o,s){const a=t[n]||(t[n]={}),l=khe(o);let u=dj(i),c,f;if(u!=null&&(e=t.scope,u=u+(l?"|"+l:""),c=a[u]),!c){const d=o?{field:oS,pulse:t.countsRef(e,i,o)}:{field:e.fieldRef(i),pulse:ae(t.output)};l&&(d.sort=e.sortRef(o)),f=e.add(Tv(r,void 0,d)),s&&(t.index[i]=f),c=ae(f),u!=null&&(a[u]=c)}return c}Kl.prototype={countsRef(e,t,n){const r=this,i=r.counts||(r.counts={}),o=dj(t);let s,a,l;return o!=null&&(e=r.scope,s=i[o]),s?n&&n.field&&QM(e,s.agg.params,n):(l={groupby:e.fieldRef(t,"key"),pulse:ae(r.output)},n&&n.field&&QM(e,l,n),a=e.add(QI(l)),s=e.add(Ri({pulse:ae(a)})),s={agg:a,ref:ae(s)},o!=null&&(i[o]=s)),s.ref},tuplesRef(){return ae(this.values)},extentRef(e,t){return gd(e,this,"extent","extent",t,!1)},domainRef(e,t){return gd(e,this,"domain","values",t,!1)},valuesRef(e,t,n){return gd(e,this,"vals","values",t,n||!0)},lookupRef(e,t){return gd(e,this,"lookup","tupleindex",t,!1)},indataRef(e,t){return gd(e,this,"indata","tupleindex",t,!0,!0)}};function rge(e,t,n){const r=e.from.facet,i=r.name,o=em(r,t);let s;r.name||I("Facet must have a name: "+Y(r)),r.data||I("Facet must reference a data set: "+Y(r)),r.field?s=t.add(JI({field:t.fieldRef(r.field),pulse:o})):r.groupby?s=t.add(jhe({key:t.keyRef(r.groupby),group:ae(t.proxy(n.parent)),pulse:o})):I("Facet must specify groupby or field: "+Y(r));const a=t.fork(),l=a.add(Ri()),u=a.add(mu({pulse:ae(l)}));a.addData(i,new Kl(a,l,l,u)),a.addSignal("parent",null),s.params.subflow={$subflow:a.parse(e).toRuntime()}}function ige(e,t,n){const r=t.add(JI({pulse:n.pulse})),i=t.fork();i.add(mu()),i.addSignal("parent",null),r.params.subflow={$subflow:i.parse(e).toRuntime()}}function hj(e,t,n){const r=e.remove,i=e.insert,o=e.toggle,s=e.modify,a=e.values,l=t.add(q1()),u="if("+e.trigger+',modify("'+n+'",'+[i,r,o,s,a].map(f=>f??"null").join(",")+"),0)",c=mo(u,t);l.update=c.$expr,l.params=c.$params}function Lv(e,t){const n=cj(e),r=e.type===Dv,i=e.from&&e.from.facet,o=e.overlap;let s=e.layout||n===g$||n===p$,a,l,u,c,f,d,h;const p=n===h$||s||i,g=nge(e.from,r,t);l=t.add(zhe({key:g.key||(e.key?op(e.key):void 0),pulse:g.pulse,clean:!r}));const y=ae(l);l=u=t.add(Ri({pulse:y})),l=t.add(Hhe({markdef:Ype(e),interactive:Xpe(e.interactive,t),clip:Gpe(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:ae(l)}));const m=ae(l);l=c=t.add(ZI(YI(e.encode,e.type,n,e.style,t,{mod:!1,pulse:m}))),l.params.parent=t.encode(),e.transform&&e.transform.forEach(S=>{const E=k$(S,t),_=E.metadata;(_.generates||_.changes)&&I("Mark transforms should not generate new data."),_.nomod||(c.params.mod=!0),E.params.pulse=ae(l),t.add(l=E)}),e.sort&&(l=t.add(epe({sort:t.compareRef(e.sort),pulse:ae(l)})));const v=ae(l);(i||s)&&(s=t.add(tj({layout:t.objectProperty(e.layout),legends:t.legends,mark:m,pulse:v})),d=ae(s));const x=t.add(KI({mark:m,pulse:d||v}));h=ae(x),r&&(p&&(a=t.operators,a.pop(),s&&a.pop()),t.pushState(v,d||h,y),i?rge(e,t,g):p?ige(e,t,g):t.parse(e),t.popState(),p&&(s&&a.push(s),a.push(x))),o&&(h=oge(o,h,t));const w=t.add(ej({pulse:h})),b=t.add(mu({pulse:ae(w)},void 0,t.parent()));e.name!=null&&(f=e.name,t.addData(f,new Kl(t,u,w,b)),e.on&&e.on.forEach(S=>{(S.insert||S.remove||S.toggle)&&I("Marks only support modify triggers."),hj(S,t,f)}))}function oge(e,t,n){const r=e.method,i=e.bound,o=e.separation,s={separation:kt(o)?n.signalRef(o.signal):o,method:kt(r)?n.signalRef(r.signal):r,pulse:t};if(e.order&&(s.sort=n.compareRef({field:e.order})),i){const a=i.tolerance;s.boundTolerance=kt(a)?n.signalRef(a.signal):+a,s.boundScale=n.scaleRef(i.scale),s.boundOrient=i.orient}return ae(n.add(Yhe(s)))}function sge(e,t){const n=t.config.legend,r=e.encode||{},i=lr(e,n),o=r.legend||{},s=o.name||void 0,a=o.interactive,l=o.style,u={};let c=0,f,d,h;w$.forEach(x=>e[x]?(u[x]=e[x],c=c||e[x]):0),c||I("Missing valid scale for legend.");const p=age(e,t.scaleType(c)),g={title:e.title!=null,scales:u,type:p,vgrad:p!=="symbol"&&i.isVertical()},y=ae(t.add(Ri(null,[g]))),m={enter:{x:{value:0},y:{value:0}}},v=ae(t.add(Whe(d={type:p,scale:t.scaleRef(c),count:t.objectProperty(i("tickCount")),limit:t.property(i("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));return p===J0?(h=[Rpe(e,c,n,r.gradient),qM(e,n,r.labels,v)],d.count=d.count||t.signalRef(`max(2,2*floor((${Ml(i.gradientLength())})/100))`)):p===uS?h=[Dpe(e,c,n,r.gradient,v),qM(e,n,r.labels,v)]:(f=zpe(e,n),h=[Lpe(e,n,r,v,Ml(f.columns))],d.size=cge(e,t,h[0].marks)),h=[ap({role:ohe,from:y,encode:m,marks:h,layout:f,interactive:a})],g.title&&h.push(Vpe(e,n,r.title,y)),Lv(ap({role:rhe,from:y,encode:Nf(uge(i,e,n),o,Qp),marks:h,aria:i("aria"),description:i("description"),zindex:i("zindex"),name:s,interactive:a,style:l}),t)}function age(e,t){let n=e.type||WM;return!e.type&&lge(e)===1&&(e.fill||e.stroke)&&(n=_C(t)?J0:tE(t)?uS:WM),n!==J0?n:tE(t)?uS:J0}function lge(e){return w$.reduce((t,n)=>t+(e[n]?1:0),0)}function uge(e,t,n){const r={enter:{},update:{}};return en(r,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),r}function cge(e,t,n){const r=Ml(KM("size",e,n)),i=Ml(KM("strokeWidth",e,n)),o=Ml(fge(n[1].encode,t,Xp));return mo(`max(ceil(sqrt(${r})+${i}),${o})`,t)}function KM(e,t,n){return t[e]?`scale("${t[e]}",datum)`:lj(e,n[0].encode)}function fge(e,t,n){return lj("fontSize",e)||Tpe("fontSize",t,n)}const dge=`item.orient==="${Rf}"?-90:item.orient==="${Df}"?90:0`;function hge(e,t){e=ee(e)?{text:e}:e;const n=lr(e,t.config.title),r=e.encode||{},i=r.group||{},o=i.name||void 0,s=i.interactive,a=i.style,l=[],u={},c=ae(t.add(Ri(null,[u])));return l.push(mge(e,n,pge(e),c)),e.subtitle&&l.push(yge(e,n,r.subtitle,c)),Lv(ap({role:uhe,from:c,encode:gge(n,i),marks:l,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:o,interactive:s,style:a}),t)}function pge(e){const t=e.encode;return t&&t.title||ge({name:e.name,interactive:e.interactive,style:e.style},t)}function gge(e,t){const n={enter:{},update:{}};return en(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:E$},angle:{signal:dge},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),Nf(n,t,Qp)}function mge(e,t,n,r){const i={value:0},o=e.text,s={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return en(s,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),Cr({type:yu,role:che,style:Epe,from:r,encode:s},n)}function yge(e,t,n,r){const i={value:0},o=e.subtitle,s={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return en(s,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),Cr({type:yu,role:fhe,style:Spe,from:r,encode:s},n)}function vge(e,t){const n=[];e.transform&&e.transform.forEach(r=>{n.push(k$(r,t))}),e.on&&e.on.forEach(r=>{hj(r,t,e.name)}),t.addDataPipeline(e.name,xge(e,t,n))}function xge(e,t,n){const r=[];let i=null,o=!1,s=!1,a,l,u,c,f;for(e.values?kt(e.values)||K0(e.format)?(r.push(ZM(t,e)),r.push(i=Qa())):r.push(i=Qa({$ingest:e.values,$format:e.format})):e.url?K0(e.url)||K0(e.format)?(r.push(ZM(t,e)),r.push(i=Qa())):r.push(i=Qa({$request:e.url,$format:e.format})):e.source&&(i=a=J(e.source).map(d=>ae(t.getData(d).output)),r.push(null)),l=0,u=n.length;l<u;++l)c=n[l],f=c.metadata,!i&&!f.source&&r.push(i=Qa()),r.push(c),f.generates&&(s=!0),f.modifies&&!s&&(o=!0),f.source?i=c:f.changes&&(i=null);return a&&(u=a.length-1,r[0]=Zhe({derive:o,pulse:u?a:a[0]}),(o||u)&&r.splice(1,0,Qa())),i||r.push(Qa()),r.push(mu({})),r}function Qa(e){const t=Ri({},e);return t.metadata={source:!0},t}function ZM(e,t){return qhe({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}const pj=e=>e===_a||e===Di,zv=(e,t,n)=>kt(e)?Sge(e.signal,t,n):e===Rf||e===Di?t:n,Pt=(e,t,n)=>kt(e)?bge(e.signal,t,n):pj(e)?t:n,Ei=(e,t,n)=>kt(e)?Ege(e.signal,t,n):pj(e)?n:t,gj=(e,t,n)=>kt(e)?_ge(e.signal,t,n):e===Di?{value:t}:{value:n},wge=(e,t,n)=>kt(e)?kge(e.signal,t,n):e===Df?{value:t}:{value:n},bge=(e,t,n)=>mj(`${e} === '${Di}' || ${e} === '${_a}'`,t,n),Ege=(e,t,n)=>mj(`${e} !== '${Di}' && ${e} !== '${_a}'`,t,n),Sge=(e,t,n)=>C$(`${e} === '${Rf}' || ${e} === '${Di}'`,t,n),_ge=(e,t,n)=>C$(`${e} === '${Di}'`,t,n),kge=(e,t,n)=>C$(`${e} === '${Df}'`,t,n),mj=(e,t,n)=>(t=t!=null?Ot(t):t,n=n!=null?Ot(n):n,JM(t)&&JM(n)?(t=t?t.signal||Y(t.value):null,n=n?n.signal||Y(n.value):null,{signal:`${e} ? (${t}) : (${n})`}):[ge({test:e},t)].concat(n||[])),JM=e=>e==null||Object.keys(e).length===1,C$=(e,t,n)=>({signal:`${e} ? (${ac(t)}) : (${ac(n)})`}),Cge=(e,t,n,r,i)=>({signal:(r!=null?`${e} === '${Rf}' ? (${ac(r)}) : `:"")+(n!=null?`${e} === '${_a}' ? (${ac(n)}) : `:"")+(i!=null?`${e} === '${Df}' ? (${ac(i)}) : `:"")+(t!=null?`${e} === '${Di}' ? (${ac(t)}) : `:"")+"(null)"}),ac=e=>kt(e)?e.signal:e==null?null:Y(e),$ge=(e,t)=>t===0?0:kt(e)?{signal:`(${e.signal}) * ${t}`}:{value:e*t},vc=(e,t)=>{const n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function Pu(e,t,n,r){let i;if(t&&te(t,e))return t[e];if(te(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":i="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":i=e[5].toLowerCase()+e.slice(6)}return r[x$][i]}else if(e.startsWith("label")){switch(e){case"labelColor":i="fill";break;case"labelFont":case"labelFontSize":i=e[5].toLowerCase()+e.slice(6)}return r[Xp][i]}return null}function e8(e){const t={};for(const n of e)if(n)for(const r in n)t[r]=1;return Object.keys(t)}function Age(e,t){var n=t.config,r=n.style,i=n.axis,o=t.scaleType(e.scale)==="band"&&n.axisBand,s=e.orient,a,l,u;if(kt(s)){const f=e8([n.axisX,n.axisY]),d=e8([n.axisTop,n.axisBottom,n.axisLeft,n.axisRight]);a={};for(u of f)a[u]=Pt(s,Pu(u,n.axisX,i,r),Pu(u,n.axisY,i,r));l={};for(u of d)l[u]=Cge(s.signal,Pu(u,n.axisTop,i,r),Pu(u,n.axisBottom,i,r),Pu(u,n.axisLeft,i,r),Pu(u,n.axisRight,i,r))}else a=s===Di||s===_a?n.axisX:n.axisY,l=n["axis"+s[0].toUpperCase()+s.slice(1)];return a||l||o?ge({},i,a,l,o):i}function Fge(e,t,n,r){const i=lr(e,t),o=e.orient;let s,a;const l={enter:s={opacity:$e},update:a={opacity:Wr},exit:{opacity:$e}};en(l,{stroke:i("domainColor"),strokeCap:i("domainCap"),strokeDash:i("domainDash"),strokeDashOffset:i("domainDashOffset"),strokeWidth:i("domainWidth"),strokeOpacity:i("domainOpacity")});const u=t8(e,0),c=t8(e,1);return s.x=a.x=Pt(o,u,$e),s.x2=a.x2=Pt(o,c),s.y=a.y=Ei(o,u,$e),s.y2=a.y2=Ei(o,c),Cr({type:b$,role:Zde,from:r,encode:l},n)}function t8(e,t){return{scale:e.scale,range:t}}function Mge(e,t,n,r,i){const o=lr(e,t),s=e.orient,a=e.gridScale,l=zv(s,1,-1),u=Tge(e.offset,l);let c,f,d;const h={enter:c={opacity:$e},update:d={opacity:Wr},exit:f={opacity:$e}};en(h,{stroke:o("gridColor"),strokeCap:o("gridCap"),strokeDash:o("gridDash"),strokeDashOffset:o("gridDashOffset"),strokeOpacity:o("gridOpacity"),strokeWidth:o("gridWidth")});const p={scale:e.scale,field:Ur,band:i.band,extra:i.extra,offset:i.offset,round:o("tickRound")},g=Pt(s,{signal:"height"},{signal:"width"}),y=a?{scale:a,range:0,mult:l,offset:u}:{value:0,offset:u},m=a?{scale:a,range:1,mult:l,offset:u}:ge(g,{mult:l,offset:u});return c.x=d.x=Pt(s,p,y),c.y=d.y=Ei(s,p,y),c.x2=d.x2=Ei(s,m),c.y2=d.y2=Pt(s,m),f.x=Pt(s,p),f.y=Ei(s,p),Cr({type:b$,role:Jde,key:Ur,from:r,encode:h},n)}function Tge(e,t){if(t!==1)if(!Z(e))e=kt(t)?{signal:`(${t.signal}) * (${e||0})`}:t*(e||0);else{let n=e=ge({},e);for(;n.mult!=null;)if(Z(n.mult))n=n.mult=ge({},n.mult);else return n.mult=kt(t)?{signal:`(${n.mult}) * (${t.signal})`}:n.mult*t,e;n.mult=t}return e}function Nge(e,t,n,r,i,o){const s=lr(e,t),a=e.orient,l=zv(a,-1,1);let u,c,f;const d={enter:u={opacity:$e},update:f={opacity:Wr},exit:c={opacity:$e}};en(d,{stroke:s("tickColor"),strokeCap:s("tickCap"),strokeDash:s("tickDash"),strokeDashOffset:s("tickDashOffset"),strokeOpacity:s("tickOpacity"),strokeWidth:s("tickWidth")});const h=Ot(i);h.mult=l;const p={scale:e.scale,field:Ur,band:o.band,extra:o.extra,offset:o.offset,round:s("tickRound")};return f.y=u.y=Pt(a,$e,p),f.y2=u.y2=Pt(a,h),c.x=Pt(a,p),f.x=u.x=Ei(a,$e,p),f.x2=u.x2=Ei(a,h),c.y=Ei(a,p),Cr({type:b$,role:the,key:Ur,from:r,encode:d},n)}function lw(e,t,n,r,i){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+r+","+i+")"}}function Rge(e,t,n,r,i,o){const s=lr(e,t),a=e.orient,l=e.scale,u=zv(a,-1,1),c=Ml(s("labelFlush")),f=Ml(s("labelFlushOffset")),d=s("labelAlign"),h=s("labelBaseline");let p=c===0||!!c,g;const y=Ot(i);y.mult=u,y.offset=Ot(s("labelPadding")||0),y.offset.mult=u;const m={scale:l,field:Ur,band:.5,offset:uj(o.offset,s("labelOffset"))},v=Pt(a,p?lw(l,c,'"left"','"right"','"center"'):{value:"center"},wge(a,"left","right")),x=Pt(a,gj(a,"bottom","top"),p?lw(l,c,'"top"','"bottom"','"middle"'):{value:"middle"}),w=lw(l,c,`-(${f})`,f,0);p=p&&f;const b={opacity:$e,x:Pt(a,m,y),y:Ei(a,m,y)},S={enter:b,update:g={opacity:Wr,text:{field:v$},x:b.x,y:b.y,align:v,baseline:x},exit:{opacity:$e,x:b.x,y:b.y}};en(S,{dx:!d&&p?Pt(a,w):null,dy:!h&&p?Ei(a,w):null}),en(S,{angle:s("labelAngle"),fill:s("labelColor"),fillOpacity:s("labelOpacity"),font:s("labelFont"),fontSize:s("labelFontSize"),fontWeight:s("labelFontWeight"),fontStyle:s("labelFontStyle"),limit:s("labelLimit"),lineHeight:s("labelLineHeight")},{align:d,baseline:h});const E=s("labelBound");let _=s("labelOverlap");return _=_||E?{separation:s("labelSeparation"),method:_,order:"datum.index",bound:E?{scale:l,orient:a,tolerance:E}:null}:void 0,g.align!==v&&(g.align=vc(g.align,v)),g.baseline!==x&&(g.baseline=vc(g.baseline,x)),Cr({type:yu,role:ehe,style:Xp,key:Ur,from:r,encode:S,overlap:_},n)}function Dge(e,t,n,r){const i=lr(e,t),o=e.orient,s=zv(o,-1,1);let a,l;const u={enter:a={opacity:$e,anchor:Ot(i("titleAnchor",null)),align:{signal:E$}},update:l=ge({},a,{opacity:Wr,text:Ot(e.title)}),exit:{opacity:$e}},c={signal:`lerp(range("${e.scale}"), ${Ov(0,1,.5)})`};return l.x=Pt(o,c),l.y=Ei(o,c),a.angle=Pt(o,$e,$ge(s,90)),a.baseline=Pt(o,gj(o,_a,Di),{value:_a}),l.angle=a.angle,l.baseline=a.baseline,en(u,{fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),angle:i("titleAngle"),baseline:i("titleBaseline")}),Oge(i,o,u,n),u.update.align=vc(u.update.align,a.align),u.update.angle=vc(u.update.angle,a.angle),u.update.baseline=vc(u.update.baseline,a.baseline),Cr({type:yu,role:nhe,style:x$,from:r,encode:u},n)}function Oge(e,t,n,r){const i=(a,l)=>a!=null?(n.update[l]=vc(Ot(a),n.update[l]),!1):!Uu(l,r),o=i(e("titleX"),"x"),s=i(e("titleY"),"y");n.enter.auto=s===o?Ot(s):Pt(t,Ot(s),Ot(o))}function Pge(e,t){const n=Age(e,t),r=e.encode||{},i=r.axis||{},o=i.name||void 0,s=i.interactive,a=i.style,l=lr(e,n),u=Npe(l),c={scale:e.scale,ticks:!!l("ticks"),labels:!!l("labels"),grid:!!l("grid"),domain:!!l("domain"),title:e.title!=null},f=ae(t.add(Ri({},[c]))),d=ae(t.add(Lhe({scale:t.scaleRef(e.scale),extra:t.property(u.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),h=[];let p;return c.grid&&h.push(Mge(e,n,r.grid,d,u)),c.ticks&&(p=l("tickSize"),h.push(Nge(e,n,r.ticks,d,p,u))),c.labels&&(p=c.ticks?p:0,h.push(Rge(e,n,r.labels,d,p,u))),c.domain&&h.push(Fge(e,n,r.domain,f)),c.title&&h.push(Dge(e,n,r.title,f)),Lv(ap({role:Kde,from:f,encode:Nf(Lge(l,e),i,Qp),marks:h,aria:l("aria"),description:l("description"),zindex:l("zindex"),name:o,interactive:s,style:a}),t)}function Lge(e,t){const n={enter:{},update:{}};return en(n,{orient:e("orient"),offset:e("offset")||0,position:ci(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:`abs(span(range("${t.scale}")))`},translate:e("translate"),format:t.format,formatType:t.formatType}),n}function yj(e,t,n){const r=J(e.signals),i=J(e.scales);return n||r.forEach(o=>XI(o,t)),J(e.projections).forEach(o=>gpe(o,t)),i.forEach(o=>rpe(o,t)),J(e.data).forEach(o=>vge(o,t)),i.forEach(o=>ipe(o,t)),(n||r).forEach(o=>Phe(o,t)),J(e.axes).forEach(o=>Pge(o,t)),J(e.marks).forEach(o=>Lv(o,t)),J(e.legends).forEach(o=>sge(o,t)),e.title&&hge(e.title,t),t.parseLambdas(),t}const zge=e=>Nf({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e);function Ige(e,t){const n=t.config,r=ae(t.root=t.add(q1())),i=jge(e,n);i.forEach(u=>XI(u,t)),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;const o=t.add(Ri()),s=t.add(ZI(YI(zge(e.encode),Dv,p$,e.style,t,{pulse:ae(o)}))),a=t.add(tj({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:r,pulse:ae(s)}));t.operators.pop(),t.pushState(ae(s),ae(a),null),yj(e,t,i),t.operators.push(a);let l=t.add(KI({mark:r,pulse:ae(a)}));return l=t.add(ej({pulse:ae(l)})),l=t.add(mu({pulse:ae(l)})),t.addData("root",new Kl(t,o,o,l)),t}function md(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function jge(e,t){const n=s=>ci(e[s],t[s]),r=[md("background",n("background")),md("autosize",Yde(n("autosize"))),md("padding",Qde(n("padding"))),md("width",n("width")||0),md("height",n("height")||0)],i=r.reduce((s,a)=>(s[a.name]=a,s),{}),o={};return J(e.signals).forEach(s=>{te(i,s.name)?s=ge(i[s.name],s):r.push(s),o[s.name]=s}),J(t.signals).forEach(s=>{!te(o,s.name)&&!te(i,s.name)&&r.push(s)}),r}function vj(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function n8(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}vj.prototype=n8.prototype={parse(e){return yj(e,this)},fork(){return new n8(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach(t=>{t.$ref=e.id}),e.refs=null),e},proxy(e){const t=e instanceof iS?ae(e):e;return this.add(Khe({value:t}))},addStream(e){return this.streams.push(e),e.id=this.id(),e},addUpdate(e){return this.updates.push(e),e},finish(){let e,t;this.root&&(this.root.root=!0);for(e in this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(r,i,o){let s,a;r&&(s=r.data||(r.data={}),a=s[i]||(s[i]=[]),a.push(o))}for(e in this.data){t=this.data[e],n(t.input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values");for(const r in t.index)n(t.index[r],e,"index:"+r)}return this},pushState(e,t,n){this._encode.push(ae(this.add(mu({pulse:e})))),this._parent.push(t),this._lookup.push(n?ae(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return Ce(this._parent)},encode(){return Ce(this._encode)},lookup(){return Ce(this._lookup)},markpath(){const e=this._markpath;return++e[e.length-1]},fieldRef(e,t){if(ee(e))return op(e,t);e.signal||I("Unsupported field reference: "+Y(e));const n=e.signal;let r=this.field[n];if(!r){const i={name:this.signalRef(n)};t&&(i.as=t),this.field[n]=r=ae(this.add(Bhe(i)))}return r},compareRef(e){let t=!1;const n=o=>kt(o)?(t=!0,this.signalRef(o.signal)):Che(o)?(t=!0,this.exprRef(o.expr)):o,r=J(e.field).map(n),i=J(e.order).map(n);return t?ae(this.add(UM({fields:r,orders:i}))):jM(r,i)},keyRef(e,t){let n=!1;const r=o=>kt(o)?(n=!0,ae(i[o.signal])):o,i=this.signals;return e=J(e).map(r),n?ae(this.add(Uhe({fields:e,flat:t}))):Ehe(e,t)},sortRef(e){if(!e)return e;const t=Nv(e.op,e.field),n=e.order||She;return n.signal?ae(this.add(UM({fields:t,orders:this.signalRef(n.signal)}))):jM(t,n)},event(e,t){const n=e+":"+t;if(!this.events[n]){const r=this.id();this.streams.push({id:r,source:e,type:t}),this.events[n]=r}return this.events[n]},hasOwnSignal(e){return te(this.signals,e)},addSignal(e,t){this.hasOwnSignal(e)&&I("Duplicate signal name: "+Y(e));const n=t instanceof iS?t:this.add(q1(t));return this.signals[e]=n},getSignal(e){return this.signals[e]||I("Unrecognized signal name: "+Y(e)),this.signals[e]},signalRef(e){return this.signals[e]?ae(this.signals[e]):(te(this.lambdas,e)||(this.lambdas[e]=this.add(q1(null))),ae(this.lambdas[e]))},parseLambdas(){const e=Object.keys(this.lambdas);for(let t=0,n=e.length;t<n;++t){const r=e[t],i=mo(r,this),o=this.lambdas[r];o.params=i.$params,o.update=i.$expr}},property(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty(e){return!e||!Z(e)?e:this.signalRef(e.signal||$$(e))},exprRef(e,t){const n={expr:mo(e,this)};return t&&(n.expr.$name=t),ae(this.add(Ihe(n)))},addBinding(e,t){this.bindings||I("Nested signals do not support binding: "+Y(e)),this.bindings.push(ge({signal:e},t))},addScaleProj(e,t){te(this.scales,e)&&I("Duplicate scale or projection name: "+Y(e)),this.scales[e]=this.add(t)},addScale(e,t){this.addScaleProj(e,Jhe(t))},addProjection(e,t){this.addScaleProj(e,Qhe(t))},getScale(e){return this.scales[e]||I("Unrecognized scale name: "+Y(e)),this.scales[e]},scaleRef(e){return ae(this.getScale(e))},scaleType(e){return this.getScale(e).params.type},projectionRef(e){return this.scaleRef(e)},projectionType(e){return this.scaleType(e)},addData(e,t){return te(this.data,e)&&I("Duplicate data set name: "+Y(e)),this.data[e]=t},getData(e){return this.data[e]||I("Undefined data set name: "+Y(e)),this.data[e]},addDataPipeline(e,t){return te(this.data,e)&&I("Duplicate data set name: "+Y(e)),this.addData(e,Kl.fromEntries(this,t))}};function $$(e){return(j(e)?Bge:Uge)(e)}function Bge(e){const t=e.length;let n="[";for(let r=0;r<t;++r){const i=e[r];n+=(r>0?",":"")+(Z(i)?i.signal||$$(i):Y(i))}return n+"]"}function Uge(e){let t="{",n=0,r,i;for(r in e)i=e[r],t+=(++n>1?",":"")+Y(r)+":"+(Z(i)?i.signal||$$(i):Y(i));return t+"}"}function Wge(){const e="sans-serif",r="#4c78a8",i="#000",o="#888",s="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:r},area:{fill:r},image:null,line:{stroke:r,strokeWidth:2},path:{stroke:r},rect:{fill:r},rule:{stroke:i},shape:{stroke:r},symbol:{fill:r,size:64},text:{fill:i,font:e,fontSize:11},trail:{fill:r,size:2},style:{"guide-label":{fill:i,font:e,fontSize:10},"guide-title":{fill:i,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:i,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:i,font:e,fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:s},view:{fill:"transparent"}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:o,grid:!1,gridWidth:1,gridColor:s,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:o,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:s,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:o,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function qge(e,t,n){return Z(e)||I("Input Vega specification must be an object."),t=xf(Wge(),t,e.config),Ige(e,new vj(t,n)).toRuntime()}var Hge="5.30.0";ge(Pc,jK,yre,Xre,Doe,Ase,tle,Dae,rle,$le,Lle,qle);const Vge=Object.freeze(Object.defineProperty({__proto__:null,Bounds:vt,CanvasHandler:jp,CanvasRenderer:i1,DATE:nr,DAY:dn,DAYOFYEAR:po,Dataflow:pc,Debug:dR,Error:z_,EventStream:Iy,Gradient:sP,GroupItem:lv,HOURS:Sr,Handler:XC,HybridHandler:KP,HybridRenderer:dE,Info:fR,Item:av,MILLISECONDS:Ci,MINUTES:_r,MONTH:mn,Marks:kr,MultiPulse:uk,None:cR,Operator:qe,Parameters:zy,Pulse:ua,QUARTER:tr,RenderType:Gs,Renderer:Ip,ResourceLoader:hP,SECONDS:Yr,SVGHandler:zP,SVGRenderer:t3,SVGStringRenderer:QP,Scenegraph:MP,TIME_UNITS:J_,Transform:P,View:PI,WEEK:St,Warn:I_,YEAR:Kt,accessor:ar,accessorFields:gn,accessorName:ft,array:J,ascending:$y,bandwidthNRD:hk,bin:GD,bootstrapCI:YD,boundClip:aL,boundContext:Op,boundItem:aE,boundMark:CP,boundStroke:ys,changeset:du,clampRange:SR,codegenExpression:uI,compare:q_,constant:bn,cumulativeLogNormal:xk,cumulativeNormal:By,cumulativeUniform:Sk,dayofyear:eD,debounce:H_,defaultLocale:ik,definition:qD,densityLogNormal:vk,densityNormal:pk,densityUniform:Ek,domChild:bt,domClear:Dr,domCreate:Hs,domFind:YC,dotbin:XD,error:I,expressionFunction:mt,extend:ge,extent:co,extentIndex:_R,falsy:Fs,fastmap:bf,field:Vr,flush:kR,font:hv,fontFamily:zp,fontSize:So,format:T0,formatLocale:Pm,formats:ak,hasOwnProperty:te,id:wp,identity:wn,inferType:RD,inferTypes:DD,ingest:De,inherits:X,inrange:nc,interpolate:kC,interpolateColors:ov,interpolateRange:VO,intersect:rL,intersectBoxLine:rc,intersectPath:RC,intersectPoint:DC,intersectRule:gP,isArray:j,isBoolean:Da,isDate:aa,isFunction:me,isIterable:CR,isNumber:Me,isObject:Z,isRegExp:$R,isString:ee,isTuple:Py,key:V_,lerp:AR,lineHeight:ba,loader:Dy,locale:TD,logger:j_,lruCache:FR,markup:e3,merge:MR,mergeConfig:xf,multiLineOffset:HC,one:vf,pad:TR,panLinear:yR,panLog:vR,panPow:xR,panSymlog:wR,parse:qge,parseExpression:e$,parseSelector:ja,path:Vy,pathCurves:MC,pathEqual:lL,pathParse:Uc,pathRectangle:uP,pathRender:Gh,pathSymbols:lP,pathTrail:cP,peek:Ce,point:gv,projection:w3,quantileLogNormal:wk,quantileNormal:Uy,quantileUniform:_k,quantiles:fk,quantizeInterpolator:GO,quarter:bR,quartiles:dk,get random(){return Xr},randomInteger:qQ,randomKDE:mk,randomLCG:WQ,randomLogNormal:KD,randomMixture:ZD,randomNormal:gk,randomUniform:JD,read:LD,regressionConstant:kk,regressionExp:t9,regressionLinear:Ck,regressionLoess:i9,regressionLog:e9,regressionPoly:r9,regressionPow:n9,regressionQuad:$k,renderModule:mv,repeat:$d,resetDefaultLocale:jX,resetSVGClipId:dP,resetSVGDefIds:One,responseType:PD,runtimeContext:SI,sampleCurve:qy,sampleLogNormal:yk,sampleNormal:jy,sampleUniform:bk,scale:Ne,sceneEqual:n3,sceneFromJSON:AP,scenePickVisit:Qm,sceneToJSON:$P,sceneVisit:$i,sceneZOrder:OC,scheme:CC,serializeXML:VP,setHybridRendererOptions:Tne,setRandom:BQ,span:bp,splitAccessPath:wo,stringValue:Y,textMetrics:xr,timeBin:yD,timeFloor:aD,timeFormatLocale:Bh,timeInterval:kf,timeOffset:cD,timeSequence:hD,timeUnitSpecifier:JR,timeUnits:ek,toBoolean:G_,toDate:Y_,toNumber:hn,toSet:ki,toString:X_,transform:HD,transforms:Pc,truncate:NR,truthy:Gr,tupleid:le,typeParsers:Wb,utcFloor:lD,utcInterval:Cf,utcOffset:fD,utcSequence:pD,utcdayofyear:rD,utcquarter:ER,utcweek:iD,version:Hge,visitArray:Ds,week:tD,writeConfig:wf,zero:Bs,zoomLinear:B_,zoomLog:U_,zoomPow:Mm,zoomSymlog:W_},Symbol.toStringTag,{value:"Module"}));function Gge(e,t,n){let r;t.x2&&(t.x?(n&&e.x>e.x2&&(r=e.x,e.x=e.x2,e.x2=r),e.width=e.x2-e.x):e.x=e.x2-(e.width||0)),t.xc&&(e.x=e.xc-(e.width||0)/2),t.y2&&(t.y?(n&&e.y>e.y2&&(r=e.y,e.y=e.y2,e.y2=r),e.height=e.y2-e.y):e.y=e.y2-(e.height||0)),t.yc&&(e.y=e.yc-(e.height||0)/2)}var Yge={NaN:NaN,E:Math.E,LN2:Math.LN2,LN10:Math.LN10,LOG2E:Math.LOG2E,LOG10E:Math.LOG10E,PI:Math.PI,SQRT1_2:Math.SQRT1_2,SQRT2:Math.SQRT2,MIN_VALUE:Number.MIN_VALUE,MAX_VALUE:Number.MAX_VALUE},Xge={"*":(e,t)=>e*t,"+":(e,t)=>e+t,"-":(e,t)=>e-t,"/":(e,t)=>e/t,"%":(e,t)=>e%t,">":(e,t)=>e>t,"<":(e,t)=>e<t,"<=":(e,t)=>e<=t,">=":(e,t)=>e>=t,"==":(e,t)=>e==t,"!=":(e,t)=>e!=t,"===":(e,t)=>e===t,"!==":(e,t)=>e!==t,"&":(e,t)=>e&t,"|":(e,t)=>e|t,"^":(e,t)=>e^t,"<<":(e,t)=>e<<t,">>":(e,t)=>e>>t,">>>":(e,t)=>e>>>t},Qge={"+":e=>+e,"-":e=>-e,"~":e=>~e,"!":e=>!e};const Kge=Array.prototype.slice,Ka=(e,t,n)=>{const r=n?n(t[0]):t[0];return r[e].apply(r,Kge.call(t,1))},Zge=(e,t,n,r,i,o,s)=>new Date(e,t||0,n??1,r||0,i||0,o||0,s||0);var Jge={isNaN:Number.isNaN,isFinite:Number.isFinite,abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,atan2:Math.atan2,ceil:Math.ceil,cos:Math.cos,exp:Math.exp,floor:Math.floor,log:Math.log,max:Math.max,min:Math.min,pow:Math.pow,random:Math.random,round:Math.round,sin:Math.sin,sqrt:Math.sqrt,tan:Math.tan,clamp:(e,t,n)=>Math.max(t,Math.min(n,e)),now:Date.now,utc:Date.UTC,datetime:Zge,date:e=>new Date(e).getDate(),day:e=>new Date(e).getDay(),year:e=>new Date(e).getFullYear(),month:e=>new Date(e).getMonth(),hours:e=>new Date(e).getHours(),minutes:e=>new Date(e).getMinutes(),seconds:e=>new Date(e).getSeconds(),milliseconds:e=>new Date(e).getMilliseconds(),time:e=>new Date(e).getTime(),timezoneoffset:e=>new Date(e).getTimezoneOffset(),utcdate:e=>new Date(e).getUTCDate(),utcday:e=>new Date(e).getUTCDay(),utcyear:e=>new Date(e).getUTCFullYear(),utcmonth:e=>new Date(e).getUTCMonth(),utchours:e=>new Date(e).getUTCHours(),utcminutes:e=>new Date(e).getUTCMinutes(),utcseconds:e=>new Date(e).getUTCSeconds(),utcmilliseconds:e=>new Date(e).getUTCMilliseconds(),length:e=>e.length,join:function(){return Ka("join",arguments)},indexof:function(){return Ka("indexOf",arguments)},lastindexof:function(){return Ka("lastIndexOf",arguments)},slice:function(){return Ka("slice",arguments)},reverse:e=>e.slice().reverse(),parseFloat,parseInt,upper:e=>String(e).toUpperCase(),lower:e=>String(e).toLowerCase(),substring:function(){return Ka("substring",arguments,String)},split:function(){return Ka("split",arguments,String)},replace:function(){return Ka("replace",arguments,String)},trim:e=>String(e).trim(),regexp:RegExp,test:(e,t)=>RegExp(e).test(t)};const e0e=["view","item","group","xy","x","y"],fS=new Set([Function,eval,setTimeout,setInterval]);typeof setImmediate=="function"&&fS.add(setImmediate);const t0e={Literal:(e,t)=>t.value,Identifier:(e,t)=>{const n=t.name;return e.memberDepth>0?n:n==="datum"?e.datum:n==="event"?e.event:n==="item"?e.item:Yge[n]||e.params["$"+n]},MemberExpression:(e,t)=>{const n=!t.computed,r=e(t.object);n&&(e.memberDepth+=1);const i=e(t.property);if(n&&(e.memberDepth-=1),fS.has(r[i])){console.error(`Prevented interpretation of member "${i}" which could lead to insecure code execution`);return}return r[i]},CallExpression:(e,t)=>{const n=t.arguments;let r=t.callee.name;return r.startsWith("_")&&(r=r.slice(1)),r==="if"?e(n[0])?e(n[1]):e(n[2]):(e.fn[r]||Jge[r]).apply(e.fn,n.map(e))},ArrayExpression:(e,t)=>t.elements.map(e),BinaryExpression:(e,t)=>Xge[t.operator](e(t.left),e(t.right)),UnaryExpression:(e,t)=>Qge[t.operator](e(t.argument)),ConditionalExpression:(e,t)=>e(t.test)?e(t.consequent):e(t.alternate),LogicalExpression:(e,t)=>t.operator==="&&"?e(t.left)&&e(t.right):e(t.left)||e(t.right),ObjectExpression:(e,t)=>t.properties.reduce((n,r)=>{e.memberDepth+=1;const i=e(r.key);return e.memberDepth-=1,fS.has(e(r.value))?console.error(`Prevented interpretation of property "${i}" which could lead to insecure code execution`):n[i]=e(r.value),n},{})};function yd(e,t,n,r,i,o){const s=a=>t0e[a.type](s,a);return s.memberDepth=0,s.fn=Object.create(t),s.params=n,s.datum=r,s.event=i,s.item=o,e0e.forEach(a=>s.fn[a]=function(){return i.vega[a](...arguments)}),s(e)}var n0e={operator(e,t){const n=t.ast,r=e.functions;return i=>yd(n,r,i)},parameter(e,t){const n=t.ast,r=e.functions;return(i,o)=>yd(n,r,o,i)},event(e,t){const n=t.ast,r=e.functions;return i=>yd(n,r,void 0,void 0,i)},handler(e,t){const n=t.ast,r=e.functions;return(i,o)=>{const s=o.item&&o.item.datum;return yd(n,r,i,s,o)}},encode(e,t){const{marktype:n,channels:r}=t,i=e.functions,o=n==="group"||n==="image"||n==="rect";return(s,a)=>{const l=s.datum;let u=0,c;for(const f in r)c=yd(r[f].ast,i,a,l,void 0,s),s[f]!==c&&(s[f]=c,u=1);return n!=="rule"&&Gge(s,r,o),u}}};const r0e="vega-lite",i0e='Dominik Moritz, Kanit "Ham" Wongsuphasawat, Arvind Satyanarayan, Jeffrey Heer',o0e="5.21.0",s0e=["Kanit Wongsuphasawat (http://kanitw.yellowpigz.com)","Dominik Moritz (https://www.domoritz.de)","Arvind Satyanarayan (https://arvindsatya.com)","Jeffrey Heer (https://jheer.org)"],a0e="https://vega.github.io/vega-lite/",l0e="Vega-Lite is a concise high-level language for interactive visualization.",u0e=["vega","chart","visualization"],c0e="build/vega-lite.js",f0e="build/vega-lite.min.js",d0e="build/vega-lite.min.js",h0e="build/src/index",p0e="build/src/index.d.ts",g0e={vl2pdf:"./bin/vl2pdf",vl2png:"./bin/vl2png",vl2svg:"./bin/vl2svg",vl2vg:"./bin/vl2vg"},m0e=["bin","build","src","vega-lite*","tsconfig.json"],y0e={changelog:"conventional-changelog -p angular -r 2",prebuild:"yarn clean:build",build:"yarn build:only","build:only":"tsc -p tsconfig.build.json && rollup -c","prebuild:examples":"yarn build:only","build:examples":"yarn data && TZ=America/Los_Angeles scripts/build-examples.sh","prebuild:examples-full":"yarn build:only","build:examples-full":"TZ=America/Los_Angeles scripts/build-examples.sh 1","build:example":"TZ=America/Los_Angeles scripts/build-example.sh","build:toc":"yarn build:jekyll && scripts/generate-toc","build:site":"rollup -c site/rollup.config.mjs","build:jekyll":"pushd site && bundle exec jekyll build -q && popd","build:versions":"scripts/update-version.sh",clean:"yarn clean:build && del-cli 'site/data/*' 'examples/compiled/*.png' && find site/examples ! -name 'index.md' ! -name 'data' -type f -delete","clean:build":"del-cli 'build/*' !build/vega-lite-schema.json",data:"rsync -r node_modules/vega-datasets/data/* site/data","build-editor-preview":"scripts/build-editor-preview.sh",schema:"mkdir -p build && ts-json-schema-generator -f tsconfig.json -p src/index.ts -t TopLevelSpec --no-type-check --no-ref-encode > build/vega-lite-schema.json && yarn renameschema && cp build/vega-lite-schema.json site/_data/",renameschema:"scripts/rename-schema.sh",presite:"yarn data && yarn schema && yarn build:site && yarn build:versions && scripts/create-example-pages.sh",site:"yarn site:only","site:only":"pushd site && bundle exec jekyll serve -I -l && popd",prettierbase:"prettier '**/*.{md,css,yml}'",format:"eslint . --fix && yarn prettierbase --write",lint:"eslint . && yarn prettierbase --check",test:"yarn jest test/ && yarn lint && yarn schema && yarn jest examples/ && yarn test:runtime","test:cover":"yarn jest --collectCoverage test/","test:inspect":"node --inspect-brk ./node_modules/.bin/jest --runInBand test","test:runtime":"TZ=America/Los_Angeles npx jest test-runtime/ --config test-runtime/jest-config.json","test:runtime:generate":"yarn build:only && del-cli test-runtime/resources && VL_GENERATE_TESTS=true yarn test:runtime",watch:"tsc -p tsconfig.build.json -w","watch:site":"yarn build:site -w","watch:test":"yarn jest --watch test/","watch:test:runtime":"TZ=America/Los_Angeles npx jest --watch test-runtime/ --config test-runtime/jest-config.json",release:"release-it"},v0e={type:"git",url:"https://github.com/vega/vega-lite.git"},x0e="BSD-3-Clause",w0e={url:"https://github.com/vega/vega-lite/issues"},b0e={"@babel/core":"^7.24.9","@babel/preset-env":"^7.25.0","@babel/preset-typescript":"^7.24.7","@release-it/conventional-changelog":"^8.0.1","@rollup/plugin-alias":"^5.1.0","@rollup/plugin-babel":"^6.0.4","@rollup/plugin-commonjs":"^26.0.1","@rollup/plugin-json":"^6.1.0","@rollup/plugin-node-resolve":"^15.2.3","@rollup/plugin-terser":"^0.4.4","@types/d3":"^7.4.3","@types/jest":"^29.5.12","@types/pako":"^2.0.3","@typescript-eslint/eslint-plugin":"^7.17.0","@typescript-eslint/parser":"^7.17.0",ajv:"^8.17.1","ajv-formats":"^3.0.1",cheerio:"^1.0.0-rc.12","conventional-changelog-cli":"^5.0.0",d3:"^7.9.0","del-cli":"^5.1.0",eslint:"^8.57.0","eslint-config-prettier":"^9.1.0","eslint-plugin-jest":"^27.9.0","eslint-plugin-prettier":"^5.2.1","fast-json-stable-stringify":"~2.1.0","highlight.js":"^11.10.0",jest:"^29.7.0","jest-dev-server":"^10.0.0",mkdirp:"^3.0.1",pako:"^2.1.0",prettier:"^3.3.3",puppeteer:"^15.0.0","release-it":"17.6.0",rollup:"^4.19.1","rollup-plugin-bundle-size":"^1.0.3",serve:"^14.2.3",terser:"^5.31.3","ts-jest":"^29.2.3","ts-json-schema-generator":"^2.3.0",typescript:"~5.5.4","vega-cli":"^5.28.0","vega-datasets":"^2.8.1","vega-embed":"^6.26.0","vega-tooltip":"^0.34.0","yaml-front-matter":"^4.1.1"},E0e={"json-stringify-pretty-compact":"~3.0.0",tslib:"~2.6.3","vega-event-selector":"~3.0.1","vega-expression":"~5.1.1","vega-util":"~1.17.2",yargs:"~17.7.2"},S0e={vega:"^5.24.0"},_0e={node:">=18"},k0e="yarn@1.22.19",C0e={name:r0e,author:i0e,version:o0e,collaborators:s0e,homepage:a0e,description:l0e,keywords:u0e,main:c0e,unpkg:f0e,jsdelivr:d0e,module:h0e,types:p0e,bin:g0e,files:m0e,scripts:y0e,repository:v0e,license:x0e,bugs:w0e,devDependencies:b0e,dependencies:E0e,peerDependencies:S0e,engines:_0e,packageManager:k0e};function A$(e){return W(e,"or")}function F$(e){return W(e,"and")}function M$(e){return W(e,"not")}function tm(e,t){if(M$(e))tm(e.not,t);else if(F$(e))for(const n of e.and)tm(n,t);else if(A$(e))for(const n of e.or)tm(n,t);else t(e)}function xc(e,t){return M$(e)?{not:xc(e.not,t)}:F$(e)?{and:e.and.map(n=>xc(n,t))}:A$(e)?{or:e.or.map(n=>xc(n,t))}:t(e)}const de=structuredClone;function xj(e){throw new Error(e)}function Kc(e,t){const n={};for(const r of t)te(e,r)&&(n[r]=e[r]);return n}function Jn(e,t){const n={...e};for(const r of t)delete n[r];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map(e=>Ue(e)).join(",")})`};function _e(e){if(Me(e))return e;const t=ee(e)?e:Ue(e);if(t.length<250)return t;let n=0;for(let r=0;r<t.length;r++){const i=t.charCodeAt(r);n=(n<<5)-n+i,n=n&n}return n}function dS(e){return e===!1||e===null}function Ee(e,t){return e.includes(t)}function Zc(e,t){let n=0;for(const[r,i]of e.entries())if(t(i,r,n++))return!0;return!1}function T$(e,t){let n=0;for(const[r,i]of e.entries())if(!t(i,r,n++))return!1;return!0}function wj(e,...t){for(const n of t)$0e(e,n??{});return e}function $0e(e,t){for(const n of B(t))wf(e,n,t[n],!0)}function eo(e,t){const n=[],r={};let i;for(const o of e)i=t(o),!(i in r)&&(r[i]=1,n.push(o));return n}function A0e(e,t){const n=B(e),r=B(t);if(n.length!==r.length)return!1;for(const i of n)if(e[i]!==t[i])return!1;return!0}function bj(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function N$(e,t){for(const n of e)if(t.has(n))return!0;return!1}function hS(e){const t=new Set;for(const n of e){const i=wo(n).map((s,a)=>a===0?s:`[${s}]`),o=i.map((s,a)=>i.slice(0,a+1).join(""));for(const s of o)t.add(s)}return t}function R$(e,t){return e===void 0||t===void 0?!0:N$(hS(e),hS(t))}function Be(e){return B(e).length===0}const B=Object.keys,Zt=Object.values,ka=Object.entries;function lp(e){return e===!0||e===!1}function Je(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function vh(e,t){return M$(e)?`!(${vh(e.not,t)})`:F$(e)?`(${e.and.map(n=>vh(n,t)).join(") && (")})`:A$(e)?`(${e.or.map(n=>vh(n,t)).join(") || (")})`:t(e)}function H1(e,t){if(t.length===0)return!0;const n=t.shift();return n in e&&H1(e[n],t)&&delete e[n],Be(e)}function Kp(e){return e.charAt(0).toUpperCase()+e.substr(1)}function D$(e,t="datum"){const n=wo(e),r=[];for(let i=1;i<=n.length;i++){const o=`[${n.slice(0,i).map(Y).join("][")}]`;r.push(`${t}${o}`)}return r.join(" && ")}function Ej(e,t="datum"){return`${t}[${Y(wo(e).join("."))}]`}function F0e(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function Kr(e){return`${wo(e).map(F0e).join("\\.")}`}function Zl(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function Of(e){return`${wo(e).join(".")}`}function Jc(e){return e?wo(e).length:0}function pt(...e){return e.find(t=>t!==void 0)}let Sj=42;function _j(e){const t=++Sj;return e?String(e)+t:t}function M0e(){Sj=42}function kj(e){return Cj(e)?e:`__${e}`}function Cj(e){return e.startsWith("__")}function up(e){if(e!==void 0)return(e%360+360)%360}function Iv(e){return Me(e)?!0:!isNaN(e)&&!isNaN(parseFloat(e))}const r8=Object.getPrototypeOf(structuredClone({}));function yr(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor.name!==t.constructor.name)return!1;let n,r;if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(r=n;r--!==0;)if(!yr(e[r],t[r]))return!1;return!0}if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const o of e.entries())if(!t.has(o[0]))return!1;for(const o of e.entries())if(!yr(o[1],t.get(o[0])))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const o of e.entries())if(!t.has(o[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(n=e.length,n!=t.length)return!1;for(r=n;r--!==0;)if(e[r]!==t[r])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf&&e.valueOf!==r8.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString&&e.toString!==r8.toString)return e.toString()===t.toString();const i=Object.keys(e);if(n=i.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!Object.prototype.hasOwnProperty.call(t,i[r]))return!1;for(r=n;r--!==0;){const o=i[r];if(!yr(e[o],t[o]))return!1}return!0}return e!==e&&t!==t}function Ue(e){const t=[];return function n(r){if(r&&r.toJSON&&typeof r.toJSON=="function"&&(r=r.toJSON()),r===void 0)return;if(typeof r=="number")return isFinite(r)?""+r:"null";if(typeof r!="object")return JSON.stringify(r);let i,o;if(Array.isArray(r)){for(o="[",i=0;i<r.length;i++)i&&(o+=","),o+=n(r[i])||"null";return o+"]"}if(r===null)return"null";if(t.includes(r))throw new TypeError("Converting circular structure to JSON");const s=t.push(r)-1,a=Object.keys(r).sort();for(o="",i=0;i<a.length;i++){const l=a[i],u=n(r[l]);u&&(o&&(o+=","),o+=JSON.stringify(l)+":"+u)}return t.splice(s,1),`{${o}}`}(e)}function W(e,t){return Z(e)&&te(e,t)&&e[t]!==void 0}const ns="row",rs="column",jv="facet",et="x",Bt="y",Oi="x2",$o="y2",Ba="xOffset",Pf="yOffset",Pi="radius",xs="radius2",ei="theta",ws="theta2",Li="latitude",zi="longitude",Ii="latitude2",Zr="longitude2",ir="color",Ao="fill",Fo="stroke",or="shape",bs="size",vu="angle",Es="opacity",Ua="fillOpacity",Wa="strokeOpacity",qa="strokeWidth",Ha="strokeDash",Zp="text",ef="order",Jp="detail",Bv="key",Jl="tooltip",Uv="href",Wv="url",qv="description",T0e={x:1,y:1,x2:1,y2:1},$j={theta:1,theta2:1,radius:1,radius2:1};function Aj(e){return te($j,e)}const O$={longitude:1,longitude2:1,latitude:1,latitude2:1};function Fj(e){switch(e){case Li:return"y";case Ii:return"y2";case zi:return"x";case Zr:return"x2"}}function Mj(e){return te(O$,e)}const N0e=B(O$),P$={...T0e,...$j,...O$,xOffset:1,yOffset:1,color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1};function wc(e){return e===ir||e===Ao||e===Fo}const Tj={row:1,column:1,facet:1},jr=B(Tj),L$={...P$,...Tj},R0e=B(L$),{order:I_e,detail:j_e,tooltip:B_e,...D0e}=L$,{row:U_e,column:W_e,facet:q_e,...O0e}=D0e;function P0e(e){return te(O0e,e)}function Nj(e){return te(L$,e)}const L0e=[Oi,$o,Ii,Zr,ws,xs];function Rj(e){return xu(e)!==e}function xu(e){switch(e){case Oi:return et;case $o:return Bt;case Ii:return Li;case Zr:return zi;case ws:return ei;case xs:return Pi}return e}function Ca(e){if(Aj(e))switch(e){case ei:return"startAngle";case ws:return"endAngle";case Pi:return"outerRadius";case xs:return"innerRadius"}return e}function Mo(e){switch(e){case et:return Oi;case Bt:return $o;case Li:return Ii;case zi:return Zr;case ei:return ws;case Pi:return xs}}function sr(e){switch(e){case et:case Oi:return"width";case Bt:case $o:return"height"}}function Dj(e){switch(e){case et:return"xOffset";case Bt:return"yOffset";case Oi:return"x2Offset";case $o:return"y2Offset";case ei:return"thetaOffset";case Pi:return"radiusOffset";case ws:return"theta2Offset";case xs:return"radius2Offset"}}function z$(e){switch(e){case et:return"xOffset";case Bt:return"yOffset"}}function z0e(e){switch(e){case"xOffset":return"x";case"yOffset":return"y"}}const I0e=B(P$),{x:H_e,y:V_e,x2:G_e,y2:Y_e,xOffset:X_e,yOffset:Q_e,latitude:K_e,longitude:Z_e,latitude2:J_e,longitude2:eke,theta:tke,theta2:nke,radius:rke,radius2:ike,...I$}=P$,j0e=B(I$),j$={x:1,y:1},Ss=B(j$);function gt(e){return te(j$,e)}const B$={theta:1,radius:1},B0e=B(B$);function Hv(e){return e==="width"?et:Bt}const Oj={xOffset:1,yOffset:1};function eg(e){return te(Oj,e)}const{text:oke,tooltip:ske,href:ake,url:lke,description:uke,detail:cke,key:fke,order:dke,...Pj}=I$,U0e=B(Pj);function W0e(e){return te(I$,e)}function q0e(e){switch(e){case ir:case Ao:case Fo:case bs:case or:case Es:case qa:case Ha:return!0;case Ua:case Wa:case vu:return!1}}const Lj={...j$,...B$,...Oj,...Pj},U$=B(Lj);function To(e){return te(Lj,e)}function H0e(e,t){return G0e(e)[t]}const zj={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},{geoshape:hke,...V0e}=zj;function G0e(e){switch(e){case ir:case Ao:case Fo:case qv:case Jp:case Bv:case Jl:case Uv:case ef:case Es:case Ua:case Wa:case qa:case jv:case ns:case rs:return zj;case et:case Bt:case Ba:case Pf:case Li:case zi:return V0e;case Oi:case $o:case Ii:case Zr:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case bs:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case Ha:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case or:return{point:"always",geoshape:"always"};case Zp:return{text:"always"};case vu:return{point:"always",square:"always",text:"always"};case Wv:return{image:"always"};case ei:return{text:"always",arc:"always"};case Pi:return{text:"always",arc:"always"};case ws:case xs:return{arc:"always"}}}function uw(e){switch(e){case et:case Bt:case ei:case Pi:case Ba:case Pf:case bs:case vu:case qa:case Es:case Ua:case Wa:case Oi:case $o:case ws:case xs:return;case jv:case ns:case rs:case or:case Ha:case Zp:case Jl:case Uv:case Wv:case qv:return"discrete";case ir:case Ao:case Fo:return"flexible";case Li:case zi:case Ii:case Zr:case Jp:case Bv:case ef:return}}const Y0e={argmax:1,argmin:1,average:1,count:1,distinct:1,exponential:1,exponentialb:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},X0e={count:1,min:1,max:1};function ps(e){return W(e,"argmin")}function Va(e){return W(e,"argmax")}function W$(e){return ee(e)&&te(Y0e,e)}const Q0e=new Set(["count","valid","missing","distinct"]);function Vv(e){return ee(e)&&Q0e.has(e)}function K0e(e){return ee(e)&&Ee(["min","max"],e)}const Z0e=new Set(["count","sum","distinct","valid","missing"]),J0e=new Set(["mean","average","median","q1","q3","min","max"]);function Ij(e){return Da(e)&&(e=ix(e,void 0)),"bin"+B(e).map(t=>Gv(e[t])?Je(`_${t}_${ka(e[t])}`):Je(`_${t}_${e[t]}`)).join("")}function Ve(e){return e===!0||wu(e)&&!e.binned}function qt(e){return e==="binned"||wu(e)&&e.binned===!0}function wu(e){return Z(e)}function Gv(e){return W(e,"param")}function i8(e){switch(e){case ns:case rs:case bs:case ir:case Ao:case Fo:case qa:case Es:case Ua:case Wa:case or:return 6;case Ha:return 4;default:return 10}}function tg(e){return W(e,"expr")}function Ht(e,{level:t}={level:0}){const n=B(e||{}),r={};for(const i of n)r[i]=t===0?hr(e[i]):Ht(e[i],{level:t-1});return r}function jj(e){const{anchor:t,frame:n,offset:r,orient:i,angle:o,limit:s,color:a,subtitleColor:l,subtitleFont:u,subtitleFontSize:c,subtitleFontStyle:f,subtitleFontWeight:d,subtitleLineHeight:h,subtitlePadding:p,...g}=e,y={...g,...a?{fill:a}:{}},m={...t?{anchor:t}:{},...n?{frame:n}:{},...r?{offset:r}:{},...i?{orient:i}:{},...o!==void 0?{angle:o}:{},...s!==void 0?{limit:s}:{}},v={...l?{subtitleColor:l}:{},...u?{subtitleFont:u}:{},...c?{subtitleFontSize:c}:{},...f?{subtitleFontStyle:f}:{},...d?{subtitleFontWeight:d}:{},...h?{subtitleLineHeight:h}:{},...p?{subtitlePadding:p}:{}},x=Kc(e,["align","baseline","dx","dy","limit"]);return{titleMarkConfig:y,subtitleMarkConfig:x,nonMarkTitleProperties:m,subtitle:v}}function zs(e){return ee(e)||j(e)&&ee(e[0])}function oe(e){return W(e,"signal")}function bu(e){return W(e,"step")}function eme(e){return j(e)?!1:W(e,"fields")&&!W(e,"data")}function tme(e){return j(e)?!1:W(e,"fields")&&W(e,"data")}function Ko(e){return j(e)?!1:W(e,"field")&&W(e,"data")}const nme={aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1,url:1,smooth:1},rme=B(nme),ime={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},pS=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function Bj(e){const t=j(e.condition)?e.condition.map(o8):o8(e.condition);return{...hr(e),condition:t}}function hr(e){if(tg(e)){const{expr:t,...n}=e;return{signal:t,...n}}return e}function o8(e){if(tg(e)){const{expr:t,...n}=e;return{signal:t,...n}}return e}function Xe(e){if(tg(e)){const{expr:t,...n}=e;return{signal:t,...n}}return oe(e)?e:e!==void 0?{value:e}:void 0}function ome(e){return oe(e)?e.signal:Y(e)}function s8(e){return oe(e)?e.signal:Y(e.value)}function vi(e){return oe(e)?e.signal:e==null?null:Y(e)}function sme(e,t,n){for(const r of n){const i=yo(r,t.markDef,t.config);i!==void 0&&(e[r]=Xe(i))}return e}function Uj(e){return[].concat(e.type,e.style??[])}function je(e,t,n,r={}){const{vgChannel:i,ignoreVgConfig:o}=r;return i&&W(t,i)?t[i]:t[e]!==void 0?t[e]:o&&(!i||i===e)?void 0:yo(e,t,n,r)}function yo(e,t,n,{vgChannel:r}={}){const i=gS(e,t,n.style);return pt(r?i:void 0,i,r?n[t.type][r]:void 0,n[t.type][e],r?n.mark[r]:n.mark[e])}function gS(e,t,n){return Wj(e,Uj(t),n)}function Wj(e,t,n){t=J(t);let r;for(const i of t){const o=n[i];W(o,e)&&(r=o[e])}return r}function qj(e,t){return J(e).reduce((n,r)=>(n.field.push(Q(r,t)),n.order.push(r.sort??"ascending"),n),{field:[],order:[]})}function Hj(e,t){const n=[...e];return t.forEach(r=>{for(const i of n)if(yr(i,r))return;n.push(r)}),n}function Vj(e,t){return yr(e,t)||!t?e:e?[...J(e),...J(t)].join(", "):t}function Gj(e,t){const n=e.value,r=t.value;if(n==null||r===null)return{explicit:e.explicit,value:null};if((zs(n)||oe(n))&&(zs(r)||oe(r)))return{explicit:e.explicit,value:Vj(n,r)};if(zs(n)||oe(n))return{explicit:e.explicit,value:n};if(zs(r)||oe(r))return{explicit:e.explicit,value:r};if(!zs(n)&&!oe(n)&&!zs(r)&&!oe(r))return{explicit:e.explicit,value:Hj(n,r)};throw new Error("It should never reach here")}function q$(e){return`Invalid specification ${Ue(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}const ame='Autosize "fit" only works for single views and layered views.';function a8(e){return`${e=="width"?"Width":"Height"} "container" only works for single views and layered views.`}function l8(e){const t=e=="width"?"Width":"Height",n=e=="width"?"x":"y";return`${t} "container" only works well with autosize "fit" or "fit-${n}".`}function u8(e){return e?`Dropping "fit-${e}" because spec has discrete ${sr(e)}.`:'Dropping "fit" because spec has discrete size.'}function H$(e){return`Unknown field for ${e}. Cannot calculate view size.`}function c8(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function lme(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function ume(e){return`The "nearest" transform is not supported for ${e} marks.`}function Yj(e){return`Selection not supported for ${e} yet.`}function cme(e){return`Cannot find a selection named "${e}".`}const fme="Scale bindings are currently only supported for scales with unbinned, continuous domains.",dme="Sequntial scales are deprecated. The available quantitative scale type values are linear, log, pow, sqrt, symlog, time and utc",hme="Legend bindings are only supported for selections over an individual field or encoding channel.";function pme(e){return`Lookups can only be performed on selection parameters. "${e}" is a variable parameter.`}function gme(e){return`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`}const mme="The same selection must be used to override scale domains in a layered view.",yme='Interval selections should be initialized using "x", "y", "longitude", or "latitude" keys.';function vme(e){return`Unknown repeated value "${e}".`}function f8(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}const xme="Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function wme(e){return`Unrecognized parse "${e}".`}function d8(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`}const bme="Attempt to add the same child twice.";function Eme(e){return`Ignoring an invalid transform: ${Ue(e)}.`}const Sme='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function h8(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function _me(e){const{parentProjection:t,projection:n}=e;return`Layer's shared projection ${Ue(t)} is overridden by a child projection ${Ue(n)}.`}const kme="Arc marks uses theta channel rather than angle, replacing angle with theta.";function Cme(e){return`${e}Offset dropped because ${e} is continuous`}function $me(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${Ue(n)}}.`}function Xj(e){return`Invalid field type "${e}".`}function Ame(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}function Fme(e){return`Invalid aggregation operator "${e}".`}function Qj(e,t){const{fill:n,stroke:r}=t;return`Dropping color ${e} as the plot also has ${n&&r?"fill and stroke":n?"fill":"stroke"}.`}function Mme(e){return`Position range does not support relative band size for ${e}.`}function mS(e,t){return`Dropping ${Ue(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`}const Tme="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function Yv(e,t,n){return`${e} dropped as it is incompatible with "${t}".`}function Nme(e){return`${e}-encoding is dropped as ${e} is not a valid encoding channel.`}function Rme(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`}function Dme(e){return`${e} encoding should be discrete (ordinal / nominal / binned) or use a discretizing scale (e.g. threshold).`}function Ome(e){return`Facet encoding dropped as ${e.join(" and ")} ${e.length>1?"are":"is"} also specified.`}function cw(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${t==="ordinal"?"order":"magnitude"}.`}function Pme(e){return`The ${e} for range marks cannot be an expression`}function Lme(e,t){return`Line mark is for continuous lines and thus cannot be used with ${e&&t?"x2 and y2":e?"x2":"y2"}. We will use the rule mark (line segments) instead.`}function zme(e,t){return`Specified orient "${e}" overridden with "${t}".`}function Ime(e){return`Cannot use the scale property "${e}" with non-color channel.`}function jme(e){return`Cannot use the relative band size with ${e} scale.`}function Bme(e){return`Using unaggregated domain with raw field has no effect (${Ue(e)}).`}function Ume(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function Wme(e){return`Unaggregated domain is currently unsupported for log scale (${Ue(e)}).`}function qme(e){return`Cannot apply size to non-oriented mark "${e}".`}function Hme(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`}function Vme(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}function Kj(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function Zj(e){return`The step for "${e}" is dropped because the ${e==="width"?"x":"y"} is continuous.`}function Gme(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${Ue(n)} and ${Ue(r)}). Using ${Ue(n)}.`}function Yme(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${Ue(n)} and ${Ue(r)}). Using the union of the two domains.`}function Xme(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}function Qme(e){return`Dropping sort property ${Ue(e)} as unioned domains only support boolean or op "count", "min", and "max".`}const p8="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",Kme="Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.",Zme="Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect.",Jme="Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.";function e1e(e){return`Cannot stack "${e}" if there is already "${e}2".`}function t1e(e){return`Stack is applied to a non-linear scale (${e}).`}function n1e(e){return`Stacking is applied even though the aggregate function is non-summative ("${e}").`}function V1(e,t){return`Invalid ${e}: ${Ue(t)}.`}function r1e(e){return`Dropping day from datetime ${Ue(e)} as day cannot be combined with other units.`}function i1e(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}function o1e(e,t,n){return`${e} is not usually used with ${t} for ${n}.`}function s1e(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}function g8(e){return`1D error band does not support ${e}.`}function Jj(e){return`Channel ${e} is required for "binned" bin.`}function a1e(e){return`Channel ${e} should not be used with "binned" bin.`}function l1e(e){return`Domain for ${e} is required for threshold scale.`}const eB=j_(I_);let tf=eB;function u1e(e){return tf=e,tf}function c1e(){return tf=eB,tf}function q(...e){tf.warn(...e)}function f1e(...e){tf.debug(...e)}function Eu(e){if(e&&Z(e)){for(const t of G$)if(W(e,t))return!0}return!1}const tB=["january","february","march","april","may","june","july","august","september","october","november","december"],d1e=tB.map(e=>e.substr(0,3)),nB=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],h1e=nB.map(e=>e.substr(0,3));function p1e(e){if(Iv(e)&&(e=+e),Me(e))return e>4&&q(V1("quarter",e)),e-1;throw new Error(V1("quarter",e))}function g1e(e){if(Iv(e)&&(e=+e),Me(e))return e-1;{const t=e.toLowerCase(),n=tB.indexOf(t);if(n!==-1)return n;const r=t.substr(0,3),i=d1e.indexOf(r);if(i!==-1)return i;throw new Error(V1("month",e))}}function m1e(e){if(Iv(e)&&(e=+e),Me(e))return e%7;{const t=e.toLowerCase(),n=nB.indexOf(t);if(n!==-1)return n;const r=t.substr(0,3),i=h1e.indexOf(r);if(i!==-1)return i;throw new Error(V1("day",e))}}function V$(e,t){const n=[];if(t&&e.day!==void 0&&B(e).length>1&&(q(r1e(e)),e=de(e),delete e.day),e.year!==void 0?n.push(e.year):n.push(2012),e.month!==void 0){const r=t?g1e(e.month):e.month;n.push(r)}else if(e.quarter!==void 0){const r=t?p1e(e.quarter):e.quarter;n.push(Me(r)?r*3:`${r}*3`)}else n.push(0);if(e.date!==void 0)n.push(e.date);else if(e.day!==void 0){const r=t?m1e(e.day):e.day;n.push(Me(r)?r+1:`${r}+1`)}else n.push(1);for(const r of["hours","minutes","seconds","milliseconds"]){const i=e[r];n.push(typeof i>"u"?0:i)}return n}function eu(e){const n=V$(e,!0).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function y1e(e){const n=V$(e,!1).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function v1e(e){const t=V$(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}const rB={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},G$=B(rB);function x1e(e){return te(rB,e)}function Su(e){return Z(e)?e.binned:iB(e)}function iB(e){return e&&e.startsWith("binned")}function Y$(e){return e.startsWith("utc")}function w1e(e){return e.substring(3)}const b1e={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function Xv(e){return G$.filter(t=>sB(e,t))}function oB(e){const t=Xv(e);return t[t.length-1]}function sB(e,t){const n=e.indexOf(t);return!(n<0||n>0&&t==="seconds"&&e.charAt(n-1)==="i"||e.length>n+3&&t==="day"&&e.charAt(n+3)==="o"||n>0&&t==="year"&&e.charAt(n-1)==="f")}function E1e(e,t,{end:n}={end:!1}){const r=D$(t),i=Y$(e)?"utc":"";function o(l){return l==="quarter"?`(${i}quarter(${r})-1)`:`${i}${l}(${r})`}let s;const a={};for(const l of G$)sB(e,l)&&(a[l]=o(l),s=l);return n&&(a[s]+="+1"),y1e(a)}function aB(e){if(!e)return;const t=Xv(e);return`timeUnitSpecifier(${Ue(t)}, ${Ue(b1e)})`}function S1e(e,t,n){if(!e)return;const r=aB(e);return`${n||Y$(e)?"utc":"time"}Format(${t}, ${r})`}function zt(e){if(!e)return;let t;return ee(e)?iB(e)?t={unit:e.substring(6),binned:!0}:t={unit:e}:Z(e)&&(t={...e,...e.unit?{unit:e.unit}:{}}),Y$(t.unit)&&(t.utc=!0,t.unit=w1e(t.unit)),t}function _1e(e){const{utc:t,...n}=zt(e);return n.unit?(t?"utc":"")+B(n).map(r=>Je(`${r==="unit"?"":`_${r}_`}${n[r]}`)).join(""):(t?"utc":"")+"timeunit"+B(n).map(r=>Je(`_${r}_${n[r]}`)).join("")}function lB(e,t=n=>n){const n=zt(e),r=oB(n.unit);if(r&&r!=="day"){const i={year:2001,month:1,date:1,hours:0,minutes:0,seconds:0,milliseconds:0},{step:o,part:s}=uB(r,n.step),a={...i,[s]:+i[s]+o};return`${t(eu(a))} - ${t(eu(i))}`}}const k1e={year:1,month:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1};function C1e(e){return te(k1e,e)}function uB(e,t=1){if(C1e(e))return{part:e,step:t};switch(e){case"day":case"dayofyear":return{part:"date",step:t};case"quarter":return{part:"month",step:t*3};case"week":return{part:"date",step:t*7}}}function $1e(e){return W(e,"param")}function X$(e){return!!(e!=null&&e.field)&&e.equal!==void 0}function Q$(e){return!!(e!=null&&e.field)&&e.lt!==void 0}function K$(e){return!!(e!=null&&e.field)&&e.lte!==void 0}function Z$(e){return!!(e!=null&&e.field)&&e.gt!==void 0}function J$(e){return!!(e!=null&&e.field)&&e.gte!==void 0}function eA(e){if(e!=null&&e.field){if(j(e.range)&&e.range.length===2)return!0;if(oe(e.range))return!0}return!1}function tA(e){return!!(e!=null&&e.field)&&(j(e.oneOf)||j(e.in))}function A1e(e){return!!(e!=null&&e.field)&&e.valid!==void 0}function cB(e){return tA(e)||X$(e)||eA(e)||Q$(e)||Z$(e)||K$(e)||J$(e)}function qi(e,t){return ox(e,{timeUnit:t,wrapTime:!0})}function F1e(e,t){return e.map(n=>qi(n,t))}function fB(e,t=!0){const{field:n}=e,r=zt(e.timeUnit),{unit:i,binned:o}=r||{},s=Q(e,{expr:"datum"}),a=i?`time(${o?s:E1e(i,n)})`:s;if(X$(e))return`${a}===${qi(e.equal,i)}`;if(Q$(e)){const l=e.lt;return`${a}<${qi(l,i)}`}else if(Z$(e)){const l=e.gt;return`${a}>${qi(l,i)}`}else if(K$(e)){const l=e.lte;return`${a}<=${qi(l,i)}`}else if(J$(e)){const l=e.gte;return`${a}>=${qi(l,i)}`}else{if(tA(e))return`indexof([${F1e(e.oneOf,i).join(",")}], ${a}) !== -1`;if(A1e(e))return Qv(a,e.valid);if(eA(e)){const{range:l}=Ht(e),u=oe(l)?{signal:`${l.signal}[0]`}:l[0],c=oe(l)?{signal:`${l.signal}[1]`}:l[1];if(u!==null&&c!==null&&t)return"inrange("+a+", ["+qi(u,i)+", "+qi(c,i)+"])";const f=[];return u!==null&&f.push(`${a} >= ${qi(u,i)}`),c!==null&&f.push(`${a} <= ${qi(c,i)}`),f.length>0?f.join(" && "):"true"}}throw new Error(`Invalid field predicate: ${Ue(e)}`)}function Qv(e,t=!0){return t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function M1e(e){return cB(e)&&e.timeUnit?{...e,timeUnit:zt(e.timeUnit)}:e}const ng={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"};function T1e(e){return e==="quantitative"||e==="temporal"}function dB(e){return e==="ordinal"||e==="nominal"}const tu=ng.quantitative,nA=ng.ordinal,nf=ng.temporal,rA=ng.nominal,Lf=ng.geojson;function N1e(e){if(e)switch(e=e.toLowerCase(),e){case"q":case tu:return"quantitative";case"t":case nf:return"temporal";case"o":case nA:return"ordinal";case"n":case rA:return"nominal";case Lf:return"geojson"}}const Vt={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",SYMLOG:"symlog",IDENTITY:"identity",SEQUENTIAL:"sequential",TIME:"time",UTC:"utc",QUANTILE:"quantile",QUANTIZE:"quantize",THRESHOLD:"threshold",BIN_ORDINAL:"bin-ordinal",ORDINAL:"ordinal",POINT:"point",BAND:"band"},yS={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"};function R1e(e,t){const n=yS[e],r=yS[t];return n===r||n==="ordinal-position"&&r==="time"||r==="ordinal-position"&&n==="time"}const D1e={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function m8(e){return D1e[e]}const hB=new Set(["linear","log","pow","sqrt","symlog"]),pB=new Set([...hB,"time","utc"]);function gB(e){return hB.has(e)}const mB=new Set(["quantile","quantize","threshold"]),O1e=new Set([...pB,...mB,"sequential","identity"]),P1e=new Set(["ordinal","bin-ordinal","point","band"]);function It(e){return P1e.has(e)}function Ai(e){return O1e.has(e)}function to(e){return pB.has(e)}function rf(e){return mB.has(e)}const L1e={pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,tickBandPaddingInner:.25,bandWithNestedOffsetPaddingInner:.2,bandWithNestedOffsetPaddingOuter:.2,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:4,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4,zero:!0};function z1e(e){return!ee(e)&&W(e,"name")}function yB(e){return W(e,"param")}function I1e(e){return W(e,"unionWith")}function j1e(e){return Z(e)&&"field"in e}const B1e={type:1,domain:1,domainMax:1,domainMin:1,domainMid:1,domainRaw:1,align:1,range:1,rangeMax:1,rangeMin:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},{type:pke,domain:gke,range:mke,rangeMax:yke,rangeMin:vke,scheme:xke,...U1e}=B1e,W1e=B(U1e);function vS(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!["point","band","identity"].includes(e);case"bins":return!["point","band","identity","ordinal"].includes(e);case"round":return to(e)||e==="band"||e==="point";case"padding":case"rangeMin":case"rangeMax":return to(e)||["point","band"].includes(e);case"paddingOuter":case"align":return["point","band"].includes(e);case"paddingInner":return e==="band";case"domainMax":case"domainMid":case"domainMin":case"domainRaw":case"clamp":return to(e);case"nice":return to(e)||e==="quantize"||e==="threshold";case"exponent":return e==="pow";case"base":return e==="log";case"constant":return e==="symlog";case"zero":return Ai(e)&&!Ee(["log","time","utc","threshold","quantile"],e)}}function vB(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return wc(e)?void 0:Ime(t);case"align":case"type":case"bins":case"domain":case"domainMax":case"domainMin":case"domainRaw":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeMax":case"rangeMin":case"reverse":case"round":case"clamp":case"zero":return}}function q1e(e,t){return Ee([nA,rA],t)?e===void 0||It(e):t===nf?Ee([Vt.TIME,Vt.UTC,void 0],e):t===tu?gB(e)||rf(e)||e===void 0:!0}function H1e(e,t,n=!1){if(!To(e))return!1;switch(e){case et:case Bt:case Ba:case Pf:case ei:case Pi:return to(t)||t==="band"?!0:t==="point"?!n:!1;case bs:case qa:case Es:case Ua:case Wa:case vu:return to(t)||rf(t)||Ee(["band","point","ordinal"],t);case ir:case Ao:case Fo:return t!=="band";case Ha:case or:return t==="ordinal"||rf(t)}}function V1e(e){return Z(e)&&"value"in e}const Un={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},xB=Un.arc,Kv=Un.area,Zv=Un.bar,G1e=Un.image,Jv=Un.line,ex=Un.point,Y1e=Un.rect,G1=Un.rule,wB=Un.text,iA=Un.tick,X1e=Un.trail,oA=Un.circle,sA=Un.square,bB=Un.geoshape;function Ga(e){return["line","area","trail"].includes(e)}function cp(e){return["rect","bar","image","arc","tick"].includes(e)}const Q1e=new Set(B(Un));function vo(e){return W(e,"type")}const K1e=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"],Z1e=["fill","fillOpacity"],J1e=[...K1e,...Z1e],eye={color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBandSize:1,timeUnitBandPosition:1},y8=B(eye),fw=["binSpacing","continuousBandSize","discreteBandSize","minBandSize"],tye={area:["line","point"],bar:fw,rect:fw,line:["point"],tick:["bandSize","thickness",...fw]},nye={color:"#4c78a8",invalid:"break-paths-show-path-domains",timeUnitBandSize:1},rye={mark:1,arc:1,area:1,bar:1,circle:1,image:1,line:1,point:1,rect:1,rule:1,square:1,text:1,tick:1,trail:1,geoshape:1},EB=B(rye);function nu(e){return W(e,"band")}const iye={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},oye=5,aA={binSpacing:0,continuousBandSize:oye,minBandSize:.25,timeUnitBandPosition:.5},sye={...aA,binSpacing:1},aye={...aA,thickness:1};function lye(e){return vo(e)?e.type:e}function SB(e,{isPath:t}){return e===void 0||e==="break-paths-show-path-domains"?t?"break-paths-show-domains":"filter":e===null?"show":e}function lA({markDef:e,config:t,scaleChannel:n,scaleType:r,isCountAggregate:i}){var a,l;if(!r||!Ai(r)||i)return"always-valid";const o=SB(je("invalid",e,t),{isPath:Ga(e.type)});return((l=(a=t.scale)==null?void 0:a.invalid)==null?void 0:l[n])!==void 0?"show":o}function uye(e){return e==="break-paths-filter-domains"||e==="break-paths-show-domains"}function _B({scaleName:e,scale:t,mode:n}){const r=`domain('${e}')`;if(!t||!e)return;const i=`${r}[0]`,o=`peek(${r})`,s=t.domainHasZero();return s==="definitely"?{scale:e,value:0}:s==="maybe"?{signal:`scale('${e}', inrange(0, ${r}) ? 0 : ${n==="zeroOrMin"?i:o})`}:{signal:`scale('${e}', ${n==="zeroOrMin"?i:o})`}}function kB({scaleChannel:e,channelDef:t,scale:n,scaleName:r,markDef:i,config:o}){var c;const s=n==null?void 0:n.get("type"),a=Mi(t),l=Vv(a==null?void 0:a.aggregate),u=lA({scaleChannel:e,markDef:i,config:o,scaleType:s,isCountAggregate:l});if(a&&u==="show"){const f=((c=o.scale.invalid)==null?void 0:c[e])??"zero-or-min";return{test:Qv(Q(a,{expr:"datum"}),!1),...cye(f,n,r)}}}function cye(e,t,n){if(V1e(e)){const{value:r}=e;return oe(r)?{signal:r.signal}:{value:r}}return _B({scale:t,scaleName:n,mode:"zeroOrMin"})}function uA(e){const{channel:t,channelDef:n,markDef:r,scale:i,scaleName:o,config:s}=e,a=xu(t),l=cA(e),u=kB({scaleChannel:a,channelDef:n,scale:i,scaleName:o,markDef:r,config:s});return u!==void 0?[u,l]:l}function fye(e){const{datum:t}=e;return Eu(t)?eu(t):`${Ue(t)}`}function Tl(e,t,n,r){const i={};if(t&&(i.scale=t),No(e)){const{datum:o}=e;Eu(o)?i.signal=eu(o):oe(o)?i.signal=o.signal:tg(o)?i.signal=o.expr:i.value=o}else i.field=Q(e,n);if(r){const{offset:o,band:s}=r;o&&(i.offset=o),s&&(i.band=s)}return i}function Y1({scaleName:e,fieldOrDatumDef:t,fieldOrDatumDef2:n,offset:r,startSuffix:i,endSuffix:o="end",bandPosition:s=.5}){const a=!oe(s)&&0<s&&s<1?"datum":void 0,l=Q(t,{expr:a,suffix:i}),u=n!==void 0?Q(n,{expr:a}):Q(t,{suffix:o,expr:a}),c={};if(s===0||s===1){c.scale=e;const f=s===0?l:u;c.field=f}else{const f=oe(s)?`(1-${s.signal}) * ${l} + ${s.signal} * ${u}`:`${1-s} * ${l} + ${s} * ${u}`;c.signal=`scale("${e}", ${f})`}return r&&(c.offset=r),c}function dye({scaleName:e,fieldDef:t}){const n=Q(t,{expr:"datum"}),r=Q(t,{expr:"datum",suffix:"end"});return`abs(scale("${e}", ${r}) - scale("${e}", ${n}))`}function cA({channel:e,channelDef:t,channel2Def:n,markDef:r,config:i,scaleName:o,scale:s,stack:a,offset:l,defaultRef:u,bandPosition:c}){if(t){if(he(t)){const f=s==null?void 0:s.get("type");if(zn(t)){c??(c=$a({fieldDef:t,fieldDef2:n,markDef:r,config:i}));const{bin:d,timeUnit:h,type:p}=t;if(Ve(d)||c&&h&&p===nf)return a!=null&&a.impute?Tl(t,o,{binSuffix:"mid"},{offset:l}):c&&!It(f)?Y1({scaleName:o,fieldOrDatumDef:t,bandPosition:c,offset:l}):Tl(t,o,ag(t,e)?{binSuffix:"range"}:{},{offset:l});if(qt(d)){if(H(n))return Y1({scaleName:o,fieldOrDatumDef:t,fieldOrDatumDef2:n,bandPosition:c,offset:l});q(Jj(e===et?Oi:$o))}}return Tl(t,o,It(f)?{binSuffix:"range"}:{},{offset:l,band:f==="band"?c??t.bandPosition??.5:void 0})}else if(Fi(t)){const f=t.value,d=l?{offset:l}:{};return{...xh(e,f),...d}}}return me(u)&&(u=u()),u&&{...u,...l?{offset:l}:{}}}function xh(e,t){return Ee(["x","x2"],e)&&t==="width"?{field:{group:"width"}}:Ee(["y","y2"],e)&&t==="height"?{field:{group:"height"}}:Xe(t)}function ru(e){return e&&e!=="number"&&e!=="time"}function CB(e,t,n){return`${e}(${t}${n?`, ${Ue(n)}`:""})`}const hye=" – ";function fA({fieldOrDatumDef:e,format:t,formatType:n,expr:r,normalizeStack:i,config:o}){var l,u;if(ru(n))return xi({fieldOrDatumDef:e,format:t,formatType:n,expr:r,config:o});const s=$B(e,r,i),a=of(e);if(t===void 0&&n===void 0&&o.customFormatTypes){if(a==="quantitative"){if(i&&o.normalizedNumberFormatType)return xi({fieldOrDatumDef:e,format:o.normalizedNumberFormat,formatType:o.normalizedNumberFormatType,expr:r,config:o});if(o.numberFormatType)return xi({fieldOrDatumDef:e,format:o.numberFormat,formatType:o.numberFormatType,expr:r,config:o})}if(a==="temporal"&&o.timeFormatType&&H(e)&&e.timeUnit===void 0)return xi({fieldOrDatumDef:e,format:o.timeFormat,formatType:o.timeFormatType,expr:r,config:o})}if(af(e)){const c=gye({field:s,timeUnit:H(e)?(l=zt(e.timeUnit))==null?void 0:l.unit:void 0,format:t,formatType:o.timeFormatType,rawTimeFormat:o.timeFormat,isUTCScale:_u(e)&&((u=e.scale)==null?void 0:u.type)===Vt.UTC});return c?{signal:c}:void 0}if(t=xS({type:a,specifiedFormat:t,config:o,normalizeStack:i}),H(e)&&Ve(e.bin)){const c=Q(e,{expr:r,binSuffix:"end"});return{signal:rg(s,c,t,n,o)}}else return t||of(e)==="quantitative"?{signal:`${MB(s,t)}`}:{signal:`isValid(${s}) ? ${s} : ""+${s}`}}function $B(e,t,n){return H(e)?n?`${Q(e,{expr:t,suffix:"end"})}-${Q(e,{expr:t,suffix:"start"})}`:Q(e,{expr:t}):fye(e)}function xi({fieldOrDatumDef:e,format:t,formatType:n,expr:r,normalizeStack:i,config:o,field:s}){if(s??(s=$B(e,r,i)),s!=="datum.value"&&H(e)&&Ve(e.bin)){const a=Q(e,{expr:r,binSuffix:"end"});return{signal:rg(s,a,t,n,o)}}return{signal:CB(n,s,t)}}function AB(e,t,n,r,i,o){var s;if(!(ee(r)&&ru(r))&&!(n===void 0&&r===void 0&&i.customFormatTypes&&of(e)==="quantitative"&&(i.normalizedNumberFormatType&&sf(e)&&e.stack==="normalize"||i.numberFormatType))){if(sf(e)&&e.stack==="normalize"&&i.normalizedNumberFormat)return xS({type:"quantitative",config:i,normalizeStack:!0});if(af(e)){const a=H(e)?(s=zt(e.timeUnit))==null?void 0:s.unit:void 0;return a===void 0&&i.customFormatTypes&&i.timeFormatType?void 0:pye({specifiedFormat:n,timeUnit:a,config:i,omitTimeFormatConfig:o})}return xS({type:t,specifiedFormat:n,config:i})}}function FB(e,t,n){var r;if(e&&(oe(e)||e==="number"||e==="time"))return e;if(af(t)&&n!=="time"&&n!=="utc")return H(t)&&((r=zt(t==null?void 0:t.timeUnit))!=null&&r.utc)?"utc":"time"}function xS({type:e,specifiedFormat:t,config:n,normalizeStack:r}){if(ee(t))return t;if(e===tu)return r?n.normalizedNumberFormat:n.numberFormat}function pye({specifiedFormat:e,timeUnit:t,config:n,omitTimeFormatConfig:r}){return e||(t?{signal:aB(t)}:r?void 0:n.timeFormat)}function MB(e,t){return`format(${e}, "${t||""}")`}function v8(e,t,n,r){return ru(n)?CB(n,e,t):MB(e,(ee(t)?t:void 0)??r.numberFormat)}function rg(e,t,n,r,i){if(n===void 0&&r===void 0&&i.customFormatTypes&&i.numberFormatType)return rg(e,t,i.numberFormat,i.numberFormatType,i);const o=v8(e,n,r,i),s=v8(t,n,r,i);return`${Qv(e,!1)} ? "null" : ${o} + "${hye}" + ${s}`}function gye({field:e,timeUnit:t,format:n,formatType:r,rawTimeFormat:i,isUTCScale:o}){return!t||n?!t&&r?`${r}(${e}, '${n}')`:(n=ee(n)?n:i,`${o?"utc":"time"}Format(${e}, '${n}')`):S1e(t,e,o)}const tx="min",mye={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function x8(e){return te(mye,e)}function yye(e){return W(e,"encoding")}function is(e){return e&&(e.op==="count"||W(e,"field"))}function TB(e){return e&&j(e)}function ig(e){return W(e,"row")||W(e,"column")}function dA(e){return W(e,"header")}function nx(e){return W(e,"facet")}function vye(e){return W(e,"param")}function xye(e){return!ee(e)&&W(e,"repeat")}function w8(e){const{field:t,timeUnit:n,bin:r,aggregate:i}=e;return{...n?{timeUnit:n}:{},...r?{bin:r}:{},...i?{aggregate:i}:{},field:t}}function hA(e){return W(e,"sort")}function $a({fieldDef:e,fieldDef2:t,markDef:n,config:r}){if(he(e)&&e.bandPosition!==void 0)return e.bandPosition;if(H(e)){const{timeUnit:i,bin:o}=e;if(i&&!t)return yo("timeUnitBandPosition",n,r);if(Ve(o))return .5}}function NB({channel:e,fieldDef:t,fieldDef2:n,markDef:r,config:i,scaleType:o,useVlSizeChannel:s}){var u,c,f;const a=sr(e),l=je(s?"size":a,r,i,{vgChannel:a});if(l!==void 0)return l;if(H(t)){const{timeUnit:d,bin:h}=t;if(d&&!n)return{band:yo("timeUnitBandSize",r,i)};if(Ve(h)&&!It(o))return{band:1}}if(cp(r.type))return o?It(o)?((u=i[r.type])==null?void 0:u.discreteBandSize)||{band:1}:(c=i[r.type])==null?void 0:c.continuousBandSize:(f=i[r.type])==null?void 0:f.discreteBandSize}function RB(e,t,n,r){return Ve(e.bin)||e.timeUnit&&zn(e)&&e.type==="temporal"?$a({fieldDef:e,fieldDef2:t,markDef:n,config:r})!==void 0:!1}function DB(e){return W(e,"sort")&&!W(e,"field")}function og(e){return W(e,"condition")}function rx(e){const t=e==null?void 0:e.condition;return!!t&&!j(t)&&H(t)}function sg(e){const t=e==null?void 0:e.condition;return!!t&&!j(t)&&he(t)}function wye(e){const t=e==null?void 0:e.condition;return!!t&&(j(t)||Fi(t))}function H(e){return W(e,"field")||(e==null?void 0:e.aggregate)==="count"}function of(e){return e==null?void 0:e.type}function No(e){return W(e,"datum")}function Zs(e){return zn(e)&&!Q1(e)||X1(e)}function b8(e){return zn(e)&&e.type==="quantitative"&&!e.bin||X1(e)}function X1(e){return No(e)&&Me(e.datum)}function he(e){return H(e)||No(e)}function zn(e){return e&&(W(e,"field")||e.aggregate==="count")&&W(e,"type")}function Fi(e){return W(e,"value")}function _u(e){return W(e,"scale")||W(e,"sort")}function sf(e){return W(e,"axis")||W(e,"stack")||W(e,"impute")}function OB(e){return W(e,"legend")}function PB(e){return W(e,"format")||W(e,"formatType")}function bye(e){return Jn(e,["legend","axis","header","scale"])}function Eye(e){return W(e,"op")}function Q(e,t={}){let n=e.field;const r=t.prefix;let i=t.suffix,o="";if(_ye(e))n=kj("count");else{let s;if(!t.nofn)if(Eye(e))s=e.op;else{const{bin:a,aggregate:l,timeUnit:u}=e;Ve(a)?(s=Ij(a),i=(t.binSuffix??"")+(t.suffix??"")):l?Va(l)?(o=`["${n}"]`,n=`argmax_${l.argmax}`):ps(l)?(o=`["${n}"]`,n=`argmin_${l.argmin}`):s=String(l):u&&!Su(u)&&(s=_1e(u),i=(!["range","mid"].includes(t.binSuffix)&&t.binSuffix||"")+(t.suffix??""))}s&&(n=n?`${s}_${n}`:s)}return i&&(n=`${n}_${i}`),r&&(n=`${r}_${n}`),t.forAs?Of(n):t.expr?Ej(n,t.expr)+o:Kr(n)+o}function Q1(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return H(e)&&!!e.bin;case"temporal":return!1}throw new Error(Xj(e.type))}function Sye(e){var t;return _u(e)&&rf((t=e.scale)==null?void 0:t.type)}function _ye(e){return e.aggregate==="count"}function kye(e,t){var s;const{field:n,bin:r,timeUnit:i,aggregate:o}=e;if(o==="count")return t.countTitle;if(Ve(r))return`${n} (binned)`;if(i&&!Su(i)){const a=(s=zt(i))==null?void 0:s.unit;if(a)return`${n} (${Xv(a).join("-")})`}else if(o)return Va(o)?`${n} for max ${o.argmax}`:ps(o)?`${n} for min ${o.argmin}`:`${Kp(o)} of ${n}`;return n}function Cye(e){const{aggregate:t,bin:n,timeUnit:r,field:i}=e;if(Va(t))return`${i} for argmax(${t.argmax})`;if(ps(t))return`${i} for argmin(${t.argmin})`;const o=r&&!Su(r)?zt(r):void 0,s=t||(o==null?void 0:o.unit)||(o==null?void 0:o.maxbins)&&"timeunit"||Ve(n)&&"bin";return s?`${s.toUpperCase()}(${i})`:i}const LB=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return Cye(e);default:return kye(e,t)}};let zB=LB;function IB(e){zB=e}function $ye(){IB(LB)}function bc(e,t,{allowDisabling:n,includeDefault:r=!0}){var a;const i=(a=pA(e))==null?void 0:a.title;if(!H(e))return i??e.title;const o=e,s=r?gA(o,t):void 0;return n?pt(i,o.title,s):i??o.title??s}function pA(e){if(sf(e)&&e.axis)return e.axis;if(OB(e)&&e.legend)return e.legend;if(dA(e)&&e.header)return e.header}function gA(e,t){return zB(e,t)}function K1(e){if(PB(e)){const{format:t,formatType:n}=e;return{format:t,formatType:n}}else{const t=pA(e)??{},{format:n,formatType:r}=t;return{format:n,formatType:r}}}function Aye(e,t){var o;switch(t){case"latitude":case"longitude":return"quantitative";case"row":case"column":case"facet":case"shape":case"strokeDash":return"nominal";case"order":return"ordinal"}if(hA(e)&&j(e.sort))return"ordinal";const{aggregate:n,bin:r,timeUnit:i}=e;if(i)return"temporal";if(r||n&&!Va(n)&&!ps(n))return"quantitative";if(_u(e)&&((o=e.scale)!=null&&o.type))switch(yS[e.scale.type]){case"numeric":case"discretizing":return"quantitative";case"time":return"temporal"}return"nominal"}function Mi(e){if(H(e))return e;if(rx(e))return e.condition}function _t(e){if(he(e))return e;if(sg(e))return e.condition}function jB(e,t,n,r={}){if(ee(e)||Me(e)||Da(e)){const i=ee(e)?"string":Me(e)?"number":"boolean";return q($me(t,i,e)),{value:e}}return he(e)?Z1(e,t,n,r):sg(e)?{...e,condition:Z1(e.condition,t,n,r)}:e}function Z1(e,t,n,r){if(PB(e)){const{format:i,formatType:o,...s}=e;if(ru(o)&&!n.customFormatTypes)return q(h8(t)),Z1(s,t,n,r)}else{const i=sf(e)?"axis":OB(e)?"legend":dA(e)?"header":null;if(i&&e[i]){const{format:o,formatType:s,...a}=e[i];if(ru(s)&&!n.customFormatTypes)return q(h8(t)),Z1({...e,[i]:a},t,n,r)}}return H(e)?mA(e,t,r):Fye(e)}function Fye(e){let t=e.type;if(t)return e;const{datum:n}=e;return t=Me(n)?"quantitative":ee(n)?"nominal":Eu(n)?"temporal":void 0,{...e,type:t}}function mA(e,t,{compositeMark:n=!1}={}){const{aggregate:r,timeUnit:i,bin:o,field:s}=e,a={...e};if(!n&&r&&!W$(r)&&!Va(r)&&!ps(r)&&(q(Fme(r)),delete a.aggregate),i&&(a.timeUnit=zt(i)),s&&(a.field=`${s}`),Ve(o)&&(a.bin=ix(o,t)),qt(o)&&!gt(t)&&q(a1e(t)),zn(a)){const{type:l}=a,u=N1e(l);l!==u&&(a.type=u),l!=="quantitative"&&Vv(r)&&(q(Ame(l,r)),a.type="quantitative")}else if(!Rj(t)){const l=Aye(a,t);a.type=l}if(zn(a)){const{compatible:l,warning:u}=Mye(a,t)||{};l===!1&&q(u)}if(hA(a)&&ee(a.sort)){const{sort:l}=a;if(x8(l))return{...a,sort:{encoding:l}};const u=l.substring(1);if(l.charAt(0)==="-"&&x8(u))return{...a,sort:{encoding:u,order:"descending"}}}if(dA(a)){const{header:l}=a;if(l){const{orient:u,...c}=l;if(u)return{...a,header:{...c,labelOrient:l.labelOrient||u,titleOrient:l.titleOrient||u}}}}return a}function ix(e,t){return Da(e)?{maxbins:i8(t)}:e==="binned"?{binned:!0}:!e.maxbins&&!e.step?{...e,maxbins:i8(t)}:e}const Lu={compatible:!0};function Mye(e,t){const n=e.type;if(n==="geojson"&&t!=="shape")return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case ns:case rs:case jv:return Q1(e)?Lu:{compatible:!1,warning:Rme(t)};case et:case Bt:case Ba:case Pf:case ir:case Ao:case Fo:case Zp:case Jp:case Bv:case Jl:case Uv:case Wv:case vu:case ei:case Pi:case qv:return Lu;case zi:case Zr:case Li:case Ii:return n!==tu?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:Lu;case Es:case Ua:case Wa:case qa:case bs:case ws:case xs:case Oi:case $o:return n==="nominal"&&!e.sort?{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`}:Lu;case or:case Ha:return!Q1(e)&&!Sye(e)?{compatible:!1,warning:Dme(t)}:Lu;case ef:return e.type==="nominal"&&!("sort"in e)?{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}:Lu}}function af(e){const{formatType:t}=K1(e);return t==="time"||!t&&Tye(e)}function Tye(e){return e&&(e.type==="temporal"||H(e)&&!!e.timeUnit)}function ox(e,{timeUnit:t,type:n,wrapTime:r,undefinedIfExprNotRequired:i}){var l;const o=t&&((l=zt(t))==null?void 0:l.unit);let s=o||n==="temporal",a;return tg(e)?a=e.expr:oe(e)?a=e.signal:Eu(e)?(s=!0,a=eu(e)):(ee(e)||Me(e))&&s&&(a=`datetime(${Ue(e)})`,x1e(o)&&(Me(e)&&e<1e4||ee(e)&&isNaN(Date.parse(e)))&&(a=eu({[o]:e}))),a?r&&s?`time(${a})`:a:i?void 0:Ue(e)}function BB(e,t){const{type:n}=e;return t.map(r=>{const i=H(e)&&!Su(e.timeUnit)?e.timeUnit:void 0,o=ox(r,{timeUnit:i,type:n,undefinedIfExprNotRequired:!0});return o!==void 0?{signal:o}:r})}function ag(e,t){return Ve(e.bin)?To(t)&&["ordinal","nominal"].includes(e.type):(console.warn("Only call this method for binned field defs."),!1)}const E8={labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDashOffset"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDashOffset"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"}};function lg(e){return e==null?void 0:e.condition}const UB=["domain","grid","labels","ticks","title"],Nye={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"both",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},WB={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},Rye={...WB,style:1,labelExpr:1,encoding:1};function S8(e){return te(Rye,e)}const Dye={axis:1,axisBand:1,axisBottom:1,axisDiscrete:1,axisLeft:1,axisPoint:1,axisQuantitative:1,axisRight:1,axisTemporal:1,axisTop:1,axisX:1,axisXBand:1,axisXDiscrete:1,axisXPoint:1,axisXQuantitative:1,axisXTemporal:1,axisY:1,axisYBand:1,axisYDiscrete:1,axisYPoint:1,axisYQuantitative:1,axisYTemporal:1},qB=B(Dye);function _s(e){return W(e,"mark")}class sx{constructor(t,n){this.name=t,this.run=n}hasMatchingType(t){return _s(t)?lye(t.mark)===this.name:!1}}function Nl(e,t){const n=e&&e[t];return n?j(n)?Zc(n,r=>!!r.field):H(n)||rx(n):!1}function HB(e,t){const n=e&&e[t];return n?j(n)?Zc(n,r=>!!r.field):H(n)||No(n)||sg(n):!1}function VB(e,t){if(gt(t)){const n=e[t];if((H(n)||No(n))&&(dB(n.type)||H(n)&&n.timeUnit)){const r=z$(t);return HB(e,r)}}return!1}function GB(e){return Zc(R0e,t=>{if(Nl(e,t)){const n=e[t];if(j(n))return Zc(n,r=>!!r.aggregate);{const r=Mi(n);return r&&!!r.aggregate}}return!1})}function YB(e,t){const n=[],r=[],i=[],o=[],s={};return yA(e,(a,l)=>{if(H(a)){const{field:u,aggregate:c,bin:f,timeUnit:d,...h}=a;if(c||d||f){const p=pA(a),g=p==null?void 0:p.title;let y=Q(a,{forAs:!0});const m={...g?[]:{title:bc(a,t,{allowDisabling:!0})},...h,field:y};if(c){let v;if(Va(c)?(v="argmax",y=Q({op:"argmax",field:c.argmax},{forAs:!0}),m.field=`${y}.${u}`):ps(c)?(v="argmin",y=Q({op:"argmin",field:c.argmin},{forAs:!0}),m.field=`${y}.${u}`):c!=="boxplot"&&c!=="errorbar"&&c!=="errorband"&&(v=c),v){const x={op:v,as:y};u&&(x.field=u),o.push(x)}}else if(n.push(y),zn(a)&&Ve(f)){if(r.push({bin:f,field:u,as:y}),n.push(Q(a,{binSuffix:"end"})),ag(a,l)&&n.push(Q(a,{binSuffix:"range"})),gt(l)){const v={field:`${y}_end`};s[`${l}2`]=v}m.bin="binned",Rj(l)||(m.type=tu)}else if(d&&!Su(d)){i.push({timeUnit:d,field:u,as:y});const v=zn(a)&&a.type!==nf&&"time";v&&(l===Zp||l===Jl?m.formatType=v:W0e(l)?m.legend={formatType:v,...m.legend}:gt(l)&&(m.axis={formatType:v,...m.axis}))}s[l]=m}else n.push(u),s[l]=e[l]}else s[l]=e[l]}),{bins:r,timeUnits:i,aggregate:o,groupby:n,encoding:s}}function Oye(e,t,n){const r=H0e(t,n);if(r){if(r==="binned"){const i=e[t===Oi?et:Bt];return!!(H(i)&&H(e[t])&&qt(i.bin))}}else return!1;return!0}function Pye(e,t,n,r){const i={};for(const o of B(e))Nj(o)||q(Nme(o));for(let o of I0e){if(!e[o])continue;const s=e[o];if(eg(o)){const a=z0e(o),l=i[a];if(H(l)&&T1e(l.type)&&H(s)&&!l.timeUnit){q(Cme(a));continue}}if(o==="angle"&&t==="arc"&&!e.theta&&(q(kme),o=ei),!Oye(e,o,t)){q(Yv(o,t));continue}if(o===bs&&t==="line"){const a=Mi(e[o]);if(a!=null&&a.aggregate){q(Tme);continue}}if(o===ir&&(n?"fill"in e:"stroke"in e)){q(Qj("encoding",{fill:"fill"in e,stroke:"stroke"in e}));continue}if(o===Jp||o===ef&&!j(s)&&!Fi(s)||o===Jl&&j(s)){if(s){if(o===ef){const a=e[o];if(DB(a)){i[o]=a;continue}}i[o]=J(s).reduce((a,l)=>(H(l)?a.push(mA(l,o)):q(mS(l,o)),a),[])}}else{if(o===Jl&&s===null)i[o]=null;else if(!H(s)&&!No(s)&&!Fi(s)&&!og(s)&&!oe(s)){q(mS(s,o));continue}i[o]=jB(s,o,r)}}return i}function ax(e,t){const n={};for(const r of B(e)){const i=jB(e[r],r,t,{compositeMark:!0});n[r]=i}return n}function Lye(e){const t=[];for(const n of B(e))if(Nl(e,n)){const r=e[n],i=J(r);for(const o of i)H(o)?t.push(o):rx(o)&&t.push(o.condition)}return t}function yA(e,t,n){if(e)for(const r of B(e)){const i=e[r];if(j(i))for(const o of i)t.call(n,o,r);else t.call(n,i,r)}}function zye(e,t,n,r){return e?B(e).reduce((i,o)=>{const s=e[o];return j(s)?s.reduce((a,l)=>t.call(r,a,l,o),i):t.call(r,i,s,o)},n):n}function XB(e,t){return B(t).reduce((n,r)=>{switch(r){case et:case Bt:case Uv:case qv:case Wv:case Oi:case $o:case Ba:case Pf:case ei:case ws:case Pi:case xs:case Li:case zi:case Ii:case Zr:case Zp:case or:case vu:case Jl:return n;case ef:if(e==="line"||e==="trail")return n;case Jp:case Bv:{const i=t[r];if(j(i)||H(i))for(const o of J(i))o.aggregate||n.push(Q(o,{}));return n}case bs:if(e==="trail")return n;case ir:case Ao:case Fo:case Es:case Ua:case Wa:case Ha:case qa:{const i=Mi(t[r]);return i&&!i.aggregate&&n.push(Q(i,{})),n}}},[])}function Iye(e){const{tooltip:t,...n}=e;if(!t)return{filteredEncoding:n};let r,i;if(j(t)){for(const o of t)o.aggregate?(r||(r=[]),r.push(o)):(i||(i=[]),i.push(o));r&&(n.tooltip=r)}else t.aggregate?n.tooltip=t:i=t;return j(i)&&i.length===1&&(i=i[0]),{customTooltipWithoutAggregatedField:i,filteredEncoding:n}}function wS(e,t,n,r=!0){if("tooltip"in n)return{tooltip:n.tooltip};const i=e.map(({fieldPrefix:s,titlePrefix:a})=>{const l=r?` of ${vA(t)}`:"";return{field:s+t.field,type:t.type,title:oe(a)?{signal:`${a}"${escape(l)}"`}:a+l}}),o=Lye(n).map(bye);return{tooltip:[...i,...eo(o,_e)]}}function vA(e){const{title:t,field:n}=e;return pt(t,n)}function xA(e,t,n,r,i){const{scale:o,axis:s}=n;return({partName:a,mark:l,positionPrefix:u,endPositionPrefix:c=void 0,extraEncoding:f={}})=>{const d=vA(n);return QB(e,a,i,{mark:l,encoding:{[t]:{field:`${u}_${n.field}`,type:n.type,...d!==void 0?{title:d}:{},...o!==void 0?{scale:o}:{},...s!==void 0?{axis:s}:{}},...ee(c)?{[`${t}2`]:{field:`${c}_${n.field}`}}:{},...r,...f}})}}function QB(e,t,n,r){const{clip:i,color:o,opacity:s}=e,a=e.type;return e[t]||e[t]===void 0&&n[t]?[{...r,mark:{...n[t],...i?{clip:i}:{},...o?{color:o}:{},...s?{opacity:s}:{},...vo(r.mark)?r.mark:{type:r.mark},style:`${a}-${String(t)}`,...Da(e[t])?{}:e[t]}}]:[]}function KB(e,t,n){const{encoding:r}=e,i=t==="vertical"?"y":"x",o=r[i],s=r[`${i}2`],a=r[`${i}Error`],l=r[`${i}Error2`];return{continuousAxisChannelDef:o0(o,n),continuousAxisChannelDef2:o0(s,n),continuousAxisChannelDefError:o0(a,n),continuousAxisChannelDefError2:o0(l,n),continuousAxis:i}}function o0(e,t){if(e!=null&&e.aggregate){const{aggregate:n,...r}=e;return n!==t&&q(s1e(n,t)),r}else return e}function ZB(e,t){const{mark:n,encoding:r}=e,{x:i,y:o}=r;if(vo(n)&&n.orient)return n.orient;if(Zs(i)){if(Zs(o)){const s=H(i)&&i.aggregate,a=H(o)&&o.aggregate;if(!s&&a===t)return"vertical";if(!a&&s===t)return"horizontal";if(s===t&&a===t)throw new Error("Both x and y cannot have aggregate");return af(o)&&!af(i)?"horizontal":"vertical"}return"horizontal"}else{if(Zs(o))return"vertical";throw new Error(`Need a valid continuous axis for ${t}s`)}}const J1="boxplot",jye=["box","median","outliers","rule","ticks"],Bye=new sx(J1,eU);function JB(e){return Me(e)?"tukey":e}function eU(e,{config:t}){e={...e,encoding:ax(e.encoding,t)};const{mark:n,encoding:r,params:i,projection:o,...s}=e,a=vo(n)?n:{type:n};i&&q(Yj("boxplot"));const l=a.extent??t.boxplot.extent,u=je("size",a,t),c=a.invalid,f=JB(l),{bins:d,timeUnits:h,transform:p,continuousAxisChannelDef:g,continuousAxis:y,groupby:m,aggregate:v,encodingWithoutContinuousAxis:x,ticksOrient:w,boxOrient:b,customTooltipWithoutAggregatedField:S}=Uye(e,l,t),E=Of(g.field),{color:_,size:k,...C}=x,$=dg=>xA(a,y,g,dg,t.boxplot),O=$(C),A=$(x),T=(Z(t.boxplot.box)?t.boxplot.box.color:t.mark.color)||"#4c78a8",F=$({...C,...k?{size:k}:{},color:{condition:{test:`datum['lower_box_${g.field}'] >= datum['upper_box_${g.field}']`,..._||{value:T}}}}),R=wS([{fieldPrefix:f==="min-max"?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:f==="min-max"?"lower_whisker_":"min_",titlePrefix:"Min"}],g,x),L={type:"tick",color:"black",opacity:1,orient:w,invalid:c,aria:!1},N=f==="min-max"?R:wS([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],g,x),D=[...O({partName:"rule",mark:{type:"rule",invalid:c,aria:!1},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:N}),...O({partName:"rule",mark:{type:"rule",invalid:c,aria:!1},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:N}),...O({partName:"ticks",mark:L,positionPrefix:"lower_whisker",extraEncoding:N}),...O({partName:"ticks",mark:L,positionPrefix:"upper_whisker",extraEncoding:N})],U=[...f!=="tukey"?D:[],...A({partName:"box",mark:{type:"bar",...u?{size:u}:{},orient:b,invalid:c,ariaRoleDescription:"box"},positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:R}),...F({partName:"median",mark:{type:"tick",invalid:c,...Z(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{},...u?{size:u}:{},orient:w,aria:!1},positionPrefix:"mid_box",extraEncoding:R})];if(f==="min-max")return{...s,transform:(s.transform??[]).concat(p),layer:U};const K=`datum["lower_box_${g.field}"]`,se=`datum["upper_box_${g.field}"]`,be=`(${se} - ${K})`,pe=`${K} - ${l} * ${be}`,Re=`${se} + ${l} * ${be}`,At=`datum["${g.field}"]`,Fr={joinaggregate:tU(g.field),groupby:m},Cs={transform:[{filter:`(${pe} <= ${At}) && (${At} <= ${Re})`},{aggregate:[{op:"min",field:g.field,as:`lower_whisker_${E}`},{op:"max",field:g.field,as:`upper_whisker_${E}`},{op:"min",field:`lower_box_${g.field}`,as:`lower_box_${E}`},{op:"max",field:`upper_box_${g.field}`,as:`upper_box_${E}`},...v],groupby:m}],layer:D},{tooltip:ne,...ye}=C,{scale:xe,axis:G}=g,Ut=vA(g),Pe=Jn(G,["title"]),nn=QB(a,"outliers",t.boxplot,{transform:[{filter:`(${At} < ${pe}) || (${At} > ${Re})`}],mark:"point",encoding:{[y]:{field:g.field,type:g.type,...Ut!==void 0?{title:Ut}:{},...xe!==void 0?{scale:xe}:{},...Be(Pe)?{}:{axis:Pe}},...ye,..._?{color:_}:{},...S?{tooltip:S}:{}}})[0];let Ft;const ji=[...d,...h,Fr];return nn?Ft={transform:ji,layer:[nn,Cs]}:(Ft=Cs,Ft.transform.unshift(...ji)),{...s,layer:[Ft,{transform:p,layer:U}]}}function tU(e){const t=Of(e);return[{op:"q1",field:e,as:`lower_box_${t}`},{op:"q3",field:e,as:`upper_box_${t}`}]}function Uye(e,t,n){const r=ZB(e,J1),{continuousAxisChannelDef:i,continuousAxis:o}=KB(e,r,J1),s=i.field,a=Of(s),l=JB(t),u=[...tU(s),{op:"median",field:s,as:`mid_box_${a}`},{op:"min",field:s,as:(l==="min-max"?"lower_whisker_":"min_")+a},{op:"max",field:s,as:(l==="min-max"?"upper_whisker_":"max_")+a}],c=l==="min-max"||l==="tukey"?[]:[{calculate:`datum["upper_box_${a}"] - datum["lower_box_${a}"]`,as:`iqr_${a}`},{calculate:`min(datum["upper_box_${a}"] + datum["iqr_${a}"] * ${t}, datum["max_${a}"])`,as:`upper_whisker_${a}`},{calculate:`max(datum["lower_box_${a}"] - datum["iqr_${a}"] * ${t}, datum["min_${a}"])`,as:`lower_whisker_${a}`}],{[o]:f,...d}=e.encoding,{customTooltipWithoutAggregatedField:h,filteredEncoding:p}=Iye(d),{bins:g,timeUnits:y,aggregate:m,groupby:v,encoding:x}=YB(p,n),w=r==="vertical"?"horizontal":"vertical",b=r,S=[...g,...y,{aggregate:[...m,...u],groupby:v},...c];return{bins:g,timeUnits:y,transform:S,groupby:v,aggregate:m,continuousAxisChannelDef:i,continuousAxis:o,encodingWithoutContinuousAxis:x,ticksOrient:w,boxOrient:b,customTooltipWithoutAggregatedField:h}}const wA="errorbar",Wye=["ticks","rule"],qye=new sx(wA,nU);function nU(e,{config:t}){e={...e,encoding:ax(e.encoding,t)};const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:o,ticksOrient:s,markDef:a,outerSpec:l,tooltipEncoding:u}=rU(e,wA,t);delete o.size;const c=xA(a,i,r,o,t.errorbar),f=a.thickness,d=a.size,h={type:"tick",orient:s,aria:!1,...f!==void 0?{thickness:f}:{},...d!==void 0?{size:d}:{}},p=[...c({partName:"ticks",mark:h,positionPrefix:"lower",extraEncoding:u}),...c({partName:"ticks",mark:h,positionPrefix:"upper",extraEncoding:u}),...c({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar",...f!==void 0?{size:f}:{}},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u})];return{...l,transform:n,...p.length>1?{layer:p}:{...p[0]}}}function Hye(e,t){const{encoding:n}=e;if(Vye(n))return{orient:ZB(e,t),inputType:"raw"};const r=Gye(n),i=Yye(n),o=n.x,s=n.y;if(r){if(i)throw new Error(`${t} cannot be both type aggregated-upper-lower and aggregated-error`);const a=n.x2,l=n.y2;if(he(a)&&he(l))throw new Error(`${t} cannot have both x2 and y2`);if(he(a)){if(Zs(o))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${t}`)}else if(he(l)){if(Zs(s))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${t}`)}throw new Error("No ranged axis")}else{const a=n.xError,l=n.xError2,u=n.yError,c=n.yError2;if(he(l)&&!he(a))throw new Error(`${t} cannot have xError2 without xError`);if(he(c)&&!he(u))throw new Error(`${t} cannot have yError2 without yError`);if(he(a)&&he(u))throw new Error(`${t} cannot have both xError and yError with both are quantiative`);if(he(a)){if(Zs(o))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}else if(he(u)){if(Zs(s))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function Vye(e){return(he(e.x)||he(e.y))&&!he(e.x2)&&!he(e.y2)&&!he(e.xError)&&!he(e.xError2)&&!he(e.yError)&&!he(e.yError2)}function Gye(e){return he(e.x2)||he(e.y2)}function Yye(e){return he(e.xError)||he(e.xError2)||he(e.yError)||he(e.yError2)}function rU(e,t,n){const{mark:r,encoding:i,params:o,projection:s,...a}=e,l=vo(r)?r:{type:r};o&&q(Yj(t));const{orient:u,inputType:c}=Hye(e,t),{continuousAxisChannelDef:f,continuousAxisChannelDef2:d,continuousAxisChannelDefError:h,continuousAxisChannelDefError2:p,continuousAxis:g}=KB(e,u,t),{errorBarSpecificAggregate:y,postAggregateCalculates:m,tooltipSummary:v,tooltipTitleWithFieldName:x}=Xye(l,f,d,h,p,c,t,n),{[g]:w,[g==="x"?"x2":"y2"]:b,[g==="x"?"xError":"yError"]:S,[g==="x"?"xError2":"yError2"]:E,..._}=i,{bins:k,timeUnits:C,aggregate:$,groupby:O,encoding:A}=YB(_,n),T=[...$,...y],F=c!=="raw"?[]:O,R=wS(v,f,A,x);return{transform:[...a.transform??[],...k,...C,...T.length===0?[]:[{aggregate:T,groupby:F}],...m],groupby:F,continuousAxisChannelDef:f,continuousAxis:g,encodingWithoutContinuousAxis:A,ticksOrient:u==="vertical"?"horizontal":"vertical",markDef:l,outerSpec:a,tooltipEncoding:R}}function Xye(e,t,n,r,i,o,s,a){let l=[],u=[];const c=t.field;let f,d=!1;if(o==="raw"){const h=e.center?e.center:e.extent?e.extent==="iqr"?"median":"mean":a.errorbar.center,p=e.extent?e.extent:h==="mean"?"stderr":"iqr";if(h==="median"!=(p==="iqr")&&q(o1e(h,p,s)),p==="stderr"||p==="stdev")l=[{op:p,field:c,as:`extent_${c}`},{op:h,field:c,as:`center_${c}`}],u=[{calculate:`datum["center_${c}"] + datum["extent_${c}"]`,as:`upper_${c}`},{calculate:`datum["center_${c}"] - datum["extent_${c}"]`,as:`lower_${c}`}],f=[{fieldPrefix:"center_",titlePrefix:Kp(h)},{fieldPrefix:"upper_",titlePrefix:_8(h,p,"+")},{fieldPrefix:"lower_",titlePrefix:_8(h,p,"-")}],d=!0;else{let g,y,m;p==="ci"?(g="mean",y="ci0",m="ci1"):(g="median",y="q1",m="q3"),l=[{op:y,field:c,as:`lower_${c}`},{op:m,field:c,as:`upper_${c}`},{op:g,field:c,as:`center_${c}`}],f=[{fieldPrefix:"upper_",titlePrefix:bc({field:c,aggregate:m,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:bc({field:c,aggregate:y,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:bc({field:c,aggregate:g,type:"quantitative"},a,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&q(i1e(e.center,e.extent)),o==="aggregated-upper-lower"?(f=[],u=[{calculate:`datum["${n.field}"]`,as:`upper_${c}`},{calculate:`datum["${c}"]`,as:`lower_${c}`}]):o==="aggregated-error"&&(f=[{fieldPrefix:"",titlePrefix:c}],u=[{calculate:`datum["${c}"] + datum["${r.field}"]`,as:`upper_${c}`}],i?u.push({calculate:`datum["${c}"] + datum["${i.field}"]`,as:`lower_${c}`}):u.push({calculate:`datum["${c}"] - datum["${r.field}"]`,as:`lower_${c}`}));for(const h of u)f.push({fieldPrefix:h.as.substring(0,6),titlePrefix:Zl(Zl(h.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:u,errorBarSpecificAggregate:l,tooltipSummary:f,tooltipTitleWithFieldName:d}}function _8(e,t,n){return`${Kp(e)} ${n} ${t}`}const bA="errorband",Qye=["band","borders"],Kye=new sx(bA,iU);function iU(e,{config:t}){e={...e,encoding:ax(e.encoding,t)};const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:o,markDef:s,outerSpec:a,tooltipEncoding:l}=rU(e,bA,t),u=s,c=xA(u,i,r,o,t.errorband),f=e.encoding.x!==void 0&&e.encoding.y!==void 0;let d={type:f?"area":"rect"},h={type:f?"line":"rule"};const p={...u.interpolate?{interpolate:u.interpolate}:{},...u.tension&&u.interpolate?{tension:u.tension}:{}};return f?(d={...d,...p,ariaRoleDescription:"errorband"},h={...h,...p,aria:!1}):u.interpolate?q(g8("interpolate")):u.tension&&q(g8("tension")),{...a,transform:n,layer:[...c({partName:"band",mark:d,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l}),...c({partName:"borders",mark:h,positionPrefix:"lower",extraEncoding:l}),...c({partName:"borders",mark:h,positionPrefix:"upper",extraEncoding:l})]}}const oU={};function EA(e,t,n){const r=new sx(e,t);oU[e]={normalizer:r,parts:n}}function Zye(){return B(oU)}EA(J1,eU,jye);EA(wA,nU,Wye);EA(bA,iU,Qye);const Jye=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],sU={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},aU={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},eve=B(sU),tve=B(aU),nve={header:1,headerRow:1,headerColumn:1,headerFacet:1},lU=B(nve),uU=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],rve={gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},ive={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},Ti="_vgsid_",ove={point:{on:"click",fields:[Ti],toggle:"event.shiftKey",resolve:"global",clear:"dblclick"},interval:{on:"[pointerdown, window:pointerup] > window:pointermove!",encodings:["x","y"],translate:"[pointerdown, window:pointerup] > window:pointermove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function SA(e){return e==="legend"||!!(e!=null&&e.legend)}function dw(e){return SA(e)&&Z(e)}function _A(e){return!!(e!=null&&e.select)}function cU(e){const t=[];for(const n of e||[]){if(_A(n))continue;const{expr:r,bind:i,...o}=n;if(i&&r){const s={...o,bind:i,init:r};t.push(s)}else{const s={...o,...r?{update:r}:{},...i?{bind:i}:{}};t.push(s)}}return t}function sve(e){return lx(e)||CA(e)||kA(e)}function kA(e){return W(e,"concat")}function lx(e){return W(e,"vconcat")}function CA(e){return W(e,"hconcat")}function fU({step:e,offsetIsDiscrete:t}){return t?e.for??"offset":"position"}function xo(e){return W(e,"step")}function k8(e){return W(e,"view")||W(e,"width")||W(e,"height")}const C8=20,ave={align:1,bounds:1,center:1,columns:1,spacing:1},lve=B(ave);function uve(e,t,n){const r=n[t],i={},{spacing:o,columns:s}=r;o!==void 0&&(i.spacing=o),s!==void 0&&(nx(e)&&!ig(e.facet)||kA(e))&&(i.columns=s),lx(e)&&(i.columns=1);for(const a of lve)if(e[a]!==void 0)if(a==="spacing"){const l=e[a];i[a]=Me(l)?l:{row:l.row??o,column:l.column??o}}else i[a]=e[a];return i}function bS(e,t){return e[t]??e[t==="width"?"continuousWidth":"continuousHeight"]}function ES(e,t){const n=ey(e,t);return xo(n)?n.step:dU}function ey(e,t){const n=e[t]??e[t==="width"?"discreteWidth":"discreteHeight"];return pt(n,{step:e.step})}const dU=20,cve={continuousWidth:200,continuousHeight:200,step:dU},fve={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:cve,mark:nye,arc:{},area:{},bar:sye,circle:{},geoshape:{},image:{},line:{},point:{},rect:aA,rule:{color:"black"},square:{},text:{color:"black"},tick:aye,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:L1e,projection:{},legend:rve,header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:ove,style:{},title:{},facet:{spacing:C8},concat:{spacing:C8},normalizedNumberFormat:".0%"},Po=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],$8={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},A8={blue:Po[0],orange:Po[1],red:Po[2],teal:Po[3],green:Po[4],yellow:Po[5],purple:Po[6],pink:Po[7],brown:Po[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function dve(e={}){return{signals:[{name:"color",value:Z(e)?{...A8,...e}:A8}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}function hve(e){return{signals:[{name:"fontSize",value:Z(e)?{...$8,...e}:$8}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}function pve(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}function hU(e){const t=B(e||{}),n={};for(const r of t){const i=e[r];n[r]=lg(i)?Bj(i):hr(i)}return n}function gve(e){const t=B(e),n={};for(const r of t)n[r]=hU(e[r]);return n}const mve=[...EB,...qB,...lU,"background","padding","legend","lineBreak","scale","style","title","view"];function pU(e={}){const{color:t,font:n,fontSize:r,selection:i,...o}=e,s=xf({},de(fve),n?pve(n):{},t?dve(t):{},r?hve(r):{},o||{});i&&wf(s,"selection",i,!0);const a=Jn(s,mve);for(const l of["background","lineBreak","padding"])s[l]&&(a[l]=hr(s[l]));for(const l of EB)s[l]&&(a[l]=Ht(s[l]));for(const l of qB)s[l]&&(a[l]=hU(s[l]));for(const l of lU)s[l]&&(a[l]=Ht(s[l]));if(s.legend&&(a.legend=Ht(s.legend)),s.scale){const{invalid:l,...u}=s.scale,c=Ht(l,{level:1});a.scale={...Ht(u),...B(c).length>0?{invalid:c}:{}}}return s.style&&(a.style=gve(s.style)),s.title&&(a.title=Ht(s.title)),s.view&&(a.view=Ht(s.view)),a}const yve=new Set(["view",...Q1e]),vve=["color","fontSize","background","padding","facet","concat","numberFormat","numberFormatType","normalizedNumberFormat","normalizedNumberFormatType","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],xve={view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"],...tye};function wve(e){e=de(e);for(const t of vve)delete e[t];if(e.axis)for(const t in e.axis)lg(e.axis[t])&&delete e.axis[t];if(e.legend)for(const t of Jye)delete e.legend[t];if(e.mark){for(const t of y8)delete e.mark[t];e.mark.tooltip&&Z(e.mark.tooltip)&&delete e.mark.tooltip}e.params&&(e.signals=(e.signals||[]).concat(cU(e.params)),delete e.params);for(const t of yve){for(const r of y8)delete e[t][r];const n=xve[t];if(n)for(const r of n)delete e[t][r];Eve(e,t)}for(const t of Zye())delete e[t];bve(e);for(const t in e)Z(e[t])&&Be(e[t])&&delete e[t];return Be(e)?void 0:e}function bve(e){const{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:r}=jj(e.title);Be(t)||(e.style["group-title"]={...e.style["group-title"],...t}),Be(n)||(e.style["group-subtitle"]={...e.style["group-subtitle"],...n}),Be(r)?delete e.title:e.title=r}function Eve(e,t,n,r){const i=e[t];t==="view"&&(n="cell");const o={...i,...e.style[n??t]};Be(o)||(e.style[n??t]=o),delete e[t]}function ux(e){return W(e,"layer")}function Sve(e){return W(e,"repeat")}function _ve(e){return!j(e.repeat)&&W(e.repeat,"layer")}class $A{map(t,n){return nx(t)?this.mapFacet(t,n):Sve(t)?this.mapRepeat(t,n):CA(t)?this.mapHConcat(t,n):lx(t)?this.mapVConcat(t,n):kA(t)?this.mapConcat(t,n):this.mapLayerOrUnit(t,n)}mapLayerOrUnit(t,n){if(ux(t))return this.mapLayer(t,n);if(_s(t))return this.mapUnit(t,n);throw new Error(q$(t))}mapLayer(t,n){return{...t,layer:t.layer.map(r=>this.mapLayerOrUnit(r,n))}}mapHConcat(t,n){return{...t,hconcat:t.hconcat.map(r=>this.map(r,n))}}mapVConcat(t,n){return{...t,vconcat:t.vconcat.map(r=>this.map(r,n))}}mapConcat(t,n){const{concat:r,...i}=t;return{...i,concat:r.map(o=>this.map(o,n))}}mapFacet(t,n){return{...t,spec:this.map(t.spec,n)}}mapRepeat(t,n){return{...t,spec:this.map(t.spec,n)}}}const kve={zero:1,center:1,normalize:1};function Cve(e){return te(kve,e)}const $ve=new Set([xB,Zv,Kv,G1,ex,oA,sA,Jv,wB,iA]),Ave=new Set([Zv,Kv,xB]);function zu(e){return H(e)&&of(e)==="quantitative"&&!e.bin}function F8(e,t,{orient:n,type:r}){const i=t==="x"?"y":"radius",o=t==="x"&&["bar","area"].includes(r),s=e[t],a=e[i];if(H(s)&&H(a))if(zu(s)&&zu(a)){if(s.stack)return t;if(a.stack)return i;const l=H(s)&&!!s.aggregate,u=H(a)&&!!a.aggregate;if(l!==u)return l?t:i;if(o){if(n==="vertical")return i;if(n==="horizontal")return t}}else{if(zu(s))return t;if(zu(a))return i}else{if(zu(s))return o&&n==="vertical"?void 0:t;if(zu(a))return o&&n==="horizontal"?void 0:i}}function Fve(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}function gU(e,t){var g,y;const n=vo(e)?e:{type:e},r=n.type;if(!$ve.has(r))return null;const i=F8(t,"x",n)||F8(t,"theta",n);if(!i)return null;const o=t[i],s=H(o)?Q(o,{}):void 0,a=Fve(i),l=[],u=new Set;if(t[a]){const m=t[a],v=H(m)?Q(m,{}):void 0;v&&v!==s&&(l.push(a),u.add(v))}const c=a==="x"?"xOffset":"yOffset",f=t[c],d=H(f)?Q(f,{}):void 0;d&&d!==s&&(l.push(c),u.add(d));const h=j0e.reduce((m,v)=>{if(v!=="tooltip"&&Nl(t,v)){const x=t[v];for(const w of J(x)){const b=Mi(w);if(b.aggregate)continue;const S=Q(b,{});(!S||!u.has(S))&&m.push({channel:v,fieldDef:b})}}return m},[]);let p;return o.stack!==void 0?Da(o.stack)?p=o.stack?"zero":null:p=o.stack:Ave.has(r)&&(p="zero"),!p||!Cve(p)||GB(t)&&h.length===0?null:((g=o==null?void 0:o.scale)!=null&&g.type&&((y=o==null?void 0:o.scale)==null?void 0:y.type)!==Vt.LINEAR&&o!=null&&o.stack&&q(t1e(o.scale.type)),he(t[Mo(i)])?(o.stack!==void 0&&q(e1e(i)),null):(H(o)&&o.aggregate&&!Z0e.has(o.aggregate)&&q(n1e(o.aggregate)),{groupbyChannels:l,groupbyFields:u,fieldChannel:i,impute:o.impute===null?!1:Ga(r),stackBy:h,offset:p}))}function mU(e,t,n){const r=Ht(e),i=je("orient",r,n);if(r.orient=Rve(r.type,t,i),i!==void 0&&i!==r.orient&&q(zme(r.orient,i)),r.type==="bar"&&r.orient){const l=je("cornerRadiusEnd",r,n);if(l!==void 0){const u=r.orient==="horizontal"&&t.x2||r.orient==="vertical"&&t.y2?["cornerRadius"]:iye[r.orient];for(const c of u)r[c]=l;r.cornerRadiusEnd!==void 0&&delete r.cornerRadiusEnd}}const o=je("opacity",r,n),s=je("fillOpacity",r,n);return o===void 0&&s===void 0&&(r.opacity=Tve(r.type,t)),je("cursor",r,n)===void 0&&(r.cursor=Mve(r,t,n)),r}function Mve(e,t,n){return t.href||e.href||je("href",e,n)?"pointer":e.cursor}function Tve(e,t){if(Ee([ex,iA,oA,sA],e)&&!GB(t))return .7}function Nve(e,t,{graticule:n}){if(n)return!1;const r=yo("filled",e,t),i=e.type;return pt(r,i!==ex&&i!==Jv&&i!==G1)}function Rve(e,t,n){switch(e){case ex:case oA:case sA:case wB:case Y1e:case G1e:return}const{x:r,y:i,x2:o,y2:s}=t;switch(e){case Zv:if(H(r)&&(qt(r.bin)||H(i)&&i.aggregate&&!r.aggregate))return"vertical";if(H(i)&&(qt(i.bin)||H(r)&&r.aggregate&&!i.aggregate))return"horizontal";if(s||o){if(n)return n;if(!o)return(H(r)&&r.type===tu&&!Ve(r.bin)||X1(r))&&H(i)&&qt(i.bin)?"horizontal":"vertical";if(!s)return(H(i)&&i.type===tu&&!Ve(i.bin)||X1(i))&&H(r)&&qt(r.bin)?"vertical":"horizontal"}case G1:if(o&&!(H(r)&&qt(r.bin))&&s&&!(H(i)&&qt(i.bin)))return;case Kv:if(s)return H(i)&&qt(i.bin)?"horizontal":"vertical";if(o)return H(r)&&qt(r.bin)?"vertical":"horizontal";if(e===G1){if(r&&!i)return"vertical";if(i&&!r)return"horizontal"}case Jv:case iA:{const a=b8(r),l=b8(i);if(n)return n;if(a&&!l)return e!=="tick"?"horizontal":"vertical";if(!a&&l)return e!=="tick"?"vertical":"horizontal";if(a&&l)return"vertical";{const u=zn(r)&&r.type===nf,c=zn(i)&&i.type===nf;if(u&&!c)return"vertical";if(!u&&c)return"horizontal"}return}}return"vertical"}function Dve(e){const{point:t,line:n,...r}=e;return B(r).length>1?r:r.type}function Ove(e){for(const t of["line","area","rule","trail"])e[t]&&(e={...e,[t]:Jn(e[t],["point","line"])});return e}function hw(e,t={},n){return e.point==="transparent"?{opacity:0}:e.point?Z(e.point)?e.point:{}:e.point!==void 0?null:t.point||n.shape?Z(t.point)?t.point:{}:void 0}function M8(e,t={}){return e.line?e.line===!0?{}:e.line:e.line!==void 0?null:t.line?t.line===!0?{}:t.line:void 0}class Pve{constructor(){this.name="path-overlay"}hasMatchingType(t,n){if(_s(t)){const{mark:r,encoding:i}=t,o=vo(r)?r:{type:r};switch(o.type){case"line":case"rule":case"trail":return!!hw(o,n[o.type],i);case"area":return!!hw(o,n[o.type],i)||!!M8(o,n[o.type])}}return!1}run(t,n,r){const{config:i}=n,{params:o,projection:s,mark:a,name:l,encoding:u,...c}=t,f=ax(u,i),d=vo(a)?a:{type:a},h=hw(d,i[d.type],f),p=d.type==="area"&&M8(d,i[d.type]),g=[{name:l,...o?{params:o}:{},mark:Dve({...d.type==="area"&&d.opacity===void 0&&d.fillOpacity===void 0?{opacity:.7}:{},...d}),encoding:Jn(f,["shape"])}],y=gU(mU(d,f,i),f);let m=f;if(y){const{fieldChannel:v,offset:x}=y;m={...f,[v]:{...f[v],...x?{stack:x}:{}}}}return m=Jn(m,["y2","x2"]),p&&g.push({...s?{projection:s}:{},mark:{type:"line",...Kc(d,["clip","interpolate","tension","tooltip"]),...p},encoding:m}),h&&g.push({...s?{projection:s}:{},mark:{type:"point",opacity:1,filled:!0,...Kc(d,["clip","tooltip"]),...h},encoding:m}),r({...c,layer:g},{...n,config:Ove(i)})}}function Lve(e,t){return t?ig(e)?vU(e,t):yU(e,t):e}function pw(e,t){return t?vU(e,t):e}function SS(e,t,n){const r=t[e];if(xye(r)){if(r.repeat in n)return{...t,[e]:n[r.repeat]};q(vme(r.repeat));return}return t}function yU(e,t){if(e=SS("field",e,t),e!==void 0){if(e===null)return null;if(hA(e)&&is(e.sort)){const n=SS("field",e.sort,t);e={...e,...n?{sort:n}:{}}}return e}}function T8(e,t){if(H(e))return yU(e,t);{const n=SS("datum",e,t);return n!==e&&!n.type&&(n.type="nominal"),n}}function N8(e,t){if(he(e)){const n=T8(e,t);if(n)return n;if(og(e))return{condition:e.condition}}else{if(sg(e)){const n=T8(e.condition,t);if(n)return{...e,condition:n};{const{condition:r,...i}=e;return i}}return e}}function vU(e,t){const n={};for(const r in e)if(W(e,r)){const i=e[r];if(j(i))n[r]=i.map(o=>N8(o,t)).filter(o=>o);else{const o=N8(i,t);o!==void 0&&(n[r]=o)}}return n}class zve{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if(_s(t)){const{encoding:n,mark:r}=t;if(r==="line"||vo(r)&&r.type==="line")for(const i of L0e){const o=xu(i),s=n[o];if(n[i]&&(H(s)&&!qt(s.bin)||No(s)))return!0}}return!1}run(t,n,r){const{encoding:i,mark:o}=t;return q(Lme(!!i.x2,!!i.y2)),r({...t,mark:Z(o)?{...o,type:"rule"}:"rule"},n)}}class Ive extends $A{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[Bye,qye,Kye,new Pve,new zve]}map(t,n){if(_s(t)){const r=Nl(t.encoding,ns),i=Nl(t.encoding,rs),o=Nl(t.encoding,jv);if(r||i||o)return this.mapFacetedUnit(t,n)}return super.map(t,n)}mapUnit(t,n){const{parentEncoding:r,parentProjection:i}=n,o=pw(t.encoding,n.repeater),s={...t,...t.name?{name:[n.repeaterPrefix,t.name].filter(l=>l).join("_")}:{},...o?{encoding:o}:{}};if(r||i)return this.mapUnitWithParentEncodingOrProjection(s,n);const a=this.mapLayerOrUnit.bind(this);for(const l of this.nonFacetUnitNormalizers)if(l.hasMatchingType(s,n.config))return l.run(s,n,a);return s}mapRepeat(t,n){return _ve(t)?this.mapLayerRepeat(t,n):this.mapNonLayerRepeat(t,n)}mapLayerRepeat(t,n){const{repeat:r,spec:i,...o}=t,{row:s,column:a,layer:l}=r,{repeater:u={},repeaterPrefix:c=""}=n;return s||a?this.mapRepeat({...t,repeat:{...s?{row:s}:{},...a?{column:a}:{}},spec:{repeat:{layer:l},spec:i}},n):{...o,layer:l.map(f=>{const d={...u,layer:f},h=`${(i.name?`${i.name}_`:"")+c}child__layer_${Je(f)}`,p=this.mapLayerOrUnit(i,{...n,repeater:d,repeaterPrefix:h});return p.name=h,p})}}mapNonLayerRepeat(t,n){const{repeat:r,spec:i,data:o,...s}=t;!j(r)&&t.columns&&(t=Jn(t,["columns"]),q(f8("repeat")));const a=[],{repeater:l={},repeaterPrefix:u=""}=n,c=!j(r)&&r.row||[l?l.row:null],f=!j(r)&&r.column||[l?l.column:null],d=j(r)&&r||[l?l.repeat:null];for(const p of d)for(const g of c)for(const y of f){const m={repeat:p,row:g,column:y,layer:l.layer},v=(i.name?`${i.name}_`:"")+u+"child__"+(j(r)?`${Je(p)}`:(r.row?`row_${Je(g)}`:"")+(r.column?`column_${Je(y)}`:"")),x=this.map(i,{...n,repeater:m,repeaterPrefix:v});x.name=v,a.push(Jn(x,["data"]))}const h=j(r)?t.columns:r.column?r.column.length:1;return{data:i.data??o,align:"all",...s,columns:h,concat:a}}mapFacet(t,n){const{facet:r}=t;return ig(r)&&t.columns&&(t=Jn(t,["columns"]),q(f8("facet"))),super.mapFacet(t,n)}mapUnitWithParentEncodingOrProjection(t,n){const{encoding:r,projection:i}=t,{parentEncoding:o,parentProjection:s,config:a}=n,l=D8({parentProjection:s,projection:i}),u=R8({parentEncoding:o,encoding:pw(r,n.repeater)});return this.mapUnit({...t,...l?{projection:l}:{},...u?{encoding:u}:{}},{config:a})}mapFacetedUnit(t,n){const{row:r,column:i,facet:o,...s}=t.encoding,{mark:a,width:l,projection:u,height:c,view:f,params:d,encoding:h,...p}=t,{facetMapping:g,layout:y}=this.getFacetMappingAndLayout({row:r,column:i,facet:o},n),m=pw(s,n.repeater);return this.mapFacet({...p,...y,facet:g,spec:{...l?{width:l}:{},...c?{height:c}:{},...f?{view:f}:{},...u?{projection:u}:{},mark:a,encoding:m,...d?{params:d}:{}}},n)}getFacetMappingAndLayout(t,n){const{row:r,column:i,facet:o}=t;if(r||i){o&&q(Ome([...r?[ns]:[],...i?[rs]:[]]));const s={},a={};for(const l of[ns,rs]){const u=t[l];if(u){const{align:c,center:f,spacing:d,columns:h,...p}=u;s[l]=p;for(const g of["align","center","spacing"])u[g]!==void 0&&(a[g]??(a[g]={}),a[g][l]=u[g])}}return{facetMapping:s,layout:a}}else{const{align:s,center:a,spacing:l,columns:u,...c}=o;return{facetMapping:Lve(c,n.repeater),layout:{...s?{align:s}:{},...a?{center:a}:{},...l?{spacing:l}:{},...u?{columns:u}:{}}}}}mapLayer(t,{parentEncoding:n,parentProjection:r,...i}){const{encoding:o,projection:s,...a}=t,l={...i,parentEncoding:R8({parentEncoding:n,encoding:o,layer:!0}),parentProjection:D8({parentProjection:r,projection:s})};return super.mapLayer({...a,...t.name?{name:[l.repeaterPrefix,t.name].filter(u=>u).join("_")}:{}},l)}}function R8({parentEncoding:e,encoding:t={},layer:n}){let r={};if(e){const i=new Set([...B(e),...B(t)]);for(const o of i){const s=t[o],a=e[o];if(he(s)){const l={...a,...s};r[o]=l}else sg(s)?r[o]={...s,condition:{...a,...s.condition}}:s||s===null?r[o]=s:(n||Fi(a)||oe(a)||he(a)||j(a))&&(r[o]=a)}}else r=t;return!r||Be(r)?void 0:r}function D8(e){const{parentProjection:t,projection:n}=e;return t&&n&&q(_me({parentProjection:t,projection:n})),n??t}function AA(e){return W(e,"filter")}function jve(e){return W(e,"stop")}function xU(e){return W(e,"lookup")}function Bve(e){return W(e,"data")}function Uve(e){return W(e,"param")}function Wve(e){return W(e,"pivot")}function qve(e){return W(e,"density")}function Hve(e){return W(e,"quantile")}function Vve(e){return W(e,"regression")}function Gve(e){return W(e,"loess")}function Yve(e){return W(e,"sample")}function Xve(e){return W(e,"window")}function Qve(e){return W(e,"joinaggregate")}function Kve(e){return W(e,"flatten")}function Zve(e){return W(e,"calculate")}function wU(e){return W(e,"bin")}function Jve(e){return W(e,"impute")}function exe(e){return W(e,"timeUnit")}function txe(e){return W(e,"aggregate")}function nxe(e){return W(e,"stack")}function rxe(e){return W(e,"fold")}function ixe(e){return W(e,"extent")&&!W(e,"density")&&!W(e,"regression")}function oxe(e){return e.map(t=>AA(t)?{filter:xc(t.filter,M1e)}:t)}class sxe extends $A{map(t,n){return n.emptySelections??(n.emptySelections={}),n.selectionPredicates??(n.selectionPredicates={}),t=O8(t,n),super.map(t,n)}mapLayerOrUnit(t,n){if(t=O8(t,n),t.encoding){const r={};for(const[i,o]of ka(t.encoding))r[i]=bU(o,n);t={...t,encoding:r}}return super.mapLayerOrUnit(t,n)}mapUnit(t,n){const{selection:r,...i}=t;return r?{...i,params:ka(r).map(([o,s])=>{const{init:a,bind:l,empty:u,...c}=s;c.type==="single"?(c.type="point",c.toggle=!1):c.type==="multi"&&(c.type="point"),n.emptySelections[o]=u!=="none";for(const f of Zt(n.selectionPredicates[o]??{}))f.empty=u!=="none";return{name:o,value:a,select:c,bind:l}})}:t}}function O8(e,t){const{transform:n,...r}=e;if(n){const i=n.map(o=>{if(AA(o))return{filter:_S(o,t)};if(wU(o)&&wu(o.bin))return{...o,bin:EU(o.bin)};if(xU(o)){const{selection:s,...a}=o.from;return s?{...o,from:{param:s,...a}}:o}return o});return{...r,transform:i}}return e}function bU(e,t){var r,i;const n=de(e);if(H(n)&&wu(n.bin)&&(n.bin=EU(n.bin)),_u(n)&&((i=(r=n.scale)==null?void 0:r.domain)!=null&&i.selection)){const{selection:o,...s}=n.scale.domain;n.scale.domain={...s,...o?{param:o}:{}}}if(og(n))if(j(n.condition))n.condition=n.condition.map(o=>{const{selection:s,param:a,test:l,...u}=o;return a?o:{...u,test:_S(o,t)}});else{const{selection:o,param:s,test:a,...l}=bU(n.condition,t);n.condition=s?n.condition:{...l,test:_S(n.condition,t)}}return n}function EU(e){const t=e.extent;if(t!=null&&t.selection){const{selection:n,...r}=t;return{...e,extent:{...r,param:n}}}return e}function _S(e,t){const n=r=>xc(r,i=>{var o;const s=t.emptySelections[i]??!0,a={param:i,empty:s};return(o=t.selectionPredicates)[i]??(o[i]=[]),t.selectionPredicates[i].push(a),a});return e.selection?n(e.selection):xc(e.test||e.filter,r=>r.selection?n(r.selection):r)}class kS extends $A{map(t,n){const r=n.selections??[];if(t.params&&!_s(t)){const i=[];for(const o of t.params)_A(o)?r.push(o):i.push(o);t.params=i}return n.selections=r,super.map(t,n)}mapUnit(t,n){const r=n.selections;if(!r||!r.length)return t;const i=(n.path??[]).concat(t.name),o=[];for(const s of r)if(!s.views||!s.views.length)o.push(s);else for(const a of s.views)(ee(a)&&(a===t.name||i.includes(a))||j(a)&&a.map(l=>i.indexOf(l)).every((l,u,c)=>l!==-1&&(u===0||l>c[u-1])))&&o.push(s);return o.length&&(t.params=o),t}}for(const e of["mapFacet","mapRepeat","mapHConcat","mapVConcat","mapLayer"]){const t=kS.prototype[e];kS.prototype[e]=function(n,r){return t.call(this,n,axe(n,r))}}function axe(e,t){return e.name?{...t,path:(t.path??[]).concat(e.name)}:t}function SU(e,t){t===void 0&&(t=pU(e.config));const n=fxe(e,t),{width:r,height:i}=e,o=dxe(n,{width:r,height:i,autosize:e.autosize},t);return{...n,...o?{autosize:o}:{}}}const lxe=new Ive,uxe=new sxe,cxe=new kS;function fxe(e,t={}){const n={config:t};return cxe.map(lxe.map(uxe.map(e,n),n),n)}function P8(e){return ee(e)?{type:e}:e??{}}function dxe(e,t,n){let{width:r,height:i}=t;const o=_s(e)||ux(e),s={};o?r=="container"&&i=="container"?(s.type="fit",s.contains="padding"):r=="container"?(s.type="fit-x",s.contains="padding"):i=="container"&&(s.type="fit-y",s.contains="padding"):(r=="container"&&(q(a8("width")),r=void 0),i=="container"&&(q(a8("height")),i=void 0));const a={type:"pad",...s,...n?P8(n.autosize):{},...P8(e.autosize)};if(a.type==="fit"&&!o&&(q(ame),a.type="pad"),r=="container"&&!(a.type=="fit"||a.type=="fit-x")&&q(l8("width")),i=="container"&&!(a.type=="fit"||a.type=="fit-y")&&q(l8("height")),!yr(a,{type:"pad"}))return a}function hxe(e){return["fit","fit-x","fit-y"].includes(e)}function pxe(e){return e?`fit-${Hv(e)}`:"fit"}const gxe=["background","padding"];function L8(e,t){const n={};for(const r of gxe)e&&e[r]!==void 0&&(n[r]=hr(e[r]));return t&&(n.params=e.params),n}class ks{constructor(t={},n={}){this.explicit=t,this.implicit=n}clone(){return new ks(de(this.explicit),de(this.implicit))}combine(){return{...this.explicit,...this.implicit}}get(t){return pt(this.explicit[t],this.implicit[t])}getWithExplicit(t){return this.explicit[t]!==void 0?{explicit:!0,value:this.explicit[t]}:this.implicit[t]!==void 0?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,{value:n,explicit:r}){n!==void 0&&this.set(t,n,r)}set(t,n,r){return delete this[r?"implicit":"explicit"][t],this[r?"explicit":"implicit"][t]=n,this}copyKeyFromSplit(t,{explicit:n,implicit:r}){n[t]!==void 0?this.set(t,n[t],!0):r[t]!==void 0&&this.set(t,r[t],!1)}copyKeyFromObject(t,n){n[t]!==void 0&&this.set(t,n[t],!0)}copyAll(t){for(const n of B(t.combine())){const r=t.getWithExplicit(n);this.setWithExplicit(n,r)}}}function Yi(e){return{explicit:!0,value:e}}function ur(e){return{explicit:!1,value:e}}function _U(e){return(t,n,r,i)=>{const o=e(t.value,n.value);return o>0?t:o<0?n:cx(t,n,r,i)}}function cx(e,t,n,r){return e.explicit&&t.explicit&&q(Gme(n,r,e.value,t.value)),e}function Aa(e,t,n,r,i=cx){return e===void 0||e.value===void 0?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:yr(e.value,t.value)?e:i(e,t,n,r)}class mxe extends ks{constructor(t={},n={},r=!1){super(t,n),this.explicit=t,this.implicit=n,this.parseNothing=r}clone(){const t=super.clone();return t.parseNothing=this.parseNothing,t}}function lf(e){return W(e,"url")}function fp(e){return W(e,"values")}function kU(e){return W(e,"name")&&!lf(e)&&!fp(e)&&!da(e)}function da(e){return e&&(CU(e)||$U(e)||FA(e))}function CU(e){return W(e,"sequence")}function $U(e){return W(e,"sphere")}function FA(e){return W(e,"graticule")}var ct;(function(e){e[e.Raw=0]="Raw",e[e.Main=1]="Main",e[e.Row=2]="Row",e[e.Column=3]="Column",e[e.Lookup=4]="Lookup",e[e.PreFilterInvalid=5]="PreFilterInvalid",e[e.PostFilterInvalid=6]="PostFilterInvalid"})(ct||(ct={}));function AU({invalid:e,isPath:t}){switch(SB(e,{isPath:t})){case"filter":return{marks:"exclude-invalid-values",scales:"exclude-invalid-values"};case"break-paths-show-domains":return{marks:t?"include-invalid-values":"exclude-invalid-values",scales:"include-invalid-values"};case"break-paths-filter-domains":return{marks:t?"include-invalid-values":"exclude-invalid-values",scales:"exclude-invalid-values"};case"show":return{marks:"include-invalid-values",scales:"include-invalid-values"}}}function yxe(e){const{marks:t,scales:n}=AU(e);return t===n?ct.Main:n==="include-invalid-values"?ct.PreFilterInvalid:ct.PostFilterInvalid}function FU(e){const{signals:t,hasLegend:n,index:r,...i}=e;return i.field=Kr(i.field),i}function iu(e,t=!0,n=wn){if(j(e)){const r=e.map(i=>iu(i,t,n));return t?`[${r.join(", ")}]`:r}else if(Eu(e))return n(t?eu(e):v1e(e));return t?n(Ue(e)):e}function vxe(e,t){for(const n of Zt(e.component.selection??{})){const r=n.name;let i=`${r}${Fa}, ${n.resolve==="global"?"true":`{unit: ${Rl(e)}}`}`;for(const o of px)o.defined(n)&&(o.signals&&(t=o.signals(e,n,t)),o.modifyExpr&&(i=o.modifyExpr(e,n,i)));t.push({name:r+Yxe,on:[{events:{signal:n.name+Fa},update:`modify(${Y(n.name+ou)}, ${i})`}]})}return MA(t)}function xxe(e,t){if(e.component.selection&&B(e.component.selection).length){const n=Y(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:ja("pointermove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return MA(t)}function wxe(e,t){let n=!1;for(const r of Zt(e.component.selection??{})){const i=r.name,o=Y(i+ou);if(t.filter(a=>a.name===i).length===0){const a=r.resolve==="global"?"union":r.resolve,l=r.type==="point"?", true, true)":")";t.push({name:r.name,update:`${GU}(${o}, ${Y(a)}${l}`})}n=!0;for(const a of px)a.defined(r)&&a.topLevelSignals&&(t=a.topLevelSignals(e,r,t))}return n&&t.filter(i=>i.name==="unit").length===0&&t.unshift({name:"unit",value:{},on:[{events:"pointermove",update:"isTuple(group()) ? group() : unit"}]}),MA(t)}function bxe(e,t){const n=[...t],r=Rl(e,{escape:!1});for(const i of Zt(e.component.selection??{})){const o={name:i.name+ou};if(i.project.hasSelectionId&&(o.transform=[{type:"collect",sort:{field:Ti}}]),i.init){const a=i.project.items.map(FU);o.values=i.project.hasSelectionId?i.init.map(l=>({unit:r,[Ti]:iu(l,!1)[0]})):i.init.map(l=>({unit:r,fields:a,values:iu(l,!1)}))}n.filter(a=>a.name===i.name+ou).length||n.push(o)}return n}function MU(e,t){for(const n of Zt(e.component.selection??{}))for(const r of px)r.defined(n)&&r.marks&&(t=r.marks(e,n,t));return t}function Exe(e,t){for(const n of e.children)rt(n)&&(t=MU(n,t));return t}function Sxe(e,t,n,r){const i=ZU(e,t.param,t);return{signal:Ai(n.get("type"))&&j(r)&&r[0]>r[1]?`isValid(${i}) && reverse(${i})`:i}}function MA(e){return e.map(t=>(t.on&&!t.on.length&&delete t.on,t))}class Ie{constructor(t,n){this.debugName=n,this._children=[],this._parent=null,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,n){if(this._children.includes(t)){q(bme);return}n!==void 0?this._children.splice(n,0,t):this._children.push(t)}removeChild(t){const n=this._children.indexOf(t);return this._children.splice(n,1),n}remove(){let t=this._parent.removeChild(this);for(const n of this._children)n._parent=this._parent,this._parent.addChild(n,t++)}insertAsParentOf(t){const n=t.parent;n.removeChild(this),this.parent=n,t.parent=this}swapWithParent(){const t=this._parent,n=t.parent;for(const i of this._children)i.parent=t;this._children=[],t.removeChild(this);const r=t.parent.removeChild(t);this._parent=n,n.addChild(this,r),t.parent=this}}class er extends Ie{clone(){const t=new this.constructor;return t.debugName=`clone_${this.debugName}`,t._source=this._source,t._name=`clone_${this._name}`,t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}constructor(t,n,r,i){super(t,n),this.type=r,this.refCounts=i,this._source=this._name=n,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}dependentFields(){return new Set}producedFields(){return new Set}hash(){return this._hash===void 0&&(this._hash=`Output ${_j()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}}function gw(e){return e.as!==void 0}function z8(e){return`${e}_end`}class ao extends Ie{clone(){return new ao(null,de(this.timeUnits))}constructor(t,n){super(t),this.timeUnits=n}static makeFromEncoding(t,n){const r=n.reduceFieldDef((i,o,s)=>{const{field:a,timeUnit:l}=o;if(l){let u;if(Su(l)){if(rt(n)){const{mark:c,markDef:f,config:d}=n,h=$a({fieldDef:o,markDef:f,config:d});(cp(c)||h)&&(u={timeUnit:zt(l),field:a})}}else u={as:Q(o,{forAs:!0}),field:a,timeUnit:l};if(rt(n)){const{mark:c,markDef:f,config:d}=n,h=$a({fieldDef:o,markDef:f,config:d});cp(c)&&gt(s)&&h!==.5&&(u.rectBandPosition=h)}u&&(i[_e(u)]=u)}return i},{});return Be(r)?null:new ao(t,r)}static makeFromTransform(t,n){const{timeUnit:r,...i}={...n},o=zt(r),s={...i,timeUnit:o};return new ao(t,{[_e(s)]:s})}merge(t){this.timeUnits={...this.timeUnits};for(const n in t.timeUnits)this.timeUnits[n]||(this.timeUnits[n]=t.timeUnits[n]);for(const n of t.children)t.removeChild(n),n.parent=this;t.remove()}removeFormulas(t){const n={};for(const[r,i]of ka(this.timeUnits)){const o=gw(i)?i.as:`${i.field}_end`;t.has(o)||(n[r]=i)}this.timeUnits=n}producedFields(){return new Set(Zt(this.timeUnits).map(t=>gw(t)?t.as:z8(t.field)))}dependentFields(){return new Set(Zt(this.timeUnits).map(t=>t.field))}hash(){return`TimeUnit ${_e(this.timeUnits)}`}assemble(){const t=[];for(const n of Zt(this.timeUnits)){const{rectBandPosition:r}=n,i=zt(n.timeUnit);if(gw(n)){const{field:o,as:s}=n,{unit:a,utc:l,...u}=i,c=[s,`${s}_end`];t.push({field:Kr(o),type:"timeunit",...a?{units:Xv(a)}:{},...l?{timezone:"utc"}:{},...u,as:c}),t.push(...I8(c,r,i))}else if(n){const{field:o}=n,s=o.replaceAll("\\.","."),a=TU({timeUnit:i,field:s}),l=z8(s);t.push({type:"formula",expr:a,as:l}),t.push(...I8([s,l],r,i))}}return t}}const fx="offsetted_rect_start",dx="offsetted_rect_end";function TU({timeUnit:e,field:t,reverse:n}){const{unit:r,utc:i}=e,o=oB(r),{part:s,step:a}=uB(o,e.step);return`${i?"utcOffset":"timeOffset"}('${s}', datum['${t}'], ${n?-a:a})`}function I8([e,t],n,r){if(n!==void 0&&n!==.5){const i=`datum['${e}']`,o=`datum['${t}']`;return[{type:"formula",expr:j8([TU({timeUnit:r,field:e,reverse:!0}),i],n+.5),as:`${e}_${fx}`},{type:"formula",expr:j8([i,o],n+.5),as:`${e}_${dx}`}]}return[]}function j8([e,t],n){return`${1-n} * ${e} + ${n} * ${t}`}const ug="_tuple_fields";class _xe{constructor(...t){this.items=t,this.hasChannel={},this.hasField={},this.hasSelectionId=!1}}const kxe={defined:()=>!0,parse:(e,t,n)=>{const r=t.name,i=t.project??(t.project=new _xe),o={},s={},a=new Set,l=(p,g)=>{const y=g==="visual"?p.channel:p.field;let m=Je(`${r}_${y}`);for(let v=1;a.has(m);v++)m=Je(`${r}_${y}_${v}`);return a.add(m),{[g]:m}},u=t.type,c=e.config.selection[u],f=n.value!==void 0?J(n.value):null;let{fields:d,encodings:h}=Z(n.select)?n.select:{};if(!d&&!h&&f){for(const p of f)if(Z(p))for(const g of B(p))P0e(g)?(h||(h=[])).push(g):u==="interval"?(q(yme),h=c.encodings):(d??(d=[])).push(g)}!d&&!h&&(h=c.encodings,"fields"in c&&(d=c.fields));for(const p of h??[]){const g=e.fieldDef(p);if(g){let y=g.field;if(g.aggregate){q(lme(p,g.aggregate));continue}else if(!y){q(c8(p));continue}if(g.timeUnit&&!Su(g.timeUnit)){y=e.vgField(p);const m={timeUnit:g.timeUnit,as:y,field:g.field};s[_e(m)]=m}if(!o[y]){const m=u==="interval"&&To(p)&&Ai(e.getScaleComponent(p).get("type"))?"R":g.bin?"R-RE":"E",v={field:y,channel:p,type:m,index:i.items.length};v.signals={...l(v,"data"),...l(v,"visual")},i.items.push(o[y]=v),i.hasField[y]=o[y],i.hasSelectionId=i.hasSelectionId||y===Ti,Mj(p)?(v.geoChannel=p,v.channel=Fj(p),i.hasChannel[v.channel]=o[y]):i.hasChannel[p]=o[y]}}else q(c8(p))}for(const p of d??[]){if(i.hasField[p])continue;const g={type:"E",field:p,index:i.items.length};g.signals={...l(g,"data")},i.items.push(g),i.hasField[p]=g,i.hasSelectionId=i.hasSelectionId||p===Ti}f&&(t.init=f.map(p=>i.items.map(g=>Z(p)?p[g.geoChannel||g.channel]!==void 0?p[g.geoChannel||g.channel]:p[g.field]:p))),Be(s)||(i.timeUnit=new ao(null,s))},signals:(e,t,n)=>{const r=t.name+ug;return n.filter(o=>o.name===r).length>0||t.project.hasSelectionId?n:n.concat({name:r,value:t.project.items.map(FU)})}},os={defined:e=>e.type==="interval"&&e.resolve==="global"&&e.bind&&e.bind==="scales",parse:(e,t)=>{const n=t.scales=[];for(const r of t.project.items){const i=r.channel;if(!To(i))continue;const o=e.getScaleComponent(i),s=o?o.get("type"):void 0;if(s=="sequential"&&q(dme),!o||!Ai(s)){q(fme);continue}o.set("selectionExtent",{param:t.name,field:r.field},!0),n.push(r)}},topLevelSignals:(e,t,n)=>{const r=t.scales.filter(s=>n.filter(a=>a.name===s.signals.data).length===0);if(!e.parent||B8(e)||r.length===0)return n;const i=n.find(s=>s.name===t.name);let o=i.update;if(o.includes(GU))i.update=`{${r.map(s=>`${Y(Kr(s.field))}: ${s.signals.data}`).join(", ")}}`;else{for(const s of r){const a=`${Y(Kr(s.field))}: ${s.signals.data}`;o.includes(a)||(o=`${o.substring(0,o.length-1)}, ${a}}`)}i.update=o}return n.concat(r.map(s=>({name:s.signals.data})))},signals:(e,t,n)=>{if(e.parent&&!B8(e))for(const r of t.scales){const i=n.find(o=>o.name===r.signals.data);i.push="outer",delete i.value,delete i.update}return n}};function CS(e,t){return`domain(${Y(e.scaleName(t))})`}function B8(e){return e.parent&&Uf(e.parent)&&!e.parent.parent}const Ec="_brush",NU="_scale_trigger",vd="geo_interval_init_tick",RU="_init",Cxe="_center",$xe={defined:e=>e.type==="interval",parse:(e,t,n)=>{var r;if(e.hasProjection){const i={...Z(n.select)?n.select:{}};i.fields=[Ti],i.encodings||(i.encodings=n.value?B(n.value):[zi,Li]),n.select={type:"interval",...i}}if(t.translate&&!os.defined(t)){const i=`!event.item || event.item.mark.name !== ${Y(t.name+Ec)}`;for(const o of t.events){if(!o.between){q(`${o} is not an ordered event stream for interval selections.`);continue}const s=J((r=o.between[0]).filter??(r.filter=[]));s.includes(i)||s.push(i)}}},signals:(e,t,n)=>{const r=t.name,i=r+Fa,o=Zt(t.project.hasChannel).filter(a=>a.channel===et||a.channel===Bt),s=t.init?t.init[0]:null;if(n.push(...o.reduce((a,l)=>a.concat(Axe(e,t,l,s&&s[l.index])),[])),e.hasProjection){const a=Y(e.projectionName()),l=e.projectionName()+Cxe,{x:u,y:c}=t.project.hasChannel,f=u&&u.signals.visual,d=c&&c.signals.visual,h=u?s&&s[u.index]:`${l}[0]`,p=c?s&&s[c.index]:`${l}[1]`,g=b=>e.getSizeSignalRef(b).signal,y=`[[${f?f+"[0]":"0"}, ${d?d+"[0]":"0"}],[${f?f+"[1]":g("width")}, ${d?d+"[1]":g("height")}]]`;s&&(n.unshift({name:r+RU,init:`[scale(${a}, [${u?h[0]:h}, ${c?p[0]:p}]), scale(${a}, [${u?h[1]:h}, ${c?p[1]:p}])]`}),(!u||!c)&&(n.find(S=>S.name===l)||n.unshift({name:l,update:`invert(${a}, [${g("width")}/2, ${g("height")}/2])`})));const m=`intersect(${y}, {markname: ${Y(e.getName("marks"))}}, unit.mark)`,v=`{unit: ${Rl(e)}}`,x=`vlSelectionTuples(${m}, ${v})`,w=o.map(b=>b.signals.visual);return n.concat({name:i,on:[{events:[...w.length?[{signal:w.join(" || ")}]:[],...s?[{signal:vd}]:[]],update:x}]})}else{if(!os.defined(t)){const u=r+NU,c=o.map(f=>{const d=f.channel,{data:h,visual:p}=f.signals,g=Y(e.scaleName(d)),y=e.getScaleComponent(d).get("type"),m=Ai(y)?"+":"";return`(!isArray(${h}) || (${m}invert(${g}, ${p})[0] === ${m}${h}[0] && ${m}invert(${g}, ${p})[1] === ${m}${h}[1]))`});c.length&&n.push({name:u,value:{},on:[{events:o.map(f=>({scale:e.scaleName(f.channel)})),update:c.join(" && ")+` ? ${u} : {}`}]})}const a=o.map(u=>u.signals.data),l=`unit: ${Rl(e)}, fields: ${r+ug}, values`;return n.concat({name:i,...s?{init:`{${l}: ${iu(s)}}`}:{},...a.length?{on:[{events:[{signal:a.join(" || ")}],update:`${a.join(" && ")} ? {${l}: [${a}]} : null`}]}:{}})}},topLevelSignals:(e,t,n)=>(rt(e)&&e.hasProjection&&t.init&&(n.filter(i=>i.name===vd).length||n.unshift({name:vd,value:null,on:[{events:"timer{1}",update:`${vd} === null ? {} : ${vd}`}]})),n),marks:(e,t,n)=>{const r=t.name,{x:i,y:o}=t.project.hasChannel,s=i==null?void 0:i.signals.visual,a=o==null?void 0:o.signals.visual,l=`data(${Y(t.name+ou)})`;if(os.defined(t)||!i&&!o)return n;const u={x:i!==void 0?{signal:`${s}[0]`}:{value:0},y:o!==void 0?{signal:`${a}[0]`}:{value:0},x2:i!==void 0?{signal:`${s}[1]`}:{field:{group:"width"}},y2:o!==void 0?{signal:`${a}[1]`}:{field:{group:"height"}}};if(t.resolve==="global")for(const y of B(u))u[y]=[{test:`${l}.length && ${l}[0].unit === ${Rl(e)}`,...u[y]},{value:0}];const{fill:c,fillOpacity:f,cursor:d,...h}=t.mark,p=B(h).reduce((y,m)=>(y[m]=[{test:[i!==void 0&&`${s}[0] !== ${s}[1]`,o!==void 0&&`${a}[0] !== ${a}[1]`].filter(v=>v).join(" && "),value:h[m]},{value:null}],y),{}),g=d??(t.translate?"move":null);return[{name:`${r+Ec}_bg`,type:"rect",clip:!0,encode:{enter:{fill:{value:c},fillOpacity:{value:f}},update:u}},...n,{name:r+Ec,type:"rect",clip:!0,encode:{enter:{...g?{cursor:{value:g}}:{},fill:{value:"transparent"}},update:{...u,...p}}}]}};function Axe(e,t,n,r){const i=!e.hasProjection,o=n.channel,s=n.signals.visual,a=Y(i?e.scaleName(o):e.projectionName()),l=d=>`scale(${a}, ${d})`,u=e.getSizeSignalRef(o===et?"width":"height").signal,c=`${o}(unit)`,f=t.events.reduce((d,h)=>[...d,{events:h.between[0],update:`[${c}, ${c}]`},{events:h,update:`[${s}[0], clamp(${c}, 0, ${u})]`}],[]);if(i){const d=n.signals.data,h=os.defined(t),p=e.getScaleComponent(o),g=p?p.get("type"):void 0,y=r?{init:iu(r,!0,l)}:{value:[]};return f.push({events:{signal:t.name+NU},update:Ai(g)?`[${l(`${d}[0]`)}, ${l(`${d}[1]`)}]`:"[0, 0]"}),h?[{name:d,on:[]}]:[{name:s,...y,on:f},{name:d,...r?{init:iu(r)}:{},on:[{events:{signal:s},update:`${s}[0] === ${s}[1] ? null : invert(${a}, ${s})`}]}]}else{const d=o===et?0:1,h=t.name+RU,p=r?{init:`[${h}[0][${d}], ${h}[1][${d}]]`}:{value:[]};return[{name:s,...p,on:f}]}}const Fxe={defined:e=>e.type==="point",signals:(e,t,n)=>{const r=t.name,i=r+ug,o=t.project,s="(item().isVoronoi ? datum.datum : datum)",a=Zt(e.component.selection??{}).reduce((f,d)=>d.type==="interval"?f.concat(d.name+Ec):f,[]).map(f=>`indexof(item().mark.name, '${f}') < 0`).join(" && "),l=`datum && item().mark.marktype !== 'group' && indexof(item().mark.role, 'legend') < 0${a?` && ${a}`:""}`;let u=`unit: ${Rl(e)}, `;if(t.project.hasSelectionId)u+=`${Ti}: ${s}[${Y(Ti)}]`;else{const f=o.items.map(d=>{const h=e.fieldDef(d.channel);return h!=null&&h.bin?`[${s}[${Y(e.vgField(d.channel,{}))}], ${s}[${Y(e.vgField(d.channel,{binSuffix:"end"}))}]]`:`${s}[${Y(d.field)}]`}).join(", ");u+=`fields: ${i}, values: [${f}]`}const c=t.events;return n.concat([{name:r+Fa,on:c?[{events:c,update:`${l} ? {${u}} : null`,force:!0}]:[]}])}};function zf({model:e,channelDef:t,vgChannel:n,invalidValueRef:r,mainRefFn:i}){const o=og(t)&&t.condition;let s=[];o&&(s=J(o).map(u=>{const c=i(u);if(vye(u)){const{param:f,empty:d}=u;return{test:KU(e,{param:f,empty:d}),...c}}else return{test:ry(e,u.test),...c}})),r!==void 0&&s.push(r);const a=i(t);return a!==void 0&&s.push(a),s.length>1||s.length===1&&s[0].test?{[n]:s}:s.length===1?{[n]:s[0]}:{}}function TA(e,t="text"){const n=e.encoding[t];return zf({model:e,channelDef:n,vgChannel:t,mainRefFn:r=>hx(r,e.config),invalidValueRef:void 0})}function hx(e,t,n="datum"){if(e){if(Fi(e))return Xe(e.value);if(he(e)){const{format:r,formatType:i}=K1(e);return fA({fieldOrDatumDef:e,format:r,formatType:i,expr:n,config:t})}}}function DU(e,t={}){const{encoding:n,markDef:r,config:i,stack:o}=e,s=n.tooltip;if(j(s))return{tooltip:U8({tooltip:s},o,i,t)};{const a=t.reactiveGeom?"datum.datum":"datum";return zf({model:e,channelDef:s,vgChannel:"tooltip",mainRefFn:u=>{const c=hx(u,i,a);if(c)return c;if(u===null)return;let f=je("tooltip",r,i);if(f===!0&&(f={content:"encoding"}),ee(f))return{value:f};if(Z(f))return oe(f)?f:f.content==="encoding"?U8(n,o,i,t):{signal:a}},invalidValueRef:void 0})}}function OU(e,t,n,{reactiveGeom:r}={}){const i={...n,...n.tooltipFormat},o=new Set,s=r?"datum.datum":"datum",a=[];function l(c,f){const d=xu(f),h=zn(c)?c:{...c,type:e[d].type},p=h.title||gA(h,i),g=J(p).join(", ").replaceAll(/"/g,'\\"');let y;if(gt(f)){const m=f==="x"?"x2":"y2",v=Mi(e[m]);if(qt(h.bin)&&v){const x=Q(h,{expr:s}),w=Q(v,{expr:s}),{format:b,formatType:S}=K1(h);y=rg(x,w,b,S,i),o.add(m)}}if((gt(f)||f===ei||f===Pi)&&t&&t.fieldChannel===f&&t.offset==="normalize"){const{format:m,formatType:v}=K1(h);y=fA({fieldOrDatumDef:h,format:m,formatType:v,expr:s,config:i,normalizeStack:!0}).signal}y??(y=hx(h,i,s).signal),a.push({channel:f,key:g,value:y})}yA(e,(c,f)=>{H(c)?l(c,f):rx(c)&&l(c.condition,f)});const u={};for(const{channel:c,key:f,value:d}of a)!o.has(c)&&!u[f]&&(u[f]=d);return u}function U8(e,t,n,{reactiveGeom:r}={}){const i=OU(e,t,n,{reactiveGeom:r}),o=ka(i).map(([s,a])=>`"${s}": ${a}`);return o.length>0?{signal:`{${o.join(", ")}}`}:void 0}function Mxe(e){const{markDef:t,config:n}=e,r=je("aria",t,n);return r===!1?{}:{...r?{aria:r}:{},...Txe(e),...Nxe(e)}}function Txe(e){const{mark:t,markDef:n,config:r}=e;if(r.aria===!1)return{};const i=je("ariaRoleDescription",n,r);return i!=null?{ariaRoleDescription:{value:i}}:te(ime,t)?{}:{ariaRoleDescription:{value:t}}}function Nxe(e){const{encoding:t,markDef:n,config:r,stack:i}=e,o=t.description;if(o)return zf({model:e,channelDef:o,vgChannel:"description",mainRefFn:l=>hx(l,e.config),invalidValueRef:void 0});const s=je("description",n,r);if(s!=null)return{description:Xe(s)};if(r.aria===!1)return{};const a=OU(t,i,r);if(!Be(a))return{description:{signal:ka(a).map(([l,u],c)=>`"${c>0?"; ":""}${l}: " + (${u})`).join(" + ")}}}function Gt(e,t,n={}){const{markDef:r,encoding:i,config:o}=t,{vgChannel:s}=n;let{defaultRef:a,defaultValue:l}=n;const u=i[e];a===void 0&&(l??(l=je(e,r,o,{vgChannel:s,ignoreVgConfig:!og(u)})),l!==void 0&&(a=Xe(l)));const c={markDef:r,config:o,scaleName:t.scaleName(e),scale:t.getScaleComponent(e)},f=kB({...c,scaleChannel:e,channelDef:u});return zf({model:t,channelDef:u,vgChannel:s??e,invalidValueRef:f,mainRefFn:h=>cA({...c,channel:e,channelDef:h,stack:null,defaultRef:a})})}function PU(e,t={filled:void 0}){const{markDef:n,encoding:r,config:i}=e,{type:o}=n,s=t.filled??je("filled",n,i),a=Ee(["bar","point","circle","square","geoshape"],o)?"transparent":void 0,l=je(s===!0?"color":void 0,n,i,{vgChannel:"fill"})??i.mark[s===!0&&"color"]??a,u=je(s===!1?"color":void 0,n,i,{vgChannel:"stroke"})??i.mark[s===!1&&"color"],c=s?"fill":"stroke",f={...l?{fill:Xe(l)}:{},...u?{stroke:Xe(u)}:{}};return n.color&&(s?n.fill:n.stroke)&&q(Qj("property",{fill:"fill"in n,stroke:"stroke"in n})),{...f,...Gt("color",e,{vgChannel:c,defaultValue:s?l:u}),...Gt("fill",e,{defaultValue:r.fill?l:void 0}),...Gt("stroke",e,{defaultValue:r.stroke?u:void 0})}}function Rxe(e){const{encoding:t,mark:n}=e,r=t.order;return!Ga(n)&&Fi(r)?zf({model:e,channelDef:r,vgChannel:"zindex",mainRefFn:i=>Xe(i.value),invalidValueRef:void 0}):{}}function uf({channel:e,markDef:t,encoding:n={},model:r,bandPosition:i}){const o=`${e}Offset`,s=t[o],a=n[o];if((o==="xOffset"||o==="yOffset")&&a)return{offsetType:"encoding",offset:cA({channel:o,channelDef:a,markDef:t,config:r==null?void 0:r.config,scaleName:r.scaleName(o),scale:r.getScaleComponent(o),stack:null,defaultRef:Xe(s),bandPosition:i})};const l=t[o];return l?{offsetType:"visual",offset:l}:{}}function Nn(e,t,{defaultPos:n,vgChannel:r}){const{encoding:i,markDef:o,config:s,stack:a}=t,l=i[e],u=i[Mo(e)],c=t.scaleName(e),f=t.getScaleComponent(e),{offset:d,offsetType:h}=uf({channel:e,markDef:o,encoding:i,model:t,bandPosition:.5}),p=NA({model:t,defaultPos:n,channel:e,scaleName:c,scale:f}),g=!l&&gt(e)&&(i.latitude||i.longitude)?{field:t.getName(e)}:Dxe({channel:e,channelDef:l,channel2Def:u,markDef:o,config:s,scaleName:c,scale:f,stack:a,offset:d,defaultRef:p,bandPosition:h==="encoding"?0:void 0});return g?{[r||e]:g}:void 0}function Dxe(e){const{channel:t,channelDef:n,scaleName:r,stack:i,offset:o,markDef:s}=e;if(he(n)&&i&&t===i.fieldChannel){if(H(n)){let a=n.bandPosition;if(a===void 0&&s.type==="text"&&(t==="radius"||t==="theta")&&(a=.5),a!==void 0)return Y1({scaleName:r,fieldOrDatumDef:n,startSuffix:"start",bandPosition:a,offset:o})}return Tl(n,r,{suffix:"end"},{offset:o})}return uA(e)}function NA({model:e,defaultPos:t,channel:n,scaleName:r,scale:i}){const{markDef:o,config:s}=e;return()=>{const a=xu(n),l=Ca(n),u=je(n,o,s,{vgChannel:l});if(u!==void 0)return xh(n,u);switch(t){case"zeroOrMin":return W8({scaleName:r,scale:i,mode:"zeroOrMin",mainChannel:a,config:s});case"zeroOrMax":return W8({scaleName:r,scale:i,mode:{zeroOrMax:{widthSignal:e.width.signal,heightSignal:e.height.signal}},mainChannel:a,config:s});case"mid":return{...e[sr(n)],mult:.5}}}}function W8({mainChannel:e,config:t,...n}){const r=_B(n),{mode:i}=n;if(r)return r;switch(e){case"radius":{if(i==="zeroOrMin")return{value:0};const{widthSignal:o,heightSignal:s}=i.zeroOrMax;return{signal:`min(${o},${s})/2`}}case"theta":return i==="zeroOrMin"?{value:0}:{signal:"2*PI"};case"x":return i==="zeroOrMin"?{value:0}:{field:{group:"width"}};case"y":return i==="zeroOrMin"?{field:{group:"height"}}:{value:0}}}const Oxe={left:"x",center:"xc",right:"x2"},Pxe={top:"y",middle:"yc",bottom:"y2"};function LU(e,t,n,r="middle"){if(e==="radius"||e==="theta")return Ca(e);const i=e==="x"?"align":"baseline",o=je(i,t,n);let s;return oe(o)?(q(Pme(i)),s=void 0):s=o,e==="x"?Oxe[s||(r==="top"?"left":"center")]:Pxe[s||r]}function ty(e,t,{defaultPos:n,defaultPos2:r,range:i}){return i?zU(e,t,{defaultPos:n,defaultPos2:r}):Nn(e,t,{defaultPos:n})}function zU(e,t,{defaultPos:n,defaultPos2:r}){const{markDef:i,config:o}=t,s=Mo(e),a=sr(e),l=Lxe(t,r,s),u=l[a]?LU(e,i,o):Ca(e);return{...Nn(e,t,{defaultPos:n,vgChannel:u}),...l}}function Lxe(e,t,n){const{encoding:r,mark:i,markDef:o,stack:s,config:a}=e,l=xu(n),u=sr(n),c=Ca(n),f=r[l],d=e.scaleName(l),h=e.getScaleComponent(l),{offset:p}=n in r||n in o?uf({channel:n,markDef:o,encoding:r,model:e}):uf({channel:l,markDef:o,encoding:r,model:e});if(!f&&(n==="x2"||n==="y2")&&(r.latitude||r.longitude)){const y=sr(n),m=e.markDef[y];return m!=null?{[y]:{value:m}}:{[c]:{field:e.getName(n)}}}const g=zxe({channel:n,channelDef:f,channel2Def:r[n],markDef:o,config:a,scaleName:d,scale:h,stack:s,offset:p,defaultRef:void 0});return g!==void 0?{[c]:g}:s0(n,o)||s0(n,{[n]:gS(n,o,a.style),[u]:gS(u,o,a.style)})||s0(n,a[i])||s0(n,a.mark)||{[c]:NA({model:e,defaultPos:t,channel:n,scaleName:d,scale:h})()}}function zxe({channel:e,channelDef:t,channel2Def:n,markDef:r,config:i,scaleName:o,scale:s,stack:a,offset:l,defaultRef:u}){return he(t)&&a&&e.charAt(0)===a.fieldChannel.charAt(0)?Tl(t,o,{suffix:"start"},{offset:l}):uA({channel:e,channelDef:n,scaleName:o,scale:s,stack:a,markDef:r,config:i,offset:l,defaultRef:u})}function s0(e,t){const n=sr(e),r=Ca(e);if(t[r]!==void 0)return{[r]:xh(e,t[r])};if(t[e]!==void 0)return{[r]:xh(e,t[e])};if(t[n]){const i=t[n];if(nu(i))q(Mme(n));else return{[n]:xh(e,i)}}}function gs(e,t){const{config:n,encoding:r,markDef:i}=e,o=i.type,s=Mo(t),a=sr(t),l=r[t],u=r[s],c=e.getScaleComponent(t),f=c?c.get("type"):void 0,d=i.orient,h=r[a]??r.size??je("size",i,n,{vgChannel:a}),p=Dj(t),g=o==="bar"&&(t==="x"?d==="vertical":d==="horizontal")||o==="tick"&&(t==="y"?d==="vertical":d==="horizontal");return H(l)&&(Ve(l.bin)||qt(l.bin)||l.timeUnit&&!u)&&!(h&&!nu(h))&&!r[p]&&!It(f)?Bxe({fieldDef:l,fieldDef2:u,channel:t,model:e}):(he(l)&&It(f)||g)&&!u?jxe(l,t,e):zU(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function Ixe(e,t,n,r,i,o,s){if(nu(i))if(n){const l=n.get("type");if(l==="band"){let u=`bandwidth('${t}')`;i.band!==1&&(u=`${i.band} * ${u}`);const c=yo("minBandSize",{type:s},r);return{signal:c?`max(${vi(c)}, ${u})`:u}}else i.band!==1&&(q(jme(l)),i=void 0)}else return{mult:i.band,field:{group:e}};else{if(oe(i))return i;if(i)return{value:i}}if(n){const l=n.get("range");if(bu(l)&&Me(l.step))return{value:l.step-2}}if(!o){const{bandPaddingInner:l,barBandPaddingInner:u,rectBandPaddingInner:c,tickBandPaddingInner:f}=r.scale,d=pt(l,s==="tick"?f:s==="bar"?u:c);if(oe(d))return{signal:`(1 - (${d.signal})) * ${e}`};if(Me(d))return{signal:`${1-d} * ${e}`}}return{value:ES(r.view,e)-2}}function jxe(e,t,n){var k,C;const{markDef:r,encoding:i,config:o,stack:s}=n,a=r.orient,l=n.scaleName(t),u=n.getScaleComponent(t),c=sr(t),f=Mo(t),d=Dj(t),h=n.scaleName(d),p=n.getScaleComponent(z$(t)),g=r.type==="tick"||a==="horizontal"&&t==="y"||a==="vertical"&&t==="x";let y;(i.size||r.size)&&(g?y=Gt("size",n,{vgChannel:c,defaultRef:Xe(r.size)}):q(qme(r.type)));const m=!!y,v=NB({channel:t,fieldDef:e,markDef:r,config:o,scaleType:(k=u||p)==null?void 0:k.get("type"),useVlSizeChannel:g});y=y||{[c]:Ixe(c,h||l,p||u,o,v,!!e,r.type)};const x=((C=u||p)==null?void 0:C.get("type"))==="band"&&nu(v)&&!m?"top":"middle",w=LU(t,r,o,x),b=w==="xc"||w==="yc",{offset:S,offsetType:E}=uf({channel:t,markDef:r,encoding:i,model:n,bandPosition:b?.5:0}),_=uA({channel:t,channelDef:e,markDef:r,config:o,scaleName:l,scale:u,stack:s,offset:S,defaultRef:NA({model:n,defaultPos:"mid",channel:t,scaleName:l,scale:u}),bandPosition:b?E==="encoding"?0:.5:oe(v)?{signal:`(1-${v})/2`}:nu(v)?(1-v.band)/2:0});if(c)return{[w]:_,...y};{const $=Ca(f),O=y[c],A=S?{...O,offset:S}:O;return{[w]:_,[$]:j(_)?[_[0],{..._[1],offset:A}]:{..._,offset:A}}}}function q8(e,t,n,r,i,o,s){if(Aj(e))return 0;const a=e==="x"||e==="y2",l=a?-t/2:t/2;if(oe(n)||oe(i)||oe(r)||o){const u=vi(n),c=vi(i),f=vi(r),d=vi(o),p=o?`(${s} < ${d} ? ${a?"":"-"}0.5 * (${d} - (${s})) : ${l})`:l,g=f?`${f} + `:"",y=u?`(${u} ? -1 : 1) * `:"",m=c?`(${c} + ${p})`:p;return{signal:g+y+m}}else return i=i||0,r+(n?-i-l:+i+l)}function Bxe({fieldDef:e,fieldDef2:t,channel:n,model:r}){var C;const{config:i,markDef:o,encoding:s}=r,a=r.getScaleComponent(n),l=r.scaleName(n),u=a?a.get("type"):void 0,c=a.get("reverse"),f=NB({channel:n,fieldDef:e,markDef:o,config:i,scaleType:u}),d=(C=r.component.axes[n])==null?void 0:C[0],h=(d==null?void 0:d.get("translate"))??.5,p=gt(n)?je("binSpacing",o,i)??0:0,g=Mo(n),y=Ca(n),m=Ca(g),v=yo("minBandSize",o,i),{offset:x}=uf({channel:n,markDef:o,encoding:s,model:r,bandPosition:0}),{offset:w}=uf({channel:g,markDef:o,encoding:s,model:r,bandPosition:0}),b=dye({fieldDef:e,scaleName:l}),S=q8(n,p,c,h,x,v,b),E=q8(g,p,c,h,w??x,v,b),_=oe(f)?{signal:`(1-${f.signal})/2`}:nu(f)?(1-f.band)/2:.5,k=$a({fieldDef:e,fieldDef2:t,markDef:o,config:i});if(Ve(e.bin)||e.timeUnit){const $=e.timeUnit&&k!==.5;return{[m]:H8({fieldDef:e,scaleName:l,bandPosition:_,offset:E,useRectOffsetField:$}),[y]:H8({fieldDef:e,scaleName:l,bandPosition:oe(_)?{signal:`1-${_.signal}`}:1-_,offset:S,useRectOffsetField:$})}}else if(qt(e.bin)){const $=Tl(e,l,{},{offset:E});if(H(t))return{[m]:$,[y]:Tl(t,l,{},{offset:S})};if(wu(e.bin)&&e.bin.step)return{[m]:$,[y]:{signal:`scale("${l}", ${Q(e,{expr:"datum"})} + ${e.bin.step})`,offset:S}}}q(Jj(g))}function H8({fieldDef:e,scaleName:t,bandPosition:n,offset:r,useRectOffsetField:i}){return Y1({scaleName:t,fieldOrDatumDef:e,bandPosition:n,offset:r,...i?{startSuffix:fx,endSuffix:dx}:{}})}const Uxe=new Set(["aria","width","height"]);function ti(e,t){const{fill:n=void 0,stroke:r=void 0}=t.color==="include"?PU(e):{};return{...Wxe(e.markDef,t),...V8("fill",n),...V8("stroke",r),...Gt("opacity",e),...Gt("fillOpacity",e),...Gt("strokeOpacity",e),...Gt("strokeWidth",e),...Gt("strokeDash",e),...Rxe(e),...DU(e),...TA(e,"href"),...Mxe(e)}}function V8(e,t){return t?{[e]:t}:{}}function Wxe(e,t){return rme.reduce((n,r)=>(!Uxe.has(r)&&W(e,r)&&t[r]!=="ignore"&&(n[r]=Xe(e[r])),n),{})}function RA(e){const{config:t,markDef:n}=e,r=new Set;if(e.forEachFieldDef((i,o)=>{var u;let s;if(!To(o)||!(s=e.getScaleType(o)))return;const a=Vv(i.aggregate),l=lA({scaleChannel:o,markDef:n,config:t,scaleType:s,isCountAggregate:a});if(uye(l)){const c=e.vgField(o,{expr:"datum",binSuffix:(u=e.stack)!=null&&u.impute?"mid":void 0});c&&r.add(c)}}),r.size>0)return{defined:{signal:[...r].map(o=>Qv(o,!0)).join(" && ")}}}function G8(e,t){if(t!==void 0)return{[e]:Xe(t)}}const mw="voronoi",IU={defined:e=>e.type==="point"&&e.nearest,parse:(e,t)=>{if(t.events)for(const n of t.events)n.markname=e.getName(mw)},marks:(e,t,n)=>{const{x:r,y:i}=t.project.hasChannel,o=e.mark;if(Ga(o))return q(ume(o)),n;const s={name:e.getName(mw),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:{fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0},...DU(e,{reactiveGeom:!0})}},transform:[{type:"voronoi",x:{expr:r||!i?"datum.datum.x || 0":"0"},y:{expr:i||!r?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let a=0,l=!1;return n.forEach((u,c)=>{const f=u.name??"";f===e.component.mark[0].name?a=c:f.includes(mw)&&(l=!0)}),l||n.splice(a+1,0,s),n}},jU={defined:e=>e.type==="point"&&e.resolve==="global"&&e.bind&&e.bind!=="scales"&&!SA(e.bind),parse:(e,t,n)=>YU(t,n),topLevelSignals:(e,t,n)=>{const r=t.name,i=t.project,o=t.bind,s=t.init&&t.init[0],a=IU.defined(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return i.items.forEach((l,u)=>{const c=Je(`${r}_${l.field}`);n.filter(d=>d.name===c).length||n.unshift({name:c,...s?{init:iu(s[u])}:{value:null},on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${a}[${Y(l.field)}] : null`}]:[],bind:o[l.field]??o[l.channel]??o})}),n},signals:(e,t,n)=>{const r=t.name,i=t.project,o=n.find(u=>u.name===r+Fa),s=r+ug,a=i.items.map(u=>Je(`${r}_${u.field}`)),l=a.map(u=>`${u} !== null`).join(" && ");return a.length&&(o.update=`${l} ? {fields: ${s}, values: [${a.join(", ")}]} : null`),delete o.value,delete o.on,n}},ny="_toggle",BU={defined:e=>e.type==="point"&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+ny,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{const n=t.name+Fa,r=t.name+ny;return`${r} ? null : ${n}, `+(t.resolve==="global"?`${r} ? null : true, `:`${r} ? null : {unit: ${Rl(e)}}, `)+`${r} ? ${n} : null`}},qxe={defined:e=>e.clear!==void 0&&e.clear!==!1,parse:(e,t)=>{t.clear&&(t.clear=ee(t.clear)?ja(t.clear,"view"):t.clear)},topLevelSignals:(e,t,n)=>{if(jU.defined(t))for(const r of t.project.items){const i=n.findIndex(o=>o.name===Je(`${t.name}_${r.field}`));i!==-1&&n[i].on.push({events:t.clear,update:"null"})}return n},signals:(e,t,n)=>{function r(i,o){i!==-1&&n[i].on&&n[i].on.push({events:t.clear,update:o})}if(t.type==="interval")for(const i of t.project.items){const o=n.findIndex(s=>s.name===i.signals.visual);if(r(o,"[0, 0]"),o===-1){const s=n.findIndex(a=>a.name===i.signals.data);r(s,"null")}}else{let i=n.findIndex(o=>o.name===t.name+Fa);r(i,"null"),BU.defined(t)&&(i=n.findIndex(o=>o.name===t.name+ny),r(i,"false"))}return n}},UU={defined:e=>{const t=e.resolve==="global"&&e.bind&&SA(e.bind),n=e.project.items.length===1&&e.project.items[0].field!==Ti;return t&&!n&&q(hme),t&&n},parse:(e,t,n)=>{const r=de(n);if(r.select=ee(r.select)?{type:r.select,toggle:t.toggle}:{...r.select,toggle:t.toggle},YU(t,r),Z(n.select)&&(n.select.on||n.select.clear)){const s='event.item && indexof(event.item.mark.role, "legend") < 0';for(const a of t.events)a.filter=J(a.filter??[]),a.filter.includes(s)||a.filter.push(s)}const i=dw(t.bind)?t.bind.legend:"click",o=ee(i)?ja(i,"view"):J(i);t.bind={legend:{merge:o}}},topLevelSignals:(e,t,n)=>{const r=t.name,i=dw(t.bind)&&t.bind.legend,o=s=>a=>{const l=de(a);return l.markname=s,l};for(const s of t.project.items){if(!s.hasLegend)continue;const a=`${Je(s.field)}_legend`,l=`${r}_${a}`;if(n.filter(c=>c.name===l).length===0){const c=i.merge.map(o(`${a}_symbols`)).concat(i.merge.map(o(`${a}_labels`))).concat(i.merge.map(o(`${a}_entries`)));n.unshift({name:l,...t.init?{}:{value:null},on:[{events:c,update:"isDefined(datum.value) ? datum.value : item().items[0].items[0].datum.value",force:!0},{events:i.merge,update:`!event.item || !datum ? null : ${l}`,force:!0}]})}}return n},signals:(e,t,n)=>{const r=t.name,i=t.project,o=n.find(d=>d.name===r+Fa),s=r+ug,a=i.items.filter(d=>d.hasLegend).map(d=>Je(`${r}_${Je(d.field)}_legend`)),u=`${a.map(d=>`${d} !== null`).join(" && ")} ? {fields: ${s}, values: [${a.join(", ")}]} : null`;t.events&&a.length>0?o.on.push({events:a.map(d=>({signal:d})),update:u}):a.length>0&&(o.update=u,delete o.value,delete o.on);const c=n.find(d=>d.name===r+ny),f=dw(t.bind)&&t.bind.legend;return c&&(t.events?c.on.push({...c.on[0],events:f}):c.on[0].events=f),n}};function Hxe(e,t,n){var i;const r=(i=e.fieldDef(t))==null?void 0:i.field;for(const o of Zt(e.component.selection??{})){const s=o.project.hasField[r]??o.project.hasChannel[t];if(s&&UU.defined(o)){const a=n.get("selections")??[];a.push(o.name),n.set("selections",a,!1),s.hasLegend=!0}}}const WU="_translate_anchor",qU="_translate_delta",Vxe={defined:e=>e.type==="interval"&&e.translate,signals:(e,t,n)=>{const r=t.name,i=os.defined(t),o=r+WU,{x:s,y:a}=t.project.hasChannel;let l=ja(t.translate,"scope");return i||(l=l.map(u=>(u.between[0].markname=r+Ec,u))),n.push({name:o,value:{},on:[{events:l.map(u=>u.between[0]),update:"{x: x(unit), y: y(unit)"+(s!==void 0?`, extent_x: ${i?CS(e,et):`slice(${s.signals.visual})`}`:"")+(a!==void 0?`, extent_y: ${i?CS(e,Bt):`slice(${a.signals.visual})`}`:"")+"}"}]},{name:r+qU,value:{},on:[{events:l,update:`{x: ${o}.x - x(unit), y: ${o}.y - y(unit)}`}]}),s!==void 0&&Y8(e,t,s,"width",n),a!==void 0&&Y8(e,t,a,"height",n),n}};function Y8(e,t,n,r,i){const o=t.name,s=o+WU,a=o+qU,l=n.channel,u=os.defined(t),c=i.find(b=>b.name===n.signals[u?"data":"visual"]),f=e.getSizeSignalRef(r).signal,d=e.getScaleComponent(l),h=d&&d.get("type"),p=d&&d.get("reverse"),g=u?l===et?p?"":"-":p?"-":"":"",y=`${s}.extent_${l}`,m=`${g}${a}.${l} / ${u?`${f}`:`span(${y})`}`,v=!u||!d?"panLinear":h==="log"?"panLog":h==="symlog"?"panSymlog":h==="pow"?"panPow":"panLinear",x=u?h==="pow"?`, ${d.get("exponent")??1}`:h==="symlog"?`, ${d.get("constant")??1}`:"":"",w=`${v}(${y}, ${m}${x})`;c.on.push({events:{signal:a},update:u?w:`clampRange(${w}, 0, ${f})`})}const HU="_zoom_anchor",VU="_zoom_delta",Gxe={defined:e=>e.type==="interval"&&e.zoom,signals:(e,t,n)=>{const r=t.name,i=os.defined(t),o=r+VU,{x:s,y:a}=t.project.hasChannel,l=Y(e.scaleName(et)),u=Y(e.scaleName(Bt));let c=ja(t.zoom,"scope");return i||(c=c.map(f=>(f.markname=r+Ec,f))),n.push({name:r+HU,on:[{events:c,update:i?"{"+[l?`x: invert(${l}, x(unit))`:"",u?`y: invert(${u}, y(unit))`:""].filter(f=>f).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:o,on:[{events:c,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),s!==void 0&&X8(e,t,s,"width",n),a!==void 0&&X8(e,t,a,"height",n),n}};function X8(e,t,n,r,i){const o=t.name,s=n.channel,a=os.defined(t),l=i.find(v=>v.name===n.signals[a?"data":"visual"]),u=e.getSizeSignalRef(r).signal,c=e.getScaleComponent(s),f=c&&c.get("type"),d=a?CS(e,s):l.name,h=o+VU,p=`${o}${HU}.${s}`,g=!a||!c?"zoomLinear":f==="log"?"zoomLog":f==="symlog"?"zoomSymlog":f==="pow"?"zoomPow":"zoomLinear",y=a?f==="pow"?`, ${c.get("exponent")??1}`:f==="symlog"?`, ${c.get("constant")??1}`:"":"",m=`${g}(${d}, ${p}, ${h}${y})`;l.on.push({events:{signal:h},update:a?m:`clampRange(${m}, 0, ${u})`})}const ou="_store",Fa="_tuple",Yxe="_modify",GU="vlSelectionResolve",px=[Fxe,$xe,kxe,BU,jU,os,UU,qxe,Vxe,Gxe,IU];function Xxe(e){let t=e.parent;for(;t&&!br(t);)t=t.parent;return t}function Rl(e,{escape:t}={escape:!0}){let n=t?Y(e.name):e.name;const r=Xxe(e);if(r){const{facet:i}=r;for(const o of jr)i[o]&&(n+=` + '__facet_${o}_' + (facet[${Y(r.vgField(o))}])`)}return n}function DA(e){return Zt(e.component.selection??{}).reduce((t,n)=>t||n.project.hasSelectionId,!1)}function YU(e,t){(ee(t.select)||!t.select.on)&&delete e.events,(ee(t.select)||!t.select.clear)&&delete e.clear,(ee(t.select)||!t.select.toggle)&&delete e.toggle}function $S(e){const t=[];return e.type==="Identifier"?[e.name]:e.type==="Literal"?[e.value]:(e.type==="MemberExpression"&&(t.push(...$S(e.object)),t.push(...$S(e.property))),t)}function XU(e){return e.object.type==="MemberExpression"?XU(e.object):e.object.name==="datum"}function QU(e){const t=e$(e),n=new Set;return t.visit(r=>{r.type==="MemberExpression"&&XU(r)&&n.add($S(r).slice(1).join("."))}),n}class If extends Ie{clone(){return new If(null,this.model,de(this.filter))}constructor(t,n,r){super(t),this.model=n,this.filter=r,this.expr=ry(this.model,this.filter,this),this._dependentFields=QU(this.expr)}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function Qxe(e,t){const n={},r=e.config.selection;if(!t||!t.length)return n;for(const i of t){const o=Je(i.name),s=i.select,a=ee(s)?s:s.type,l=Z(s)?de(s):{type:a},u=r[a];for(const d in u)d==="fields"||d==="encodings"||(d==="mark"&&(l.mark={...u.mark,...l.mark}),(l[d]===void 0||l[d]===!0)&&(l[d]=de(u[d]??l[d])));const c=n[o]={...l,name:o,type:a,init:i.value,bind:i.bind,events:ee(l.on)?ja(l.on,"scope"):J(de(l.on))},f=de(i);for(const d of px)d.defined(c)&&d.parse&&d.parse(e,c,f)}return n}function KU(e,t,n,r="datum"){const i=ee(t)?t:t.param,o=Je(i),s=Y(o+ou);let a;try{a=e.getSelectionComponent(o,i)}catch{return`!!${o}`}if(a.project.timeUnit){const d=n??e.component.data.raw,h=a.project.timeUnit.clone();d.parent?h.insertAsParentOf(d):d.parent=h}const l=a.project.hasSelectionId?"vlSelectionIdTest(":"vlSelectionTest(",u=a.resolve==="global"?")":`, ${Y(a.resolve)})`,c=`${l}${s}, ${r}${u}`,f=`length(data(${s}))`;return t.empty===!1?`${f} && ${c}`:`!${f} || ${c}`}function ZU(e,t,n){const r=Je(t),i=n.encoding;let o=n.field,s;try{s=e.getSelectionComponent(r,t)}catch{return r}if(!i&&!o)o=s.project.items[0].field,s.project.items.length>1&&q(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${Y(o)}.`);else if(i&&!o){const a=s.project.items.filter(l=>l.channel===i);!a.length||a.length>1?(o=s.project.items[0].field,q((a.length?"Multiple ":"No ")+`matching ${Y(i)} encoding found for selection ${Y(n.param)}. Using "field": ${Y(o)}.`)):o=a[0].field}return`${s.name}[${Y(Kr(o))}]`}function Kxe(e,t){for(const[n,r]of ka(e.component.selection??{})){const i=e.getName(`lookup_${n}`);e.component.data.outputNodes[i]=r.materialized=new er(new If(t,e,{param:n}),i,ct.Lookup,e.component.data.outputNodeRefCounts)}}function ry(e,t,n){return vh(t,r=>ee(r)?r:$1e(r)?KU(e,r,n):fB(r))}function Zxe(e,t){if(e)return j(e)&&!zs(e)?e.map(n=>gA(n,t)).join(", "):e}function yw(e,t,n,r){var i,o;e.encode??(e.encode={}),(i=e.encode)[t]??(i[t]={}),(o=e.encode[t]).update??(o.update={}),e.encode[t].update[n]=r}function Yd(e,t,n,r={header:!1}){var f,d;const{disable:i,orient:o,scale:s,labelExpr:a,title:l,zindex:u,...c}=e.combine();if(!i){for(const h in c){const p=h,g=Nye[p],y=c[p];if(g&&g!==t&&g!=="both")delete c[p];else if(lg(y)){const{condition:m,...v}=y,x=J(m),w=E8[p];if(w){const{vgProp:b,part:S}=w,E=[...x.map(_=>{const{test:k,...C}=_;return{test:ry(null,k),...C}}),v];yw(c,S,b,E),delete c[p]}else if(w===null){const b={signal:x.map(S=>{const{test:E,..._}=S;return`${ry(null,E)} ? ${s8(_)} : `}).join("")+s8(v)};c[p]=b}}else if(oe(y)){const m=E8[p];if(m){const{vgProp:v,part:x}=m;yw(c,x,v,y),delete c[p]}}Ee(["labelAlign","labelBaseline"],p)&&c[p]===null&&delete c[p]}if(t==="grid"){if(!c.grid)return;if(c.encode){const{grid:h}=c.encode;c.encode={...h?{grid:h}:{}},Be(c.encode)&&delete c.encode}return{scale:s,orient:o,...c,domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:pt(u,0)}}else{if(!r.header&&e.mainExtracted)return;if(a!==void 0){let p=a;(d=(f=c.encode)==null?void 0:f.labels)!=null&&d.update&&oe(c.encode.labels.update.text)&&(p=Zl(a,"datum.label",c.encode.labels.update.text.signal)),yw(c,"labels","text",{signal:p})}if(c.labelAlign===null&&delete c.labelAlign,c.encode){for(const p of UB)e.hasAxisPart(p)||delete c.encode[p];Be(c.encode)&&delete c.encode}const h=Zxe(l,n);return{scale:s,orient:o,grid:!1,...h?{title:h}:{},...c,...n.aria===!1?{aria:!1}:{},zindex:pt(u,0)}}}}function JU(e){const{axes:t}=e.component,n=[];for(const r of Ss)if(t[r]){for(const i of t[r])if(!i.get("disable")&&!i.get("gridScale")){const o=r==="x"?"height":"width",s=e.getSizeSignalRef(o).signal;o!==s&&n.push({name:o,update:s})}}return n}function Jxe(e,t){const{x:n=[],y:r=[]}=e;return[...n.map(i=>Yd(i,"grid",t)),...r.map(i=>Yd(i,"grid",t)),...n.map(i=>Yd(i,"main",t)),...r.map(i=>Yd(i,"main",t))].filter(i=>i)}function Q8(e,t,n,r){return Object.assign.apply(null,[{},...e.map(i=>{if(i==="axisOrient"){const o=n==="x"?"bottom":"left",s=t[n==="x"?"axisBottom":"axisLeft"]||{},a=t[n==="x"?"axisTop":"axisRight"]||{},l=new Set([...B(s),...B(a)]),u={};for(const c of l.values())u[c]={signal:`${r.signal} === "${o}" ? ${vi(s[c])} : ${vi(a[c])}`};return u}return t[i]})])}function e2e(e,t,n,r){const i=t==="band"?["axisDiscrete","axisBand"]:t==="point"?["axisDiscrete","axisPoint"]:gB(t)?["axisQuantitative"]:t==="time"||t==="utc"?["axisTemporal"]:[],o=e==="x"?"axisX":"axisY",s=oe(n)?"axisOrient":`axis${Kp(n)}`,a=[...i,...i.map(u=>o+u.substr(4))],l=["axis",s,o];return{vlOnlyAxisConfig:Q8(a,r,e,n),vgAxisConfig:Q8(l,r,e,n),axisConfigStyle:t2e([...l,...a],r)}}function t2e(e,t){var r;const n=[{}];for(const i of e){let o=(r=t[i])==null?void 0:r.style;if(o){o=J(o);for(const s of o)n.push(t.style[s])}}return Object.assign.apply(null,n)}function AS(e,t,n,r={}){var o;const i=Wj(e,n,t);if(i!==void 0)return{configFrom:"style",configValue:i};for(const s of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(((o=r[s])==null?void 0:o[e])!==void 0)return{configFrom:s,configValue:r[s][e]};return{}}const K8={scale:({model:e,channel:t})=>e.scaleName(t),format:({format:e})=>e,formatType:({formatType:e})=>e,grid:({fieldOrDatumDef:e,axis:t,scaleType:n})=>t.grid??n2e(n,e),gridScale:({model:e,channel:t})=>r2e(e,t),labelAlign:({axis:e,labelAngle:t,orient:n,channel:r})=>e.labelAlign||tW(t,n,r),labelAngle:({labelAngle:e})=>e,labelBaseline:({axis:e,labelAngle:t,orient:n,channel:r})=>e.labelBaseline||eW(t,n,r),labelFlush:({axis:e,fieldOrDatumDef:t,channel:n})=>e.labelFlush??o2e(t.type,n),labelOverlap:({axis:e,fieldOrDatumDef:t,scaleType:n})=>e.labelOverlap??s2e(t.type,n,H(t)&&!!t.timeUnit,H(t)?t.sort:void 0),orient:({orient:e})=>e,tickCount:({channel:e,model:t,axis:n,fieldOrDatumDef:r,scaleType:i})=>{const o=e==="x"?"width":e==="y"?"height":void 0,s=o?t.getSizeSignalRef(o):void 0;return n.tickCount??l2e({fieldOrDatumDef:r,scaleType:i,size:s,values:n.values})},tickMinStep:u2e,title:({axis:e,model:t,channel:n})=>{if(e.title!==void 0)return e.title;const r=nW(t,n);if(r!==void 0)return r;const i=t.typedFieldDef(n),o=n==="x"?"x2":"y2",s=t.fieldDef(o);return Hj(i?[w8(i)]:[],H(s)?[w8(s)]:[])},values:({axis:e,fieldOrDatumDef:t})=>c2e(e,t),zindex:({axis:e,fieldOrDatumDef:t,mark:n})=>e.zindex??f2e(n,t)};function n2e(e,t){return!It(e)&&H(t)&&!Ve(t==null?void 0:t.bin)&&!qt(t==null?void 0:t.bin)}function r2e(e,t){const n=t==="x"?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)}function i2e(e,t,n,r,i){const o=t==null?void 0:t.labelAngle;if(o!==void 0)return oe(o)?o:up(o);{const{configValue:s}=AS("labelAngle",r,t==null?void 0:t.style,i);return s!==void 0?up(s):n===et&&Ee([rA,nA],e.type)&&!(H(e)&&e.timeUnit)?270:void 0}}function FS(e){return`(((${e.signal} % 360) + 360) % 360)`}function eW(e,t,n,r){if(e!==void 0)if(n==="x"){if(oe(e)){const i=FS(e),o=oe(t)?`(${t.signal} === "top")`:t==="top";return{signal:`(45 < ${i} && ${i} < 135) || (225 < ${i} && ${i} < 315) ? "middle" :(${i} <= 45 || 315 <= ${i}) === ${o} ? "bottom" : "top"`}}if(45<e&&e<135||225<e&&e<315)return"middle";if(oe(t)){const i=e<=45||315<=e?"===":"!==";return{signal:`${t.signal} ${i} "top" ? "bottom" : "top"`}}return(e<=45||315<=e)==(t==="top")?"bottom":"top"}else{if(oe(e)){const i=FS(e),o=oe(t)?`(${t.signal} === "left")`:t==="left";return{signal:`${i} <= 45 || 315 <= ${i} || (135 <= ${i} && ${i} <= 225) ? ${r?'"middle"':"null"} : (45 <= ${i} && ${i} <= 135) === ${o} ? "top" : "bottom"`}}if(e<=45||315<=e||135<=e&&e<=225)return r?"middle":null;if(oe(t)){const i=45<=e&&e<=135?"===":"!==";return{signal:`${t.signal} ${i} "left" ? "top" : "bottom"`}}return(45<=e&&e<=135)==(t==="left")?"top":"bottom"}}function tW(e,t,n){if(e===void 0)return;const r=n==="x",i=r?0:90,o=r?"bottom":"left";if(oe(e)){const s=FS(e),a=oe(t)?`(${t.signal} === "${o}")`:t===o;return{signal:`(${i?`(${s} + 90)`:s} % 180 === 0) ? ${r?null:'"center"'} :(${i} < ${s} && ${s} < ${180+i}) === ${a} ? "left" : "right"`}}if((e+i)%180===0)return r?null:"center";if(oe(t)){const s=i<e&&e<180+i?"===":"!==";return{signal:`${`${t.signal} ${s} "${o}"`} ? "left" : "right"`}}return(i<e&&e<180+i)==(t===o)?"left":"right"}function o2e(e,t){if(t==="x"&&Ee(["quantitative","temporal"],e))return!0}function s2e(e,t,n,r){if(n&&!Z(r)||e!=="nominal"&&e!=="ordinal")return t==="log"||t==="symlog"?"greedy":!0}function a2e(e){return e==="x"?"bottom":"left"}function l2e({fieldOrDatumDef:e,scaleType:t,size:n,values:r}){var i;if(!r&&!It(t)&&t!=="log"){if(H(e)){if(Ve(e.bin))return{signal:`ceil(${n.signal}/10)`};if(e.timeUnit&&Ee(["month","hours","day","quarter"],(i=zt(e.timeUnit))==null?void 0:i.unit))return}return{signal:`ceil(${n.signal}/40)`}}}function u2e({format:e,fieldOrDatumDef:t}){if(e==="d")return 1;if(H(t)){const{timeUnit:n}=t;if(n){const r=lB(n);if(r)return{signal:r}}}}function nW(e,t){const n=t==="x"?"x2":"y2",r=e.fieldDef(t),i=e.fieldDef(n),o=r?r.title:void 0,s=i?i.title:void 0;if(o&&s)return Vj(o,s);if(o)return o;if(s)return s;if(o!==void 0)return o;if(s!==void 0)return s}function c2e(e,t){const n=e.values;if(j(n))return BB(t,n);if(oe(n))return n}function f2e(e,t){return e==="rect"&&Q1(t)?1:0}class cf extends Ie{clone(){return new cf(null,de(this.transform))}constructor(t,n){super(t),this.transform=n,this._dependentFields=QU(this.transform.calculate)}static parseAllForSortIndex(t,n){return n.forEachFieldDef((r,i)=>{if(_u(r)&&TB(r.sort)){const{field:o,timeUnit:s}=r,a=r.sort,l=a.map((u,c)=>`${fB({field:o,timeUnit:s,equal:u})} ? ${c} : `).join("")+a.length;t=new cf(t,{calculate:l,as:ff(r,i,{forAs:!0})})}}),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${_e(this.transform)}`}}function ff(e,t,n){return Q(e,{prefix:t,suffix:"sort_index",...n})}function gx(e,t){return Ee(["top","bottom"],t)?"column":Ee(["left","right"],t)||e==="row"?"row":"column"}function df(e,t,n,r){const i=r==="row"?n.headerRow:r==="column"?n.headerColumn:n.headerFacet;return pt((t||{})[e],i[e],n.header[e])}function mx(e,t,n,r){const i={};for(const o of e){const s=df(o,t||{},n,r);s!==void 0&&(i[o]=s)}return i}const OA=["row","column"],PA=["header","footer"];function d2e(e,t){const n=e.component.layoutHeaders[t].title,r=e.config?e.config:void 0,i=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:o,titleAngle:s,titleOrient:a}=mx(["titleAnchor","titleAngle","titleOrient"],i.header,r,t),l=gx(t,a),u=up(s);return{name:`${t}-title`,type:"group",role:`${l}-title`,title:{text:n,...t==="row"?{orient:"left"}:{},style:"guide-title",...iW(u,l),...rW(l,u,o),...oW(r,i,t,eve,sU)}}}function rW(e,t,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}const r=tW(t,e==="row"?"left":"top",e==="row"?"y":"x");return r?{align:r}:{}}function iW(e,t){const n=eW(e,t==="row"?"left":"top",t==="row"?"y":"x",!0);return n?{baseline:n}:{}}function h2e(e,t){const n=e.component.layoutHeaders[t],r=[];for(const i of PA)if(n[i])for(const o of n[i]){const s=g2e(e,t,i,n,o);s!=null&&r.push(s)}return r}function p2e(e,t){const{sort:n}=e;return is(n)?{field:Q(n,{expr:"datum"}),order:n.order??"ascending"}:j(n)?{field:ff(e,t,{expr:"datum"}),order:"ascending"}:{field:Q(e,{expr:"datum"}),order:n??"ascending"}}function MS(e,t,n){const{format:r,formatType:i,labelAngle:o,labelAnchor:s,labelOrient:a,labelExpr:l}=mx(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e.header,n,t),u=fA({fieldOrDatumDef:e,format:r,formatType:i,expr:"parent",config:n}).signal,c=gx(t,a);return{text:{signal:l?Zl(Zl(l,"datum.label",u),"datum.value",Q(e,{expr:"parent"})):u},...t==="row"?{orient:"left"}:{},style:"guide-label",frame:"group",...iW(o,c),...rW(c,o,s),...oW(n,e,t,tve,aU)}}function g2e(e,t,n,r,i){if(i){let o=null;const{facetFieldDef:s}=r,a=e.config?e.config:void 0;if(s&&i.labels){const{labelOrient:f}=mx(["labelOrient"],s.header,a,t);(t==="row"&&!Ee(["top","bottom"],f)||t==="column"&&!Ee(["left","right"],f))&&(o=MS(s,t,a))}const l=br(e)&&!ig(e.facet),u=i.axes,c=(u==null?void 0:u.length)>0;if(o||c){const f=t==="row"?"height":"width";return{name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`,...r.facetFieldDef?{from:{data:e.getName(`${t}_domain`)},sort:p2e(s,t)}:{},...c&&l?{from:{data:e.getName(`facet_domain_${t}`)}}:{},...o?{title:o}:{},...i.sizeSignal?{encode:{update:{[f]:i.sizeSignal}}}:{},...c?{axes:u}:{}}}}return null}const m2e={column:{start:0,end:1},row:{start:1,end:0}};function y2e(e,t){return m2e[t][e]}function v2e(e,t){const n={};for(const r of jr){const i=e[r];if(i!=null&&i.facetFieldDef){const{titleAnchor:o,titleOrient:s}=mx(["titleAnchor","titleOrient"],i.facetFieldDef.header,t,r),a=gx(r,s),l=y2e(o,a);l!==void 0&&(n[a]=l)}}return Be(n)?void 0:n}function oW(e,t,n,r,i){const o={};for(const s of r){if(!i[s])continue;const a=df(s,t==null?void 0:t.header,e,n);a!==void 0&&(o[i[s]]=a)}return o}function LA(e){return[...a0(e,"width"),...a0(e,"height"),...a0(e,"childWidth"),...a0(e,"childHeight")]}function a0(e,t){const n=t==="width"?"x":"y",r=e.component.layoutSize.get(t);if(!r||r==="merged")return[];const i=e.getSizeSignalRef(t).signal;if(r==="step"){const o=e.getScaleComponent(n);if(o){const s=o.get("type"),a=o.get("range");if(It(s)&&bu(a)){const l=e.scaleName(n);return br(e.parent)&&e.parent.component.resolve.scale[n]==="independent"?[Z8(l,a)]:[Z8(l,a),{name:i,update:sW(l,o,`domain('${l}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}else if(r=="container"){const o=i.endsWith("width"),s=o?"containerSize()[0]":"containerSize()[1]",a=bS(e.config.view,o?"width":"height"),l=`isFinite(${s}) ? ${s} : ${a}`;return[{name:i,init:l,on:[{update:l,events:"window:resize"}]}]}else return[{name:i,value:r}]}function Z8(e,t){const n=`${e}_step`;return oe(t.step)?{name:n,update:t.step.signal}:{name:n,value:t.step}}function sW(e,t,n){const r=t.get("type"),i=t.get("padding"),o=pt(t.get("paddingOuter"),i);let s=t.get("paddingInner");return s=r==="band"?s!==void 0?s:i:1,`bandspace(${n}, ${vi(s)}, ${vi(o)}) * ${e}_step`}function aW(e){return e==="childWidth"?"width":e==="childHeight"?"height":e}function lW(e,t){return B(e).reduce((n,r)=>({...n,...zf({model:t,channelDef:e[r],vgChannel:r,mainRefFn:i=>Xe(i.value),invalidValueRef:void 0})}),{})}function uW(e,t){if(br(t))return e==="theta"?"independent":"shared";if(Uf(t))return"shared";if(qA(t))return gt(e)||e==="theta"||e==="radius"?"independent":"shared";throw new Error("invalid model type for resolve")}function zA(e,t){const n=e.scale[t],r=gt(t)?"axis":"legend";return n==="independent"?(e[r][t]==="shared"&&q(Xme(t)),"independent"):e[r][t]||"shared"}const x2e={...ive,disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1},cW=B(x2e);class w2e extends ks{}const J8={symbols:b2e,gradient:E2e,labels:S2e,entries:_2e};function b2e(e,{fieldOrDatumDef:t,model:n,channel:r,legendCmpt:i,legendType:o}){if(o!=="symbol")return;const{markDef:s,encoding:a,config:l,mark:u}=n,c=s.filled&&u!=="trail";let f={...sme({},n,J1e),...PU(n,{filled:c})};const d=i.get("symbolOpacity")??l.legend.symbolOpacity,h=i.get("symbolFillColor")??l.legend.symbolFillColor,p=i.get("symbolStrokeColor")??l.legend.symbolStrokeColor,g=d===void 0?fW(a.opacity)??s.opacity:void 0;if(f.fill){if(r==="fill"||c&&r===ir)delete f.fill;else if(W(f.fill,"field"))h?delete f.fill:(f.fill=Xe(l.legend.symbolBaseFillColor??"black"),f.fillOpacity=Xe(g??1));else if(j(f.fill)){const y=TS(a.fill??a.color)??s.fill??(c&&s.color);y&&(f.fill=Xe(y))}}if(f.stroke){if(r==="stroke"||!c&&r===ir)delete f.stroke;else if(W(f.stroke,"field")||p)delete f.stroke;else if(j(f.stroke)){const y=pt(TS(a.stroke||a.color),s.stroke,c?s.color:void 0);y&&(f.stroke={value:y})}}if(r!==Es){const y=H(t)&&hW(n,i,t);y?f.opacity=[{test:y,...Xe(g??1)},Xe(l.legend.unselectedOpacity)]:g&&(f.opacity=Xe(g))}return f={...f,...e},Be(f)?void 0:f}function E2e(e,{model:t,legendType:n,legendCmpt:r}){if(n!=="gradient")return;const{config:i,markDef:o,encoding:s}=t;let a={};const u=(r.get("gradientOpacity")??i.legend.gradientOpacity)===void 0?fW(s.opacity)||o.opacity:void 0;return u&&(a.opacity=Xe(u)),a={...a,...e},Be(a)?void 0:a}function S2e(e,{fieldOrDatumDef:t,model:n,channel:r,legendCmpt:i}){const o=n.legend(r)||{},s=n.config,a=H(t)?hW(n,i,t):void 0,l=a?[{test:a,value:1},{value:s.legend.unselectedOpacity}]:void 0,{format:u,formatType:c}=o;let f;ru(c)?f=xi({fieldOrDatumDef:t,field:"datum.value",format:u,formatType:c,config:s}):u===void 0&&c===void 0&&s.customFormatTypes&&(t.type==="quantitative"&&s.numberFormatType?f=xi({fieldOrDatumDef:t,field:"datum.value",format:s.numberFormat,formatType:s.numberFormatType,config:s}):t.type==="temporal"&&s.timeFormatType&&H(t)&&t.timeUnit===void 0&&(f=xi({fieldOrDatumDef:t,field:"datum.value",format:s.timeFormat,formatType:s.timeFormatType,config:s})));const d={...l?{opacity:l}:{},...f?{text:f}:{},...e};return Be(d)?void 0:d}function _2e(e,{legendCmpt:t}){const n=t.get("selections");return n!=null&&n.length?{...e,fill:{value:"transparent"}}:e}function fW(e){return dW(e,(t,n)=>Math.max(t,n.value))}function TS(e){return dW(e,(t,n)=>pt(t,n.value))}function dW(e,t){if(wye(e))return J(e.condition).reduce(t,e.value);if(Fi(e))return e.value}function hW(e,t,n){const r=t.get("selections");if(!(r!=null&&r.length))return;const i=Y(n.field);return r.map(o=>`(!length(data(${Y(Je(o)+ou)})) || (${o}[${i}] && indexof(${o}[${i}], datum.value) >= 0))`).join(" || ")}const eT={direction:({direction:e})=>e,format:({fieldOrDatumDef:e,legend:t,config:n})=>{const{format:r,formatType:i}=t;return AB(e,e.type,r,i,n,!1)},formatType:({legend:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:r}=e;return FB(r,t,n)},gradientLength:e=>{const{legend:t,legendConfig:n}=e;return t.gradientLength??n.gradientLength??T2e(e)},labelOverlap:({legend:e,legendConfig:t,scaleType:n})=>e.labelOverlap??t.labelOverlap??N2e(n),symbolType:({legend:e,markDef:t,channel:n,encoding:r})=>e.symbolType??C2e(t.type,n,r.shape,t.shape),title:({fieldOrDatumDef:e,config:t})=>bc(e,t,{allowDisabling:!0}),type:({legendType:e,scaleType:t,channel:n})=>{if(wc(n)&&to(t)){if(e==="gradient")return}else if(e==="symbol")return;return e},values:({fieldOrDatumDef:e,legend:t})=>k2e(t,e)};function k2e(e,t){const n=e.values;if(j(n))return BB(t,n);if(oe(n))return n}function C2e(e,t,n,r){if(t!=="shape"){const i=TS(n)??r;if(i)return i}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}function $2e(e){const{legend:t}=e;return pt(t.type,A2e(e))}function A2e({channel:e,timeUnit:t,scaleType:n}){if(wc(e)){if(Ee(["quarter","month","day"],t))return"symbol";if(to(n))return"gradient"}return"symbol"}function F2e({legendConfig:e,legendType:t,orient:n,legend:r}){return r.direction??e[t?"gradientDirection":"symbolDirection"]??M2e(n,t)}function M2e(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return t==="gradient"?"horizontal":void 0}}function T2e({legendConfig:e,model:t,direction:n,orient:r,scaleType:i}){const{gradientHorizontalMaxLength:o,gradientHorizontalMinLength:s,gradientVerticalMaxLength:a,gradientVerticalMinLength:l}=e;if(to(i))return n==="horizontal"?r==="top"||r==="bottom"?tT(t,"width",s,o):s:tT(t,"height",l,a)}function tT(e,t,n,r){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${r})`}}function N2e(e){if(Ee(["quantile","threshold","log","symlog"],e))return"greedy"}function pW(e){const t=rt(e)?R2e(e):L2e(e);return e.component.legends=t,t}function R2e(e){const{encoding:t}=e,n={};for(const r of[ir,...uU]){const i=_t(t[r]);!i||!e.getScaleComponent(r)||r===or&&H(i)&&i.type===Lf||(n[r]=P2e(e,r))}return n}function D2e(e,t){const n=e.scaleName(t);if(e.mark==="trail"){if(t==="color")return{stroke:n};if(t==="size")return{strokeWidth:n}}return t==="color"?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n}}function O2e(e,t,n,r){switch(t){case"disable":return n!==void 0;case"values":return!!(n!=null&&n.values);case"title":if(t==="title"&&e===(r==null?void 0:r.title))return!0}return e===(n||{})[t]}function P2e(e,t){var w;let n=e.legend(t);const{markDef:r,encoding:i,config:o}=e,s=o.legend,a=new w2e({},D2e(e,t));Hxe(e,t,a);const l=n!==void 0?!n:s.disable;if(a.set("disable",l,n!==void 0),l)return a;n=n||{};const u=e.getScaleComponent(t).get("type"),c=_t(i[t]),f=H(c)?(w=zt(c.timeUnit))==null?void 0:w.unit:void 0,d=n.orient||o.legend.orient||"right",h=$2e({legend:n,channel:t,timeUnit:f,scaleType:u}),p=F2e({legend:n,legendType:h,orient:d,legendConfig:s}),g={legend:n,channel:t,model:e,markDef:r,encoding:i,fieldOrDatumDef:c,legendConfig:s,config:o,scaleType:u,orient:d,legendType:h,direction:p};for(const b of cW){if(h==="gradient"&&b.startsWith("symbol")||h==="symbol"&&b.startsWith("gradient"))continue;const S=b in eT?eT[b](g):n[b];if(S!==void 0){const E=O2e(S,b,n,e.fieldDef(t));(E||o.legend[b]===void 0)&&a.set(b,S,E)}}const y=(n==null?void 0:n.encoding)??{},m=a.get("selections"),v={},x={fieldOrDatumDef:c,model:e,channel:t,legendCmpt:a,legendType:h};for(const b of["labels","legend","title","symbols","gradient","entries"]){const S=lW(y[b]??{},e),E=b in J8?J8[b](S,x):S;E!==void 0&&!Be(E)&&(v[b]={...m!=null&&m.length&&H(c)?{name:`${Je(c.field)}_legend_${b}`}:{},...m!=null&&m.length?{interactive:!!m}:{},update:E})}return Be(v)||a.set("encode",v,!!(n!=null&&n.encoding)),a}function L2e(e){const{legends:t,resolve:n}=e.component;for(const r of e.children){pW(r);for(const i of B(r.component.legends))n.legend[i]=zA(e.component.resolve,i),n.legend[i]==="shared"&&(t[i]=gW(t[i],r.component.legends[i]),t[i]||(n.legend[i]="independent",delete t[i]))}for(const r of B(t))for(const i of e.children)i.component.legends[r]&&n.legend[r]==="shared"&&delete i.component.legends[r];return t}function gW(e,t){var o,s,a,l;if(!e)return t.clone();const n=e.getWithExplicit("orient"),r=t.getWithExplicit("orient");if(n.explicit&&r.explicit&&n.value!==r.value)return;let i=!1;for(const u of cW){const c=Aa(e.getWithExplicit(u),t.getWithExplicit(u),u,"legend",(f,d)=>{switch(u){case"symbolType":return z2e(f,d);case"title":return Gj(f,d);case"type":return i=!0,ur("symbol")}return cx(f,d,u,"legend")});e.setWithExplicit(u,c)}return i&&((s=(o=e.implicit)==null?void 0:o.encode)!=null&&s.gradient&&H1(e.implicit,["encode","gradient"]),(l=(a=e.explicit)==null?void 0:a.encode)!=null&&l.gradient&&H1(e.explicit,["encode","gradient"])),e}function z2e(e,t){return t.value==="circle"?t:e}function I2e(e,t,n,r){var i,o;e.encode??(e.encode={}),(i=e.encode)[t]??(i[t]={}),(o=e.encode[t]).update??(o.update={}),e.encode[t].update[n]=r}function mW(e){const t=e.component.legends,n={};for(const i of B(t)){const o=e.getScaleComponent(i),s=Ue(o.get("domains"));if(n[s])for(const a of n[s])gW(a,t[i])||n[s].push(t[i]);else n[s]=[t[i].clone()]}return Zt(n).flat().map(i=>j2e(i,e.config)).filter(i=>i!==void 0)}function j2e(e,t){var s,a,l;const{disable:n,labelExpr:r,selections:i,...o}=e.combine();if(!n){if(t.aria===!1&&o.aria==null&&(o.aria=!1),(s=o.encode)!=null&&s.symbols){const u=o.encode.symbols.update;u.fill&&u.fill.value!=="transparent"&&!u.stroke&&!o.stroke&&(u.stroke={value:"transparent"});for(const c of uU)o[c]&&delete u[c]}if(o.title||delete o.title,r!==void 0){let u=r;(l=(a=o.encode)==null?void 0:a.labels)!=null&&l.update&&oe(o.encode.labels.update.text)&&(u=Zl(r,"datum.label",o.encode.labels.update.text.signal)),I2e(o,"labels","text",{signal:u})}return o}}function B2e(e){return Uf(e)||qA(e)?U2e(e):yW(e)}function U2e(e){return e.children.reduce((t,n)=>t.concat(n.assembleProjections()),yW(e))}function yW(e){const t=e.component.projection;if(!t||t.merged)return[];const n=t.combine(),{name:r}=n;if(t.data){const i={signal:`[${t.size.map(s=>s.signal).join(", ")}]`},o=t.data.reduce((s,a)=>{const l=oe(a)?a.signal:`data('${e.lookupDataSource(a)}')`;return Ee(s,l)||s.push(l),s},[]);if(o.length<=0)throw new Error("Projection's fit didn't find any data sources");return[{name:r,size:i,fit:{signal:o.length>1?`[${o.join(", ")}]`:o[0]},...n}]}else return[{name:r,translate:{signal:"[width / 2, height / 2]"},...n}]}const W2e=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class vW extends ks{constructor(t,n,r,i){super({...n},{name:t}),this.specifiedProjection=n,this.size=r,this.data=i,this.merged=!1}get isFit(){return!!this.data}}function xW(e){e.component.projection=rt(e)?q2e(e):G2e(e)}function q2e(e){if(e.hasProjection){const t=Ht(e.specifiedProjection),n=!(t&&(t.scale!=null||t.translate!=null)),r=n?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,i=n?H2e(e):void 0,o=new vW(e.projectionName(!0),{...Ht(e.config.projection),...t},r,i);return o.get("type")||o.set("type","equalEarth",!1),o}}function H2e(e){const t=[],{encoding:n}=e;for(const r of[[zi,Li],[Zr,Ii]])(_t(n[r[0]])||_t(n[r[1]]))&&t.push({signal:e.getName(`geojson_${t.length}`)});return e.channelHasField(or)&&e.typedFieldDef(or).type===Lf&&t.push({signal:e.getName(`geojson_${t.length}`)}),t.length===0&&t.push(e.requestDataName(ct.Main)),t}function V2e(e,t){const n=T$(W2e,i=>!!(!te(e.explicit,i)&&!te(t.explicit,i)||te(e.explicit,i)&&te(t.explicit,i)&&yr(e.get(i),t.get(i))));if(yr(e.size,t.size)){if(n)return e;if(yr(e.explicit,{}))return t;if(yr(t.explicit,{}))return e}return null}function G2e(e){if(e.children.length===0)return;let t;for(const r of e.children)xW(r);const n=T$(e.children,r=>{const i=r.component.projection;if(i)if(t){const o=V2e(t,i);return o&&(t=o),!!o}else return t=i,!0;else return!0});if(t&&n){const r=e.projectionName(!0),i=new vW(r,t.specifiedProjection,t.size,de(t.data));for(const o of e.children){const s=o.component.projection;s&&(s.isFit&&i.data.push(...o.component.projection.data),o.renameProjection(s.get("name"),r),s.merged=!0)}return i}}function Y2e(e,t,n,r){if(ag(t,n)){const i=rt(e)?e.axis(n)??e.legend(n)??{}:{},o=Q(t,{expr:"datum"}),s=Q(t,{expr:"datum",binSuffix:"end"});return{formulaAs:Q(t,{binSuffix:"range",forAs:!0}),formula:rg(o,s,i.format,i.formatType,r)}}return{}}function wW(e,t){return`${Ij(e)}_${t}`}function X2e(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)}}function IA(e,t,n){const r=ix(n,void 0)??{},i=wW(r,t);return e.getName(`${i}_bins`)}function Q2e(e){return"as"in e}function nT(e,t,n){let r,i;Q2e(e)?r=ee(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:r=[Q(e,{forAs:!0}),Q(e,{binSuffix:"end",forAs:!0})];const o={...ix(t,void 0)},s=wW(o,e.field),{signal:a,extentSignal:l}=X2e(n,s);if(Gv(o.extent)){const c=o.extent;i=ZU(n,c.param,c),delete o.extent}const u={bin:o,field:e.field,as:[r],...a?{signal:a}:{},...l?{extentSignal:l}:{},...i?{span:i}:{}};return{key:s,binComponent:u}}class lo extends Ie{clone(){return new lo(null,de(this.bins))}constructor(t,n){super(t),this.bins=n}static makeFromEncoding(t,n){const r=n.reduceFieldDef((i,o,s)=>{if(zn(o)&&Ve(o.bin)){const{key:a,binComponent:l}=nT(o,o.bin,n);i[a]={...l,...i[a],...Y2e(n,o,s,n.config)}}return i},{});return Be(r)?null:new lo(t,r)}static makeFromTransform(t,n,r){const{key:i,binComponent:o}=nT(n,n.bin,r);return new lo(t,{[i]:o})}merge(t,n){for(const r of B(t.bins))r in this.bins?(n(t.bins[r].signal,this.bins[r].signal),this.bins[r].as=eo([...this.bins[r].as,...t.bins[r].as],_e)):this.bins[r]=t.bins[r];for(const r of t.children)t.removeChild(r),r.parent=this;t.remove()}producedFields(){return new Set(Zt(this.bins).map(t=>t.as).flat(2))}dependentFields(){return new Set(Zt(this.bins).map(t=>t.field))}hash(){return`Bin ${_e(this.bins)}`}assemble(){return Zt(this.bins).flatMap(t=>{const n=[],[r,...i]=t.as,{extent:o,...s}=t.bin,a={type:"bin",field:Kr(t.field),as:r,signal:t.signal,...Gv(o)?{extent:null}:{extent:o},...t.span?{span:{signal:`span(${t.span})`}}:{},...s};!o&&t.extentSignal&&(n.push({type:"extent",field:Kr(t.field),signal:t.extentSignal}),a.extent={signal:t.extentSignal}),n.push(a);for(const l of i)for(let u=0;u<2;u++)n.push({type:"formula",expr:Q({field:r[u]},{expr:"datum"}),as:l[u]});return t.formula&&n.push({type:"formula",expr:t.formula,as:t.formulaAs}),n})}}function K2e(e,t,n,r){var o;const i=rt(r)?r.encoding[Mo(t)]:void 0;if(zn(n)&&rt(r)&&RB(n,i,r.markDef,r.config)){e.add(Q(n,{})),e.add(Q(n,{suffix:"end"}));const{mark:s,markDef:a,config:l}=r,u=$a({fieldDef:n,markDef:a,config:l});cp(s)&&u!==.5&&gt(t)&&(e.add(Q(n,{suffix:fx})),e.add(Q(n,{suffix:dx}))),n.bin&&ag(n,t)&&e.add(Q(n,{binSuffix:"range"}))}else if(Mj(t)){const s=Fj(t);e.add(r.getName(s))}else e.add(Q(n));return _u(n)&&j1e((o=n.scale)==null?void 0:o.range)&&e.add(n.scale.range.field),e}function Z2e(e,t){for(const n of B(t)){const r=t[n];for(const i of B(r))n in e?e[n][i]=new Set([...e[n][i]??[],...r[i]]):e[n]={[i]:r[i]}}}class Si extends Ie{clone(){return new Si(null,new Set(this.dimensions),de(this.measures))}constructor(t,n,r){super(t),this.dimensions=n,this.measures=r}get groupBy(){return this.dimensions}static makeFromEncoding(t,n){let r=!1;n.forEachFieldDef(s=>{s.aggregate&&(r=!0)});const i={},o=new Set;return!r||(n.forEachFieldDef((s,a)=>{const{aggregate:l,field:u}=s;if(l)if(l==="count")i["*"]??(i["*"]={}),i["*"].count=new Set([Q(s,{forAs:!0})]);else{if(ps(l)||Va(l)){const c=ps(l)?"argmin":"argmax",f=l[c];i[f]??(i[f]={}),i[f][c]=new Set([Q({op:c,field:f},{forAs:!0})])}else i[u]??(i[u]={}),i[u][l]=new Set([Q(s,{forAs:!0})]);To(a)&&n.scaleDomain(a)==="unaggregated"&&(i[u]??(i[u]={}),i[u].min=new Set([Q({field:u,aggregate:"min"},{forAs:!0})]),i[u].max=new Set([Q({field:u,aggregate:"max"},{forAs:!0})]))}else K2e(o,a,s,n)}),o.size+B(i).length===0)?null:new Si(t,o,i)}static makeFromTransform(t,n){var r;const i=new Set,o={};for(const s of n.aggregate){const{op:a,field:l,as:u}=s;a&&(a==="count"?(o["*"]??(o["*"]={}),o["*"].count=new Set([u||Q(s,{forAs:!0})])):(o[l]??(o[l]={}),(r=o[l])[a]??(r[a]=new Set),o[l][a].add(u||Q(s,{forAs:!0}))))}for(const s of n.groupby??[])i.add(s);return i.size+B(o).length===0?null:new Si(t,i,o)}merge(t){return bj(this.dimensions,t.dimensions)?(Z2e(this.measures,t.measures),!0):(f1e("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...B(this.measures)])}producedFields(){const t=new Set;for(const n of B(this.measures))for(const r of B(this.measures[n])){const i=this.measures[n][r];i.size===0?t.add(`${r}_${n}`):i.forEach(t.add,t)}return t}hash(){return`Aggregate ${_e({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const t=[],n=[],r=[];for(const o of B(this.measures))for(const s of B(this.measures[o]))for(const a of this.measures[o][s])r.push(a),t.push(s),n.push(o==="*"?null:Kr(o));return{type:"aggregate",groupby:[...this.dimensions].map(Kr),ops:t,fields:n,as:r}}}class jf extends Ie{constructor(t,n,r,i){super(t),this.model=n,this.name=r,this.data=i;for(const o of jr){const s=n.facet[o];if(s){const{bin:a,sort:l}=s;this[o]={name:n.getName(`${o}_domain`),fields:[Q(s),...Ve(a)?[Q(s,{binSuffix:"end"})]:[]],...is(l)?{sortField:l}:j(l)?{sortIndexField:ff(s,o)}:{}}}}this.childModel=n.child}hash(){let t="Facet";for(const n of jr)this[n]&&(t+=` ${n.charAt(0)}:${_e(this[n])}`);return t}get fields(){var n;const t=[];for(const r of jr)(n=this[r])!=null&&n.fields&&t.push(...this[r].fields);return t}dependentFields(){const t=new Set(this.fields);for(const n of jr)this[n]&&(this[n].sortField&&t.add(this[n].sortField.field),this[n].sortIndexField&&t.add(this[n].sortIndexField));return t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const t={};for(const n of Ss){const r=this.childModel.component.scales[n];if(r&&!r.merged){const i=r.get("type"),o=r.get("range");if(It(i)&&bu(o)){const s=yx(this.childModel,n),a=WA(s);a?t[n]=a:q(H$(n))}}}return t}assembleRowColumnHeaderData(t,n,r){const i={row:"y",column:"x",facet:void 0}[t],o=[],s=[],a=[];i&&r&&r[i]&&(n?(o.push(`distinct_${r[i]}`),s.push("max")):(o.push(r[i]),s.push("distinct")),a.push(`distinct_${r[i]}`));const{sortField:l,sortIndexField:u}=this[t];if(l){const{op:c=tx,field:f}=l;o.push(f),s.push(c),a.push(Q(l,{forAs:!0}))}else u&&(o.push(u),s.push("max"),a.push(u));return{name:this[t].name,source:n??this.data,transform:[{type:"aggregate",groupby:this[t].fields,...o.length?{fields:o,ops:s,as:a}:{}}]}}assembleFacetHeaderData(t){var l;const{columns:n}=this.model.layout,{layoutHeaders:r}=this.model.component,i=[],o={};for(const u of OA){for(const c of PA){const f=(r[u]&&r[u][c])??[];for(const d of f)if(((l=d.axes)==null?void 0:l.length)>0){o[u]=!0;break}}if(o[u]){const c=`length(data("${this.facet.name}"))`,f=u==="row"?n?{signal:`ceil(${c} / ${n})`}:1:n?{signal:`min(${c}, ${n})`}:{signal:c};i.push({name:`${this.facet.name}_${u}`,transform:[{type:"sequence",start:0,stop:f}]})}}const{row:s,column:a}=o;return(s||a)&&i.unshift(this.assembleRowColumnHeaderData("facet",null,t)),i}assemble(){const t=[];let n=null;const r=this.getChildIndependentFieldsWithStep(),{column:i,row:o,facet:s}=this;if(i&&o&&(r.x||r.y)){n=`cross_${this.column.name}_${this.row.name}`;const a=[].concat(r.x??[],r.y??[]),l=a.map(()=>"distinct");t.push({name:n,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:a,ops:l}]})}for(const a of[rs,ns])this[a]&&t.push(this.assembleRowColumnHeaderData(a,n,r));if(s){const a=this.assembleFacetHeaderData(r);a&&t.push(...a)}return t}}function rT(e){return e.startsWith("'")&&e.endsWith("'")||e.startsWith('"')&&e.endsWith('"')?e.slice(1,-1):e}function J2e(e,t){const n=D$(e);if(t==="number")return`toNumber(${n})`;if(t==="boolean")return`toBoolean(${n})`;if(t==="string")return`toString(${n})`;if(t==="date")return`toDate(${n})`;if(t==="flatten")return n;if(t.startsWith("date:")){const r=rT(t.slice(5,t.length));return`timeParse(${n},'${r}')`}else if(t.startsWith("utc:")){const r=rT(t.slice(4,t.length));return`utcParse(${n},'${r}')`}else return q(wme(t)),null}function ewe(e){const t={};return tm(e.filter,n=>{if(cB(n)){let r=null;X$(n)?r=hr(n.equal):K$(n)?r=hr(n.lte):Q$(n)?r=hr(n.lt):Z$(n)?r=hr(n.gt):J$(n)?r=hr(n.gte):eA(n)?r=n.range[0]:tA(n)&&(r=(n.oneOf??n.in)[0]),r&&(Eu(r)?t[n.field]="date":Me(r)?t[n.field]="number":ee(r)&&(t[n.field]="string")),n.timeUnit&&(t[n.field]="date")}}),t}function twe(e){const t={};function n(r){af(r)?t[r.field]="date":r.type==="quantitative"&&K0e(r.aggregate)?t[r.field]="number":Jc(r.field)>1?r.field in t||(t[r.field]="flatten"):_u(r)&&is(r.sort)&&Jc(r.sort.field)>1&&(r.sort.field in t||(t[r.sort.field]="flatten"))}if((rt(e)||br(e))&&e.forEachFieldDef((r,i)=>{if(zn(r))n(r);else{const o=xu(i),s=e.fieldDef(o);n({...r,type:s.type})}}),rt(e)){const{mark:r,markDef:i,encoding:o}=e;if(Ga(r)&&!e.encoding.order){const s=i.orient==="horizontal"?"y":"x",a=o[s];H(a)&&a.type==="quantitative"&&!(a.field in t)&&(t[a.field]="number")}}return t}function nwe(e){const t={};if(rt(e)&&e.component.selection)for(const n of B(e.component.selection)){const r=e.component.selection[n];for(const i of r.project.items)!i.channel&&Jc(i.field)>1&&(t[i.field]="flatten")}return t}class pn extends Ie{clone(){return new pn(null,de(this._parse))}constructor(t,n){super(t),this._parse=n}hash(){return`Parse ${_e(this._parse)}`}static makeExplicit(t,n,r){var s;let i={};const o=n.data;return!da(o)&&((s=o==null?void 0:o.format)!=null&&s.parse)&&(i=o.format.parse),this.makeWithAncestors(t,i,{},r)}static makeWithAncestors(t,n,r,i){for(const a of B(r)){const l=i.getWithExplicit(a);l.value!==void 0&&(l.explicit||l.value===r[a]||l.value==="derived"||r[a]==="flatten"?delete r[a]:q(d8(a,r[a],l.value)))}for(const a of B(n)){const l=i.get(a);l!==void 0&&(l===n[a]?delete n[a]:q(d8(a,n[a],l)))}const o=new ks(n,r);i.copyAll(o);const s={};for(const a of B(o.combine())){const l=o.get(a);l!==null&&(s[a]=l)}return B(s).length===0||i.parseNothing?null:new pn(t,s)}get parse(){return this._parse}merge(t){this._parse={...this._parse,...t.parse},t.remove()}assembleFormatParse(){const t={};for(const n of B(this._parse)){const r=this._parse[n];Jc(n)===1&&(t[n]=r)}return t}producedFields(){return new Set(B(this._parse))}dependentFields(){return new Set(B(this._parse))}assembleTransforms(t=!1){return B(this._parse).filter(n=>t?Jc(n)>1:!0).map(n=>{const r=J2e(n,this._parse[n]);return r?{type:"formula",expr:r,as:Of(n)}:null}).filter(n=>n!==null)}}class Ma extends Ie{clone(){return new Ma(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set([Ti])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:Ti}}}class cg extends Ie{clone(){return new cg(null,this.params)}constructor(t,n){super(t),this.params=n}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${_e(this.params)}`}assemble(){return{type:"graticule",...this.params===!0?{}:this.params}}}class fg extends Ie{clone(){return new fg(null,this.params)}constructor(t,n){super(t),this.params=n}dependentFields(){return new Set}producedFields(){return new Set([this.params.as??"data"])}hash(){return`Hash ${_e(this.params)}`}assemble(){return{type:"sequence",...this.params}}}class su extends Ie{constructor(t){super(null),t??(t={name:"source"});let n;if(da(t)||(n=t.format?{...Jn(t.format,["parse"])}:{}),fp(t))this._data={values:t.values};else if(lf(t)){if(this._data={url:t.url},!n.type){let r=/(?:\.([^.]+))?$/.exec(t.url)[1];Ee(["json","csv","tsv","dsv","topojson"],r)||(r="json"),n.type=r}}else $U(t)?this._data={values:[{type:"Sphere"}]}:(kU(t)||da(t))&&(this._data={});this._generator=da(t),t.name&&(this._name=t.name),n&&!Be(n)&&(this._data.format=n)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return{name:this._name,...this._data,transform:[]}}}var iT=function(e,t,n,r,i){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?i.call(e,n):i?i.value=n:t.set(e,n),n},rwe=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},Xd;function jA(e){return e instanceof su||e instanceof cg||e instanceof fg}class BA{constructor(){Xd.set(this,void 0),iT(this,Xd,!1,"f")}setModified(){iT(this,Xd,!0,"f")}get modifiedFlag(){return rwe(this,Xd,"f")}}Xd=new WeakMap;class ku extends BA{getNodeDepths(t,n,r){r.set(t,n);for(const i of t.children)this.getNodeDepths(i,n+1,r);return r}optimize(t){const r=[...this.getNodeDepths(t,0,new Map).entries()].sort((i,o)=>o[1]-i[1]);for(const i of r)this.run(i[0]);return this.modifiedFlag}}class UA extends BA{optimize(t){this.run(t);for(const n of t.children)this.optimize(n);return this.modifiedFlag}}class iwe extends UA{mergeNodes(t,n){const r=n.shift();for(const i of n)t.removeChild(i),i.parent=r,i.remove()}run(t){const n=t.children.map(i=>i.hash()),r={};for(let i=0;i<n.length;i++)r[n[i]]===void 0?r[n[i]]=[t.children[i]]:r[n[i]].push(t.children[i]);for(const i of B(r))r[i].length>1&&(this.setModified(),this.mergeNodes(t,r[i]))}}class owe extends UA{constructor(t){super(),this.requiresSelectionId=t&&DA(t)}run(t){t instanceof Ma&&(this.requiresSelectionId&&(jA(t.parent)||t.parent instanceof Si||t.parent instanceof pn)||(this.setModified(),t.remove()))}}class swe extends BA{optimize(t){return this.run(t,new Set),this.modifiedFlag}run(t,n){let r=new Set;t instanceof ao&&(r=t.producedFields(),N$(r,n)&&(this.setModified(),t.removeFormulas(n),t.producedFields.length===0&&t.remove()));for(const i of t.children)this.run(i,new Set([...n,...r]))}}class awe extends UA{constructor(){super()}run(t){t instanceof er&&!t.isRequired()&&(this.setModified(),t.remove())}}class lwe extends ku{run(t){if(!jA(t)&&!(t.numChildren()>1)){for(const n of t.children)if(n instanceof pn)if(t instanceof pn)this.setModified(),t.merge(n);else{if(R$(t.producedFields(),n.dependentFields()))continue;this.setModified(),n.swapWithParent()}}}}class uwe extends ku{run(t){const n=[...t.children],r=t.children.filter(i=>i instanceof pn);if(t.numChildren()>1&&r.length>=1){const i={},o=new Set;for(const s of r){const a=s.parse;for(const l of B(a))l in i?i[l]!==a[l]&&o.add(l):i[l]=a[l]}for(const s of o)delete i[s];if(!Be(i)){this.setModified();const s=new pn(t,i);for(const a of n){if(a instanceof pn)for(const l of B(i))delete a.parse[l];t.removeChild(a),a.parent=s,a instanceof pn&&B(a.parse).length===0&&a.remove()}}}}}class cwe extends ku{run(t){t instanceof er||t.numChildren()>0||t instanceof jf||t instanceof su||(this.setModified(),t.remove())}}class fwe extends ku{run(t){const n=t.children.filter(i=>i instanceof ao),r=n.pop();for(const i of n)this.setModified(),r.merge(i)}}class dwe extends ku{run(t){const n=t.children.filter(i=>i instanceof Si),r={};for(const i of n){const o=_e(i.groupBy);o in r||(r[o]=[]),r[o].push(i)}for(const i of B(r)){const o=r[i];if(o.length>1){const s=o.pop();for(const a of o)s.merge(a)&&(t.removeChild(a),a.parent=s,a.remove(),this.setModified())}}}}class hwe extends ku{constructor(t){super(),this.model=t}run(t){const n=!(jA(t)||t instanceof If||t instanceof pn||t instanceof Ma),r=[],i=[];for(const o of t.children)o instanceof lo&&(n&&!R$(t.producedFields(),o.dependentFields())?r.push(o):i.push(o));if(r.length>0){const o=r.pop();for(const s of r)o.merge(s,this.model.renameSignal.bind(this.model));this.setModified(),t instanceof lo?t.merge(o,this.model.renameSignal.bind(this.model)):o.swapWithParent()}if(i.length>1){const o=i.pop();for(const s of i)o.merge(s,this.model.renameSignal.bind(this.model));this.setModified()}}}class pwe extends ku{run(t){const n=[...t.children];if(!Zc(n,s=>s instanceof er)||t.numChildren()<=1)return;const i=[];let o;for(const s of n)if(s instanceof er){let a=s;for(;a.numChildren()===1;){const[l]=a.children;if(l instanceof er)a=l;else break}i.push(...a.children),o?(t.removeChild(s),s.parent=o.parent,o.parent.removeChild(o),o.parent=a,this.setModified()):o=a}else i.push(s);if(i.length){this.setModified();for(const s of i)s.parent.removeChild(s),s.parent=o}}}class Cu extends Ie{clone(){return new Cu(null,de(this.transform))}constructor(t,n){super(t),this.transform=n}addDimensions(t){this.transform.groupby=eo(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t.add,t),this.transform.joinaggregate.map(n=>n.field).filter(n=>n!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(t){return t.as??Q(t)}hash(){return`JoinAggregateTransform ${_e(this.transform)}`}assemble(){const t=[],n=[],r=[];for(const o of this.transform.joinaggregate)n.push(o.op),r.push(this.getDefaultName(o)),t.push(o.field===void 0?null:o.field);const i=this.transform.groupby;return{type:"joinaggregate",as:r,ops:n,fields:t,...i!==void 0?{groupby:i}:{}}}}class hf extends Ie{clone(){return new hf(null,{...this.filter})}constructor(t,n){super(t),this.filter=n}static make(t,n,r){const{config:i,markDef:o}=n,{marks:s,scales:a}=r;if(s==="include-invalid-values"&&a==="include-invalid-values")return null;const l=n.reduceFieldDef((u,c,f)=>{const d=To(f)&&n.getScaleComponent(f);if(d){const h=d.get("type"),{aggregate:p}=c,g=lA({scaleChannel:f,markDef:o,config:i,scaleType:h,isCountAggregate:Vv(p)});g!=="show"&&g!=="always-valid"&&(u[c.field]=c)}return u},{});return B(l).length?new hf(t,l):null}dependentFields(){return new Set(B(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${_e(this.filter)}`}assemble(){const t=B(this.filter).reduce((n,r)=>{const i=this.filter[r],o=Q(i,{expr:"datum"});return i!==null&&(i.type==="temporal"?n.push(`(isDate(${o}) || (${NS(o)}))`):i.type==="quantitative"&&n.push(NS(o))),n},[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}function NS(e){return`isValid(${e}) && isFinite(+${e})`}function gwe(e){return e.stack.stackBy.reduce((t,n)=>{const r=n.fieldDef,i=Q(r);return i&&t.push(i),t},[])}function mwe(e){return j(e)&&e.every(t=>ee(t))&&e.length>1}class ss extends Ie{clone(){return new ss(null,de(this._stack))}constructor(t,n){super(t),this._stack=n}static makeFromTransform(t,n){const{stack:r,groupby:i,as:o,offset:s="zero"}=n,a=[],l=[];if(n.sort!==void 0)for(const f of n.sort)a.push(f.field),l.push(pt(f.order,"ascending"));const u={field:a,order:l};let c;return mwe(o)?c=o:ee(o)?c=[o,`${o}_end`]:c=[`${n.stack}_start`,`${n.stack}_end`],new ss(t,{dimensionFieldDefs:[],stackField:r,groupby:i,offset:s,sort:u,facetby:[],as:c})}static makeFromEncoding(t,n){const r=n.stack,{encoding:i}=n;if(!r)return null;const{groupbyChannels:o,fieldChannel:s,offset:a,impute:l}=r,u=o.map(h=>{const p=i[h];return Mi(p)}).filter(h=>!!h),c=gwe(n),f=n.encoding.order;let d;if(j(f)||H(f))d=qj(f);else{const h=DB(f)?f.sort:s==="y"?"descending":"ascending";d=c.reduce((p,g)=>(p.field.includes(g)||(p.field.push(g),p.order.push(h)),p),{field:[],order:[]})}return new ss(t,{dimensionFieldDefs:u,stackField:n.vgField(s),facetby:[],stackby:c,sort:d,offset:a,impute:l,as:[n.vgField(s,{suffix:"start",forAs:!0}),n.vgField(s,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby.push(...t)}dependentFields(){const t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(t.add,t),this._stack.facetby.forEach(t.add,t),this._stack.sort.field.forEach(t.add,t),t}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${_e(this._stack)}`}getGroupbyFields(){const{dimensionFieldDefs:t,impute:n,groupby:r}=this._stack;return t.length>0?t.map(i=>i.bin?n?[Q(i,{binSuffix:"mid"})]:[Q(i,{}),Q(i,{binSuffix:"end"})]:[Q(i)]).flat():r??[]}assemble(){const t=[],{facetby:n,dimensionFieldDefs:r,stackField:i,stackby:o,sort:s,offset:a,impute:l,as:u}=this._stack;if(l)for(const c of r){const{bandPosition:f=.5,bin:d}=c;if(d){const h=Q(c,{expr:"datum"}),p=Q(c,{expr:"datum",binSuffix:"end"});t.push({type:"formula",expr:`${NS(h)} ? ${f}*${h}+${1-f}*${p} : ${h}`,as:Q(c,{binSuffix:"mid",forAs:!0})})}t.push({type:"impute",field:i,groupby:[...o,...n],key:Q(c,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[...this.getGroupbyFields(),...n],field:i,sort:s,as:u,offset:a}),t}}class Bf extends Ie{clone(){return new Bf(null,de(this.transform))}constructor(t,n){super(t),this.transform=n}addDimensions(t){this.transform.groupby=eo(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return(this.transform.groupby??[]).forEach(t.add,t),(this.transform.sort??[]).forEach(n=>t.add(n.field)),this.transform.window.map(n=>n.field).filter(n=>n!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){return t.as??Q(t)}hash(){return`WindowTransform ${_e(this.transform)}`}assemble(){const t=[],n=[],r=[],i=[];for(const f of this.transform.window)n.push(f.op),r.push(this.getDefaultName(f)),i.push(f.param===void 0?null:f.param),t.push(f.field===void 0?null:f.field);const o=this.transform.frame,s=this.transform.groupby;if(o&&o[0]===null&&o[1]===null&&n.every(f=>W$(f)))return{type:"joinaggregate",as:r,ops:n,fields:t,...s!==void 0?{groupby:s}:{}};const a=[],l=[];if(this.transform.sort!==void 0)for(const f of this.transform.sort)a.push(f.field),l.push(f.order??"ascending");const u={field:a,order:l},c=this.transform.ignorePeers;return{type:"window",params:i,as:r,ops:n,fields:t,sort:u,...c!==void 0?{ignorePeers:c}:{},...s!==void 0?{groupby:s}:{},...o!==void 0?{frame:o}:{}}}}function ywe(e){function t(n){if(!(n instanceof jf)){const r=n.clone();if(r instanceof er){const i=DS+r.getSource();r.setSource(i),e.model.component.data.outputNodes[i]=r}else(r instanceof Si||r instanceof ss||r instanceof Bf||r instanceof Cu)&&r.addDimensions(e.fields);for(const i of n.children.flatMap(t))i.parent=r;return[r]}return n.children.flatMap(t)}return t}function RS(e){if(e instanceof jf)if(e.numChildren()===1&&!(e.children[0]instanceof er)){const t=e.children[0];(t instanceof Si||t instanceof ss||t instanceof Bf||t instanceof Cu)&&t.addDimensions(e.fields),t.swapWithParent(),RS(e)}else{const t=e.model.component.data.main;bW(t);const n=ywe(e),r=e.children.map(n).flat();for(const i of r)i.parent=t}else e.children.map(RS)}function bW(e){if(e instanceof er&&e.type===ct.Main&&e.numChildren()===1){const t=e.children[0];t instanceof jf||(t.swapWithParent(),bW(e))}}const DS="scale_",l0=5;function OS(e){for(const t of e){for(const n of t.children)if(n.parent!==t)return!1;if(!OS(t.children))return!1}return!0}function ri(e,t){let n=!1;for(const r of t)n=e.optimize(r)||n;return n}function oT(e,t,n){let r=e.sources,i=!1;return i=ri(new awe,r)||i,i=ri(new owe(t),r)||i,r=r.filter(o=>o.numChildren()>0),i=ri(new cwe,r)||i,r=r.filter(o=>o.numChildren()>0),n||(i=ri(new lwe,r)||i,i=ri(new hwe(t),r)||i,i=ri(new swe,r)||i,i=ri(new uwe,r)||i,i=ri(new dwe,r)||i,i=ri(new fwe,r)||i,i=ri(new iwe,r)||i,i=ri(new pwe,r)||i),e.sources=r,i}function vwe(e,t){OS(e.sources);let n=0,r=0;for(let i=0;i<l0&&oT(e,t,!0);i++)n++;e.sources.map(RS);for(let i=0;i<l0&&oT(e,t,!1);i++)r++;OS(e.sources),Math.max(n,r)===l0&&q(`Maximum optimization runs(${l0}) reached.`)}class Tt{constructor(t){Object.defineProperty(this,"signal",{enumerable:!0,get:t})}static fromName(t,n){return new Tt(()=>t(n))}}function EW(e){rt(e)?xwe(e):wwe(e)}function xwe(e){const t=e.component.scales;for(const n of B(t)){const r=Ewe(e,n);if(t[n].setWithExplicit("domains",r),_we(e,n),e.component.data.isFaceted){let o=e;for(;!br(o)&&o.parent;)o=o.parent;if(o.component.resolve.scale[n]==="shared")for(const a of r.value)Ko(a)&&(a.data=DS+a.data.replace(DS,""))}}}function wwe(e){for(const n of e.children)EW(n);const t=e.component.scales;for(const n of B(t)){let r,i=null;for(const o of e.children){const s=o.component.scales[n];if(s){r===void 0?r=s.getWithExplicit("domains"):r=Aa(r,s.getWithExplicit("domains"),"domains","scale",PS);const a=s.get("selectionExtent");i&&a&&i.param!==a.param&&q(mme),i=a}}t[n].setWithExplicit("domains",r),i&&t[n].set("selectionExtent",i,!0)}}function bwe(e,t,n,r){if(e==="unaggregated"){const{valid:i,reason:o}=sT(t,n);if(!i){q(o);return}}else if(e===void 0&&r.useUnaggregatedDomain){const{valid:i}=sT(t,n);if(i)return"unaggregated"}return e}function Ewe(e,t){const n=e.getScaleComponent(t).get("type"),{encoding:r}=e,i=bwe(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return i!==e.scaleDomain(t)&&(e.specifiedScales[t]={...e.specifiedScales[t],domain:i}),t==="x"&&_t(r.x2)?_t(r.x)?Aa(Ts(n,i,e,"x"),Ts(n,i,e,"x2"),"domain","scale",PS):Ts(n,i,e,"x2"):t==="y"&&_t(r.y2)?_t(r.y)?Aa(Ts(n,i,e,"y"),Ts(n,i,e,"y2"),"domain","scale",PS):Ts(n,i,e,"y2"):Ts(n,i,e,t)}function Swe(e,t,n){return e.map(r=>({signal:`{data: ${ox(r,{timeUnit:n,type:t})}}`}))}function vw(e,t,n){var i;const r=(i=zt(n))==null?void 0:i.unit;return t==="temporal"||r?Swe(e,t,r):[e]}function Ts(e,t,n,r){const{encoding:i,markDef:o,mark:s,config:a,stack:l}=n,u=_t(i[r]),{type:c}=u,f=u.timeUnit,d=yxe({invalid:yo("invalid",o,a),isPath:Ga(s)});if(I1e(t)){const g=Ts(e,void 0,n,r),y=vw(t.unionWith,c,f);return Yi([...y,...g.value])}else{if(oe(t))return Yi([t]);if(t&&t!=="unaggregated"&&!yB(t))return Yi(vw(t,c,f))}if(l&&r===l.fieldChannel){if(l.offset==="normalize")return ur([[0,1]]);const g=n.requestDataName(d);return ur([{data:g,field:n.vgField(r,{suffix:"start"})},{data:g,field:n.vgField(r,{suffix:"end"})}])}const h=To(r)&&H(u)?kwe(n,r,e):void 0;if(No(u)){const g=vw([u.datum],c,f);return ur(g)}const p=u;if(t==="unaggregated"){const{field:g}=u;return ur([{data:n.requestDataName(d),field:Q({field:g,aggregate:"min"})},{data:n.requestDataName(d),field:Q({field:g,aggregate:"max"})}])}else if(Ve(p.bin)){if(It(e))return ur(e==="bin-ordinal"?[]:[{data:lp(h)?n.requestDataName(d):n.requestDataName(ct.Raw),field:n.vgField(r,ag(p,r)?{binSuffix:"range"}:{}),sort:h===!0||!Z(h)?{field:n.vgField(r,{}),op:"min"}:h}]);{const{bin:g}=p;if(Ve(g)){const y=IA(n,p.field,g);return ur([new Tt(()=>{const m=n.getSignalName(y);return`[${m}.start, ${m}.stop]`})])}else return ur([{data:n.requestDataName(d),field:n.vgField(r,{})}])}}else if(p.timeUnit&&Ee(["time","utc"],e)){const g=i[Mo(r)];if(RB(p,g,o,a)){const y=n.requestDataName(d),m=$a({fieldDef:p,fieldDef2:g,markDef:o,config:a}),v=cp(s)&&m!==.5&&gt(r);return ur([{data:y,field:n.vgField(r,v?{suffix:fx}:{})},{data:y,field:n.vgField(r,{suffix:v?dx:"end"})}])}}return ur(h?[{data:lp(h)?n.requestDataName(d):n.requestDataName(ct.Raw),field:n.vgField(r),sort:h}]:[{data:n.requestDataName(d),field:n.vgField(r)}])}function xw(e,t){const{op:n,field:r,order:i}=e;return{op:n??(t?"sum":tx),...r?{field:Kr(r)}:{},...i?{order:i}:{}}}function _we(e,t){var a;const n=e.component.scales[t],r=e.specifiedScales[t].domain,i=(a=e.fieldDef(t))==null?void 0:a.bin,o=yB(r)?r:void 0,s=wu(i)&&Gv(i.extent)?i.extent:void 0;(o||s)&&n.set("selectionExtent",o??s,!0)}function kwe(e,t,n){if(!It(n))return;const r=e.fieldDef(t),i=r.sort;if(TB(i))return{op:"min",field:ff(r,t),order:"ascending"};const{stack:o}=e,s=o?new Set([...o.groupbyFields,...o.stackBy.map(a=>a.fieldDef.field)]):void 0;if(is(i)){const a=o&&!s.has(i.field);return xw(i,a)}else if(yye(i)){const{encoding:a,order:l}=i,u=e.fieldDef(a),{aggregate:c,field:f}=u,d=o&&!s.has(f);if(ps(c)||Va(c))return xw({field:Q(u),order:l},d);if(W$(c)||!c)return xw({op:c,field:f,order:l},d)}else{if(i==="descending")return{op:"min",field:e.vgField(t),order:"descending"};if(Ee(["ascending",void 0],i))return!0}}function sT(e,t){const{aggregate:n,type:r}=e;return n?ee(n)&&!J0e.has(n)?{valid:!1,reason:Ume(n)}:r==="quantitative"&&t==="log"?{valid:!1,reason:Wme(e)}:{valid:!0}:{valid:!1,reason:Bme(e)}}function PS(e,t,n,r){return e.explicit&&t.explicit&&q(Yme(n,r,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function Cwe(e){const t=eo(e.map(s=>{if(Ko(s)){const{sort:a,...l}=s;return l}return s}),_e),n=eo(e.map(s=>{if(Ko(s)){const a=s.sort;return a!==void 0&&!lp(a)&&("op"in a&&a.op==="count"&&delete a.field,a.order==="ascending"&&delete a.order),a}}).filter(s=>s!==void 0),_e);if(t.length===0)return;if(t.length===1){const s=e[0];if(Ko(s)&&n.length>0){let a=n[0];if(n.length>1){q(p8);const l=n.filter(u=>Z(u)&&"op"in u&&u.op!=="min");n.every(u=>Z(u)&&"op"in u)&&l.length===1?a=l[0]:a=!0}else if(Z(a)&&"field"in a){const l=a.field;s.field===l&&(a=a.order?{order:a.order}:!0)}return{...s,sort:a}}return s}const r=eo(n.map(s=>lp(s)||!("op"in s)||ee(s.op)&&te(X0e,s.op)?s:(q(Qme(s)),!0)),_e);let i;r.length===1?i=r[0]:r.length>1&&(q(p8),i=!0);const o=eo(e.map(s=>Ko(s)?s.data:null),s=>s);return o.length===1&&o[0]!==null?{data:o[0],fields:t.map(a=>a.field),...i?{sort:i}:{}}:{fields:t,...i?{sort:i}:{}}}function WA(e){if(Ko(e)&&ee(e.field))return e.field;if(eme(e)){let t;for(const n of e.fields)if(Ko(n)&&ee(n.field)){if(!t)t=n.field;else if(t!==n.field)return q(Kme),t}return q(Zme),t}else if(tme(e)){q(Jme);const t=e.fields[0];return ee(t)?t:void 0}}function yx(e,t){const r=e.component.scales[t].get("domains").map(i=>(Ko(i)&&(i.data=e.lookupDataSource(i.data)),i));return Cwe(r)}function SW(e){return Uf(e)||qA(e)?e.children.reduce((t,n)=>t.concat(SW(n)),aT(e)):aT(e)}function aT(e){return B(e.component.scales).reduce((t,n)=>{const r=e.component.scales[n];if(r.merged)return t;const i=r.combine(),{name:o,type:s,selectionExtent:a,domains:l,range:u,reverse:c,...f}=i,d=$we(i.range,o,n,e),h=yx(e,n),p=a?Sxe(e,a,r,h):null;return t.push({name:o,type:s,...h?{domain:h}:{},...p?{domainRaw:p}:{},range:d,...c!==void 0?{reverse:c}:{},...f}),t},[])}function $we(e,t,n,r){if(gt(n)){if(bu(e))return{step:{signal:`${t}_step`}}}else if(Z(e)&&Ko(e))return{...e,data:r.lookupDataSource(e.data)};return e}class _W extends ks{constructor(t,n){super({},{name:t}),this.merged=!1,this.setWithExplicit("type",n)}domainHasZero(){const t=this.get("type");if(Ee([Vt.LOG,Vt.TIME,Vt.UTC],t))return"definitely-not";const n=this.get("zero");if(n===!0||n===void 0&&Ee([Vt.LINEAR,Vt.SQRT,Vt.POW],t))return"definitely";const r=this.get("domains");if(r.length>0){let i=!1,o=!1,s=!1;for(const a of r){if(j(a)){const l=a[0],u=a[a.length-1];if(Me(l)&&Me(u))if(l<=0&&u>=0){i=!0;continue}else{o=!0;continue}}s=!0}if(i)return"definitely";if(o&&!s)return"definitely-not"}return"maybe"}}const Awe=["range","scheme"];function Fwe(e){const t=e.component.scales;for(const n of U$){const r=t[n];if(!r)continue;const i=Mwe(n,e);r.setWithExplicit("range",i)}}function lT(e,t){const n=e.fieldDef(t);if(n!=null&&n.bin){const{bin:r,field:i}=n,o=sr(t),s=e.getName(o);if(Z(r)&&r.binned&&r.step!==void 0)return new Tt(()=>{const a=e.scaleName(t),l=`(domain("${a}")[1] - domain("${a}")[0]) / ${r.step}`;return`${e.getSignalName(s)} / (${l})`});if(Ve(r)){const a=IA(e,i,r);return new Tt(()=>{const l=e.getSignalName(a),u=`(${l}.stop - ${l}.start) / ${l}.step`;return`${e.getSignalName(s)} / (${u})`})}}}function Mwe(e,t){const n=t.specifiedScales[e],{size:r}=t,o=t.getScaleComponent(e).get("type");for(const f of Awe)if(n[f]!==void 0){const d=vS(o,f),h=vB(e,f);if(!d)q(Kj(o,f,e));else if(h)q(h);else switch(f){case"range":{const p=n.range;if(j(p)){if(gt(e))return Yi(p.map(g=>{if(g==="width"||g==="height"){const y=t.getName(g),m=t.getSignalName.bind(t);return Tt.fromName(m,y)}return g}))}else if(Z(p))return Yi({data:t.requestDataName(ct.Main),field:p.field,sort:{op:"min",field:t.vgField(e)}});return Yi(p)}case"scheme":return Yi(Twe(n[f]))}}const s=e===et||e==="xOffset"?"width":"height",a=r[s];if(xo(a)){if(gt(e))if(It(o)){const f=CW(a,t,e);if(f)return Yi({step:f})}else q(Zj(s));else if(eg(e)){const f=e===Ba?"x":"y";if(t.getScaleComponent(f).get("type")==="band"){const p=$W(a,o);if(p)return Yi(p)}}}const{rangeMin:l,rangeMax:u}=n,c=Nwe(e,t);return(l!==void 0||u!==void 0)&&vS(o,"rangeMin")&&j(c)&&c.length===2?Yi([l??c[0],u??c[1]]):ur(c)}function Twe(e){return z1e(e)?{scheme:e.name,...Jn(e,["name"])}:{scheme:e}}function kW(e,t,n,{center:r}={}){const i=sr(e),o=t.getName(i),s=t.getSignalName.bind(t);return e===Bt&&Ai(n)?r?[Tt.fromName(a=>`${s(a)}/2`,o),Tt.fromName(a=>`-${s(a)}/2`,o)]:[Tt.fromName(s,o),0]:r?[Tt.fromName(a=>`-${s(a)}/2`,o),Tt.fromName(a=>`${s(a)}/2`,o)]:[0,Tt.fromName(s,o)]}function Nwe(e,t){const{size:n,config:r,mark:i,encoding:o}=t,{type:s}=_t(o[e]),l=t.getScaleComponent(e).get("type"),{domain:u,domainMid:c}=t.specifiedScales[e];switch(e){case et:case Bt:{if(Ee(["point","band"],l)){const f=AW(e,n,r.view);if(xo(f))return{step:CW(f,t,e)}}return kW(e,t,l)}case Ba:case Pf:return Rwe(e,t,l);case bs:{const f=Pwe(i,r),d=Lwe(i,n,t,r);return rf(l)?Owe(f,d,Dwe(l,r,u,e)):[f,d]}case ei:return[0,Math.PI*2];case vu:return[0,360];case Pi:return[0,new Tt(()=>{const f=t.getSignalName(br(t.parent)?"child_width":"width"),d=t.getSignalName(br(t.parent)?"child_height":"height");return`min(${f},${d})/2`})];case qa:return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case Ha:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case or:return"symbol";case ir:case Ao:case Fo:return l==="ordinal"?s==="nominal"?"category":"ordinal":c!==void 0?"diverging":i==="rect"||i==="geoshape"?"heatmap":"ramp";case Es:case Ua:case Wa:return[r.scale.minOpacity,r.scale.maxOpacity]}}function CW(e,t,n){const{encoding:r}=t,i=t.getScaleComponent(n),o=z$(n),s=r[o];if(fU({step:e,offsetIsDiscrete:he(s)&&dB(s.type)})==="offset"&&HB(r,o)){const l=t.getScaleComponent(o);let c=`domain('${t.scaleName(o)}').length`;if(l.get("type")==="band"){const d=l.get("paddingInner")??l.get("padding")??0,h=l.get("paddingOuter")??l.get("padding")??0;c=`bandspace(${c}, ${d}, ${h})`}const f=i.get("paddingInner")??i.get("padding");return{signal:`${e.step} * ${c} / (1-${ome(f)})`}}else return e.step}function $W(e,t){if(fU({step:e,offsetIsDiscrete:It(t)})==="offset")return{step:e.step}}function Rwe(e,t,n){const r=e===Ba?"x":"y",i=t.getScaleComponent(r);if(!i)return kW(r,t,n,{center:!0});const o=i.get("type"),s=t.scaleName(r),{markDef:a,config:l}=t;if(o==="band"){const u=AW(r,t.size,t.config.view);if(xo(u)){const c=$W(u,n);if(c)return c}return[0,{signal:`bandwidth('${s}')`}]}else{const u=t.encoding[r];if(H(u)&&u.timeUnit){const c=lB(u.timeUnit,p=>`scale('${s}', ${p})`),f=t.config.scale.bandWithNestedOffsetPaddingInner,d=$a({fieldDef:u,markDef:a,config:l})-.5,h=d!==0?` + ${d}`:"";if(f){const p=oe(f)?`${f.signal}/2`+h:`${f/2+d}`,g=oe(f)?`(1 - ${f.signal}/2)`+h:`${1-f/2+d}`;return[{signal:`${p} * (${c})`},{signal:`${g} * (${c})`}]}return[0,{signal:c}]}return xj(`Cannot use ${e} scale if ${r} scale is not discrete.`)}}function AW(e,t,n){const r=e===et?"width":"height",i=t[r];return i||ey(n,r)}function Dwe(e,t,n,r){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return n!==void 0&&j(n)?n.length+1:(q(l1e(r)),3)}}function Owe(e,t,n){const r=()=>{const i=vi(t),o=vi(e),s=`(${i} - ${o}) / (${n} - 1)`;return`sequence(${o}, ${i} + ${s}, ${s})`};return oe(t)?new Tt(r):{signal:r()}}function Pwe(e,t){switch(e){case"bar":case"tick":return t.scale.minBandSize;case"line":case"trail":case"rule":return t.scale.minStrokeWidth;case"text":return t.scale.minFontSize;case"point":case"square":case"circle":return t.scale.minSize}throw new Error(Yv("size",e))}const uT=.95;function Lwe(e,t,n,r){const i={x:lT(n,"x"),y:lT(n,"y")};switch(e){case"bar":case"tick":{if(r.scale.maxBandSize!==void 0)return r.scale.maxBandSize;const o=cT(t,i,r.view);return Me(o)?o-1:new Tt(()=>`${o.signal} - 1`)}case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":{if(r.scale.maxSize)return r.scale.maxSize;const o=cT(t,i,r.view);return Me(o)?Math.pow(uT*o,2):new Tt(()=>`pow(${uT} * ${o.signal}, 2)`)}}throw new Error(Yv("size",e))}function cT(e,t,n){const r=xo(e.width)?e.width.step:ES(n,"width"),i=xo(e.height)?e.height.step:ES(n,"height");return t.x||t.y?new Tt(()=>`min(${[t.x?t.x.signal:r,t.y?t.y.signal:i].join(", ")})`):Math.min(r,i)}function FW(e,t){rt(e)?zwe(e,t):TW(e,t)}function zwe(e,t){const n=e.component.scales,{config:r,encoding:i,markDef:o,specifiedScales:s}=e;for(const a of B(n)){const l=s[a],u=n[a],c=e.getScaleComponent(a),f=_t(i[a]),d=l[t],h=c.get("type"),p=c.get("padding"),g=c.get("paddingInner"),y=vS(h,t),m=vB(a,t);if(d!==void 0&&(y?m&&q(m):q(Kj(h,t,a))),y&&m===void 0)if(d!==void 0){const v=f.timeUnit,x=f.type;switch(t){case"domainMax":case"domainMin":Eu(l[t])||x==="temporal"||v?u.set(t,{signal:ox(l[t],{type:x,timeUnit:v})},!0):u.set(t,l[t],!0);break;default:u.copyKeyFromObject(t,l)}}else{const v=W(fT,t)?fT[t]({model:e,channel:a,fieldOrDatumDef:f,scaleType:h,scalePadding:p,scalePaddingInner:g,domain:l.domain,domainMin:l.domainMin,domainMax:l.domainMax,markDef:o,config:r,hasNestedOffsetScale:VB(i,a),hasSecondaryRangeChannel:!!i[Mo(a)]}):r.scale[t];v!==void 0&&u.set(t,v,!1)}}}const fT={bins:({model:e,fieldOrDatumDef:t})=>H(t)?Iwe(e,t):void 0,interpolate:({channel:e,fieldOrDatumDef:t})=>jwe(e,t.type),nice:({scaleType:e,channel:t,domain:n,domainMin:r,domainMax:i,fieldOrDatumDef:o})=>Bwe(e,t,n,r,i,o),padding:({channel:e,scaleType:t,fieldOrDatumDef:n,markDef:r,config:i})=>Uwe(e,t,i.scale,n,r,i.bar),paddingInner:({scalePadding:e,channel:t,markDef:n,scaleType:r,config:i,hasNestedOffsetScale:o})=>Wwe(e,t,n.type,r,i.scale,o),paddingOuter:({scalePadding:e,channel:t,scaleType:n,scalePaddingInner:r,config:i,hasNestedOffsetScale:o})=>qwe(e,t,n,r,i.scale,o),reverse:({fieldOrDatumDef:e,scaleType:t,channel:n,config:r})=>{const i=H(e)?e.sort:void 0;return Hwe(t,i,n,r.scale)},zero:({channel:e,fieldOrDatumDef:t,domain:n,markDef:r,scaleType:i,config:o,hasSecondaryRangeChannel:s})=>Vwe(e,t,n,r,i,o.scale,s)};function MW(e){rt(e)?Fwe(e):TW(e,"range")}function TW(e,t){const n=e.component.scales;for(const r of e.children)t==="range"?MW(r):FW(r,t);for(const r of B(n)){let i;for(const o of e.children){const s=o.component.scales[r];if(s){const a=s.getWithExplicit(t);i=Aa(i,a,t,"scale",_U((l,u)=>{switch(t){case"range":return l.step&&u.step?l.step-u.step:0}return 0}))}}n[r].setWithExplicit(t,i)}}function Iwe(e,t){const n=t.bin;if(Ve(n)){const r=IA(e,t.field,n);return new Tt(()=>e.getSignalName(r))}else if(qt(n)&&wu(n)&&n.step!==void 0)return{step:n.step}}function jwe(e,t){if(Ee([ir,Ao,Fo],e)&&t!=="nominal")return"hcl"}function Bwe(e,t,n,r,i,o){var s;if(!((s=Mi(o))!=null&&s.bin||j(n)||i!=null||r!=null||Ee([Vt.TIME,Vt.UTC],e)))return gt(t)?!0:void 0}function Uwe(e,t,n,r,i,o){if(gt(e)){if(to(t)){if(n.continuousPadding!==void 0)return n.continuousPadding;const{type:s,orient:a}=i;if(s==="bar"&&!(H(r)&&(r.bin||r.timeUnit))&&(a==="vertical"&&e==="x"||a==="horizontal"&&e==="y"))return o.continuousBandSize}if(t===Vt.POINT)return n.pointPadding}}function Wwe(e,t,n,r,i,o=!1){if(e===void 0){if(gt(t)){const{bandPaddingInner:s,barBandPaddingInner:a,rectBandPaddingInner:l,tickBandPaddingInner:u,bandWithNestedOffsetPaddingInner:c}=i;return o?c:pt(s,n==="bar"?a:n==="tick"?u:l)}else if(eg(t)&&r===Vt.BAND)return i.offsetBandPaddingInner}}function qwe(e,t,n,r,i,o=!1){if(e===void 0){if(gt(t)){const{bandPaddingOuter:s,bandWithNestedOffsetPaddingOuter:a}=i;if(o)return a;if(n===Vt.BAND)return pt(s,oe(r)?{signal:`${r.signal}/2`}:r/2)}else if(eg(t)){if(n===Vt.POINT)return .5;if(n===Vt.BAND)return i.offsetBandPaddingOuter}}}function Hwe(e,t,n,r){if(n==="x"&&r.xReverse!==void 0)return Ai(e)&&t==="descending"?oe(r.xReverse)?{signal:`!${r.xReverse.signal}`}:!r.xReverse:r.xReverse;if(Ai(e)&&t==="descending")return!0}function Vwe(e,t,n,r,i,o,s){if(!!n&&n!=="unaggregated"&&Ai(i)){if(j(n)){const l=n[0],u=n[n.length-1];if(Me(l)&&l<=0&&Me(u)&&u>=0)return!0}return!1}if(e==="size"&&t.type==="quantitative"&&!rf(i))return!0;if(!(H(t)&&t.bin)&&Ee([...Ss,...B0e],e)){const{orient:l,type:u}=r;return Ee(["bar","area","line","trail"],u)&&(l==="horizontal"&&e==="y"||l==="vertical"&&e==="x")?!1:Ee(["bar","area"],u)&&!s?!0:o==null?void 0:o.zero}return!1}function Gwe(e,t,n,r,i=!1){const o=Ywe(t,n,r,i),{type:s}=e;return To(t)?s!==void 0?H1e(t,s)?H(n)&&!q1e(s,n.type)?(q(Vme(s,o)),o):s:(q(Hme(t,s,o)),o):o:null}function Ywe(e,t,n,r){var i;switch(t.type){case"nominal":case"ordinal":{if(wc(e)||uw(e)==="discrete")return e==="shape"&&t.type==="ordinal"&&q(cw(e,"ordinal")),"ordinal";if(gt(e)||eg(e)){if(Ee(["rect","bar","image","rule","tick"],n.type)||r)return"band"}else if(n.type==="arc"&&e in B$)return"band";const o=n[sr(e)];return nu(o)||sf(t)&&((i=t.axis)!=null&&i.tickBand)?"band":"point"}case"temporal":return wc(e)?"time":uw(e)==="discrete"?(q(cw(e,"temporal")),"ordinal"):H(t)&&t.timeUnit&&zt(t.timeUnit).utc?"utc":"time";case"quantitative":return wc(e)?H(t)&&Ve(t.bin)?"bin-ordinal":"linear":uw(e)==="discrete"?(q(cw(e,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(Xj(t.type))}function Xwe(e,{ignoreRange:t}={}){NW(e),EW(e);for(const n of W1e)FW(e,n);t||MW(e)}function NW(e){rt(e)?e.component.scales=Qwe(e):e.component.scales=Zwe(e)}function Qwe(e){const{encoding:t,mark:n,markDef:r}=e,i={};for(const o of U$){const s=_t(t[o]);if(s&&n===bB&&o===or&&s.type===Lf)continue;let a=s&&s.scale;if(s&&a!==null&&a!==!1){a??(a={});const l=VB(t,o),u=Gwe(a,o,s,r,l);i[o]=new _W(e.scaleName(`${o}`,!0),{value:u,explicit:a.type===u})}}return i}const Kwe=_U((e,t)=>m8(e)-m8(t));function Zwe(e){var t;const n=e.component.scales={},r={},i=e.component.resolve;for(const o of e.children){NW(o);for(const s of B(o.component.scales))if((t=i.scale)[s]??(t[s]=uW(s,e)),i.scale[s]==="shared"){const a=r[s],l=o.component.scales[s].getWithExplicit("type");a?R1e(a.value,l.value)?r[s]=Aa(a,l,"type","scale",Kwe):(i.scale[s]="independent",delete r[s]):r[s]=l}}for(const o of B(r)){const s=e.scaleName(o,!0),a=r[o];n[o]=new _W(s,a);for(const l of e.children){const u=l.component.scales[o];u&&(l.renameScale(u.get("name"),s),u.merged=!0)}}return n}class ww{constructor(){this.nameMap={}}rename(t,n){this.nameMap[t]=n}has(t){return this.nameMap[t]!==void 0}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}function rt(e){return(e==null?void 0:e.type)==="unit"}function br(e){return(e==null?void 0:e.type)==="facet"}function qA(e){return(e==null?void 0:e.type)==="concat"}function Uf(e){return(e==null?void 0:e.type)==="layer"}class HA{constructor(t,n,r,i,o,s,a){this.type=n,this.parent=r,this.config=o,this.correctDataNames=l=>{var u,c,f;return(u=l.from)!=null&&u.data&&(l.from.data=this.lookupDataSource(l.from.data)),(f=(c=l.from)==null?void 0:c.facet)!=null&&f.data&&(l.from.facet.data=this.lookupDataSource(l.from.facet.data)),l},this.parent=r,this.config=o,this.view=Ht(a),this.name=t.name??i,this.title=zs(t.title)?{text:t.title}:t.title?Ht(t.title):void 0,this.scaleNameMap=r?r.scaleNameMap:new ww,this.projectionNameMap=r?r.projectionNameMap:new ww,this.signalNameMap=r?r.signalNameMap:new ww,this.data=t.data,this.description=t.description,this.transforms=oxe(t.transform??[]),this.layout=n==="layer"||n==="unit"?{}:uve(t,n,o),this.component={data:{sources:r?r.component.data.sources:[],outputNodes:r?r.component.data.outputNodes:{},outputNodeRefCounts:r?r.component.data.outputNodeRefCounts:{},isFaceted:nx(t)||(r==null?void 0:r.component.data.isFaceted)&&t.data===void 0},layoutSize:new ks,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:{scale:{},axis:{},legend:{},...s?de(s):{}},selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){Xwe(this)}parseProjection(){xW(this)}renameTopLevelLayoutSizeSignal(){this.getName("width")!=="width"&&this.renameSignal(this.getName("width"),"width"),this.getName("height")!=="height"&&this.renameSignal(this.getName("height"),"height")}parseLegends(){pW(this)}assembleEncodeFromView(t){const{style:n,...r}=t,i={};for(const o of B(r)){const s=r[o];s!==void 0&&(i[o]=Xe(s))}return i}assembleGroupEncodeEntry(t){let n={};return this.view&&(n=this.assembleEncodeFromView(this.view)),!t&&(this.description&&(n.description=Xe(this.description)),this.type==="unit"||this.type==="layer")?{width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height"),...n}:Be(n)?void 0:n}assembleLayout(){if(!this.layout)return;const{spacing:t,...n}=this.layout,{component:r,config:i}=this,o=v2e(r.layoutHeaders,i);return{padding:t,...this.assembleDefaultLayout(),...n,...o?{titleBand:o}:{}}}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:t}=this.component;let n=[];for(const r of jr)t[r].title&&n.push(d2e(this,r));for(const r of OA)n=n.concat(h2e(this,r));return n}assembleAxes(){return Jxe(this.component.axes,this.config)}assembleLegends(){return mW(this)}assembleProjections(){return B2e(this)}assembleTitle(){const{encoding:t,...n}=this.title??{},r={...jj(this.config.title).nonMarkTitleProperties,...n,...t?{encode:{update:t}}:{}};if(r.text)return Ee(["unit","layer"],this.type)?Ee(["middle",void 0],r.anchor)&&(r.frame??(r.frame="group")):r.anchor??(r.anchor="start"),Be(r)?void 0:r}assembleGroup(t=[]){const n={};t=t.concat(this.assembleSignals()),t.length>0&&(n.signals=t);const r=this.assembleLayout();r&&(n.layout=r),n.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const i=!this.parent||br(this.parent)?SW(this):[];i.length>0&&(n.scales=i);const o=this.assembleAxes();o.length>0&&(n.axes=o);const s=this.assembleLegends();return s.length>0&&(n.legends=s),n}getName(t){return Je((this.name?`${this.name}_`:"")+t)}getDataName(t){return this.getName(ct[t].toLowerCase())}requestDataName(t){const n=this.getDataName(t),r=this.component.data.outputNodeRefCounts;return r[n]=(r[n]||0)+1,n}getSizeSignalRef(t){if(br(this.parent)){const n=aW(t),r=Hv(n),i=this.component.scales[r];if(i&&!i.merged){const o=i.get("type"),s=i.get("range");if(It(o)&&bu(s)){const a=i.get("name"),l=yx(this,r),u=WA(l);if(u){const c=Q({aggregate:"distinct",field:u},{expr:"datum"});return{signal:sW(a,i,c)}}else return q(H$(r)),null}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){const n=this.component.data.outputNodes[t];return n?n.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,n){this.signalNameMap.rename(t,n)}renameScale(t,n){this.scaleNameMap.rename(t,n)}renameProjection(t,n){this.projectionNameMap.rename(t,n)}scaleName(t,n){if(n)return this.getName(t);if(Nj(t)&&To(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t)))return this.scaleNameMap.get(this.getName(t))}projectionName(t){if(t)return this.getName("projection");if(this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection")))return this.projectionNameMap.get(this.getName("projection"))}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const n=this.component.scales[t];return n&&!n.merged?n:this.parent?this.parent.getScaleComponent(t):void 0}getScaleType(t){const n=this.getScaleComponent(t);return n?n.get("type"):void 0}getSelectionComponent(t,n){let r=this.component.selection[t];if(!r&&this.parent&&(r=this.parent.getSelectionComponent(t,n)),!r)throw new Error(cme(n));return r}hasAxisOrientSignalRef(){var t,n;return((t=this.component.axes.x)==null?void 0:t.some(r=>r.hasOrientSignalRef()))||((n=this.component.axes.y)==null?void 0:n.some(r=>r.hasOrientSignalRef()))}}class RW extends HA{vgField(t,n={}){const r=this.fieldDef(t);if(r)return Q(r,n)}reduceFieldDef(t,n){return zye(this.getMapping(),(r,i,o)=>{const s=Mi(i);return s?t(r,s,o):r},n)}forEachFieldDef(t,n){yA(this.getMapping(),(r,i)=>{const o=Mi(r);o&&t(o,i)},n)}}class vx extends Ie{clone(){return new vx(null,de(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=de(n);const r=this.transform.as??[void 0,void 0];this.transform.as=[r[0]??"value",r[1]??"density"];const i=this.transform.resolve??"shared";this.transform.resolve=i}dependentFields(){return new Set([this.transform.density,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${_e(this.transform)}`}assemble(){const{density:t,...n}=this.transform,r={type:"kde",field:t,...n};return r.resolve=this.transform.resolve,r}}class xx extends Ie{clone(){return new xx(null,de(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=de(n)}dependentFields(){return new Set([this.transform.extent])}producedFields(){return new Set([])}hash(){return`ExtentTransform ${_e(this.transform)}`}assemble(){const{extent:t,param:n}=this.transform;return{type:"extent",field:t,signal:n}}}class wx extends Ie{clone(){return new wx(this.parent,de(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=de(n);const{flatten:r,as:i=[]}=this.transform;this.transform.as=r.map((o,s)=>i[s]??o)}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${_e(this.transform)}`}assemble(){const{flatten:t,as:n}=this.transform;return{type:"flatten",fields:t,as:n}}}class bx extends Ie{clone(){return new bx(null,de(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=de(n);const r=this.transform.as??[void 0,void 0];this.transform.as=[r[0]??"key",r[1]??"value"]}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${_e(this.transform)}`}assemble(){const{fold:t,as:n}=this.transform;return{type:"fold",fields:t,as:n}}}class Sc extends Ie{clone(){return new Sc(null,de(this.fields),this.geojson,this.signal)}static parseAll(t,n){if(n.component.projection&&!n.component.projection.isFit)return t;let r=0;for(const i of[[zi,Li],[Zr,Ii]]){const o=i.map(s=>{const a=_t(n.encoding[s]);return H(a)?a.field:No(a)?{expr:`${a.datum}`}:Fi(a)?{expr:`${a.value}`}:void 0});(o[0]||o[1])&&(t=new Sc(t,o,null,n.getName(`geojson_${r++}`)))}if(n.channelHasField(or)){const i=n.typedFieldDef(or);i.type===Lf&&(t=new Sc(t,null,i.field,n.getName(`geojson_${r++}`)))}return t}constructor(t,n,r,i){super(t),this.fields=n,this.geojson=r,this.signal=i}dependentFields(){const t=(this.fields??[]).filter(ee);return new Set([...this.geojson?[this.geojson]:[],...t])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${_e(this.fields)}`}assemble(){return[...this.geojson?[{type:"filter",expr:`isValid(datum["${this.geojson}"])`}]:[],{type:"geojson",...this.fields?{fields:this.fields}:{},...this.geojson?{geojson:this.geojson}:{},signal:this.signal}]}}class dp extends Ie{clone(){return new dp(null,this.projection,de(this.fields),de(this.as))}constructor(t,n,r,i){super(t),this.projection=n,this.fields=r,this.as=i}static parseAll(t,n){if(!n.projectionName())return t;for(const r of[[zi,Li],[Zr,Ii]]){const i=r.map(s=>{const a=_t(n.encoding[s]);return H(a)?a.field:No(a)?{expr:`${a.datum}`}:Fi(a)?{expr:`${a.value}`}:void 0}),o=r[0]===Zr?"2":"";(i[0]||i[1])&&(t=new dp(t,n.projectionName(),i,[n.getName(`x${o}`),n.getName(`y${o}`)]))}return t}dependentFields(){return new Set(this.fields.filter(ee))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${_e(this.fields)} ${_e(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class Dl extends Ie{clone(){return new Dl(null,de(this.transform))}constructor(t,n){super(t),this.transform=n}dependentFields(){return new Set([this.transform.impute,this.transform.key,...this.transform.groupby??[]])}producedFields(){return new Set([this.transform.impute])}processSequence(t){const{start:n=0,stop:r,step:i}=t;return{signal:`sequence(${[n,r,...i?[i]:[]].join(",")})`}}static makeFromTransform(t,n){return new Dl(t,n)}static makeFromEncoding(t,n){const r=n.encoding,i=r.x,o=r.y;if(H(i)&&H(o)){const s=i.impute?i:o.impute?o:void 0;if(s===void 0)return;const a=i.impute?o:o.impute?i:void 0,{method:l,value:u,frame:c,keyvals:f}=s.impute,d=XB(n.mark,r);return new Dl(t,{impute:s.field,key:a.field,...l?{method:l}:{},...u!==void 0?{value:u}:{},...c?{frame:c}:{},...f!==void 0?{keyvals:f}:{},...d.length?{groupby:d}:{}})}return null}hash(){return`Impute ${_e(this.transform)}`}assemble(){const{impute:t,key:n,keyvals:r,method:i,groupby:o,value:s,frame:a=[null,null]}=this.transform,l={type:"impute",field:t,key:n,...r?{keyvals:jve(r)?this.processSequence(r):r}:{},method:"value",...o?{groupby:o}:{},value:!i||i==="value"?s:null};if(i&&i!=="value"){const u={type:"window",as:[`imputed_${t}_value`],ops:[i],fields:[t],frame:a,ignorePeers:!1,...o?{groupby:o}:{}},c={type:"formula",expr:`datum.${t} === null ? datum.imputed_${t}_value : datum.${t}`,as:t};return[l,u,c]}else return[l]}}class Ex extends Ie{clone(){return new Ex(null,de(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=de(n);const r=this.transform.as??[void 0,void 0];this.transform.as=[r[0]??n.on,r[1]??n.loess]}dependentFields(){return new Set([this.transform.loess,this.transform.on,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${_e(this.transform)}`}assemble(){const{loess:t,on:n,...r}=this.transform;return{type:"loess",x:n,y:t,...r}}}class hp extends Ie{clone(){return new hp(null,de(this.transform),this.secondary)}constructor(t,n,r){super(t),this.transform=n,this.secondary=r}static make(t,n,r,i){const o=n.component.data.sources,{from:s}=r;let a=null;if(Bve(s)){let l=PW(s.data,o);l||(l=new su(s.data),o.push(l));const u=n.getName(`lookup_${i}`);a=new er(l,u,ct.Lookup,n.component.data.outputNodeRefCounts),n.component.data.outputNodes[u]=a}else if(Uve(s)){const l=s.param;r={as:l,...r};let u;try{u=n.getSelectionComponent(Je(l),l)}catch{throw new Error(pme(l))}if(a=u.materialized,!a)throw new Error(gme(l))}return new hp(t,r,a.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?J(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${_e({transform:this.transform,secondary:this.secondary})}`}assemble(){let t;if(this.transform.from.fields)t={values:this.transform.from.fields,...this.transform.as?{as:J(this.transform.as)}:{}};else{let n=this.transform.as;ee(n)||(q(Sme),n="_lookup"),t={as:[n]}}return{type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup],...t,...this.transform.default?{default:this.transform.default}:{}}}}class Sx extends Ie{clone(){return new Sx(null,de(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=de(n);const r=this.transform.as??[void 0,void 0];this.transform.as=[r[0]??"prob",r[1]??"value"]}dependentFields(){return new Set([this.transform.quantile,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${_e(this.transform)}`}assemble(){const{quantile:t,...n}=this.transform;return{type:"quantile",field:t,...n}}}class _x extends Ie{clone(){return new _x(null,de(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=de(n);const r=this.transform.as??[void 0,void 0];this.transform.as=[r[0]??n.on,r[1]??n.regression]}dependentFields(){return new Set([this.transform.regression,this.transform.on,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${_e(this.transform)}`}assemble(){const{regression:t,on:n,...r}=this.transform;return{type:"regression",x:n,y:t,...r}}}class kx extends Ie{clone(){return new kx(null,de(this.transform))}constructor(t,n){super(t),this.transform=n}addDimensions(t){this.transform.groupby=eo((this.transform.groupby??[]).concat(t),n=>n)}producedFields(){}dependentFields(){return new Set([this.transform.pivot,this.transform.value,...this.transform.groupby??[]])}hash(){return`PivotTransform ${_e(this.transform)}`}assemble(){const{pivot:t,value:n,groupby:r,limit:i,op:o}=this.transform;return{type:"pivot",field:t,value:n,...i!==void 0?{limit:i}:{},...o!==void 0?{op:o}:{},...r!==void 0?{groupby:r}:{}}}}class Cx extends Ie{clone(){return new Cx(null,de(this.transform))}constructor(t,n){super(t),this.transform=n}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${_e(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function DW(e){let t=0;function n(r,i){if(r instanceof su&&!r.isGenerator&&!lf(r.data)&&(e.push(i),i={name:null,source:i.name,transform:[]}),r instanceof pn&&(r.parent instanceof su&&!i.source?(i.format={...i.format,parse:r.assembleFormatParse()},i.transform.push(...r.assembleTransforms(!0))):i.transform.push(...r.assembleTransforms())),r instanceof jf){i.name||(i.name=`data_${t++}`),!i.source||i.transform.length>0?(e.push(i),r.data=i.name):r.data=i.source,e.push(...r.assemble());return}switch((r instanceof cg||r instanceof fg||r instanceof hf||r instanceof If||r instanceof cf||r instanceof dp||r instanceof Si||r instanceof hp||r instanceof Bf||r instanceof Cu||r instanceof bx||r instanceof wx||r instanceof vx||r instanceof Ex||r instanceof Sx||r instanceof _x||r instanceof Ma||r instanceof Cx||r instanceof kx||r instanceof xx)&&i.transform.push(r.assemble()),(r instanceof lo||r instanceof ao||r instanceof Dl||r instanceof ss||r instanceof Sc)&&i.transform.push(...r.assemble()),r instanceof er&&(i.source&&i.transform.length===0?r.setSource(i.source):r.parent instanceof er?r.setSource(i.name):(i.name||(i.name=`data_${t++}`),r.setSource(i.name),r.numChildren()===1&&(e.push(i),i={name:null,source:i.name,transform:[]}))),r.numChildren()){case 0:r instanceof er&&(!i.source||i.transform.length>0)&&e.push(i);break;case 1:n(r.children[0],i);break;default:{i.name||(i.name=`data_${t++}`);let o=i.name;!i.source||i.transform.length>0?e.push(i):o=i.source;for(const s of r.children)n(s,{name:null,source:o,transform:[]});break}}}return n}function Jwe(e){const t=[],n=DW(t);for(const r of e.children)n(r,{source:e.name,name:null,transform:[]});return t}function ebe(e,t){const n=[],r=DW(n);let i=0;for(const s of e.sources){s.hasName()||(s.dataName=`source_${i++}`);const a=s.assemble();r(s,a)}for(const s of n)s.transform.length===0&&delete s.transform;let o=0;for(const[s,a]of n.entries())(a.transform??[]).length===0&&!a.source&&n.splice(o++,0,n.splice(s,1)[0]);for(const s of n)for(const a of s.transform??[])a.type==="lookup"&&(a.from=e.outputNodes[a.from].getSource());for(const s of n)s.name in t&&(s.values=t[s.name]);return n}function tbe(e){return e==="top"||e==="left"||oe(e)?"header":"footer"}function nbe(e){for(const t of jr)rbe(e,t);dT(e,"x"),dT(e,"y")}function rbe(e,t){var s;const{facet:n,config:r,child:i,component:o}=e;if(e.channelHasField(t)){const a=n[t],l=df("title",null,r,t);let u=bc(a,r,{allowDisabling:!0,includeDefault:l===void 0||!!l});i.component.layoutHeaders[t].title&&(u=j(u)?u.join(", "):u,u+=` / ${i.component.layoutHeaders[t].title}`,i.component.layoutHeaders[t].title=null);const c=df("labelOrient",a.header,r,t),f=a.header!==null?pt((s=a.header)==null?void 0:s.labels,r.header.labels,!0):!1,d=Ee(["bottom","right"],c)?"footer":"header";o.layoutHeaders[t]={title:a.header!==null?u:null,facetFieldDef:a,[d]:t==="facet"?[]:[OW(e,t,f)]}}}function OW(e,t,n){const r=t==="row"?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(r)?e.child.getSizeSignalRef(r):void 0,axes:[]}}function dT(e,t){const{child:n}=e;if(n.component.axes[t]){const{layoutHeaders:r,resolve:i}=e.component;if(i.axis[t]=zA(i,t),i.axis[t]==="shared"){const o=t==="x"?"column":"row",s=r[o];for(const a of n.component.axes[t]){const l=tbe(a.get("orient"));s[l]??(s[l]=[OW(e,o,!1)]);const u=Yd(a,"main",e.config,{header:!0});u&&s[l][0].axes.push(u),a.mainExtracted=!0}}}}function ibe(e){VA(e),iy(e,"width"),iy(e,"height")}function obe(e){VA(e);const t=e.layout.columns===1?"width":"childWidth",n=e.layout.columns===void 0?"height":"childHeight";iy(e,t),iy(e,n)}function VA(e){for(const t of e.children)t.parseLayoutSize()}function iy(e,t){const n=aW(t),r=Hv(n),i=e.component.resolve,o=e.component.layoutSize;let s;for(const a of e.children){const l=a.component.layoutSize.getWithExplicit(n),u=i.scale[r]??uW(r,e);if(u==="independent"&&l.value==="step"){s=void 0;break}if(s){if(u==="independent"&&s.value!==l.value){s=void 0;break}s=Aa(s,l,n,"")}else s=l}if(s){for(const a of e.children)e.renameSignal(a.getName(n),e.getName(t)),a.component.layoutSize.set(n,"merged",!1);o.setWithExplicit(t,s)}else o.setWithExplicit(t,{explicit:!1,value:void 0})}function sbe(e){const{size:t,component:n}=e;for(const r of Ss){const i=sr(r);if(t[i]){const o=t[i];n.layoutSize.set(i,xo(o)?"step":o,!0)}else{const o=abe(e,i);n.layoutSize.set(i,o,!1)}}}function abe(e,t){const n=t==="width"?"x":"y",r=e.config,i=e.getScaleComponent(n);if(i){const o=i.get("type"),s=i.get("range");if(It(o)){const a=ey(r.view,t);return bu(s)||xo(a)?"step":a}else return bS(r.view,t)}else{if(e.hasProjection||e.mark==="arc")return bS(r.view,t);{const o=ey(r.view,t);return xo(o)?o.step:o}}}function LS(e,t,n){return Q(t,{suffix:`by_${Q(e)}`,...n})}class wh extends RW{constructor(t,n,r,i){super(t,"facet",n,r,i,t.resolve),this.child=KA(t.spec,this,this.getName("child"),void 0,i),this.children=[this.child],this.facet=this.initFacet(t.facet)}initFacet(t){if(!ig(t))return{facet:this.initFacetFieldDef(t,"facet")};const n=B(t),r={};for(const i of n){if(![ns,rs].includes(i)){q(Yv(i,"facet"));break}const o=t[i];if(o.field===void 0){q(mS(o,i));break}r[i]=this.initFacetFieldDef(o,i)}return r}initFacetFieldDef(t,n){const r=mA(t,n);return r.header?r.header=Ht(r.header):r.header===null&&(r.header=null),r}channelHasField(t){return W(this.facet,t)}fieldDef(t){return this.facet[t]}parseData(){this.component.data=$x(this),this.child.parseData()}parseLayoutSize(){VA(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),nbe(this)}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){const t={};for(const n of jr)for(const r of PA){const i=this.component.layoutHeaders[n],o=i[r],{facetFieldDef:s}=i;if(s){const a=df("titleOrient",s.header,this.config,n);if(["right","bottom"].includes(a)){const l=gx(n,a);t.titleAnchor??(t.titleAnchor={}),t.titleAnchor[l]="end"}}if(o!=null&&o[0]){const a=n==="row"?"height":"width",l=r==="header"?"headerBand":"footerBand";n!=="facet"&&!this.child.component.layoutSize.get(a)&&(t[l]??(t[l]={}),t[l][n]=.5),i.title&&(t.offset??(t.offset={}),t.offset[n==="row"?"rowTitle":"columnTitle"]=10)}}return t}assembleDefaultLayout(){const{column:t,row:n}=this.facet,r=t?this.columnDistinctSignal():n?1:void 0;let i="all";return(!n&&this.component.resolve.scale.x==="independent"||!t&&this.component.resolve.scale.y==="independent")&&(i="none"),{...this.getHeaderLayoutMixins(),...r?{columns:r}:{},bounds:"full",align:i}}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof wh))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroupStyle(){}assembleGroup(t){return this.parent&&this.parent instanceof wh?{...this.channelHasField("column")?{encode:{update:{columns:{field:Q(this.facet.column,{prefix:"distinct"})}}}}:{},...super.assembleGroup(t)}:super.assembleGroup(t)}getCardinalityAggregateForChild(){const t=[],n=[],r=[];if(this.child instanceof wh){if(this.child.channelHasField("column")){const i=Q(this.child.facet.column);t.push(i),n.push("distinct"),r.push(`distinct_${i}`)}}else for(const i of Ss){const o=this.child.component.scales[i];if(o&&!o.merged){const s=o.get("type"),a=o.get("range");if(It(s)&&bu(a)){const l=yx(this.child,i),u=WA(l);u?(t.push(u),n.push("distinct"),r.push(`distinct_${u}`)):q(H$(i))}}}return{fields:t,ops:n,as:r}}assembleFacet(){const{name:t,data:n}=this.component.data.facetRoot,{row:r,column:i}=this.facet,{fields:o,ops:s,as:a}=this.getCardinalityAggregateForChild(),l=[];for(const c of jr){const f=this.facet[c];if(f){l.push(Q(f));const{bin:d,sort:h}=f;if(Ve(d)&&l.push(Q(f,{binSuffix:"end"})),is(h)){const{field:p,op:g=tx}=h,y=LS(f,h);r&&i?(o.push(y),s.push("max"),a.push(y)):(o.push(p),s.push(g),a.push(y))}else if(j(h)){const p=ff(f,c);o.push(p),s.push("max"),a.push(p)}}}const u=!!r&&!!i;return{name:t,data:n,groupby:l,...u||o.length>0?{aggregate:{...u?{cross:u}:{},...o.length?{fields:o,ops:s,as:a}:{}}}:{}}}facetSortFields(t){const{facet:n}=this,r=n[t];return r?is(r.sort)?[LS(r,r.sort,{expr:"datum"})]:j(r.sort)?[ff(r,t,{expr:"datum"})]:[Q(r,{expr:"datum"})]:[]}facetSortOrder(t){const{facet:n}=this,r=n[t];if(r){const{sort:i}=r;return[(is(i)?i.order:!j(i)&&i)||"ascending"]}return[]}assembleLabelTitle(){var i;const{facet:t,config:n}=this;if(t.facet)return MS(t.facet,"facet",n);const r={row:["top","bottom"],column:["left","right"]};for(const o of OA)if(t[o]){const s=df("labelOrient",(i=t[o])==null?void 0:i.header,n,o);if(r[o].includes(s))return MS(t[o],o,n)}}assembleMarks(){const{child:t}=this,n=this.component.data.facetRoot,r=Jwe(n),i=t.assembleGroupEncodeEntry(!1),o=this.assembleLabelTitle()||t.assembleTitle(),s=t.assembleGroupStyle();return[{name:this.getName("cell"),type:"group",...o?{title:o}:{},...s?{style:s}:{},from:{facet:this.assembleFacet()},sort:{field:jr.map(l=>this.facetSortFields(l)).flat(),order:jr.map(l=>this.facetSortOrder(l)).flat()},...r.length>0?{data:r}:{},...i?{encode:{update:i}}:{},...t.assembleGroup(xxe(this,[]))}]}getMapping(){return this.facet}}function lbe(e,t){const{row:n,column:r}=t;if(n&&r){let i=null;for(const o of[n,r])if(is(o.sort)){const{field:s,op:a=tx}=o.sort;e=i=new Cu(e,{joinaggregate:[{op:a,field:s,as:LS(o,o.sort,{forAs:!0})}],groupby:[Q(o)]})}return i}return null}function PW(e,t){var n,r,i,o;for(const s of t){const a=s.data;if(e.name&&s.hasName()&&e.name!==s.dataName)continue;const l=(n=e.format)==null?void 0:n.mesh,u=(r=a.format)==null?void 0:r.feature;if(l&&u)continue;const c=(i=e.format)==null?void 0:i.feature;if((c||u)&&c!==u)continue;const f=(o=a.format)==null?void 0:o.mesh;if(!((l||f)&&l!==f)){if(fp(e)&&fp(a)){if(yr(e.values,a.values))return s}else if(lf(e)&&lf(a)){if(e.url===a.url)return s}else if(kU(e)&&e.name===s.dataName)return s}}return null}function ube(e,t){if(e.data||!e.parent){if(e.data===null){const r=new su({values:[]});return t.push(r),r}const n=PW(e.data,t);if(n)return da(e.data)||(n.data.format=wj({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{const r=new su(e.data);return t.push(r),r}}else return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}function cbe(e,t,n){let r=0;for(const i of t.transforms){let o,s;if(Zve(i))s=e=new cf(e,i),o="derived";else if(AA(i)){const a=ewe(i);s=e=pn.makeWithAncestors(e,{},a,n)??e,e=new If(e,t,i.filter)}else if(wU(i))s=e=lo.makeFromTransform(e,i,t),o="number";else if(exe(i))o="date",n.getWithExplicit(i.field).value===void 0&&(e=new pn(e,{[i.field]:o}),n.set(i.field,o,!1)),s=e=ao.makeFromTransform(e,i);else if(txe(i))s=e=Si.makeFromTransform(e,i),o="number",DA(t)&&(e=new Ma(e));else if(xU(i))s=e=hp.make(e,t,i,r++),o="derived";else if(Xve(i))s=e=new Bf(e,i),o="number";else if(Qve(i))s=e=new Cu(e,i),o="number";else if(nxe(i))s=e=ss.makeFromTransform(e,i),o="derived";else if(rxe(i))s=e=new bx(e,i),o="derived";else if(ixe(i))s=e=new xx(e,i),o="derived";else if(Kve(i))s=e=new wx(e,i),o="derived";else if(Wve(i))s=e=new kx(e,i),o="derived";else if(Yve(i))e=new Cx(e,i);else if(Jve(i))s=e=Dl.makeFromTransform(e,i),o="derived";else if(qve(i))s=e=new vx(e,i),o="derived";else if(Hve(i))s=e=new Sx(e,i),o="derived";else if(Vve(i))s=e=new _x(e,i),o="derived";else if(Gve(i))s=e=new Ex(e,i),o="derived";else{q(Eme(i));continue}if(s&&o!==void 0)for(const a of s.producedFields()??[])n.set(a,o,!1)}return e}function $x(e){var y;let t=ube(e,e.component.data.sources);const{outputNodes:n,outputNodeRefCounts:r}=e.component.data,i=e.data,s=!(i&&(da(i)||lf(i)||fp(i)))&&e.parent?e.parent.component.data.ancestorParse.clone():new mxe;da(i)?(CU(i)?t=new fg(t,i.sequence):FA(i)&&(t=new cg(t,i.graticule)),s.parseNothing=!0):((y=i==null?void 0:i.format)==null?void 0:y.parse)===null&&(s.parseNothing=!0),t=pn.makeExplicit(t,e,s)??t,t=new Ma(t);const a=e.parent&&Uf(e.parent);(rt(e)||br(e))&&a&&(t=lo.makeFromEncoding(t,e)??t),e.transforms.length>0&&(t=cbe(t,e,s));const l=nwe(e),u=twe(e);t=pn.makeWithAncestors(t,{},{...l,...u},s)??t,rt(e)&&(t=Sc.parseAll(t,e),t=dp.parseAll(t,e)),(rt(e)||br(e))&&(a||(t=lo.makeFromEncoding(t,e)??t),t=ao.makeFromEncoding(t,e)??t,t=cf.parseAllForSortIndex(t,e));const c=t=u0(ct.Raw,e,t);if(rt(e)){const m=Si.makeFromEncoding(t,e);m&&(t=m,DA(e)&&(t=new Ma(t))),t=Dl.makeFromEncoding(t,e)??t,t=ss.makeFromEncoding(t,e)??t}let f,d;if(rt(e)){const{markDef:m,mark:v,config:x}=e,w=je("invalid",m,x),{marks:b,scales:S}=d=AU({invalid:w,isPath:Ga(v)});b!==S&&S==="include-invalid-values"&&(f=t=u0(ct.PreFilterInvalid,e,t)),b==="exclude-invalid-values"&&(t=hf.make(t,e,d)??t)}const h=t=u0(ct.Main,e,t);let p;if(rt(e)&&d){const{marks:m,scales:v}=d;m==="include-invalid-values"&&v==="exclude-invalid-values"&&(t=hf.make(t,e,d)??t,p=t=u0(ct.PostFilterInvalid,e,t))}rt(e)&&Kxe(e,h);let g=null;if(br(e)){const m=e.getName("facet");t=lbe(t,e.facet)??t,g=new jf(t,e,m,h.getSource()),n[m]=g}return{...e.component.data,outputNodes:n,outputNodeRefCounts:r,raw:c,main:h,facetRoot:g,ancestorParse:s,preFilterInvalid:f,postFilterInvalid:p}}function u0(e,t,n){const{outputNodes:r,outputNodeRefCounts:i}=t.component.data,o=t.getDataName(e),s=new er(n,o,e,i);return r[o]=s,s}class fbe extends HA{constructor(t,n,r,i){var o,s,a,l;super(t,"concat",n,r,i,t.resolve),(((s=(o=t.resolve)==null?void 0:o.axis)==null?void 0:s.x)==="shared"||((l=(a=t.resolve)==null?void 0:a.axis)==null?void 0:l.y)==="shared")&&q(xme),this.children=this.getChildren(t).map((u,c)=>KA(u,this,this.getName(`concat_${c}`),void 0,i))}parseData(){this.component.data=$x(this);for(const t of this.children)t.parseData()}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of B(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){for(const t of this.children)t.parseAxesAndHeaders()}getChildren(t){return lx(t)?t.vconcat:CA(t)?t.hconcat:t.concat}parseLayoutSize(){obe(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,r)=>r.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.forEach(t=>t.assembleSignals()),[]}assembleLayoutSignals(){const t=LA(this);for(const n of this.children)t.push(...n.assembleLayoutSignals());return t}assembleSelectionData(t){return this.children.reduce((n,r)=>r.assembleSelectionData(n),t)}assembleMarks(){return this.children.map(t=>{const n=t.assembleTitle(),r=t.assembleGroupStyle(),i=t.assembleGroupEncodeEntry(!1);return{type:"group",name:t.getName("group"),...n?{title:n}:{},...r?{style:r}:{},...i?{encode:{update:i}}:{},...t.assembleGroup()}})}assembleGroupStyle(){}assembleDefaultLayout(){const t=this.layout.columns;return{...t!=null?{columns:t}:{},bounds:"full",align:"each"}}}function dbe(e){return e===!1||e===null}const hbe={disable:1,gridScale:1,scale:1,...WB,labelExpr:1,encode:1},LW=B(hbe);class GA extends ks{constructor(t={},n={},r=!1){super(),this.explicit=t,this.implicit=n,this.mainExtracted=r}clone(){return new GA(de(this.explicit),de(this.implicit),this.mainExtracted)}hasAxisPart(t){return t==="axis"?!0:t==="grid"||t==="title"?!!this.get(t):!dbe(this.get(t))}hasOrientSignalRef(){return oe(this.explicit.orient)}}function pbe(e,t,n){const{encoding:r,config:i}=e,o=_t(r[t])??_t(r[Mo(t)]),s=e.axis(t)||{},{format:a,formatType:l}=s;if(ru(l))return{text:xi({fieldOrDatumDef:o,field:"datum.value",format:a,formatType:l,config:i}),...n};if(a===void 0&&l===void 0&&i.customFormatTypes){if(of(o)==="quantitative"){if(sf(o)&&o.stack==="normalize"&&i.normalizedNumberFormatType)return{text:xi({fieldOrDatumDef:o,field:"datum.value",format:i.normalizedNumberFormat,formatType:i.normalizedNumberFormatType,config:i}),...n};if(i.numberFormatType)return{text:xi({fieldOrDatumDef:o,field:"datum.value",format:i.numberFormat,formatType:i.numberFormatType,config:i}),...n}}if(of(o)==="temporal"&&i.timeFormatType&&H(o)&&!o.timeUnit)return{text:xi({fieldOrDatumDef:o,field:"datum.value",format:i.timeFormat,formatType:i.timeFormatType,config:i}),...n}}return n}function gbe(e){return Ss.reduce((t,n)=>(e.component.scales[n]&&(t[n]=[Ebe(n,e)]),t),{})}const mbe={bottom:"top",top:"bottom",left:"right",right:"left"};function ybe(e){const{axes:t,resolve:n}=e.component,r={top:0,bottom:0,right:0,left:0};for(const i of e.children){i.parseAxesAndHeaders();for(const o of B(i.component.axes))n.axis[o]=zA(e.component.resolve,o),n.axis[o]==="shared"&&(t[o]=vbe(t[o],i.component.axes[o]),t[o]||(n.axis[o]="independent",delete t[o]))}for(const i of Ss){for(const o of e.children)if(o.component.axes[i]){if(n.axis[i]==="independent"){t[i]=(t[i]??[]).concat(o.component.axes[i]);for(const s of o.component.axes[i]){const{value:a,explicit:l}=s.getWithExplicit("orient");if(!oe(a)){if(r[a]>0&&!l){const u=mbe[a];r[a]>r[u]&&s.set("orient",u,!1)}r[a]++}}}delete o.component.axes[i]}if(n.axis[i]==="independent"&&t[i]&&t[i].length>1)for(const[o,s]of(t[i]||[]).entries())o>0&&s.get("grid")&&!s.explicit.grid&&(s.implicit.grid=!1)}}function vbe(e,t){if(e){if(e.length!==t.length)return;const n=e.length;for(let r=0;r<n;r++){const i=e[r],o=t[r];if(!!i!=!!o)return;if(i&&o){const s=i.getWithExplicit("orient"),a=o.getWithExplicit("orient");if(s.explicit&&a.explicit&&s.value!==a.value)return;e[r]=xbe(i,o)}}}else return t.map(n=>n.clone());return e}function xbe(e,t){for(const n of LW){const r=Aa(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(i,o)=>{switch(n){case"title":return Gj(i,o);case"gridScale":return{explicit:i.explicit,value:pt(i.value,o.value)}}return cx(i,o,n,"axis")});e.setWithExplicit(n,r)}return e}function wbe(e,t,n,r,i){if(t==="disable")return n!==void 0;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(oe(n.labelAngle)?n.labelAngle:up(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===nW(r,i))return!0}return e===n[t]}const bbe=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function Ebe(e,t){var m,v;let n=t.axis(e);const r=new GA,i=_t(t.encoding[e]),{mark:o,config:s}=t,a=(n==null?void 0:n.orient)||((m=s[e==="x"?"axisX":"axisY"])==null?void 0:m.orient)||((v=s.axis)==null?void 0:v.orient)||a2e(e),l=t.getScaleComponent(e).get("type"),u=e2e(e,l,a,t.config),c=n!==void 0?!n:AS("disable",s.style,n==null?void 0:n.style,u).configValue;if(r.set("disable",c,n!==void 0),c)return r;n=n||{};const f=i2e(i,n,e,s.style,u),d=FB(n.formatType,i,l),h=AB(i,i.type,n.format,n.formatType,s,!0),p={fieldOrDatumDef:i,axis:n,channel:e,model:t,scaleType:l,orient:a,labelAngle:f,format:h,formatType:d,mark:o,config:s};for(const x of LW){const w=x in K8?K8[x](p):S8(x)?n[x]:void 0,b=w!==void 0,S=wbe(w,x,n,t,e);if(b&&S)r.set(x,w,S);else{const{configValue:E=void 0,configFrom:_=void 0}=S8(x)&&x!=="values"?AS(x,s.style,n.style,u):{},k=E!==void 0;b&&!k?r.set(x,w,S):(_!=="vgAxisConfig"||bbe.has(x)&&k||lg(E)||oe(E))&&r.set(x,E,!1)}}const g=n.encoding??{},y=UB.reduce((x,w)=>{if(!r.hasAxisPart(w))return x;const b=lW(g[w]??{},t),S=w==="labels"?pbe(t,e,b):b;return S!==void 0&&!Be(S)&&(x[w]={update:S}),x},{});return Be(y)||r.set("encode",y,!!n.encoding||n.labelAngle!==void 0),r}function Sbe({encoding:e,size:t}){for(const n of Ss){const r=sr(n);xo(t[r])&&Zs(e[n])&&(delete t[r],q(Zj(r)))}return t}const _be={vgMark:"arc",encodeEntry:e=>({...ti(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...Nn("x",e,{defaultPos:"mid"}),...Nn("y",e,{defaultPos:"mid"}),...gs(e,"radius"),...gs(e,"theta")})},kbe={vgMark:"area",encodeEntry:e=>({...ti(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"}),...ty("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="horizontal"}),...ty("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="vertical"}),...RA(e)})},Cbe={vgMark:"rect",encodeEntry:e=>({...ti(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...gs(e,"x"),...gs(e,"y")})},$be={vgMark:"shape",encodeEntry:e=>({...ti(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})}),postEncodingTransform:e=>{const{encoding:t}=e,n=t.shape;return[{type:"geoshape",projection:e.projectionName(),...n&&H(n)&&n.type===Lf?{field:Q(n,{expr:"datum"})}:{}}]}},Abe={vgMark:"image",encodeEntry:e=>({...ti(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"}),...gs(e,"x"),...gs(e,"y"),...TA(e,"url")})},Fbe={vgMark:"line",encodeEntry:e=>({...ti(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...Nn("x",e,{defaultPos:"mid"}),...Nn("y",e,{defaultPos:"mid"}),...Gt("size",e,{vgChannel:"strokeWidth"}),...RA(e)})},Mbe={vgMark:"trail",encodeEntry:e=>({...ti(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...Nn("x",e,{defaultPos:"mid"}),...Nn("y",e,{defaultPos:"mid"}),...Gt("size",e),...RA(e)})};function YA(e,t){const{config:n}=e;return{...ti(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...Nn("x",e,{defaultPos:"mid"}),...Nn("y",e,{defaultPos:"mid"}),...Gt("size",e),...Gt("angle",e),...Tbe(e,n,t)}}function Tbe(e,t,n){return n?{shape:{value:n}}:Gt("shape",e)}const Nbe={vgMark:"symbol",encodeEntry:e=>YA(e)},Rbe={vgMark:"symbol",encodeEntry:e=>YA(e,"circle")},Dbe={vgMark:"symbol",encodeEntry:e=>YA(e,"square")},Obe={vgMark:"rect",encodeEntry:e=>({...ti(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...gs(e,"x"),...gs(e,"y")})},Pbe={vgMark:"rule",encodeEntry:e=>{const{markDef:t}=e,n=t.orient;return!e.encoding.x&&!e.encoding.y&&!e.encoding.latitude&&!e.encoding.longitude?{}:{...ti(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...ty("x",e,{defaultPos:n==="horizontal"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="vertical"}),...ty("y",e,{defaultPos:n==="vertical"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="horizontal"}),...Gt("size",e,{vgChannel:"strokeWidth"})}}},Lbe={vgMark:"text",encodeEntry:e=>{const{config:t,encoding:n}=e;return{...ti(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"}),...Nn("x",e,{defaultPos:"mid"}),...Nn("y",e,{defaultPos:"mid"}),...TA(e),...Gt("size",e,{vgChannel:"fontSize"}),...Gt("angle",e),...G8("align",zbe(e.markDef,n,t)),...G8("baseline",Ibe(e.markDef,n,t)),...Nn("radius",e,{defaultPos:null}),...Nn("theta",e,{defaultPos:null})}}};function zbe(e,t,n){if(je("align",e,n)===void 0)return"center"}function Ibe(e,t,n){if(je("baseline",e,n)===void 0)return"middle"}const jbe={vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:n}=e,r=n.orient,i=r==="horizontal"?"x":"y",o=r==="horizontal"?"y":"x",s=r==="horizontal"?"height":"width";return{...ti(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...gs(e,i),...Nn(o,e,{defaultPos:"mid",vgChannel:o==="y"?"yc":"xc"}),[s]:Xe(je("thickness",n,t))}}},c0={arc:_be,area:kbe,bar:Cbe,circle:Rbe,geoshape:$be,image:Abe,line:Fbe,point:Nbe,rect:Obe,rule:Pbe,square:Dbe,text:Lbe,tick:jbe,trail:Mbe};function Bbe(e){if(Ee([Jv,Kv,X1e],e.mark)){const t=XB(e.mark,e.encoding);if(t.length>0)return Ube(e,t)}else if(e.mark===Zv){const t=pS.some(n=>je(n,e.markDef,e.config));if(e.stack&&!e.fieldDef("size")&&t)return Wbe(e)}return XA(e)}const hT="faceted_path_";function Ube(e,t){return[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:hT+e.requestDataName(ct.Main),data:e.requestDataName(ct.Main),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:XA(e,{fromPrefix:hT})}]}const pT="stack_group_";function Wbe(e){var u;const[t]=XA(e,{fromPrefix:pT}),n=e.scaleName(e.stack.fieldChannel),r=(c={})=>e.vgField(e.stack.fieldChannel,c),i=(c,f)=>{const d=[r({prefix:"min",suffix:"start",expr:f}),r({prefix:"max",suffix:"start",expr:f}),r({prefix:"min",suffix:"end",expr:f}),r({prefix:"max",suffix:"end",expr:f})];return`${c}(${d.map(h=>`scale('${n}',${h})`).join(",")})`};let o,s;e.stack.fieldChannel==="x"?(o={...Kc(t.encode.update,["y","yc","y2","height",...pS]),x:{signal:i("min","datum")},x2:{signal:i("max","datum")},clip:{value:!0}},s={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},t.encode.update={...Jn(t.encode.update,["y","yc","y2"]),height:{field:{group:"height"}}}):(o={...Kc(t.encode.update,["x","xc","x2","width"]),y:{signal:i("min","datum")},y2:{signal:i("max","datum")},clip:{value:!0}},s={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},t.encode.update={...Jn(t.encode.update,["x","xc","x2"]),width:{field:{group:"width"}}});for(const c of pS){const f=yo(c,e.markDef,e.config);t.encode.update[c]?(o[c]=t.encode.update[c],delete t.encode.update[c]):f&&(o[c]=Xe(f)),f&&(t.encode.update[c]={value:0})}const a=[];if(((u=e.stack.groupbyChannels)==null?void 0:u.length)>0)for(const c of e.stack.groupbyChannels){const f=e.fieldDef(c),d=Q(f);d&&a.push(d),(f!=null&&f.bin||f!=null&&f.timeUnit)&&a.push(Q(f,{binSuffix:"end"}))}return o=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((c,f)=>{if(t.encode.update[f])return{...c,[f]:t.encode.update[f]};{const d=yo(f,e.markDef,e.config);return d!==void 0?{...c,[f]:Xe(d)}:c}},o),o.stroke&&(o.strokeForeground={value:!0},o.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(ct.Main),name:pT+e.requestDataName(ct.Main),groupby:a,aggregate:{fields:[r({suffix:"start"}),r({suffix:"start"}),r({suffix:"end"}),r({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:o},marks:[{type:"group",encode:{update:s},marks:[t]}]}]}function qbe(e){const{encoding:t,stack:n,mark:r,markDef:i,config:o}=e,s=t.order;if(!(!j(s)&&Fi(s)&&dS(s.value)||!s&&dS(je("order",i,o)))){if((j(s)||H(s))&&!n)return qj(s,{expr:"datum"});if(Ga(r)){const a=i.orient==="horizontal"?"y":"x",l=t[a];if(H(l))return{field:a}}}}function XA(e,t={fromPrefix:""}){const{mark:n,markDef:r,encoding:i,config:o}=e,s=pt(r.clip,Hbe(e),Vbe(e)),a=Uj(r),l=i.key,u=qbe(e),c=Gbe(e),f=je("aria",r,o),d=c0[n].postEncodingTransform?c0[n].postEncodingTransform(e):null;return[{name:e.getName("marks"),type:c0[n].vgMark,...s?{clip:s}:{},...a?{style:a}:{},...l?{key:l.field}:{},...u?{sort:u}:{},...c||{},...f===!1?{aria:f}:{},from:{data:t.fromPrefix+e.requestDataName(ct.Main)},encode:{update:c0[n].encodeEntry(e)},...d?{transform:d}:{}}]}function Hbe(e){const t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return t!=null&&t.get("selectionExtent")||n!=null&&n.get("selectionExtent")?!0:void 0}function Vbe(e){const t=e.component.projection;return t&&!t.isFit?!0:void 0}function Gbe(e){if(!e.component.selection)return null;const t=B(e.component.selection).length;let n=t,r=e.parent;for(;r&&n===0;)n=B(r.component.selection).length,r=r.parent;return n?{interactive:t>0||e.mark==="geoshape"||!!e.encoding.tooltip||!!e.markDef.tooltip}:null}class zW extends RW{constructor(t,n,r,i={},o){super(t,"unit",n,r,o,void 0,k8(t)?t.view:void 0),this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection=[],this.children=[];const s=vo(t.mark)?{...t.mark}:{type:t.mark},a=s.type;s.filled===void 0&&(s.filled=Nve(s,o,{graticule:t.data&&FA(t.data)}));const l=this.encoding=Pye(t.encoding||{},a,s.filled,o);this.markDef=mU(s,l,o),this.size=Sbe({encoding:l,size:k8(t)?{...i,...t.width?{width:t.width}:{},...t.height?{height:t.height}:{}}:i}),this.stack=gU(this.markDef,l),this.specifiedScales=this.initScales(a,l),this.specifiedAxes=this.initAxes(l),this.specifiedLegends=this.initLegends(l),this.specifiedProjection=t.projection,this.selection=(t.params??[]).filter(u=>_A(u))}get hasProjection(){const{encoding:t}=this,n=this.mark===bB,r=t&&N0e.some(i=>he(t[i]));return n||r}scaleDomain(t){const n=this.specifiedScales[t];return n?n.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,n){return U$.reduce((r,i)=>{const o=_t(n[i]);return o&&(r[i]=this.initScale(o.scale??{})),r},{})}initScale(t){const{domain:n,range:r}=t,i=Ht(t);return j(n)&&(i.domain=n.map(hr)),j(r)&&(i.range=r.map(hr)),i}initAxes(t){return Ss.reduce((n,r)=>{const i=t[r];if(he(i)||r===et&&he(t.x2)||r===Bt&&he(t.y2)){const o=he(i)?i.axis:void 0;n[r]=o&&this.initAxis({...o})}return n},{})}initAxis(t){const n=B(t),r={};for(const i of n){const o=t[i];r[i]=lg(o)?Bj(o):hr(o)}return r}initLegends(t){return U0e.reduce((n,r)=>{const i=_t(t[r]);if(i&&q0e(r)){const o=i.legend;n[r]=o&&Ht(o)}return n},{})}parseData(){this.component.data=$x(this)}parseLayoutSize(){sbe(this)}parseSelections(){this.component.selection=Qxe(this,this.selection)}parseMarkGroup(){this.component.mark=Bbe(this)}parseAxesAndHeaders(){this.component.axes=gbe(this)}assembleSelectionTopLevelSignals(t){return wxe(this,t)}assembleSignals(){return[...JU(this),...vxe(this,[])]}assembleSelectionData(t){return bxe(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return LA(this)}assembleMarks(){let t=this.component.mark??[];return(!this.parent||!Uf(this.parent))&&(t=MU(this,t)),t.map(this.correctDataNames)}assembleGroupStyle(){const{style:t}=this.view||{};return t!==void 0?t:this.encoding.x||this.encoding.y?"cell":"view"}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(t){return Nl(this.encoding,t)}fieldDef(t){const n=this.encoding[t];return Mi(n)}typedFieldDef(t){const n=this.fieldDef(t);return zn(n)?n:null}}class QA extends HA{constructor(t,n,r,i,o){super(t,"layer",n,r,o,t.resolve,t.view);const s={...i,...t.width?{width:t.width}:{},...t.height?{height:t.height}:{}};this.children=t.layer.map((a,l)=>{if(ux(a))return new QA(a,this,this.getName(`layer_${l}`),s,o);if(_s(a))return new zW(a,this,this.getName(`layer_${l}`),s,o);throw new Error(q$(a))})}parseData(){this.component.data=$x(this);for(const t of this.children)t.parseData()}parseLayoutSize(){ibe(this)}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of B(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){ybe(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,r)=>r.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleSignals()),JU(this))}assembleLayoutSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleLayoutSignals()),LA(this))}assembleSelectionData(t){return this.children.reduce((n,r)=>r.assembleSelectionData(n),t)}assembleGroupStyle(){const t=new Set;for(const r of this.children)for(const i of J(r.assembleGroupStyle()))t.add(i);const n=Array.from(t);return n.length>1?n:n.length===1?n[0]:void 0}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(const n of this.children)if(t=n.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return Exe(this,this.children.flatMap(t=>t.assembleMarks()))}assembleLegends(){return this.children.reduce((t,n)=>t.concat(n.assembleLegends()),mW(this))}}function KA(e,t,n,r,i){if(nx(e))return new wh(e,t,n,i);if(ux(e))return new QA(e,t,n,r,i);if(_s(e))return new zW(e,t,n,r,i);if(sve(e))return new fbe(e,t,n,i);throw new Error(q$(e))}function Ybe(e,t={}){t.logger&&u1e(t.logger),t.fieldTitle&&IB(t.fieldTitle);try{const n=pU(xf(t.config,e.config)),r=SU(e,n),i=KA(r,null,"",void 0,n);return i.parse(),vwe(i.component.data,i),{spec:Qbe(i,Xbe(e,r.autosize,n,i),e.datasets,e.usermeta),normalized:r}}finally{t.logger&&c1e(),t.fieldTitle&&$ye()}}function Xbe(e,t,n,r){const i=r.component.layoutSize.get("width"),o=r.component.layoutSize.get("height");if(t===void 0?(t={type:"pad"},r.hasAxisOrientSignalRef()&&(t.resize=!0)):ee(t)&&(t={type:t}),i&&o&&hxe(t.type)){if(i==="step"&&o==="step")q(u8()),t.type="pad";else if(i==="step"||o==="step"){const s=i==="step"?"width":"height";q(u8(Hv(s)));const a=s==="width"?"height":"width";t.type=pxe(a)}}return{...B(t).length===1&&t.type?t.type==="pad"?{}:{autosize:t.type}:{autosize:t},...L8(n,!1),...L8(e,!0)}}function Qbe(e,t,n={},r){const i=e.config?wve(e.config):void 0,o=[].concat(e.assembleSelectionData([]),ebe(e.component.data,n)),s=e.assembleProjections(),a=e.assembleTitle(),l=e.assembleGroupStyle(),u=e.assembleGroupEncodeEntry(!0);let c=e.assembleLayoutSignals();c=c.filter(h=>(h.name==="width"||h.name==="height")&&h.value!==void 0?(t[h.name]=+h.value,!1):!0);const{params:f,...d}=t;return{$schema:"https://vega.github.io/schema/vega/v5.json",...e.description?{description:e.description}:{},...d,...a?{title:a}:{},...l?{style:l}:{},...u?{encode:{update:u}}:{},data:o,...s.length>0?{projections:s}:{},...e.assembleGroup([...c,...e.assembleSelectionTopLevelSignals([]),...cU(f)]),...i?{config:i}:{},...r?{usermeta:r}:{}}}const Kbe=C0e.version,Zbe=Object.freeze(Object.defineProperty({__proto__:null,accessPathDepth:Jc,accessPathWithDatum:D$,compile:Ybe,contains:Ee,deepEqual:yr,deleteNestedProperty:H1,duplicate:de,entries:ka,every:T$,fieldIntersection:R$,flatAccessWithDatum:Ej,getFirstDefined:pt,hasIntersection:N$,hasProperty:W,hash:_e,internalField:kj,isBoolean:lp,isEmpty:Be,isEqual:A0e,isInternalField:Cj,isNullOrFalse:dS,isNumeric:Iv,keys:B,logicalExpr:vh,mergeDeep:wj,never:xj,normalize:SU,normalizeAngle:up,omit:Jn,pick:Kc,prefixGenerator:hS,removePathFromField:Of,replaceAll:Zl,replacePathInField:Kr,resetIdCounter:M0e,setEqual:bj,some:Zc,stringify:Ue,titleCase:Kp,unique:eo,uniqueId:_j,vals:Zt,varName:Je,version:Kbe},Symbol.toStringTag,{value:"Module"}));function IW(e){const[t,n]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:t,version:n}}var Jbe="vega-themes",eEe="2.15.0",tEe="Themes for stylized Vega and Vega-Lite visualizations.",nEe=["vega","vega-lite","themes","style"],rEe="BSD-3-Clause",iEe={name:"UW Interactive Data Lab",url:"https://idl.cs.washington.edu"},oEe=[{name:"Emily Gu",url:"https://github.com/emilygu"},{name:"Arvind Satyanarayan",url:"http://arvindsatya.com"},{name:"Jeffrey Heer",url:"https://idl.cs.washington.edu"},{name:"Dominik Moritz",url:"https://www.domoritz.de"}],sEe="build/vega-themes.js",ZA="build/vega-themes.module.js",aEe="build/vega-themes.min.js",lEe="build/vega-themes.min.js",uEe="build/vega-themes.module.d.ts",cEe={type:"git",url:"https://github.com/vega/vega-themes.git"},fEe=["src","build"],dEe={prebuild:"yarn clean",build:"rollup -c",clean:"rimraf build && rimraf examples/build","copy:data":"rsync -r node_modules/vega-datasets/data/* examples/data","copy:build":"rsync -r build/* examples/build","deploy:gh":"yarn build && mkdir -p examples/build && rsync -r build/* examples/build && gh-pages -d examples",preversion:"yarn lint",serve:"browser-sync start -s -f build examples --serveStatic examples",start:"yarn build && concurrently --kill-others -n Server,Rollup 'yarn serve' 'rollup -c -w'",format:"eslint . --fix",lint:"eslint .",release:"release-it"},hEe={"@babel/core":"^7.24.6","@babel/plugin-transform-runtime":"^7.24.6","@babel/preset-env":"^7.24.6","@babel/preset-typescript":"^7.24.6","@release-it/conventional-changelog":"^8.0.1","@rollup/plugin-json":"^6.1.0","@rollup/plugin-node-resolve":"^15.2.3","@rollup/plugin-terser":"^0.4.4","@typescript-eslint/eslint-plugin":"^7.11.0","@typescript-eslint/parser":"^7.11.0","browser-sync":"^3.0.2",concurrently:"^8.2.2",eslint:"^8.45.0","eslint-config-prettier":"^9.1.0","eslint-plugin-prettier":"^5.1.3","gh-pages":"^6.1.1",prettier:"^3.2.5","release-it":"^17.3.0",rollup:"^4.18.0","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-ts":"^3.4.5",typescript:"^5.4.5",vega:"^5.25.0","vega-lite":"^5.9.3"},pEe={vega:"*","vega-lite":"*"},gEe={},mEe={name:Jbe,version:eEe,description:tEe,keywords:nEe,license:rEe,author:iEe,contributors:oEe,main:sEe,module:ZA,unpkg:aEe,jsdelivr:lEe,types:uEe,repository:cEe,files:fEe,scripts:dEe,devDependencies:hEe,peerDependencies:pEe,dependencies:gEe};const Iu="#fff",gT="#888",yEe={background:"#333",view:{stroke:gT},title:{color:Iu,subtitleColor:Iu},style:{"guide-label":{fill:Iu},"guide-title":{fill:Iu}},axis:{domainColor:Iu,gridColor:gT,tickColor:Iu}},Za="#4572a7",vEe={background:"#fff",arc:{fill:Za},area:{fill:Za},line:{stroke:Za,strokeWidth:2},path:{stroke:Za},rect:{fill:Za},shape:{stroke:Za},symbol:{fill:Za,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},Ja="#30a2da",bw="#cbcbcb",xEe="#999",wEe="#333",mT="#f0f0f0",yT="#333",bEe={arc:{fill:Ja},area:{fill:Ja},axis:{domainColor:bw,grid:!0,gridColor:bw,gridWidth:1,labelColor:xEe,labelFontSize:10,titleColor:wEe,tickColor:bw,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:mT,group:{fill:mT},legend:{labelColor:yT,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:yT,titleFontSize:14,titlePadding:10},line:{stroke:Ja,strokeWidth:2},path:{stroke:Ja,strokeWidth:.5},rect:{fill:Ja},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:Ja},bar:{binSpacing:2,fill:Ja,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},el="#000",EEe={group:{fill:"#e5e5e5"},arc:{fill:el},area:{fill:el},line:{stroke:el},path:{stroke:el},rect:{fill:el},shape:{stroke:el},symbol:{fill:el,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},SEe=22,_Ee="normal",vT="Benton Gothic, sans-serif",xT=11.5,kEe="normal",tl="#82c6df",Ew="Benton Gothic Bold, sans-serif",wT="normal",bT=13,xd={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},CEe={background:"#ffffff",title:{anchor:"start",color:"#000000",font:Ew,fontSize:SEe,fontWeight:_Ee},arc:{fill:tl},area:{fill:tl},line:{stroke:tl,strokeWidth:2},path:{stroke:tl},rect:{fill:tl},shape:{stroke:tl},symbol:{fill:tl,size:30},axis:{labelFont:vT,labelFontSize:xT,labelFontWeight:kEe,titleFont:Ew,titleFontSize:bT,titleFontWeight:wT},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:vT,labelFontSize:xT,symbolType:"square",titleFont:Ew,titleFontSize:bT,titleFontWeight:wT},range:{category:xd["category-6"],diverging:xd["fireandice-6"],heatmap:xd["fire-7"],ordinal:xd["fire-7"],ramp:xd["fire-7"]}},nl="#ab5787",f0="#979797",$Ee={background:"#f9f9f9",arc:{fill:nl},area:{fill:nl},line:{stroke:nl},path:{stroke:nl},rect:{fill:nl},shape:{stroke:nl},symbol:{fill:nl,size:30},axis:{domainColor:f0,domainWidth:.5,gridWidth:.2,labelColor:f0,tickColor:f0,tickWidth:.2,titleColor:f0},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},rl="#3e5c69",AEe={background:"#fff",arc:{fill:rl},area:{fill:rl},line:{stroke:rl},path:{stroke:rl},rect:{fill:rl},shape:{stroke:rl},symbol:{fill:rl},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},Tr="#1696d2",ET="#000000",FEe="#FFFFFF",d0="Lato",Sw="Lato",MEe="Lato",TEe="#DEDDDD",NEe=18,wd={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},REe={background:FEe,title:{anchor:"start",fontSize:NEe,font:d0},axisX:{domain:!0,domainColor:ET,domainWidth:1,grid:!1,labelFontSize:12,labelFont:Sw,labelAngle:0,tickColor:ET,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:d0},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:TEe,gridWidth:1,labelFontSize:12,labelFont:Sw,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:d0,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:Sw,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:d0,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:wd["six-groups-cat-1"],diverging:wd["diverging-colors"],heatmap:wd["diverging-colors"],ordinal:wd["six-groups-seq"],ramp:wd["shades-blue"]},area:{fill:Tr},rect:{fill:Tr},line:{color:Tr,stroke:Tr,strokeWidth:5},trail:{color:Tr,stroke:Tr,strokeWidth:0,size:1},path:{stroke:Tr,strokeWidth:.5},point:{filled:!0},text:{font:MEe,color:Tr,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:Tr,stroke:null}},arc:{fill:Tr},shape:{stroke:Tr},symbol:{fill:Tr,size:30}},il="#3366CC",ST="#ccc",h0="Arial, sans-serif",DEe={arc:{fill:il},area:{fill:il},path:{stroke:il},rect:{fill:il},shape:{stroke:il},symbol:{stroke:il},circle:{fill:il},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:h0,fontSize:12},"guide-title":{font:h0,fontSize:12},"group-title":{font:h0,fontSize:12}},title:{font:h0,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:ST,tickColor:ST,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},JA=e=>e*(1/3+1),_T=JA(9),kT=JA(10),CT=JA(12),bd="Segoe UI",$T="wf_standard-font, helvetica, arial, sans-serif",AT="#252423",Ed="#605E5C",FT="transparent",OEe="#C8C6C4",oi="#118DFF",PEe="#12239E",LEe="#E66C37",zEe="#6B007B",IEe="#E044A7",jEe="#744EC2",BEe="#D9B300",UEe="#D64550",jW=oi,BW="#DEEFFF",MT=[BW,jW],WEe=[BW,"#c7e4ff","#b0d9ff","#9aceff","#83c3ff","#6cb9ff","#55aeff","#3fa3ff","#2898ff",jW],qEe={view:{stroke:FT},background:FT,font:bd,header:{titleFont:$T,titleFontSize:CT,titleColor:AT,labelFont:bd,labelFontSize:kT,labelColor:Ed},axis:{ticks:!1,grid:!1,domain:!1,labelColor:Ed,labelFontSize:_T,titleFont:$T,titleColor:AT,titleFontSize:CT,titleFontWeight:"normal"},axisQuantitative:{tickCount:3,grid:!0,gridColor:OEe,gridDash:[1,5],labelFlush:!1},axisBand:{tickExtra:!0},axisX:{labelPadding:5},axisY:{labelPadding:10},bar:{fill:oi},line:{stroke:oi,strokeWidth:3,strokeCap:"round",strokeJoin:"round"},text:{font:bd,fontSize:_T,fill:Ed},arc:{fill:oi},area:{fill:oi,line:!0,opacity:.6},path:{stroke:oi},rect:{fill:oi},point:{fill:oi,filled:!0,size:75},shape:{stroke:oi},symbol:{fill:oi,strokeWidth:1.5,size:50},legend:{titleFont:bd,titleFontWeight:"bold",titleColor:Ed,labelFont:bd,labelFontSize:kT,labelColor:Ed,symbolType:"circle",symbolSize:75},range:{category:[oi,PEe,LEe,zEe,IEe,jEe,BEe,UEe],diverging:MT,heatmap:MT,ordinal:WEe}},_w='IBM Plex Sans,system-ui,-apple-system,BlinkMacSystemFont,".sfnstext-regular",sans-serif',HEe='IBM Plex Sans Condensed, system-ui, -apple-system, BlinkMacSystemFont, ".SFNSText-Regular", sans-serif',kw=400,p0={textPrimary:{g90:"#f4f4f4",g100:"#f4f4f4",white:"#161616",g10:"#161616"},textSecondary:{g90:"#c6c6c6",g100:"#c6c6c6",white:"#525252",g10:"#525252"},layerAccent01:{white:"#e0e0e0",g10:"#e0e0e0",g90:"#525252",g100:"#393939"},gridBg:{white:"#ffffff",g10:"#ffffff",g90:"#161616",g100:"#161616"}},VEe=["#8a3ffc","#33b1ff","#007d79","#ff7eb6","#fa4d56","#fff1f1","#6fdc8c","#4589ff","#d12771","#d2a106","#08bdba","#bae6ff","#ba4e00","#d4bbff"],GEe=["#6929c4","#1192e8","#005d5d","#9f1853","#fa4d56","#570408","#198038","#002d9c","#ee538b","#b28600","#009d9a","#012749","#8a3800","#a56eff"];function Ax({theme:e,background:t}){const n=["white","g10"].includes(e)?"light":"dark",r=p0.gridBg[e],i=p0.textPrimary[e],o=p0.textSecondary[e],s=n==="dark"?VEe:GEe,a=n==="dark"?"#d4bbff":"#6929c4";return{background:t,arc:{fill:a},area:{fill:a},path:{stroke:a},rect:{fill:a},shape:{stroke:a},symbol:{stroke:a},circle:{fill:a},view:{fill:r,stroke:r},group:{fill:r},title:{color:i,anchor:"start",dy:-15,fontSize:16,font:_w,fontWeight:600},axis:{labelColor:o,labelFontSize:12,labelFont:HEe,labelFontWeight:kw,titleColor:i,titleFontWeight:600,titleFontSize:12,grid:!0,gridColor:p0.layerAccent01[e],labelAngle:0},axisX:{titlePadding:10},axisY:{titlePadding:2.5},style:{"guide-label":{font:_w,fill:o,fontWeight:kw},"guide-title":{font:_w,fill:o,fontWeight:kw}},range:{category:s,diverging:["#750e13","#a2191f","#da1e28","#fa4d56","#ff8389","#ffb3b8","#ffd7d9","#fff1f1","#e5f6ff","#bae6ff","#82cfff","#33b1ff","#1192e8","#0072c3","#00539a","#003a6d"],heatmap:["#f6f2ff","#e8daff","#d4bbff","#be95ff","#a56eff","#8a3ffc","#6929c4","#491d8b","#31135e","#1c0f30"]}}}const YEe=Ax({theme:"white",background:"#ffffff"}),XEe=Ax({theme:"g10",background:"#f4f4f4"}),QEe=Ax({theme:"g90",background:"#262626"}),KEe=Ax({theme:"g100",background:"#161616"}),ZEe=mEe.version,JEe=Object.freeze(Object.defineProperty({__proto__:null,carbong10:XEe,carbong100:KEe,carbong90:QEe,carbonwhite:YEe,dark:yEe,excel:vEe,fivethirtyeight:bEe,ggplot2:EEe,googlecharts:DEe,latimes:CEe,powerbi:qEe,quartz:$Ee,urbaninstitute:REe,version:ZEe,vox:AEe},Symbol.toStringTag,{value:"Module"}));function eSe(e,t,n,r){if(j(e))return`[${e.map(i=>t(ee(i)?i:TT(i,n))).join(", ")}]`;if(Z(e)){let i="";const{title:o,image:s,...a}=e;o&&(i+=`<h2>${t(o)}</h2>`),s&&(i+=`<img src="${new URL(t(s),r||location.href).href}">`);const l=Object.keys(a);if(l.length>0){i+="<table>";for(const u of l){let c=a[u];c!==void 0&&(Z(c)&&(c=TT(c,n)),i+=`<tr><td class="key">${t(u)}</td><td class="value">${t(c)}</td></tr>`)}i+="</table>"}return i||"{}"}return t(e)}function tSe(e){const t=[];return function(n,r){if(typeof r!="object"||r===null)return r;const i=t.indexOf(this)+1;return t.length=i,t.length>e?"[Object]":t.indexOf(r)>=0?"[Circular]":(t.push(r),r)}}function TT(e,t){return JSON.stringify(e,tSe(t))}var nSe=`#vg-tooltip-element {
  visibility: hidden;
  padding: 8px;
  position: fixed;
  z-index: 1000;
  font-family: sans-serif;
  font-size: 11px;
  border-radius: 3px;
  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
  /* The default theme is the light theme. */
  background-color: rgba(255, 255, 255, 0.95);
  border: 1px solid #d9d9d9;
  color: black;
}
#vg-tooltip-element.visible {
  visibility: visible;
}
#vg-tooltip-element h2 {
  margin-top: 0;
  margin-bottom: 10px;
  font-size: 13px;
}
#vg-tooltip-element table {
  border-spacing: 0;
}
#vg-tooltip-element table tr {
  border: none;
}
#vg-tooltip-element table tr td {
  overflow: hidden;
  text-overflow: ellipsis;
  padding-top: 2px;
  padding-bottom: 2px;
}
#vg-tooltip-element table tr td.key {
  color: #808080;
  max-width: 150px;
  text-align: right;
  padding-right: 4px;
}
#vg-tooltip-element table tr td.value {
  display: block;
  max-width: 300px;
  max-height: 7em;
  text-align: left;
}
#vg-tooltip-element.dark-theme {
  background-color: rgba(32, 32, 32, 0.9);
  border: 1px solid #f5f5f5;
  color: white;
}
#vg-tooltip-element.dark-theme td.key {
  color: #bfbfbf;
}
`;const UW="vg-tooltip-element",rSe={offsetX:10,offsetY:10,id:UW,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:iSe,maxDepth:2,formatTooltip:eSe,baseURL:""};function iSe(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")}function oSe(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return nSe.toString().replace(UW,e)}function sSe(e,t,n,r){let i=e.clientX+n;i+t.width>window.innerWidth&&(i=+e.clientX-n-t.width);let o=e.clientY+r;return o+t.height>window.innerHeight&&(o=+e.clientY-r-t.height),{x:i,y:o}}class aSe{constructor(t){this.options={...rSe,...t};const n=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const r=document.createElement("style");r.setAttribute("id",this.options.styleId),r.innerHTML=oSe(n);const i=document.head;i.childNodes.length>0?i.insertBefore(r,i.childNodes[0]):i.appendChild(r)}}tooltipHandler(t,n,r,i){if(this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),(document.fullscreenElement??document.body).appendChild(this.el)),i==null||i===""){this.el.classList.remove("visible",`${this.options.theme}-theme`);return}this.el.innerHTML=this.options.formatTooltip(i,this.options.sanitize,this.options.maxDepth,this.options.baseURL),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x:o,y:s}=sSe(n,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.style.top=`${s}px`,this.el.style.left=`${o}px`}}var Cw={};function lSe(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}class uSe{constructor(){this.max=1e3,this.map=new Map}get(t){const n=this.map.get(t);if(n!==void 0)return this.map.delete(t),this.map.set(t,n),n}delete(t){return this.map.delete(t)}set(t,n){if(!this.delete(t)&&n!==void 0){if(this.map.size>=this.max){const i=this.map.keys().next().value;this.delete(i)}this.map.set(t,n)}return this}}var cSe=uSe;const fSe=Object.freeze({loose:!0}),dSe=Object.freeze({}),hSe=e=>e?typeof e!="object"?fSe:e:dSe;var e5=hSe,zS={exports:{}};const pSe="2.0.0",WW=256,gSe=Number.MAX_SAFE_INTEGER||9007199254740991,mSe=16,ySe=WW-6,vSe=["major","premajor","minor","preminor","patch","prepatch","prerelease"];var t5={MAX_LENGTH:WW,MAX_SAFE_COMPONENT_LENGTH:mSe,MAX_SAFE_BUILD_LENGTH:ySe,MAX_SAFE_INTEGER:gSe,RELEASE_TYPES:vSe,SEMVER_SPEC_VERSION:pSe,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2};const xSe=typeof process=="object"&&Cw&&Cw.NODE_DEBUG&&/\bsemver\b/i.test(Cw.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};var Fx=xSe;(function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:n,MAX_SAFE_BUILD_LENGTH:r,MAX_LENGTH:i}=t5,o=Fx;t=e.exports={};const s=t.re=[],a=t.safeRe=[],l=t.src=[],u=t.t={};let c=0;const f="[a-zA-Z0-9-]",d=[["\\s",1],["\\d",i],[f,r]],h=g=>{for(const[y,m]of d)g=g.split(`${y}*`).join(`${y}{0,${m}}`).split(`${y}+`).join(`${y}{1,${m}}`);return g},p=(g,y,m)=>{const v=h(y),x=c++;o(g,x,y),u[g]=x,l[x]=y,s[x]=new RegExp(y,m?"g":void 0),a[x]=new RegExp(v,m?"g":void 0)};p("NUMERICIDENTIFIER","0|[1-9]\\d*"),p("NUMERICIDENTIFIERLOOSE","\\d+"),p("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${f}*`),p("MAINVERSION",`(${l[u.NUMERICIDENTIFIER]})\\.(${l[u.NUMERICIDENTIFIER]})\\.(${l[u.NUMERICIDENTIFIER]})`),p("MAINVERSIONLOOSE",`(${l[u.NUMERICIDENTIFIERLOOSE]})\\.(${l[u.NUMERICIDENTIFIERLOOSE]})\\.(${l[u.NUMERICIDENTIFIERLOOSE]})`),p("PRERELEASEIDENTIFIER",`(?:${l[u.NUMERICIDENTIFIER]}|${l[u.NONNUMERICIDENTIFIER]})`),p("PRERELEASEIDENTIFIERLOOSE",`(?:${l[u.NUMERICIDENTIFIERLOOSE]}|${l[u.NONNUMERICIDENTIFIER]})`),p("PRERELEASE",`(?:-(${l[u.PRERELEASEIDENTIFIER]}(?:\\.${l[u.PRERELEASEIDENTIFIER]})*))`),p("PRERELEASELOOSE",`(?:-?(${l[u.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${l[u.PRERELEASEIDENTIFIERLOOSE]})*))`),p("BUILDIDENTIFIER",`${f}+`),p("BUILD",`(?:\\+(${l[u.BUILDIDENTIFIER]}(?:\\.${l[u.BUILDIDENTIFIER]})*))`),p("FULLPLAIN",`v?${l[u.MAINVERSION]}${l[u.PRERELEASE]}?${l[u.BUILD]}?`),p("FULL",`^${l[u.FULLPLAIN]}$`),p("LOOSEPLAIN",`[v=\\s]*${l[u.MAINVERSIONLOOSE]}${l[u.PRERELEASELOOSE]}?${l[u.BUILD]}?`),p("LOOSE",`^${l[u.LOOSEPLAIN]}$`),p("GTLT","((?:<|>)?=?)"),p("XRANGEIDENTIFIERLOOSE",`${l[u.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),p("XRANGEIDENTIFIER",`${l[u.NUMERICIDENTIFIER]}|x|X|\\*`),p("XRANGEPLAIN",`[v=\\s]*(${l[u.XRANGEIDENTIFIER]})(?:\\.(${l[u.XRANGEIDENTIFIER]})(?:\\.(${l[u.XRANGEIDENTIFIER]})(?:${l[u.PRERELEASE]})?${l[u.BUILD]}?)?)?`),p("XRANGEPLAINLOOSE",`[v=\\s]*(${l[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[u.XRANGEIDENTIFIERLOOSE]})(?:${l[u.PRERELEASELOOSE]})?${l[u.BUILD]}?)?)?`),p("XRANGE",`^${l[u.GTLT]}\\s*${l[u.XRANGEPLAIN]}$`),p("XRANGELOOSE",`^${l[u.GTLT]}\\s*${l[u.XRANGEPLAINLOOSE]}$`),p("COERCEPLAIN",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?`),p("COERCE",`${l[u.COERCEPLAIN]}(?:$|[^\\d])`),p("COERCEFULL",l[u.COERCEPLAIN]+`(?:${l[u.PRERELEASE]})?(?:${l[u.BUILD]})?(?:$|[^\\d])`),p("COERCERTL",l[u.COERCE],!0),p("COERCERTLFULL",l[u.COERCEFULL],!0),p("LONETILDE","(?:~>?)"),p("TILDETRIM",`(\\s*)${l[u.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",p("TILDE",`^${l[u.LONETILDE]}${l[u.XRANGEPLAIN]}$`),p("TILDELOOSE",`^${l[u.LONETILDE]}${l[u.XRANGEPLAINLOOSE]}$`),p("LONECARET","(?:\\^)"),p("CARETTRIM",`(\\s*)${l[u.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",p("CARET",`^${l[u.LONECARET]}${l[u.XRANGEPLAIN]}$`),p("CARETLOOSE",`^${l[u.LONECARET]}${l[u.XRANGEPLAINLOOSE]}$`),p("COMPARATORLOOSE",`^${l[u.GTLT]}\\s*(${l[u.LOOSEPLAIN]})$|^$`),p("COMPARATOR",`^${l[u.GTLT]}\\s*(${l[u.FULLPLAIN]})$|^$`),p("COMPARATORTRIM",`(\\s*)${l[u.GTLT]}\\s*(${l[u.LOOSEPLAIN]}|${l[u.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",p("HYPHENRANGE",`^\\s*(${l[u.XRANGEPLAIN]})\\s+-\\s+(${l[u.XRANGEPLAIN]})\\s*$`),p("HYPHENRANGELOOSE",`^\\s*(${l[u.XRANGEPLAINLOOSE]})\\s+-\\s+(${l[u.XRANGEPLAINLOOSE]})\\s*$`),p("STAR","(<|>)?=?\\s*\\*"),p("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),p("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(zS,zS.exports);var n5=zS.exports;const NT=/^[0-9]+$/,qW=(e,t)=>{const n=NT.test(e),r=NT.test(t);return n&&r&&(e=+e,t=+t),e===t?0:n&&!r?-1:r&&!n?1:e<t?-1:1},wSe=(e,t)=>qW(t,e);var bSe={compareIdentifiers:qW,rcompareIdentifiers:wSe};const g0=Fx,{MAX_LENGTH:RT,MAX_SAFE_INTEGER:m0}=t5,{safeRe:DT,t:OT}=n5,ESe=e5,{compareIdentifiers:ju}=bSe;let SSe=class Hi{constructor(t,n){if(n=ESe(n),t instanceof Hi){if(t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease)return t;t=t.version}else if(typeof t!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof t}".`);if(t.length>RT)throw new TypeError(`version is longer than ${RT} characters`);g0("SemVer",t,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;const r=t.trim().match(n.loose?DT[OT.LOOSE]:DT[OT.FULL]);if(!r)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>m0||this.major<0)throw new TypeError("Invalid major version");if(this.minor>m0||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>m0||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){const o=+i;if(o>=0&&o<m0)return o}return i}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(g0("SemVer.compare",this.version,this.options,t),!(t instanceof Hi)){if(typeof t=="string"&&t===this.version)return 0;t=new Hi(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof Hi||(t=new Hi(t,this.options)),ju(this.major,t.major)||ju(this.minor,t.minor)||ju(this.patch,t.patch)}comparePre(t){if(t instanceof Hi||(t=new Hi(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let n=0;do{const r=this.prerelease[n],i=t.prerelease[n];if(g0("prerelease compare",n,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return ju(r,i)}while(++n)}compareBuild(t){t instanceof Hi||(t=new Hi(t,this.options));let n=0;do{const r=this.build[n],i=t.build[n];if(g0("build compare",n,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return ju(r,i)}while(++n)}inc(t,n,r){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",n,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",n,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",n,r),this.inc("pre",n,r);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",n,r),this.inc("pre",n,r);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const i=Number(r)?1:0;if(!n&&r===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[i];else{let o=this.prerelease.length;for(;--o>=0;)typeof this.prerelease[o]=="number"&&(this.prerelease[o]++,o=-2);if(o===-1){if(n===this.prerelease.join(".")&&r===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(i)}}if(n){let o=[n,i];r===!1&&(o=[n]),ju(this.prerelease[0],n)===0?isNaN(this.prerelease[1])&&(this.prerelease=o):this.prerelease=o}break}default:throw new Error(`invalid increment argument: ${t}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};var r5=SSe;const PT=r5,_Se=(e,t,n)=>new PT(e,n).compare(new PT(t,n));var Wf=_Se;const kSe=Wf,CSe=(e,t,n)=>kSe(e,t,n)===0;var $Se=CSe;const ASe=Wf,FSe=(e,t,n)=>ASe(e,t,n)!==0;var MSe=FSe;const TSe=Wf,NSe=(e,t,n)=>TSe(e,t,n)>0;var RSe=NSe;const DSe=Wf,OSe=(e,t,n)=>DSe(e,t,n)>=0;var PSe=OSe;const LSe=Wf,zSe=(e,t,n)=>LSe(e,t,n)<0;var ISe=zSe;const jSe=Wf,BSe=(e,t,n)=>jSe(e,t,n)<=0;var USe=BSe;const WSe=$Se,qSe=MSe,HSe=RSe,VSe=PSe,GSe=ISe,YSe=USe,XSe=(e,t,n,r)=>{switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e===n;case"!==":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e!==n;case"":case"=":case"==":return WSe(e,n,r);case"!=":return qSe(e,n,r);case">":return HSe(e,n,r);case">=":return VSe(e,n,r);case"<":return GSe(e,n,r);case"<=":return YSe(e,n,r);default:throw new TypeError(`Invalid operator: ${t}`)}};var QSe=XSe,$w,LT;function KSe(){if(LT)return $w;LT=1;const e=Symbol("SemVer ANY");class t{static get ANY(){return e}constructor(c,f){if(f=n(f),c instanceof t){if(c.loose===!!f.loose)return c;c=c.value}c=c.trim().split(/\s+/).join(" "),s("comparator",c,f),this.options=f,this.loose=!!f.loose,this.parse(c),this.semver===e?this.value="":this.value=this.operator+this.semver.version,s("comp",this)}parse(c){const f=this.options.loose?r[i.COMPARATORLOOSE]:r[i.COMPARATOR],d=c.match(f);if(!d)throw new TypeError(`Invalid comparator: ${c}`);this.operator=d[1]!==void 0?d[1]:"",this.operator==="="&&(this.operator=""),d[2]?this.semver=new a(d[2],this.options.loose):this.semver=e}toString(){return this.value}test(c){if(s("Comparator.test",c,this.options.loose),this.semver===e||c===e)return!0;if(typeof c=="string")try{c=new a(c,this.options)}catch{return!1}return o(c,this.operator,this.semver,this.options)}intersects(c,f){if(!(c instanceof t))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new l(c.value,f).test(this.value):c.operator===""?c.value===""?!0:new l(this.value,f).test(c.semver):(f=n(f),f.includePrerelease&&(this.value==="<0.0.0-0"||c.value==="<0.0.0-0")||!f.includePrerelease&&(this.value.startsWith("<0.0.0")||c.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&c.operator.startsWith(">")||this.operator.startsWith("<")&&c.operator.startsWith("<")||this.semver.version===c.semver.version&&this.operator.includes("=")&&c.operator.includes("=")||o(this.semver,"<",c.semver,f)&&this.operator.startsWith(">")&&c.operator.startsWith("<")||o(this.semver,">",c.semver,f)&&this.operator.startsWith("<")&&c.operator.startsWith(">")))}}$w=t;const n=e5,{safeRe:r,t:i}=n5,o=QSe,s=Fx,a=r5,l=HW();return $w}var Aw,zT;function HW(){if(zT)return Aw;zT=1;class e{constructor(T,F){if(F=r(F),T instanceof e)return T.loose===!!F.loose&&T.includePrerelease===!!F.includePrerelease?T:new e(T.raw,F);if(T instanceof i)return this.raw=T.value,this.set=[[T]],this.format(),this;if(this.options=F,this.loose=!!F.loose,this.includePrerelease=!!F.includePrerelease,this.raw=T.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(R=>this.parseRange(R.trim())).filter(R=>R.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const R=this.set[0];if(this.set=this.set.filter(L=>!p(L[0])),this.set.length===0)this.set=[R];else if(this.set.length>1){for(const L of this.set)if(L.length===1&&g(L[0])){this.set=[L];break}}}this.format()}format(){return this.range=this.set.map(T=>T.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(T){const R=((this.options.includePrerelease&&d)|(this.options.loose&&h))+":"+T,L=n.get(R);if(L)return L;const N=this.options.loose,D=N?a[l.HYPHENRANGELOOSE]:a[l.HYPHENRANGE];T=T.replace(D,$(this.options.includePrerelease)),o("hyphen replace",T),T=T.replace(a[l.COMPARATORTRIM],u),o("comparator trim",T),T=T.replace(a[l.TILDETRIM],c),o("tilde trim",T),T=T.replace(a[l.CARETTRIM],f),o("caret trim",T);let U=T.split(" ").map(pe=>m(pe,this.options)).join(" ").split(/\s+/).map(pe=>C(pe,this.options));N&&(U=U.filter(pe=>(o("loose invalid filter",pe,this.options),!!pe.match(a[l.COMPARATORLOOSE])))),o("range list",U);const K=new Map,se=U.map(pe=>new i(pe,this.options));for(const pe of se){if(p(pe))return[pe];K.set(pe.value,pe)}K.size>1&&K.has("")&&K.delete("");const be=[...K.values()];return n.set(R,be),be}intersects(T,F){if(!(T instanceof e))throw new TypeError("a Range is required");return this.set.some(R=>y(R,F)&&T.set.some(L=>y(L,F)&&R.every(N=>L.every(D=>N.intersects(D,F)))))}test(T){if(!T)return!1;if(typeof T=="string")try{T=new s(T,this.options)}catch{return!1}for(let F=0;F<this.set.length;F++)if(O(this.set[F],T,this.options))return!0;return!1}}Aw=e;const t=cSe,n=new t,r=e5,i=KSe(),o=Fx,s=r5,{safeRe:a,t:l,comparatorTrimReplace:u,tildeTrimReplace:c,caretTrimReplace:f}=n5,{FLAG_INCLUDE_PRERELEASE:d,FLAG_LOOSE:h}=t5,p=A=>A.value==="<0.0.0-0",g=A=>A.value==="",y=(A,T)=>{let F=!0;const R=A.slice();let L=R.pop();for(;F&&R.length;)F=R.every(N=>L.intersects(N,T)),L=R.pop();return F},m=(A,T)=>(o("comp",A,T),A=b(A,T),o("caret",A),A=x(A,T),o("tildes",A),A=E(A,T),o("xrange",A),A=k(A,T),o("stars",A),A),v=A=>!A||A.toLowerCase()==="x"||A==="*",x=(A,T)=>A.trim().split(/\s+/).map(F=>w(F,T)).join(" "),w=(A,T)=>{const F=T.loose?a[l.TILDELOOSE]:a[l.TILDE];return A.replace(F,(R,L,N,D,U)=>{o("tilde",A,R,L,N,D,U);let K;return v(L)?K="":v(N)?K=`>=${L}.0.0 <${+L+1}.0.0-0`:v(D)?K=`>=${L}.${N}.0 <${L}.${+N+1}.0-0`:U?(o("replaceTilde pr",U),K=`>=${L}.${N}.${D}-${U} <${L}.${+N+1}.0-0`):K=`>=${L}.${N}.${D} <${L}.${+N+1}.0-0`,o("tilde return",K),K})},b=(A,T)=>A.trim().split(/\s+/).map(F=>S(F,T)).join(" "),S=(A,T)=>{o("caret",A,T);const F=T.loose?a[l.CARETLOOSE]:a[l.CARET],R=T.includePrerelease?"-0":"";return A.replace(F,(L,N,D,U,K)=>{o("caret",A,L,N,D,U,K);let se;return v(N)?se="":v(D)?se=`>=${N}.0.0${R} <${+N+1}.0.0-0`:v(U)?N==="0"?se=`>=${N}.${D}.0${R} <${N}.${+D+1}.0-0`:se=`>=${N}.${D}.0${R} <${+N+1}.0.0-0`:K?(o("replaceCaret pr",K),N==="0"?D==="0"?se=`>=${N}.${D}.${U}-${K} <${N}.${D}.${+U+1}-0`:se=`>=${N}.${D}.${U}-${K} <${N}.${+D+1}.0-0`:se=`>=${N}.${D}.${U}-${K} <${+N+1}.0.0-0`):(o("no pr"),N==="0"?D==="0"?se=`>=${N}.${D}.${U}${R} <${N}.${D}.${+U+1}-0`:se=`>=${N}.${D}.${U}${R} <${N}.${+D+1}.0-0`:se=`>=${N}.${D}.${U} <${+N+1}.0.0-0`),o("caret return",se),se})},E=(A,T)=>(o("replaceXRanges",A,T),A.split(/\s+/).map(F=>_(F,T)).join(" ")),_=(A,T)=>{A=A.trim();const F=T.loose?a[l.XRANGELOOSE]:a[l.XRANGE];return A.replace(F,(R,L,N,D,U,K)=>{o("xRange",A,R,L,N,D,U,K);const se=v(N),be=se||v(D),pe=be||v(U),Re=pe;return L==="="&&Re&&(L=""),K=T.includePrerelease?"-0":"",se?L===">"||L==="<"?R="<0.0.0-0":R="*":L&&Re?(be&&(D=0),U=0,L===">"?(L=">=",be?(N=+N+1,D=0,U=0):(D=+D+1,U=0)):L==="<="&&(L="<",be?N=+N+1:D=+D+1),L==="<"&&(K="-0"),R=`${L+N}.${D}.${U}${K}`):be?R=`>=${N}.0.0${K} <${+N+1}.0.0-0`:pe&&(R=`>=${N}.${D}.0${K} <${N}.${+D+1}.0-0`),o("xRange return",R),R})},k=(A,T)=>(o("replaceStars",A,T),A.trim().replace(a[l.STAR],"")),C=(A,T)=>(o("replaceGTE0",A,T),A.trim().replace(a[T.includePrerelease?l.GTE0PRE:l.GTE0],"")),$=A=>(T,F,R,L,N,D,U,K,se,be,pe,Re)=>(v(R)?F="":v(L)?F=`>=${R}.0.0${A?"-0":""}`:v(N)?F=`>=${R}.${L}.0${A?"-0":""}`:D?F=`>=${F}`:F=`>=${F}${A?"-0":""}`,v(se)?K="":v(be)?K=`<${+se+1}.0.0-0`:v(pe)?K=`<${se}.${+be+1}.0-0`:Re?K=`<=${se}.${be}.${pe}-${Re}`:A?K=`<${se}.${be}.${+pe+1}-0`:K=`<=${K}`,`${F} ${K}`.trim()),O=(A,T,F)=>{for(let R=0;R<A.length;R++)if(!A[R].test(T))return!1;if(T.prerelease.length&&!F.includePrerelease){for(let R=0;R<A.length;R++)if(o(A[R].semver),A[R].semver!==i.ANY&&A[R].semver.prerelease.length>0){const L=A[R].semver;if(L.major===T.major&&L.minor===T.minor&&L.patch===T.patch)return!0}return!1}return!0};return Aw}const ZSe=HW(),JSe=(e,t,n)=>{try{t=new ZSe(t,n)}catch{return!1}return t.test(e)};var e_e=JSe,VW=lSe(e_e);function t_e(e,t,n){const r=e.open(t),i=1e4,o=250,{origin:s}=new URL(t);let a=~~(i/o);function l(c){c.source===r&&(a=0,e.removeEventListener("message",l,!1))}e.addEventListener("message",l,!1);function u(){a<=0||(r.postMessage(n,s),setTimeout(u,o),a-=1)}setTimeout(u,o)}var n_e=`.vega-embed {
  position: relative;
  display: inline-block;
  box-sizing: border-box;
}
.vega-embed.has-actions {
  padding-right: 38px;
}
.vega-embed details:not([open]) > :not(summary) {
  display: none !important;
}
.vega-embed summary {
  list-style: none;
  position: absolute;
  top: 0;
  right: 0;
  padding: 6px;
  z-index: 1000;
  background: white;
  box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
  color: #1b1e23;
  border: 1px solid #aaa;
  border-radius: 999px;
  opacity: 0.2;
  transition: opacity 0.4s ease-in;
  cursor: pointer;
  line-height: 0px;
}
.vega-embed summary::-webkit-details-marker {
  display: none;
}
.vega-embed summary:active {
  box-shadow: #aaa 0px 0px 0px 1px inset;
}
.vega-embed summary svg {
  width: 14px;
  height: 14px;
}
.vega-embed details[open] summary {
  opacity: 0.7;
}
.vega-embed:hover summary, .vega-embed:focus-within summary {
  opacity: 1 !important;
  transition: opacity 0.2s ease;
}
.vega-embed .vega-actions {
  position: absolute;
  z-index: 1001;
  top: 35px;
  right: -9px;
  display: flex;
  flex-direction: column;
  padding-bottom: 8px;
  padding-top: 8px;
  border-radius: 4px;
  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);
  border: 1px solid #d9d9d9;
  background: white;
  animation-duration: 0.15s;
  animation-name: scale-in;
  animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);
  text-align: left;
}
.vega-embed .vega-actions a {
  padding: 8px 16px;
  font-family: sans-serif;
  font-size: 14px;
  font-weight: 600;
  white-space: nowrap;
  color: #434a56;
  text-decoration: none;
}
.vega-embed .vega-actions a:hover, .vega-embed .vega-actions a:focus {
  background-color: #f7f7f9;
  color: black;
}
.vega-embed .vega-actions::before, .vega-embed .vega-actions::after {
  content: "";
  display: inline-block;
  position: absolute;
}
.vega-embed .vega-actions::before {
  left: auto;
  right: 14px;
  top: -16px;
  border: 8px solid rgba(0, 0, 0, 0);
  border-bottom-color: #d9d9d9;
}
.vega-embed .vega-actions::after {
  left: auto;
  right: 15px;
  top: -14px;
  border: 7px solid rgba(0, 0, 0, 0);
  border-bottom-color: #fff;
}
.vega-embed .chart-wrapper.fit-x {
  width: 100%;
}
.vega-embed .chart-wrapper.fit-y {
  height: 100%;
}

.vega-embed-wrapper {
  max-width: 100%;
  overflow: auto;
  padding-right: 14px;
}

@keyframes scale-in {
  from {
    opacity: 0;
    transform: scale(0.6);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}
`;function GW(e,...t){for(const n of t)r_e(e,n);return e}function r_e(e,t){for(const n of Object.keys(t))wf(e,n,t[n],!0)}const ai=Vge;let pp=Zbe;const y0=typeof window<"u"?window:void 0;var WT;pp===void 0&&((WT=y0==null?void 0:y0.vl)!=null&&WT.compile)&&(pp=y0.vl);const i_e={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},o_e={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},Qd={vega:"Vega","vega-lite":"Vega-Lite"},oy={vega:ai.version,"vega-lite":pp?pp.version:"not available"},s_e={vega:e=>e,"vega-lite":(e,t)=>pp.compile(e,{config:t}).spec},a_e=`
<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
  <circle r="2" cy="8" cx="2"></circle>
  <circle r="2" cy="8" cx="8"></circle>
  <circle r="2" cy="8" cx="14"></circle>
</svg>`,l_e="chart-wrapper";function u_e(e){return typeof e=="function"}function IT(e,t,n,r){const i=`<html><head>${t}</head><body><pre><code class="json">`,o=`</code></pre>${n}</body></html>`,s=window.open("");s.document.write(i+e+o),s.document.title=`${Qd[r]} JSON Source`}function c_e(e,t){if(e.$schema){const n=IW(e.$schema);t&&t!==n.library&&console.warn(`The given visualization spec is written in ${Qd[n.library]}, but mode argument sets ${Qd[t]??t}.`);const r=n.library;return VW(oy[r],`^${n.version.slice(1)}`)||console.warn(`The input spec uses ${Qd[r]} ${n.version}, but the current version of ${Qd[r]} is v${oy[r]}.`),r}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":t??"vega"}function YW(e){return!!(e&&"load"in e)}function jT(e){return YW(e)?e:ai.loader(e)}function f_e(e){var n;const t=((n=e.usermeta)==null?void 0:n.embedOptions)??{};return ee(t.defaultStyle)&&(t.defaultStyle=!1),t}async function d_e(e,t,n={}){let r,i;ee(t)?(i=jT(n.loader),r=JSON.parse(await i.load(t))):r=t;const o=f_e(r),s=o.loader;(!i||s)&&(i=jT(n.loader??s));const a=await BT(o,i),l=await BT(n,i),u={...GW(l,a),config:xf(l.config??{},a.config??{})};return await p_e(e,r,u,i)}async function BT(e,t){const n=ee(e.config)?JSON.parse(await t.load(e.config)):e.config??{},r=ee(e.patch)?JSON.parse(await t.load(e.patch)):e.patch;return{...e,...r?{patch:r}:{},...n?{config:n}:{}}}function h_e(e){const t=e.getRootNode?e.getRootNode():document;return t instanceof ShadowRoot?{root:t,rootContainer:t}:{root:document,rootContainer:document.head??document.body}}async function p_e(e,t,n={},r){const i=n.theme?xf(JEe[n.theme],n.config??{}):n.config,o=Da(n.actions)?n.actions:GW({},i_e,n.actions??{}),s={...o_e,...n.i18n},a=n.renderer??"canvas",l=n.logLevel??ai.Warn,u=n.downloadFileName??"visualization",c=typeof e=="string"?document.querySelector(e):e;if(!c)throw new Error(`${e} does not exist`);if(n.defaultStyle!==!1){const b="vega-embed-style",{root:S,rootContainer:E}=h_e(c);if(!S.getElementById(b)){const _=document.createElement("style");_.id=b,_.innerHTML=n.defaultStyle===void 0||n.defaultStyle===!0?n_e.toString():n.defaultStyle,E.appendChild(_)}}const f=c_e(t,n.mode);let d=s_e[f](t,i);if(f==="vega-lite"&&d.$schema){const b=IW(d.$schema);VW(oy.vega,`^${b.version.slice(1)}`)||console.warn(`The compiled spec uses Vega ${b.version}, but current version is v${oy.vega}.`)}c.classList.add("vega-embed"),o&&c.classList.add("has-actions"),c.innerHTML="";let h=c;if(o){const b=document.createElement("div");b.classList.add(l_e),c.appendChild(b),h=b}const p=n.patch;if(p&&(d=p instanceof Function?p(d):_y(d,p,!0,!1).newDocument),n.formatLocale&&ai.formatLocale(n.formatLocale),n.timeFormatLocale&&ai.timeFormatLocale(n.timeFormatLocale),n.expressionFunctions)for(const b in n.expressionFunctions){const S=n.expressionFunctions[b];"fn"in S?ai.expressionFunction(b,S.fn,S.visitor):S instanceof Function&&ai.expressionFunction(b,S)}const{ast:g}=n,y=ai.parse(d,f==="vega-lite"?{}:i,{ast:g}),m=new(n.viewClass||ai.View)(y,{loader:r,logLevel:l,renderer:a,...g?{expr:ai.expressionInterpreter??n.expr??n0e}:{}});if(m.addSignalListener("autosize",(b,S)=>{const{type:E}=S;E=="fit-x"?(h.classList.add("fit-x"),h.classList.remove("fit-y")):E=="fit-y"?(h.classList.remove("fit-x"),h.classList.add("fit-y")):E=="fit"?h.classList.add("fit-x","fit-y"):h.classList.remove("fit-x","fit-y")}),n.tooltip!==!1){const{loader:b,tooltip:S}=n,E=b&&!YW(b)?b==null?void 0:b.baseURL:void 0,_=u_e(S)?S:new aSe({baseURL:E,...S===!0?{}:S}).call;m.tooltip(_)}let{hover:v}=n;if(v===void 0&&(v=f==="vega"),v){const{hoverSet:b,updateSet:S}=typeof v=="boolean"?{}:v;m.hover(b,S)}n&&(n.width!=null&&m.width(n.width),n.height!=null&&m.height(n.height),n.padding!=null&&m.padding(n.padding)),await m.initialize(h,n.bind).runAsync();let x;if(o!==!1){let b=c;if(n.defaultStyle!==!1||n.forceActionsMenu){const E=document.createElement("details");E.title=s.CLICK_TO_VIEW_ACTIONS,c.append(E),b=E;const _=document.createElement("summary");_.innerHTML=a_e,E.append(_),x=k=>{E.contains(k.target)||E.removeAttribute("open")},document.addEventListener("click",x)}const S=document.createElement("div");if(b.append(S),S.classList.add("vega-actions"),o===!0||o.export!==!1){for(const E of["svg","png"])if(o===!0||o.export===!0||o.export[E]){const _=s[`${E.toUpperCase()}_ACTION`],k=document.createElement("a"),C=Z(n.scaleFactor)?n.scaleFactor[E]:n.scaleFactor;k.text=_,k.href="#",k.target="_blank",k.download=`${u}.${E}`,k.addEventListener("mousedown",async function($){$.preventDefault();const O=await m.toImageURL(E,C);this.href=O}),S.append(k)}}if(o===!0||o.source!==!1){const E=document.createElement("a");E.text=s.SOURCE_ACTION,E.href="#",E.addEventListener("click",function(_){IT(r2(t),n.sourceHeader??"",n.sourceFooter??"",f),_.preventDefault()}),S.append(E)}if(f==="vega-lite"&&(o===!0||o.compiled!==!1)){const E=document.createElement("a");E.text=s.COMPILED_ACTION,E.href="#",E.addEventListener("click",function(_){IT(r2(d),n.sourceHeader??"",n.sourceFooter??"","vega"),_.preventDefault()}),S.append(E)}if(o===!0||o.editor!==!1){const E=n.editorUrl??"https://vega.github.io/editor/",_=document.createElement("a");_.text=s.EDITOR_ACTION,_.href="#",_.addEventListener("click",function(k){t_e(window,E,{config:i,mode:p?"vega":f,renderer:a,spec:r2(p?d:t)}),k.preventDefault()}),S.append(_)}}function w(){x&&document.removeEventListener("click",x),m.finalize()}return{view:m,spec:t,vgSpec:d,finalize:w,embedOptions:n}}function g_e(e){return!!e&&{}.toString.call(e)==="[object Function]"}function m_e(e,t,n){n&&(g_e(n)?n(e.data(t)):e.change(t,ai.changeset().remove(()=>!0).insert(n)))}function y_e(e,t){Object.keys(t).forEach(n=>{m_e(e,n,t[n])})}function XW(e){const t=new Set;return e.forEach(n=>{Object.keys(n).forEach(r=>{t.add(r)})}),t}const QW=()=>{};function Fw(e,t){const n=Object.keys(t);return n.forEach(r=>{try{e.addSignalListener(r,t[r])}catch(i){console.warn("Cannot add invalid signal listener.",i)}}),n.length>0}var v_e=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var r,i,o;if(Array.isArray(t)){if(r=t.length,r!=n.length)return!1;for(i=r;i--!==0;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(o=Object.keys(t),r=o.length,r!==Object.keys(n).length)return!1;for(i=r;i--!==0;)if(!Object.prototype.hasOwnProperty.call(n,o[i]))return!1;for(i=r;i--!==0;){var s=o[i];if(!e(t[s],n[s]))return!1}return!0}return t!==t&&n!==n};const x_e=sy(v_e);function w_e(e,t){if(e===t)return!1;const n={width:!1,height:!1,isExpensive:!1},r=XW([e,t]);return r.has("width")&&(!("width"in e)||!("width"in t)||e.width!==t.width)&&("width"in e&&typeof e.width=="number"?n.width=e.width:n.isExpensive=!0),r.has("height")&&(!("height"in e)||!("height"in t)||e.height!==t.height)&&("height"in e&&typeof e.height=="number"?n.height=e.height:n.isExpensive=!0),r.delete("width"),r.delete("height"),[...r].some(i=>!(i in e)||!(i in t)||!x_e(e[i],t[i]))&&(n.isExpensive=!0),n.width!==!1||n.height!==!1||n.isExpensive?n:!1}function UT(e,t){const n=Object.keys(t);return n.forEach(r=>{try{e.removeSignalListener(r,t[r])}catch(i){console.warn("Cannot remove invalid signal listener.",i)}}),n.length>0}function Mw(e){const{spec:t,width:n,height:r}=e;return typeof n<"u"&&typeof r<"u"?{...t,width:n,height:r}:typeof n<"u"?{...t,width:n}:typeof r<"u"?{...t,height:r}:t}function Kd(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class KW extends El.PureComponent{constructor(){super(...arguments),Kd(this,"containerRef",El.createRef()),Kd(this,"resultPromise",void 0),Kd(this,"handleError",t=>{const{onError:n=QW}=this.props;n(t,this.containerRef.current),console.warn(t)}),Kd(this,"modifyView",t=>{this.resultPromise&&this.resultPromise.then(n=>(n&&t(n.view),!0)).catch(this.handleError)})}componentDidMount(){this.createView()}componentDidUpdate(t){const n=XW([this.props,t]);if(n.delete("className"),n.delete("signalListeners"),n.delete("spec"),n.delete("style"),n.delete("width"),n.delete("height"),Array.from(n).some(r=>this.props[r]!==t[r]))this.clearView(),this.createView();else{const r=w_e(Mw(this.props),Mw(t)),{signalListeners:i}=this.props,{signalListeners:o}=t;if(r)if(r.isExpensive)this.clearView(),this.createView();else{const s=!_b(i,o);this.modifyView(a=>{r.width!==!1&&a.width(r.width),r.height!==!1&&a.height(r.height),s&&(o&&UT(a,o),i&&Fw(a,i)),a.run()})}else _b(i,o)||this.modifyView(s=>{o&&UT(s,o),i&&Fw(s,i),s.run()})}}componentWillUnmount(){this.clearView()}createView(){const{spec:t,onNewView:n,signalListeners:r={},width:i,height:o,...s}=this.props;if(this.containerRef.current){const a=Mw(this.props);this.resultPromise=d_e(this.containerRef.current,a,s).then(l=>{if(l){const{view:u}=l;Fw(u,r)&&u.run()}return l}).catch(this.handleError),n&&this.modifyView(n)}}clearView(){return this.resultPromise&&this.resultPromise.then(t=>{t&&t.finalize()}).catch(this.handleError),this.resultPromise=void 0,this}render(){const{className:t,style:n}=this.props;return El.createElement("div",{ref:this.containerRef,className:t,style:n})}}Kd(KW,"propTypes",{className:m4.string,onError:m4.func});function IS(){return IS=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},IS.apply(this,arguments)}function jS(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const b_e={};class ZW extends El.PureComponent{constructor(){super(...arguments),jS(this,"vegaEmbed",El.createRef()),jS(this,"handleNewView",t=>{this.update();const{onNewView:n=QW}=this.props;n(t)})}componentDidMount(){this.update()}componentDidUpdate(t){_b(this.props.data,t.data)||this.update()}update(){const{data:t}=this.props;this.vegaEmbed.current&&t&&Object.keys(t).length>0&&this.vegaEmbed.current.modifyView(n=>{y_e(n,t),n.resize().run()})}render(){const{data:t,...n}=this.props;return El.createElement(KW,IS({ref:this.vegaEmbed},n,{onNewView:this.handleNewView}))}}jS(ZW,"defaultProps",{data:b_e});function BS(){return BS=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},BS.apply(this,arguments)}function E_e(e){return El.createElement(ZW,BS({},e,{mode:"vega-lite"}))}function i5(e){return M.jsx(E_e,{renderer:"svg",actions:!1,spec:{width:400,height:300,autosize:{type:"fit",resize:!0,contains:"content"},...e.spec},config:{font:"Montserrat",background:"#fff0"}})}function S_e(){const e=yf(n=>{var r;return(r=n.output)==null?void 0:r.averageDay},"time-series");let t=Array(24).fill(0).map((n,r)=>({time:r+1,mean:0,min:0,max:0,date:new Date(2024,1,1,r+1,0,0)}));return e&&(t=e.map(n=>({time:n.time+1,mean:n.mean,min:n.min,max:n.max,date:new Date(2024,1,1,n.time+1,0,0)}))),M.jsx(Sy,{spinning:e===void 0,children:M.jsx(i5,{spec:{encoding:{x:{field:"date",title:"Time of day",axis:{labelFontSize:12,titleFontSize:16},timeUnit:"hours"}},layer:[{mark:{opacity:.3,type:"area",ariaRoleDescription:"errorband",style:"errorband-band"},encoding:{y:{field:"min",type:"quantitative"},y2:{field:"max",type:"quantitative"}}},{mark:"line",encoding:{y:{field:"mean",type:"quantitative",title:"Power demand [kW]",axis:{labelFontSize:12,titleFontSize:16}}}},{mark:{type:"point",tooltip:!0},params:[{name:"picked",select:{type:"point",on:"pointerover",clear:"pointerout"}}],encoding:{y:{field:"mean",type:"quantitative"},color:{condition:{param:"picked",empty:!1,value:"darkblue"},value:"lightblue"}}}],data:{values:t}}})})}function __e(e,t){const n=new Date(e,0);return new Date(n.setDate(t))}function k_e(){const e=yf(n=>{var r;return(r=n.output)==null?void 0:r.totalEnergyCharged},"energy-over-year"),t=Array(12).fill(0).map((n,r)=>({month:r+1,sum:0,date:new Date(2024,r,1)}));if(e)for(const n of e){const i=__e(2024,n.day).getMonth()+1;t[i-1].sum+=n.kWh}return M.jsx(Sy,{spinning:e===void 0,children:M.jsx(i5,{spec:{encoding:{x:{field:"date",title:"Month",axis:{labelFontSize:12,titleFontSize:16},type:"temporal",timeUnit:"month"},y:{field:"sum",title:"Energy total [kWh]",type:"quantitative",axis:{labelFontSize:12,titleFontSize:16}}},layer:[{mark:{type:"line"}},{mark:{type:"point",tooltip:!0},params:[{name:"picked",select:{type:"point",on:"pointerover",clear:"pointerout"}}],encoding:{color:{condition:{param:"picked",empty:!1,value:"darkblue"},value:"lightblue"}}}],data:{values:t}}})})}function C_e(){const e=yf(i=>{var o;return(o=i.output)==null?void 0:o.energyPerStation},"energy-per-station"),[t,n]=uo.useState("year"),r=[];if(e)for(const[i,o]of Object.entries(e))r.push({stationNr:+i,energy:o[t]});return M.jsx(Sy,{spinning:e===void 0,children:M.jsx("div",{children:M.jsx(i5,{spec:{mark:{type:"bar",tooltip:!0},params:[{name:"picked",select:{type:"point",on:"pointerover",clear:"pointerout"}}],encoding:{x:{field:"stationNr",title:"Charging point",axis:{labelFontSize:12,titleFontSize:16}},y:{field:"energy",type:"quantitative",title:"Energy used [kWh]",axis:{labelFontSize:12,titleFontSize:16}},y2:{value:0},color:{condition:{param:"picked",empty:!1,value:"darkblue"},value:"lightblue"}},data:{values:r}}})})})}function $_e(e){const t=e.size||"24",n=e.color||"var(--color-secondary-1)",r=e.color2||"#c8c8c8",i=e.angle||0;return M.jsxs("svg",{width:t,height:t,viewBox:"5 5 95 95",children:[M.jsx("path",{d:"M 50 70 L 80 70 C 84 59 84 59 81 45 L 50 70 Z",fill:r}),M.jsx("path",{d:"M 20 70 L 80 70 C 100 10 0 10 20 70 Z",strokeWidth:"2",stroke:n,fill:"none"}),M.jsx("path",{transform:`rotate(${i}, 50, 75)`,d:"M 50 20 L 45 70 C 40 83 60 83 55 70 Z",strokeWidth:"1",stroke:n,fill:n})]})}function A_e(){const e=Math.random()*33,t=33,r=-90+e/t*180;return M.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[M.jsx($_e,{angle:r,color:"gray",color2:"#c0d5e0",size:"calc(min(50%, 300px))"}),M.jsxs("div",{children:[M.jsxs("div",{style:{display:"flex",alignItems:"flex-end"},children:[M.jsx("div",{style:{fontSize:"xx-large",fontWeight:"bolder"},children:e.toFixed(1)}),M.jsxs("div",{style:{fontWeight:"bolder"},children:["/ ",t.toFixed(1)]})]}),M.jsxs("div",{style:{padding:"1rem"},children:[M.jsx("div",{style:{fontSize:"smaller"},children:"concurrency factor:"}),M.jsx("div",{style:{fontSize:"smaller"},children:"your settings / simulated"})]})]})]})}function F_e(){const e=yf(t=>{var n;return(n=t.output)==null?void 0:n.chargingEvents},"charging-events");return M.jsx(Sy,{spinning:e===void 0,children:M.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0rem",width:"100%",fontSize:"small"},children:[M.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[M.jsx("h5",{children:"Concurrency"}),M.jsx("div",{style:{margin:"auto"},children:M.jsx(A_e,{})})]}),M.jsxs("div",{style:{display:"flex",flexDirection:"column",marginTop:"-1rem"},children:[M.jsx("h5",{children:"Charging events (total)"}),M.jsx("table",{children:M.jsxs("tbody",{children:[M.jsxs("tr",{children:[M.jsx("td",{style:{textAlign:"end"},children:"Year"}),M.jsx("td",{style:{fontWeight:"bold"},children:Math.floor((e==null?void 0:e.year)||0)})]}),M.jsxs("tr",{children:[M.jsx("td",{style:{textAlign:"end"},children:"Month"}),M.jsx("td",{style:{fontWeight:"bold"},children:Math.floor((e==null?void 0:e.month)||0)})]}),M.jsxs("tr",{children:[M.jsx("td",{style:{textAlign:"end"},children:"Week"}),M.jsx("td",{style:{fontWeight:"bold"},children:Math.floor((e==null?void 0:e.week)||0)})]}),M.jsxs("tr",{children:[M.jsx("td",{style:{textAlign:"end"},children:"Day"}),M.jsx("td",{style:{fontWeight:"bold"},children:Math.floor((e==null?void 0:e.day)||0)})]})]})})]})]})})}function v0(e){return M.jsxs("div",{className:"graphContainer",children:[M.jsx("h3",{children:e.title}),e.children]})}function M_e(){return M.jsxs("div",{className:"graphs",children:[M.jsx(v0,{title:"Energy per station",children:M.jsx(C_e,{})}),M.jsx(v0,{title:"Energy over year",children:M.jsx(k_e,{})}),M.jsx(v0,{title:"Average day",children:M.jsx(S_e,{})}),M.jsx(v0,{title:"Events, Concurrency",children:M.jsx(F_e,{})})]})}function T_e(){return M.jsxs("div",{className:"dashboard",children:[M.jsx(KV,{}),M.jsx(M_e,{})]})}function N_e(e){const t=e.color||"var(--color-secondary-1)";return M.jsxs("svg",{width:e.width??200,height:e.height??30,xmlns:"http://www.w3.org/2000/svg",id:"svg5",version:"1.1",viewBox:"0 0 298.6001 63.038448",children:[M.jsxs("defs",{id:"defs2",children:[M.jsx("clipPath",{clipPathUnits:"userSpaceOnUse",id:"clipPath25",children:M.jsx("path",{d:"M 0,1.206994e-5 H 959.76 V 540.00001 H 0 Z",id:"path23"})}),M.jsx("clipPath",{clipPathUnits:"userSpaceOnUse",id:"clipPath35",children:M.jsx("path",{d:"M 0,0 H 960 V 540 H 0 Z",id:"path33"})}),M.jsx("clipPath",{clipPathUnits:"userSpaceOnUse",id:"clipPath1057",children:M.jsx("rect",{height:"65.130898",id:"rect1059",style:{strokeWidth:.271269},width:"39.721909",x:"-18.504492",y:"104.38057"})})]}),M.jsxs("g",{id:"layer1",transform:"translate(18.380696,-104.38057)",children:[M.jsx("g",{id:"g17",transform:"matrix(0.35277777,0,0,-0.35277777,-39.02458,225.93)"}),M.jsxs("g",{clipPath:"url(#clipPath1057)",id:"g1051",children:[M.jsx("path",{d:"m 22.702501,142.58636 c -20.8441285,1.77045 -39.176857,-13.69183 -40.9473,-34.53595 -0.103657,-1.2204 -0.148061,-2.4451 -0.133054,-3.66984 l 16.9935769,0.20824 c -0.1413298,11.53231 9.0928752,20.99568 20.6252161,21.137 0.675181,0.008 1.350398,-0.0162 2.023251,-0.0733 z",id:"path39",style:{fill:"#92d050",fillOpacity:.749,fillRule:"nonzero",stroke:"none",strokeWidth:.352778}}),M.jsx("path",{d:"m -1.8827476,167.42298 c 0,-20.91916 16.9583346,-37.8775 37.8775266,-37.8775 0.02978,0 0.05955,3e-5 0.08936,1e-4 l -0.03037,12.86168 c -13.815836,-0.0326 -25.042177,11.1409 -25.074774,24.95673 -3.5e-5,0.0196 -7e-5,0.0393 -7e-5,0.059 z",id:"path41",style:{fill:"#002060",fillOpacity:.749,fillRule:"nonzero",stroke:"none",strokeWidth:.352778}}),M.jsx("path",{d:"m -18.183885,167.42298 c 0,-20.91916 16.9583377,-37.8775 37.877509,-37.8775 1.661901,0 3.322003,0.10939 4.96951,0.32741 l -2.153885,16.27498 c -11.749898,-1.55501 -22.53569758,6.70958 -24.0907208,18.45948 -0.1235393,0.93345 -0.1855082,1.87403 -0.1855082,2.81563 z",id:"path43",style:{fill:"#ffc000",fillOpacity:.749,fillRule:"nonzero",stroke:"none",strokeWidth:.352778}}),M.jsx("path",{d:"m 36.38855,142.52533 c -20.919193,0 -37.87752,-16.95834 -37.87752,-37.8775 0,-0.0298 3.53e-5,-0.0596 1.059e-4,-0.0894 l 12.8616951,0.0304 c -0.03263,13.8158 11.140899,25.04214 24.956699,25.07474 0.01969,7e-5 0.03934,7e-5 0.05902,7e-5 z",id:"path45",style:{fill:"#ff0000",fillOpacity:.749,fillRule:"nonzero",stroke:"none",strokeWidth:.352778}})]}),M.jsx("path",{d:"M 44.082449,144.1339 H 33.790196 v 22.95301 H 20.87105 v -62.70092 h 23.297527 q 11.110465,0 17.1394,4.95234 6.028934,4.95234 6.028934,13.99574 0,6.41651 -2.799148,10.72289 -2.756084,4.26332 -8.397445,6.80409 l 13.565103,25.62297 v 0.60289 H 55.838872 Z M 33.790196,133.66939 H 44.21164 q 4.866212,0 7.536169,-2.45464 2.669957,-2.4977 2.669957,-6.84714 0,-4.43558 -2.540766,-6.97634 -2.497701,-2.54077 -7.708423,-2.54077 H 33.790196 Z",id:"path295",style:{fontWeight:"bold",fontSize:"88.1947px",fontFamily:"Roboto",strokeWidth:.0846667},fill:t}),M.jsx("path",{d:"m 96.708357,167.41902 q -10.249189,0 -16.708762,-6.28732 -6.416509,-6.28731 -6.416509,-16.75182 v -1.20579 q 0,-7.0194 2.71302,-12.53157 2.713021,-5.55523 7.66536,-8.52664 4.995403,-3.01446 11.368848,-3.01446 9.560166,0 15.029276,6.02893 5.51217,6.02893 5.51217,17.09634 v 5.08153 H 86.200785 q 0.602893,4.56476 3.61736,7.32085 3.057532,2.75608 7.708424,2.75608 7.191661,0 11.239661,-5.21072 l 6.11506,6.84715 q -2.79915,3.96187 -7.57923,6.20119 -4.78009,2.19625 -10.593703,2.19625 z m -1.421106,-38.24067 q -3.703489,0 -6.028935,2.4977 -2.282383,2.4977 -2.92834,7.14859 h 17.311654 v -0.99046 q -0.0861,-4.13413 -2.23932,-6.37345 -2.153188,-2.28238 -6.115059,-2.28238 z",id:"path297",style:{fontWeight:"bold",fontSize:"88.1947px",fontFamily:"Roboto",strokeWidth:.0846667},fill:t}),M.jsx("path",{d:"m 119.89138,142.82958 q 0,-6.93328 2.66996,-12.35932 2.66996,-5.42604 7.66536,-8.39744 5.03847,-2.9714 11.6703,-2.9714 9.43097,0 15.37378,5.77055 5.98587,5.77055 6.67489,15.67523 l 0.0861,3.18672 q 0,10.72289 -5.98587,17.22553 -5.98587,6.45957 -16.06281,6.45957 -10.07693,0 -16.10587,-6.45957 -5.98587,-6.45958 -5.98587,-17.57004 z m 12.44545,0.90434 q 0,6.63183 2.4977,10.16306 2.4977,3.48817 7.14859,3.48817 4.5217,0 7.06247,-3.44511 2.54076,-3.48816 2.54076,-11.11046 0,-6.50264 -2.54076,-10.07693 -2.54077,-3.5743 -7.14859,-3.5743 -4.56477,0 -7.06247,3.5743 -2.4977,3.53123 -2.4977,10.98127 z",id:"path299",style:{fontWeight:"bold",fontSize:"88.1947px",fontFamily:"Roboto",strokeWidth:.0846667},fill:t}),M.jsx("path",{d:"m 182.14396,120.49186 0.38758,5.38298 q 4.9954,-6.24425 13.39285,-6.24425 7.40697,0 11.02433,4.34944 3.61737,4.34945 3.70349,13.00527 v 30.10161 h -12.44544 v -29.80016 q 0,-3.96187 -1.72255,-5.72749 -1.72256,-1.80868 -5.72749,-1.80868 -5.25379,0 -7.88068,4.47864 v 32.85769 h -12.44544 v -46.59505 z",id:"path301",style:{fontWeight:"bold",fontSize:"88.1947px",fontFamily:"Roboto",strokeWidth:.0846667},fill:t}),M.jsx("path",{d:"m 218.93343,111.07984 q 0,-2.79915 1.85174,-4.60783 1.89481,-1.80868 5.1246,-1.80868 3.18672,0 5.08153,1.80868 1.89481,1.80868 1.89481,4.60783 0,2.84221 -1.93788,4.65089 -1.8948,1.80868 -5.03846,1.80868 -3.14366,0 -5.08153,-1.80868 -1.89481,-1.80868 -1.89481,-4.65089 z",id:"path361",style:{fontWeight:"bold",fontSize:"88.1947px",fontFamily:"Roboto",strokeWidth:.0846667},fill:t}),M.jsx("path",{d:"m 232.15402,167.08691 h -12.48851 v -46.59505 h 12.48851 z",id:"path303",style:{fontWeight:"bold",fontSize:"88.1947px",fontFamily:"Roboto",strokeWidth:.0846667},fill:t}),M.jsx("path",{d:"m 260.71148,157.38515 q 3.4451,0 5.59829,-1.89481 2.15319,-1.89481 2.23932,-5.03846 h 11.6703 q -0.0431,4.73702 -2.58383,8.69889 -2.54077,3.9188 -6.97634,6.11506 -4.39251,2.15319 -9.73242,2.15319 -9.99081,0 -15.76136,-6.33038 -5.77055,-6.37345 -5.77055,-17.57004 v -0.81821 q 0,-10.76596 5.72748,-17.18247 5.72749,-6.4165 15.7183,-6.4165 8.74195,0 13.99574,4.9954 5.29685,4.95234 5.38298,13.22059 h -11.6703 q -0.0861,-3.61736 -2.23932,-5.85668 -2.15319,-2.28238 -5.68442,-2.28238 -4.34945,0 -6.58877,3.18672 -2.19625,3.14366 -2.19625,10.24919 v 1.29192 q 0,7.19165 2.19625,10.33531 2.19626,3.14366 6.6749,3.14366 z",id:"path305",style:{fontWeight:"bold",fontSize:"88.1947px",fontFamily:"Roboto",strokeWidth:.0846667},fill:t})]})]})}function R_e(){return Cm({type:"init"}),M.jsxs("div",{className:"fullscreen",children:[M.jsxs("div",{className:"header",children:[M.jsx("h1",{children:"Demo app"}),M.jsx(N_e,{color:"white"})]}),M.jsx("div",{className:"body",children:M.jsx(T_e,{})})]})}nR(document.getElementById("root")).render(M.jsx(uo.StrictMode,{children:M.jsx(R_e,{})}))});export default D_e();
